"use strict";var Qv=Object.create;var dc=Object.defineProperty;var Zv=Object.getOwnPropertyDescriptor;var Xv=Object.getOwnPropertyNames;var eI=Object.getPrototypeOf,tI=Object.prototype.hasOwnProperty;var rI=(e,t,r)=>t in e?dc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Ci=(e,t)=>{for(var r in t)dc(e,r,{get:t[r],enumerable:!0})},oI=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Xv(t))!tI.call(e,n)&&n!==r&&dc(e,n,{get:()=>t[n],enumerable:!(o=Zv(t,n))||o.enumerable});return e};var Ri=(e,t,r)=>(r=e!=null?Qv(eI(e)):{},oI(t||!e||!e.__esModule?dc(r,"default",{value:e,enumerable:!0}):r,e));var Nt=(e,t,r)=>(rI(e,typeof t!="symbol"?t+"":t,r),r);var Eg=e=>typeof e=="function",a=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):r=>t(r,...arguments)};switch(e){case 0:return t;case 1:return function(r){return arguments.length>=1?t(r):function(){return t(r)}};case 2:return function(r,o){return arguments.length>=2?t(r,o):function(n){return t(n,r)}};case 3:return function(r,o,n){return arguments.length>=3?t(r,o,n):function(s){return t(s,r,o)}};case 4:return function(r,o,n,s){return arguments.length>=4?t(r,o,n,s):function(i){return t(i,r,o,n)}};case 5:return function(r,o,n,s,i){return arguments.length>=5?t(r,o,n,s,i):function(c){return t(c,r,o,n,s)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(o){return t(o,...r)}}}};var F=e=>e;var Ai=e=>()=>e,Or=Ai(!0),Dt=Ai(!1);var xc=Ai(void 0),es=xc;function ne(e,t,r,o,n,s,i,c,p){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return o(r(t(e)));case 5:return n(o(r(t(e))));case 6:return s(n(o(r(t(e)))));case 7:return i(s(n(o(r(t(e))))));case 8:return c(i(s(n(o(r(t(e)))))));case 9:return p(c(i(s(n(o(r(t(e))))))));default:{let u=arguments[0];for(let f=1;f<arguments.length;f++)u=arguments[f](u);return u}}}var gc=e=>(t,r)=>t===r||e(t,r);var _g=a(2,(e,t)=>gc((r,o)=>e(t(r),t(o))));var Og=e=>gc((t,r)=>{if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(!e(t[o],r[o]))return!1;return!0});var yc=e=>(t,r)=>t===r?0:e(t,r);var Cg=yc((e,t)=>e<t?-1:1);var Rg=e=>yc((t,r)=>e(r,t));var Mi=a(2,(e,t)=>yc((r,o)=>e(t(r),t(o))));var nI=e=>yc((t,r)=>{let o=Math.min(t.length,r.length),n=0;for(let s of e){if(n>=o)break;let i=s(t[n],r[n]);if(i!==0)return i;n++}return 0});var Ag=(...e)=>nI(e);var ef=e=>a(2,(t,r)=>e(t,r)===1);var tf=e=>a(2,(t,r)=>t===r||e(t,r)>-1?t:r);var Ti=e=>typeof e=="string",Jo=e=>typeof e=="number",bc=e=>typeof e=="boolean",ts=e=>typeof e=="bigint",Mg=e=>typeof e=="symbol",Tg=Eg,vi=e=>e===void 0;var vg=e=>e===null;var Ig=e=>!1;var pe=e=>typeof e=="object"&&e!=null||Tg(e);var Qo=e=>e==null,kg=e=>e!=null;var Sc=e=>e instanceof Date,Lt=e=>pe(e)&&Symbol.iterator in e,Ii=e=>pe(e)&&!Array.isArray(e);var wg=e=>!e;var iI=335903614,aI=4150755663,cI=1481765933,pI=1284865837,uI=9007199254740992,lI=134217728,rs=class{constructor(t,r,o,n){return Qo(r)&&Qo(t)?(r=Math.random()*4294967295>>>0,t=0):Qo(r)&&(r=t,t=0),Qo(n)&&Qo(o)?(n=this._state?this._state[3]:aI,o=this._state?this._state[2]:iI):Qo(n)&&(n=o,o=0),this._state=new Int32Array([0,0,o>>>0,((n||0)|1)>>>0]),this._next(),Fg(this._state,this._state[0],this._state[1],t>>>0,r>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){if(!t)return this._next();if(t=t>>>0,!(t&t-1))return this._next()&t-1;let r=0,o=(-t>>>0)%t>>>0;for(r=this._next();r<o;r=this._next());return r%t}number(){let t=(this._next()&67108863)*1,r=(this._next()&134217727)*1;return(t*lI+r)/uI}_next(){let t=this._state[0]>>>0,r=this._state[1]>>>0;fI(this._state,t,r,cI,pI),Fg(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let o=t>>>18,n=(r>>>18|t<<14)>>>0;o=(o^t)>>>0,n=(n^r)>>>0;let s=(n>>>27|o<<5)>>>0,i=t>>>27,c=(-i>>>0&31)>>>0;return(s>>>i|s<<c)>>>0}};function fI(e,t,r,o,n){let s=(r>>>16)*(n&65535)>>>0,i=(r&65535)*(n>>>16)>>>0,c=(r&65535)*(n&65535)>>>0,p=(r>>>16)*(n>>>16)+((i>>>16)+(s>>>16))>>>0;i=i<<16>>>0,c=c+i>>>0,c>>>0<i>>>0&&(p=p+1>>>0),s=s<<16>>>0,c=c+s>>>0,c>>>0<s>>>0&&(p=p+1>>>0),p=p+Math.imul(r,o)>>>0,p=p+Math.imul(t,n)>>>0,e[0]=p,e[1]=c}function Fg(e,t,r,o,n){let s=t+o>>>0,i=r+n>>>0;i>>>0<r>>>0&&(s=s+1|0),e[0]=s,e[1]=i}var nf=Symbol.for("@effect/data/Global/globalStoreId");nf in globalThis||(globalThis[nf]=new Map);var of=globalThis[nf],K=(e,t)=>(of.has(e)||of.set(e,t()),of.get(e));var sf=K(Symbol.for("@effect/data/Hash/randomHashCache"),()=>new WeakMap),dI=K(Symbol.for("@effect/data/Hash/pcgr"),()=>new rs),A=Symbol.for("@effect/data/Hash"),S=e=>{switch(typeof e){case"number":return _c(e);case"bigint":return we(e.toString(10));case"boolean":return we(String(e));case"symbol":return we(String(e));case"string":return we(e);case"undefined":return we("undefined");case"function":case"object":return e===null?we("null"):xI(e)?e[A]():Ro(e);default:throw new Error("Bug in Equal.hash")}},Ro=e=>(sf.has(e)||sf.set(e,_c(dI.integer(Number.MAX_SAFE_INTEGER))),sf.get(e)),I=e=>t=>t*53^e,Ec=e=>e&3221225471|e>>>1&1073741824,xI=e=>typeof e=="object"&&e!==null&&A in e,_c=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return Ec(e)},we=e=>{let t=5381,r=e.length;for(;r;)t=t*33^e.charCodeAt(--r);return Ec(t)},gI=(e,t)=>{let r=12289;for(let o=0;o<t.length;o++)r^=I(S(e[t[o]]))(we(t[o]));return Ec(r)},wi=e=>gI(e,Object.keys(e)),Xr=e=>{let t=6151;for(let r=0;r<e.length;r++)t=I(S(e[r]))(t);return Ec(t)};var M=Symbol.for("@effect/data/Equal");function O(){return arguments.length===1?e=>Pg(e,arguments[0]):Pg(arguments[0],arguments[1])}function Pg(e,t){if(e===t)return!0;let r=typeof e;return r!==typeof t?!1:(r==="object"||r==="function")&&e!==null&&t!==null&&os(e)&&os(t)?S(e)===S(t)&&e[M](t):!1}var os=e=>typeof e=="object"&&e!==null&&M in e,Oc=()=>(e,t)=>S(e)===S(t)&&O(e,t);var Ao=Symbol.for("@effect/io/Effect"),Mo={_R:e=>e,_E:e=>e,_A:e=>e};var E=(e,t)=>{switch(t.length){case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let o=0,n=t.length;o<n;o++)r=t[o](r);return r}}};var Ng,Dg,Cc=Symbol.for("@effect/data/Option"),af=class{[(Ng=Ao,M)](t){return Lg(t)&&uf(t)&&O(t.i0,this.i0)}[A](){return S(this.i0)}toString(){return`Some(${String(this.i0)})`}toJSON(){return{_tag:this._tag,value:this.i0}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}get[Cc](){return{_A:t=>t}}get value(){return this.i0}constructor(t){this.i0=t,this._tag="Some",this._id=Cc,this.i1=void 0,this.i2=void 0,this[Ng]=Mo}pipe(){return E(this,arguments)}},cf=class{constructor(){this._tag="None",this._id=Cc,this.i0=void 0,this.i1=void 0,this.i2=void 0,this[Dg]=Mo}[(Dg=Ao,M)](t){return Lg(t)&&pf(t)}[A](){return S(this._tag)}toString(){return"None()"}toJSON(){return{_tag:this._tag}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}get[Cc](){return{_A:t=>t}}pipe(){return E(this,arguments)}},Lg=e=>typeof e=="object"&&e!=null&&"_tag"in e&&(e._tag==="None"||e._tag==="Some")&&os(e),pf=e=>e._tag==="None",uf=e=>e._tag==="Some",Hg=new cf,qg=e=>new af(e);var Ug,Wg,Rc=Symbol.for("@effect/data/Either"),lf=class{[(Ug=Ao,M)](t){return jg(t)&&hf(t)&&O(t.i0,this.i0)}[A](){return S(this.i0)}get right(){return this.i0}constructor(t){this.i0=t,this._tag="Right",this._id=Rc,this.i1=void 0,this.i2=void 0,this[Ug]=Mo}get[Rc](){return{_E:t=>t,_A:t=>t}}toString(){return`right(${String(this.i0)})`}toJSON(){return{_tag:this._tag,right:this.i0}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},ff=class{[(Wg=Ao,M)](t){return jg(t)&&mf(t)&&O(t.i0,this.i0)}[A](){return S(this.i0)}get[Rc](){return{_E:t=>t,_A:t=>t}}get left(){return this.i0}constructor(t){this.i0=t,this._tag="Left",this._id=Rc,this.i1=void 0,this.i2=void 0,this[Wg]=Mo}toString(){return`left(${String(this.i0)})`}toJSON(){return{_tag:this._tag,left:this.i0}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},jg=e=>typeof e=="object"&&e!=null&&"_tag"in e&&(e._tag==="Left"||e._tag==="Right")&&os(e),mf=e=>e._tag==="Left",hf=e=>e._tag==="Right",zg=e=>new ff(e),Kg=e=>new lf(e);var EI=Symbol.for("@effect/data/Either"),P=Kg,q=zg;var Ac=e=>pe(e)&&"_id"in e&&e._id===EI,Ae=mf,Cr=hf;var Mc=a(2,(e,{onLeft:t,onRight:r})=>Ae(e)?t(e.left):r(e.right)),Tc=Mc({onLeft:F,onRight:F});var bt=Cg;var RI=Symbol.for("@effect/data/Option"),x=()=>Hg,d=qg,Bg=e=>pe(e)&&"_id"in e&&e._id===RI,z=pf,N=uf,De=a(2,(e,{onNone:t,onSome:r})=>z(e)?t():r(e.value));var V=a(2,(e,t)=>z(e)?t():e.value),ns=a(2,(e,t)=>z(e)?t():e);var Ht=e=>e==null?x():d(e);var je=V(xc);var AI=a(2,(e,t)=>{if(N(e))return e.value;throw t()}),Gg=AI(()=>new Error("getOrThrow called on a None")),Me=a(2,(e,t)=>z(e)?x():d(t(e.value)));var ss=a(2,(e,t)=>z(e)?x():t(e.value));var $g=ss(F);var MI=e=>a(2,(t,r)=>z(t)?!1:e(t.value,r)),TI=Oc(),Vg=MI(TI);var df=e=>e.length>0;var xf=(e,t)=>{let r=Math.max(1,Math.floor(e)),o=[t(0)];for(let n=1;n<r;n++)o.push(t(n));return o};var Q=e=>Array.isArray(e)?e:Array.from(e);var rr=a(2,(e,t)=>[t,...e]);var Yg=a(2,(e,t)=>[...e,t]);var II=e=>e.length===0,gf=II,Ic=df,Rr=df;var Jg=(e,t)=>e<0||e>=t.length;var kI=a(2,(e,t)=>{let r=Math.floor(t);return Jg(r,e)?x():d(e[r])}),yf=a(2,(e,t)=>{let r=Math.floor(t);if(Jg(r,e))throw new Error(`Index ${r} out of bounds`);return e[r]});var kc=kI(0),_e=yf(0),Qg=e=>Rr(e)?d(wI(e)):x(),wI=e=>e[e.length-1];var qt=e=>e.slice(1);var bf=e=>Array.from(e).reverse();var Zo=a(2,(e,t)=>{let r=Array.from(e);return r.sort(t),r});var Sf=a(2,(e,t)=>Zg(e,t,(r,o)=>[r,o])),Zg=a(3,(e,t,r)=>{let o=Q(e),n=Q(t);return Rr(o)&&Rr(n)?FI(n,r)(o):[]});var FI=a(3,(e,t,r)=>{let o=[r(_e(e),_e(t))],n=Math.min(e.length,t.length);for(let s=1;s<n;s++)o[s]=r(e[s],t[s]);return o});var PI=a(2,(e,t)=>{let r=[_e(e)],o=qt(e);for(let n of o)r.every(s=>!t(n,s))&&r.push(n);return r});var Xo=()=>[],St=e=>[e],eo=a(2,(e,t)=>e.map(t)),is=eo,wc=a(2,(e,t)=>{if(gf(e))return[];let r=[];for(let o=0;o<e.length;o++)r.push(...t(e[o],o));return r});var Fc=wc(F);var Fi=a(2,(e,t)=>{let r=Q(e),o=[];for(let n=0;n<r.length;n++){let s=t(r[n],n);N(s)&&o.push(s.value)}return o});var Xg=Fi(F);var it=a(3,(e,t,r)=>Q(e).reduce((o,n,s)=>r(o,n,s),t)),Pc=a(3,(e,t,r)=>Q(e).reduceRight((o,n,s)=>r(o,n,s),t));var Ef=(e,t)=>{let r=[],o=e,n;for(;N(n=t(o));){let[s,i]=n.value;r.push(s),o=i}return r};var ey=Og;var NI=a(2,(e,t)=>{let r=Q(e);return Rr(r)?PI(t)(r):[]}),ty=NI(Oc());var to=a(2,(e,t)=>Q(e).join(t));var ry,_f=Symbol.for("@effect/data/Context/Tag"),Nc=class{[(ry=Ao,M)](t){return this===t}[A](){return Ro(this)}get[_f](){return{_S:t=>t,_I:t=>t}}constructor(t){this._tag="Tag",this.i0=void 0,this.i1=void 0,this.i2=void 0,this[ry]=Mo;let r=Error.stackTraceLimit;if(Error.stackTraceLimit=3,this.creationError=new Error,Error.stackTraceLimit=r,typeof t<"u")return this.i0=t,K(t,()=>this)}get stack(){return this.creationError.stack}toString(){return JSON.stringify(this)}toJSON(){return{_tag:"Tag",identifier:this.i0,stack:this.stack}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}of(t){return t}context(t){return Rf(this,t)}},Of=Symbol.for("@effect/data/Context"),or=class{[M](t){if(Cf(t)&&this.unsafeMap.size===t.unsafeMap.size){for(let r of this.unsafeMap.keys())if(!t.unsafeMap.has(r)||!O(this.unsafeMap.get(r),t.unsafeMap.get(r)))return!1;return!0}return!1}[A](){return _c(this.unsafeMap.size)}constructor(t){this.unsafeMap=t,this._id=Of,this._S=r=>r}pipe(){return E(this,arguments)}},DI=e=>{let t=new Error(`Service not found${e.i0?`: ${String(e.i0)}`:""}`);if(e.stack){let r=e.stack.split(`
`);if(r.length>2){let o=r[3].match(/at (.*)/);o&&(t.message=t.message+` (defined at ${o[1]})`)}}if(t.stack){let r=t.stack.split(`
`);r.splice(1,3),t.stack=r.join(`
`)}return t},Cf=e=>typeof e=="object"&&e!==null&&"_id"in e&&e._id===Of,oy=e=>typeof e=="object"&&e!==null&&_f in e,ny=()=>new or(new Map),Rf=(e,t)=>new or(new Map([[e,t]])),sy=a(3,(e,t,r)=>{let o=new Map(e.unsafeMap);return o.set(t,r),new or(o)}),Af=a(2,(e,t)=>{if(!e.unsafeMap.has(t))throw DI(t);return e.unsafeMap.get(t)}),iy=Af,ay=a(2,(e,t)=>e.unsafeMap.has(t)?d(e.unsafeMap.get(t)):x()),cy=a(2,(e,t)=>{let r=new Map(e.unsafeMap);for(let[o,n]of t.unsafeMap)r.set(o,n);return new or(r)}),py=(...e)=>t=>{let r=new Set(e),o=new Map;for(let[n,s]of t.unsafeMap.entries())r.has(n)&&o.set(n,s);return new or(o)},uy=(...e)=>t=>{let r=new Map(t.unsafeMap);for(let o of e)r.delete(o);return new or(r)};var at=e=>new Nc(e);var HI=Cf,ly=oy,Et=ny,Dc=Rf,Te=sy,Ar=iy,as=Af,Mf=ay,en=cy,qI=py,UI=uy;var WI=(()=>{let e={[A](){return Xr(this)},[M](t){return Array.isArray(t)&&this.length===t.length?this.every((r,o)=>O(r,t[o])):!1}};return Object.setPrototypeOf(e,Array.prototype)})(),jI=(()=>{let e={[A](){return wi(this)},[M](t){let r=Object.keys(this),o=Object.keys(t);if(r.length!==o.length)return!1;for(let n of r)if(!(n in t&&O(this[n],t[n])))return!1;return!0}};return Object.setPrototypeOf(e,Object.prototype)})(),ro=e=>fy(Object.assign({},e)),fy=e=>Object.setPrototypeOf(e,jI),zI=(...e)=>Tf(e),KI=e=>Tf(e.slice(0)),Tf=e=>Object.setPrototypeOf(e,WI),BI=()=>e=>ro(e===void 0?{}:e);var my=e=>t=>ro(t===void 0?{_tag:e}:{...t,_tag:e}),GI=e=>{class t extends hy{constructor(){super(...arguments),this._tag=e}}return t},hy=(()=>{class e{constructor(r){r&&Object.assign(this,r)}[A](){return wi(this)}[M](r){let o=Object.keys(this),n=Object.keys(r);if(o.length!==n.length)return!1;for(let s of o)if(!(s in r&&O(this[s],r[s])))return!1;return!0}}return e})(),$I=()=>my;var yy=Symbol.for("@effect/data/Duration"),YI=BigInt(1e3),dy=BigInt(1e9),xy=/^(-?\d+(?:\.\d+)?)\s+(nanos|micros|millis|seconds|minutes|hours|days|weeks)$/,ze=e=>{if(by(e))return e;if(Jo(e))return cs(e);if(ts(e))return Lc(e);{xy.lastIndex=0;let t=xy.exec(e);if(t){let[r,o,n]=t,s=Number(o);switch(n){case"nanos":return Lc(BigInt(o));case"micros":return QI(BigInt(o));case"millis":return cs(s);case"seconds":return If(s);case"minutes":return ZI(s);case"hours":return XI(s);case"days":return ek(s);case"weeks":return tk(s)}}}throw new Error("Invalid duration input")},gy={_tag:"Millis",millis:0},JI={_tag:"Infinity"},nr=class{constructor(t){this._id=yy,Jo(t)?isNaN(t)||t<0?this.value=gy:Number.isFinite(t)?Number.isInteger(t)?this.value={_tag:"Millis",millis:t}:this.value={_tag:"Nanos",nanos:BigInt(Math.round(t*1e6))}:this.value=JI:t<BigInt(0)?this.value=gy:this.value={_tag:"Nanos",nanos:t}}[A](){return wi(this.value)}[M](t){return by(t)&&nk(this,t)}toString(){switch(this.value._tag){case"Millis":return`Duration("${this.value.millis} millis")`;case"Nanos":return`Duration("${this.value.nanos} nanos")`;case"Infinity":return"Duration(Infinity)"}}toJSON(){return this.value._tag==="Nanos"?{_tag:"Duration",value:{_tag:"Nanos",hrtime:rk(this)}}:{_tag:"Duration",value:this.value}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},by=e=>pe(e)&&"_id"in e&&e._id===yy,vf=new nr(0);var Lc=e=>new nr(e),QI=e=>new nr(e*YI),cs=e=>new nr(e),If=e=>new nr(e*1e3),ZI=e=>new nr(e*6e4),XI=e=>new nr(e*36e5),ek=e=>new nr(e*864e5),tk=e=>new nr(e*6048e5),Mr=e=>{let t=ze(e);switch(t.value._tag){case"Infinity":return 1/0;case"Nanos":return Number(t.value.nanos)/1e6;case"Millis":return t.value.millis}};var rk=e=>{let t=ze(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/dy),Number(t.value.nanos%dy)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}};var Sy=a(3,(e,t,r)=>{let o=ze(e),n=ze(t);if(o.value._tag==="Infinity"||n.value._tag==="Infinity")return r.onMillis(Mr(o),Mr(n));if(o.value._tag==="Nanos"||n.value._tag==="Nanos"){let s=o.value._tag==="Nanos"?o.value.nanos:BigInt(Math.round(o.value.millis*1e6)),i=n.value._tag==="Nanos"?n.value.nanos:BigInt(Math.round(n.value.millis*1e6));return r.onNanos(s,i)}return r.onMillis(o.value.millis,n.value.millis)});var ok=(e,t)=>Sy(e,t,{onMillis:(r,o)=>r===o,onNanos:(r,o)=>r===o});var kf=a(2,(e,t)=>Sy(e,t,{onMillis:(r,o)=>r>=o,onNanos:(r,o)=>r>=o})),nk=a(2,(e,t)=>ok(ze(e),ze(t)));var wf=Math.pow(2,5),Ey=wf-1,_y=wf/2,Oy=wf/4;function sk(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function To(e,t){return t>>>e&Ey}function vo(e){return 1<<e}function Hc(e,t){return sk(e&t-1)}function rn(e,t,r,o){let n=o;if(!e){let s=o.length;n=new Array(s);for(let i=0;i<s;++i)n[i]=o[i]}return n[t]=r,n}function Ff(e,t,r){let o=r.length-1,n=0,s=0,i=r;if(e)n=s=t;else for(i=new Array(o);n<t;)i[s++]=r[n++];for(++n;n<=o;)i[s++]=r[n++];return e&&(i.length=o),i}function Cy(e,t,r,o){let n=o.length;if(e){let p=n;for(;p>=t;)o[p--]=o[p];return o[t]=r,o}let s=0,i=0,c=new Array(n+1);for(;s<t;)c[i++]=o[s++];for(c[t]=r;s<n;)c[++i]=o[s++];return c}var qc=class{constructor(t,r){this.value=t,this.previous=r}};var Tr=class e{constructor(){this._tag="EmptyNode"}modify(t,r,o,n,s,i){let c=o(x());return z(c)?new e:(++i.value,new ps(t,n,s,c))}};function Ut(e){return e instanceof Tr}function ik(e){return Ut(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function Uc(e,t){return Ut(e)?!1:t===e.edit}var ps=class e{constructor(t,r,o,n){this.edit=t,this.hash=r,this.key=o,this.value=n,this._tag="LeafNode"}modify(t,r,o,n,s,i){if(O(s,this.key)){let p=o(this.value);return p===this.value?this:z(p)?(--i.value,new Tr):Uc(this,t)?(this.value=p,this):new e(t,n,s,p)}let c=o(x());return z(c)?this:(++i.value,Ry(t,r,this.hash,this,n,new e(t,n,s,c)))}},Pf=class e{constructor(t,r,o){this.edit=t,this.hash=r,this.children=o,this._tag="CollisionNode"}modify(t,r,o,n,s,i){if(n===this.hash){let p=Uc(this,t),u=this.updateCollisionList(p,t,this.hash,this.children,o,s,i);return u===this.children?this:u.length>1?new e(t,this.hash,u):u[0]}let c=o(x());return z(c)?this:(++i.value,Ry(t,r,this.hash,this,n,new ps(t,n,s,c)))}updateCollisionList(t,r,o,n,s,i,c){let p=n.length;for(let f=0;f<p;++f){let m=n[f];if("key"in m&&O(i,m.key)){let y=m.value,b=s(y);return b===y?n:z(b)?(--c.value,Ff(t,f,n)):rn(t,f,new ps(r,o,i,b),n)}}let u=s(x());return z(u)?n:(++c.value,rn(t,p,new ps(r,o,i,u),n))}},Pi=class e{constructor(t,r,o){this.edit=t,this.mask=r,this.children=o,this._tag="IndexedNode"}modify(t,r,o,n,s,i){let c=this.mask,p=this.children,u=To(r,n),f=vo(u),m=Hc(c,f),y=c&f,b=Uc(this,t);if(!y){let H=new Tr().modify(t,r+5,o,n,s,i);return H?p.length>=_y?ck(t,u,H,c,p):new e(t,c|f,Cy(b,m,H,p)):this}let C=p[m],R=C.modify(t,r+5,o,n,s,i);if(C===R)return this;let v=c,w;if(Ut(R)){if(v&=~f,!v)return new Tr;if(p.length<=2&&ik(p[m^1]))return p[m^1];w=Ff(b,m,p)}else w=rn(b,m,R,p);return b?(this.mask=v,this.children=w,this):new e(t,v,w)}},Nf=class e{constructor(t,r,o){this.edit=t,this.size=r,this.children=o,this._tag="ArrayNode"}modify(t,r,o,n,s,i){let c=this.size,p=this.children,u=To(r,n),f=p[u],m=(f||new Tr).modify(t,r+5,o,n,s,i);if(f===m)return this;let y=Uc(this,t),b;if(Ut(f)&&!Ut(m))++c,b=rn(y,u,m,p);else if(!Ut(f)&&Ut(m)){if(--c,c<=Oy)return ak(t,c,u,p);b=rn(y,u,new Tr,p)}else b=rn(y,u,m,p);return y?(this.size=c,this.children=b,this):new e(t,c,b)}};function ak(e,t,r,o){let n=new Array(t-1),s=0,i=0;for(let c=0,p=o.length;c<p;++c)if(c!==r){let u=o[c];u&&!Ut(u)&&(n[s++]=u,i|=1<<c)}return new Pi(e,i,n)}function ck(e,t,r,o,n){let s=[],i=o,c=0;for(let p=0;i;++p)i&1&&(s[p]=n[c++]),i>>>=1;return s[t]=r,new Nf(e,c+1,s)}function pk(e,t,r,o,n,s){if(r===n)return new Pf(e,r,[s,o]);let i=To(t,r),c=To(t,n);if(i===c)return p=>new Pi(e,vo(i)|vo(c),[p]);{let p=i<c?[o,s]:[s,o];return new Pi(e,vo(i)|vo(c),p)}}function Ry(e,t,r,o,n,s){let i,c=t;for(;;){let p=pk(e,c,r,o,n,s);if(typeof p=="function")i=new qc(p,i),c=c+5;else{let u=p;for(;i!=null;)u=i.value(u),i=i.previous;return u}}}var Df=Symbol.for("@effect/data/HashMap"),Ni=class{constructor(t,r,o,n){this._editable=t,this._edit=r,this._root=o,this._size=n,this._id=Df}[Symbol.iterator](){return new Wc(this,(t,r)=>[t,r])}[A](){let t=S("HashMap");for(let r of this)t^=I(S(r[0]))(S(r[1]));return t}[M](t){if(vy(t)){if(t._size!==this._size)return!1;for(let r of this){let o=zc(r[0],S(r[0]))(t);if(z(o))return!1;if(!O(r[1],o.value))return!1}return!0}return!1}toString(){return`HashMap(${Array.from(this).map(([t,r])=>`[${String(t)}, ${String(r)}]`).join(", ")})`}toJSON(){return{_tag:"HashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},Wc=class e{constructor(t,r){this.map=t,this.f=r,this.v=Ay(this.map._root,this.f,void 0)}next(){if(z(this.v))return{done:!0,value:void 0};let t=this.v.value;return this.v=jc(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new e(this.map,this.f)}},jc=e=>e?My(e[0],e[1],e[2],e[3],e[4]):x(),Ay=(e,t,r=void 0)=>{switch(e._tag){case"LeafNode":return N(e.value)?d({value:t(e.key,e.value.value),cont:r}):jc(r);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let o=e.children;return My(o.length,o,0,t,r)}default:return jc(r)}},My=(e,t,r,o,n)=>{for(;r<e;){let s=t[r++];if(s&&!Ut(s))return Ay(s,o,[e,t,r,o,n])}return jc(n)},ls=()=>new Ni(!1,0,new Tr,0),Ty=(...e)=>Lf(e),Lf=e=>{let t=Bc(ls());for(let r of e)on(r[0],r[1])(t);return wy(t)},vy=e=>pe(e)&&"_id"in e&&e._id===Df,Iy=e=>e&&Ut(e._root),ky=a(2,(e,t)=>zc(e,t,S(t))),zc=a(3,(e,t,r)=>{let o=e._root,n=0;for(;;)switch(o._tag){case"LeafNode":return O(t,o.key)?o.value:x();case"CollisionNode":{if(r===o.hash){let s=o.children;for(let i=0,c=s.length;i<c;++i){let p=s[i];if("key"in p&&O(t,p.key))return p.value}}return x()}case"IndexedNode":{let s=To(n,r),i=vo(s);if(o.mask&i){o=o.children[Hc(o.mask,i)],n+=5;break}return x()}case"ArrayNode":{if(o=o.children[To(n,r)],o){n+=5;break}return x()}default:return x()}});var Hf=a(2,(e,t)=>N(zc(e,t,S(t))));var on=a(3,(e,t,r)=>qf(e,t,()=>d(r))),lk=a(3,(e,t,r)=>e._editable?(e._root=t,e._size=r,e):t===e._root?e:new Ni(e._editable,e._edit,t,r)),Kc=e=>new Wc(e,t=>t);var fs=e=>e._size,Bc=e=>new Ni(!0,e._edit+1,e._root,e._size),wy=e=>(e._editable=!1,e);var qf=a(3,(e,t,r)=>Fy(e,t,S(t),r)),Fy=a(4,(e,t,r,o)=>{let n={value:e._size},s=e._root.modify(e._editable?e._edit:NaN,0,o,r,t,n);return lk(s,n.value)(e)});var Di=a(2,(e,t)=>qf(e,t,x));var Py=a(2,(e,t)=>ms(e,ls(),(r,o,n)=>on(r,n,t(o,n))));var Gc=a(2,(e,t)=>ms(e,void 0,(r,o,n)=>t(o,n))),ms=a(3,(e,t,r)=>{let o=e._root;if(o._tag==="LeafNode")return N(o.value)?r(t,o.value.value,o.key):t;if(o._tag==="EmptyNode")return t;let n=[o.children],s;for(;s=n.pop();)for(let i=0,c=s.length;i<c;){let p=s[i++];p&&!Ut(p)&&(p._tag==="LeafNode"?N(p.value)&&(t=r(t,p.value.value,p.key)):n.push(p.children))}return t});var Uf=Symbol.for("@effect/data/HashSet"),hs=class{constructor(t){this._keyMap=t,this._id=Uf}[Symbol.iterator](){return Kc(this._keyMap)}[A](){return I(S(this._keyMap))(S("HashSet"))}[M](t){return Dy(t)?fs(this._keyMap)===fs(t._keyMap)&&O(this._keyMap,t._keyMap):!1}toString(){return`HashSet(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"HashSet",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},Dy=e=>pe(e)&&"_id"in e&&e._id===Uf,Li=()=>new hs(ls()),Ly=e=>{let t=$c(Li());for(let r of e)ds(t,r);return Vc(t)},Hy=(...e)=>{let t=$c(Li());for(let r of e)ds(t,r);return Vc(t)},qy=a(2,(e,t)=>Hf(e._keyMap,t));var Uy=e=>fs(e._keyMap),$c=e=>new hs(Bc(e._keyMap)),Vc=e=>(e._keyMap._editable=!1,e),Wf=a(2,(e,t)=>{let r=$c(e);return t(r),Vc(r)}),ds=a(2,(e,t)=>e._keyMap._editable?(on(t,!0)(e._keyMap),e):new hs(on(t,!0)(e._keyMap))),jf=a(2,(e,t)=>e._keyMap._editable?(Di(t)(e._keyMap),e):new hs(Di(t)(e._keyMap))),Wy=a(2,(e,t)=>Wf(e,r=>{for(let o of t)jf(r,o)}));var jy=a(2,(e,t)=>Wf(Li(),r=>{zy(e,o=>ds(r,o));for(let o of t)ds(r,o)}));var zy=a(2,(e,t)=>Gc(e._keyMap,(r,o)=>t(o))),Ky=a(3,(e,t,r)=>ms(e._keyMap,t,(o,n,s)=>r(o,s)));var oo=ls,By=Ty,Yc=Lf,Gy=Iy,Hi=ky;var vr=on,zf=Kc;var Jc=fs;var $y=Di;var Vy=Py;var Yy=Gc,Kf=ms;var mk=Symbol.for("@effect/data/MutableRef"),Bf=class{constructor(t){this.current=t,this._T=r=>r,this._id=mk}toString(){return`MutableRef(${String(this.current)})`}toJSON(){return{_tag:"MutableRef",current:this.current}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},ct=e=>new Bf(e),Qc=a(3,(e,t,r)=>O(t,e.current)?(e.current=r,!0):!1);var Ot=e=>e.current;var Jy=e=>dk(e,t=>t+1),Wt=a(2,(e,t)=>(e.current=t,e)),hk=a(2,(e,t)=>(e.current=t,e.current)),Gf=a(2,(e,t)=>Wt(e,t(Ot(e)))),dk=a(2,(e,t)=>hk(e,t(Ot(e))));var xk=Symbol.for("@effect/data/MutableHashMap"),$f=class{constructor(){this._id=xk,this.backingMap=ct(oo())}[Symbol.iterator](){return this.backingMap.current[Symbol.iterator]()}toString(){return`MutableHashMap(${Array.from(this).map(([t,r])=>`[${String(t)}, ${String(r)}]`).join(", ")})`}toJSON(){return{_tag:"MutableHashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},an=()=>new $f;var ye=a(2,(e,t)=>Hi(e.backingMap.current,t)),sr=a(2,(e,t)=>N(ye(e,t)));var cn=a(2,(e,t)=>(Gf(e.backingMap,$y(t)),e)),pt=a(3,(e,t,r)=>(Gf(e.backingMap,vr(t,r)),e)),Zc=e=>Jc(Ot(e.backingMap));var Qy=Symbol.for("@effect/data/Chunk");function gk(e,t,r,o,n){for(let s=t;s<Math.min(e.length,t+n);s++)r[o+s-t]=e[s];return r}var Zy=[],yk=e=>gc((t,r)=>Ze(t).every((o,n)=>e(o,Io(r,n)))),bk=yk(O),oe=class{constructor(t){switch(this.backing=t,this._id=Qy,t._tag){case"IEmpty":{this.length=0,this.depth=0,this.left=this,this.right=this;break}case"IConcat":{this.length=t.left.length+t.right.length,this.depth=1+Math.max(t.left.depth,t.right.depth),this.left=t.left,this.right=t.right;break}case"IArray":{this.length=t.array.length,this.depth=0,this.left=ir,this.right=ir;break}case"ISingleton":{this.length=1,this.depth=0,this.left=ir,this.right=ir;break}case"ISlice":{this.length=t.length,this.depth=t.chunk.depth+1,this.left=ir,this.right=ir;break}}}toString(){return`Chunk(${Ze(this).map(String).join(", ")})`}toJSON(){return{_tag:"Chunk",values:Ze(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}[M](t){return Xy(t)&&bk(this,t)}[A](){return Xr(Ze(this))}[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return Zy[Symbol.iterator]();default:return Ze(this)[Symbol.iterator]()}}pipe(){return E(this,arguments)}},Xy=e=>pe(e)&&"_id"in e&&e._id===Qy,ir=new oe({_tag:"IEmpty"}),Xe=()=>ir;var Oe=e=>new oe({_tag:"ISingleton",a:e}),Ir=e=>Xy(e)?e:new oe({_tag:"IArray",array:Q(e)}),Yf=(e,t,r)=>{switch(e.backing._tag){case"IArray":{gk(e.backing.array,0,t,r,e.length);break}case"IConcat":{Yf(e.left,t,r),Yf(e.right,t,r+e.left.length);break}case"ISingleton":{t[r]=e.backing.a;break}case"ISlice":{let o=0,n=r;for(;o<e.length;)t[n]=Io(e,o),o+=1,n+=1;break}}},Ze=e=>{switch(e.backing._tag){case"IEmpty":return Zy;case"IArray":return e.backing.array;default:{let t=new Array(e.length);return Yf(e,t,0),e.backing={_tag:"IArray",array:t},e.left=ir,e.right=ir,e.depth=0,t}}},no=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return new oe({_tag:"IArray",array:bf(e.backing.array)});case"IConcat":return new oe({_tag:"IConcat",left:no(e.backing.right),right:no(e.backing.left)});case"ISlice":return Ct(bf(Ze(e)))}},Sk=a(2,(e,t)=>t<0||t>=e.length?x():d(Io(e,t))),Ct=e=>new oe({_tag:"IArray",array:e});var Io=a(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?Io(e.left,t):Io(e.right,t-e.left.length);case"ISlice":return Io(e.backing.chunk,t+e.backing.offset)}}),Xc=a(2,(e,t)=>eb(e,Oe(t))),ve=a(2,(e,t)=>eb(Oe(t),e)),Jf=a(2,(e,t)=>{if(t<=0)return ir;if(t>=e.length)return e;switch(e.backing._tag){case"ISlice":return new oe({_tag:"ISlice",chunk:e.backing.chunk,length:t,offset:e.backing.offset});case"IConcat":return t>e.left.length?new oe({_tag:"IConcat",left:e.left,right:Jf(e.right,t-e.left.length)}):Jf(e.left,t);default:return new oe({_tag:"ISlice",chunk:e,offset:0,length:t})}}),xs=a(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return ir;switch(e.backing._tag){case"ISlice":return new oe({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?xs(e.right,t-e.left.length):new oe({_tag:"IConcat",left:xs(e.left,t),right:e.right});default:return new oe({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}});var ar=a(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;let r=t.depth-e.depth;if(Math.abs(r)<=1)return new oe({_tag:"IConcat",left:e,right:t});if(r<-1)if(e.left.depth>=e.right.depth){let o=ar(e.right,t);return new oe({_tag:"IConcat",left:e.left,right:o})}else{let o=ar(e.right.right,t);if(o.depth===e.depth-3){let n=new oe({_tag:"IConcat",left:e.right.left,right:o});return new oe({_tag:"IConcat",left:e.left,right:n})}else{let n=new oe({_tag:"IConcat",left:e.left,right:e.right.left});return new oe({_tag:"IConcat",left:n,right:o})}}else if(t.right.depth>=t.left.depth){let o=ar(e,t.left);return new oe({_tag:"IConcat",left:o,right:t.right})}else{let o=ar(e,t.left.left);if(o.depth===t.depth-3){let n=new oe({_tag:"IConcat",left:o,right:t.left.right});return new oe({_tag:"IConcat",left:n,right:t.right})}else{let n=new oe({_tag:"IConcat",left:t.left.right,right:t.right});return new oe({_tag:"IConcat",left:o,right:n})}}}),eb=a(2,(e,t)=>ar(e,t));var gs=e=>e.length===0,Ke=e=>e.length>0,pn=Sk(0),un=e=>Io(e,0),Be=un;var tb=e=>Io(e,e.length-1),Qf=a(2,(e,t)=>e.backing._tag==="ISingleton"?Oe(t(e.backing.a,0)):Ct(eo((r,o)=>t(r,o))(Ze(e))));var ep=a(2,(e,t)=>Ct(Zo(Ze(e),t)));var Ek=a(2,(e,t)=>[Jf(e,t),xs(e,t)]);var rb=a(2,(e,t)=>{let r=0;for(let o of Ze(e)){if(t(o))break;r++}return Ek(e,r)});var Ge=e=>xs(e,1);var ob=e=>Ct(ty(Ze(e)));var _k=Symbol.for("@effect/data/MutableList"),Zf=class{constructor(){this._id=_k,this.head=void 0,this.tail=void 0,this._length=0}[Symbol.iterator](){let t=!1,r=this.head;return{next(){if(t)return this.return();if(r==null)return t=!0,this.return();let o=r.value;return r=r.next,{done:t,value:o}},return(o){return t||(t=!0),{done:!0,value:o}}}}toString(){return`MutableList(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableList",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},Xf=class{constructor(t){this.value=t,this.removed=!1,this.prev=void 0,this.next=void 0}},nb=()=>new Zf;var sb=e=>em(e)===0,em=e=>e._length;var ib=a(2,(e,t)=>{let r=new Xf(t);return e.head===void 0&&(e.head=r),e.tail===void 0||(e.tail.next=r,r.prev=e.tail),e.tail=r,e._length+=1,e}),ab=e=>{let t=e.head;if(t!==void 0)return Ok(e,t),t.value};var Ok=(e,t)=>{t.removed||(t.removed=!0,t.prev!==void 0&&t.next!==void 0?(t.prev.next=t.next,t.next.prev=t.prev):t.prev!==void 0?(e.tail=t.prev,t.prev.next=void 0):t.next!==void 0?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))};var Rk=Symbol.for("@effect/data/MutableQueue"),rm=Symbol.for("@effect/data/mutable/MutableQueue/Empty"),tm=class{constructor(t=void 0){this.capacity=t,this._tag="Bounded",this._id=Rk,this.queue=nb()}[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()}toString(){return`MutableQueue(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableQueue",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}};var cb=()=>new tm;var pb=a(2,(e,t)=>{let r=em(e.queue);return e.capacity!==void 0&&r===e.capacity?!1:(ib(t)(e.queue),!0)});var ub=a(2,(e,t)=>sb(e.queue)?t:ab(e.queue));var ys=Symbol.for("@effect/data/Differ/ContextPatch");function kr(e){return e}var om=class{constructor(){this._tag="Empty",this._Input=kr,this._Output=kr,this._id=ys}[A](){return we("ContextPatch(Empty)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}},nm=class{constructor(t,r){this.first=t,this.second=r,this._tag="AndThen",this._id=ys,this._Input=kr,this._Output=kr}[A](){return we("ContextPatch(AndThen)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.first,t.first)&&O(this.second,t.second)}},sm=class{constructor(t,r){this.tag=t,this.service=r,this._tag="AddService",this._id=ys,this._Input=kr,this._Output=kr}[A](){return we("ContextPatch(AddService)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.tag,t.tag)&&O(this.service,t.service)}},im=class{constructor(t){this.tag=t,this._tag="RemoveService",this._id=ys,this._Input=kr,this._Output=kr}[A](){return we("ContextPatch(RemoveService)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.tag,t.tag)}},am=class{constructor(t,r){this.tag=t,this.update=r,this._tag="UpdateService",this._id=ys,this._Input=kr,this._Output=kr}[A](){return we("ContextPatch(AndThen)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.tag,t.tag)&&O(this.update,t.update)}},cm=()=>new om,lb=(e,t)=>{let r=new Map(e.unsafeMap),o=cm();for(let[n,s]of t.unsafeMap.entries())if(r.has(n)){let i=r.get(n);r.delete(n),O(i,s)||(o=qi(new am(n,()=>s))(o))}else r.delete(n),o=qi(new sm(n,s))(o);for(let[n]of r.entries())o=qi(new im(n))(o);return o},qi=a(2,(e,t)=>new nm(e,t)),fb=a(2,(e,t)=>{let r=!1,o=Oe(e),n=new Map(t.unsafeMap);for(;Ke(o);){let i=Be(o),c=Ge(o);switch(i._tag){case"Empty":{o=c;break}case"AddService":{n.set(i.tag,i.service),o=c;break}case"AndThen":{o=ve(ve(c,i.second),i.first);break}case"RemoveService":{n.delete(i.tag),o=c;break}case"UpdateService":{n.set(i.tag,i.update(n.get(i.tag))),r=!0,o=c;break}}}if(!r)return new or(n);let s=new Map;for(let[i]of t.unsafeMap)n.has(i)&&(s.set(i,n.get(i)),n.delete(i));for(let[i,c]of n)s.set(i,c);return new or(s)});var tp=cm,mb=lb,hb=qi,db=fb;var $e=Li,ut=Ly,so=Hy,gb=qy;var io=Uy;var wr=ds,pm=jf,um=Wy;var Ve=jy;var ln=Ky;var Ui=Symbol.for("@effect/data/Differ/HashSetPatch");function op(e){return e}var lm=class{constructor(){this._tag="Empty",this._Value=op,this._id=Ui}[A](){return we("HashSetPatch(Empty)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}},fm=class{constructor(t,r){this.first=t,this.second=r,this._tag="AndThen",this._Value=op,this._id=Ui}[A](){return we("HashSetPatch(AndThen)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.first,t.first)&&O(this.second,t.second)}},mm=class{constructor(t){this.value=t,this._tag="Add",this._Value=op,this._id=Ui}[A](){return we("HashSetPatch(Add)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.value,t.value)}},hm=class{constructor(t){this.value=t,this._tag="Remove",this._Value=op,this._id=Ui}[A](){return we("HashSetPatch(Remove)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.value,t.value)}},dm=()=>new lm,yb=(e,t)=>{let[r,o]=ln([e,dm()],([n,s],i)=>gb(i)(n)?[pm(i)(n),s]:[n,rp(new mm(i))(s)])(t);return ln(o,(n,s)=>rp(new hm(s))(n))(r)},rp=a(2,(e,t)=>new fm(e,t)),bb=a(2,(e,t)=>{let r=t,o=Oe(e);for(;Ke(o);){let n=Be(o),s=Ge(o);switch(n._tag){case"Empty":{o=s;break}case"AndThen":{o=ve(n.first)(ve(n.second)(s));break}case"Add":{r=wr(n.value)(r),o=s;break}case"Remove":r=pm(n.value)(r),o=s}}return r});var np=dm,Sb=yb,Eb=rp,_b=bb;var Cb=Symbol.for("@effect/data/Differ"),xm=class{constructor(t){this._id=Cb,this._P=F,this._V=F,this.empty=t.empty,this.diff=t.diff,this.combine=t.combine,this.patch=t.patch}},Wi=e=>new xm(e),Rb=()=>Wi({empty:tp(),combine:(e,t)=>hb(t)(e),diff:(e,t)=>mb(e,t),patch:(e,t)=>db(t)(e)});var Ab=()=>Wi({empty:np(),combine:(e,t)=>Eb(t)(e),diff:(e,t)=>Sb(e,t),patch:(e,t)=>_b(t)(e)});var Mb=()=>Tb((e,t)=>t),Tb=e=>Wi({empty:F,combine:(t,r)=>t===F?r:r===F?t:o=>r(t(o)),diff:(t,r)=>O(t,r)?F:Ai(r),patch:(t,r)=>e(r,t(r))});var vb=a(3,(e,t,r)=>e.diff(t,r)),Ib=a(3,(e,t,r)=>e.combine(t,r)),kb=a(3,(e,t,r)=>e.patch(t,r)),sp=Wi,wb=Rb;var Fb=Ab;var Pb=Mb;var bm=Symbol.for("@effect/data/List"),ji=e=>Array.from(e),kk=e=>_g(ey(e),ji),wk=kk(O),bs=class{constructor(t,r){this.head=t,this.tail=r,this._tag="Cons",this._id=bm}toString(){return`List.Cons(${ji(this).map(String).join(", ")})`}toJSON(){return{_tag:"List.Cons",values:ji(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}[M](t){return Nb(t)&&this._tag===t._tag&&wk(this,t)}[A](){return Xr(ji(this))}[Symbol.iterator](){let t=!1,r=this;return{next(){if(t)return this.return();if(r._tag==="Nil")return t=!0,this.return();let o=r.head;return r=r.tail,{done:t,value:o}},return(o){return t||(t=!0),{done:!0,value:o}}}}pipe(){return E(this,arguments)}},ym=class{constructor(){this._tag="Nil",this._id=bm}toString(){return"List.Nil"}toJSON(){return{_tag:"List.Nil"}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}[A](){return Xr(ji(this))}[M](t){return Nb(t)&&this._tag===t._tag}[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}}pipe(){return E(this,arguments)}},Nb=e=>pe(e)&&"_id"in e&&e._id===bm,lt=e=>e._tag==="Nil",zi=e=>e._tag==="Cons";var Db=new ym,Fk=()=>Db,ao=(e,t)=>new bs(e,t),cr=Fk,Ki=e=>new bs(e,Db);var Lb=a(2,(e,t)=>Pk(t,e));var ko=a(2,(e,t)=>ao(t,e)),Pk=a(2,(e,t)=>{if(lt(e))return t;if(lt(t))return e;{let r=new bs(t.head,e),o=r,n=t.tail;for(;!lt(n);){let s=new bs(n.head,e);o.tail=s,o=s,n=n.tail}return r}});var Hb=a(2,(e,t)=>{let r=e;for(;!lt(r);){if(t(r.head))return d(r.head);r=r.tail}return x()});var ip=e=>lt(e)?x():d(e.head);var qb=a(3,(e,t,r)=>{let o=t,n=e;for(;!lt(n);)o=r(o,n.head),n=n.tail;return o});var Ub=e=>{let t=cr(),r=e;for(;!lt(r);)t=ko(t,r.head),r=r.tail;return t};var Wb,jb,zb,cp="@effect/io/Fiber/Id",wo=Symbol.for(cp),Bi="None",Sm="Runtime",Em="Composite",_m=class{constructor(){this[Wb]=wo,this._tag=Bi}[(Wb=wo,A)](){return I(S(this._tag))(S(cp))}[M](t){return up(t)&&t._tag===Bi}},Om=class{constructor(t,r){this.id=t,this.startTimeMillis=r,this[jb]=wo,this._tag=Sm}[(jb=wo,A)](){return I(S(this.startTimeMillis))(I(S(this.id))(I(S(this._tag))(S(cp))))}[M](t){return up(t)&&t._tag===Sm&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}},Cm=class{constructor(t,r){this.left=t,this.right=r,this[zb]=wo,this._tag=Em}[(zb=wo,A)](){return I(S(this.right))(I(S(this.left))(I(S(this._tag))(S(cp))))}[M](t){return up(t)&&t._tag===Em&&O(this.left,t.left)&&O(this.right,t.right)}},pp=new _m;var up=e=>typeof e=="object"&&e!=null&&wo in e;var Bb=a(2,(e,t)=>e._tag===Bi?t:t._tag===Bi?e:new Cm(e,t));var ap=e=>{switch(e._tag){case Bi:return $e();case Sm:return so(e.id);case Em:return Ve(ap(e.right))(ap(e.left))}},Kb=K(Symbol.for("@effect/io/Fiber/Id/_fiberCounter"),()=>ct(0));var lp=e=>Array.from(ap(e)).map(r=>`#${r}`).join(",");var Gb=()=>{let e=Ot(Kb);return Wt(e+1)(Kb),new Om(e,new Date().getTime())};var et=pp;var Rm=Bb;var Vb=lp;var fp=Gb;var fn="Die",Fo="Empty",mn="Fail",_s="Interrupt",hn="Annotated",dn="Parallel",xn="Sequential";var eS="@effect/io/Cause",Im=Symbol.for(eS),Dk={_E:e=>e},yn={[Im]:Dk,[A](){return I(S(Hk(this)))(S(eS))},[M](e){return xp(e)&&Lk(this,e)},pipe(){return E(this,arguments)},toJSON(){return{_tag:"Cause",errors:Sp(this)}},toString(){return uo(this)},[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}},tt=(()=>{let e=Object.create(yn);return e._tag=Fo,e})(),bn=e=>{let t=Object.create(yn);return t._tag=mn,t.error=e,t},Le=e=>{let t=Object.create(yn);return t._tag=fn,t.defect=e,t},pr=e=>{let t=Object.create(yn);return t._tag=_s,t.fiberId=e,t},Po=(e,t)=>{let r=Object.create(yn);return r._tag=hn,r.cause=e,r.annotation=t,r},Fe=(e,t)=>{let r=Object.create(yn);return r._tag=dn,r.left=e,r.right=t,r},Ce=(e,t)=>{let r=Object.create(yn);return r._tag=xn,r.left=e,r.right=t,r},xp=e=>typeof e=="object"&&e!=null&&Im in e,km=e=>e._tag===Fo;var gp=e=>e._tag===fn;var wm=e=>e._tag===Fo?!0:gn(e,!0,(t,r)=>{switch(r._tag){case Fo:return d(t);case fn:case mn:case _s:return d(!1);default:return x()}});var No=e=>bp(void 0,Uk)(e),Gi=e=>no(gn(e,Xe(),(t,r)=>r._tag===mn?d(ve(r.error)(t)):x())),yp=e=>no(gn(e,Xe(),(t,r)=>r._tag===fn?d(ve(r.defect)(t)):x())),$i=e=>gn(e,$e(),(t,r)=>r._tag===_s?d(wr(r.fiberId)(t)):x()),tS=e=>Vi(e,t=>t._tag===mn?d(t.error):x()),co=e=>{let t=tS(e);switch(t._tag){case"None":return P(e);case"Some":return q(t.value)}};var Fm=e=>Cs(e,{onEmpty:x(),onFail:()=>x(),onDie:t=>d(Le(t)),onInterrupt:()=>x(),onAnnotated:(t,r)=>Me(o=>Po(o,r))(t),onSequential:(t,r)=>N(t)&&N(r)?d(Ce(t.value,r.value)):N(t)&&z(r)?d(t.value):z(t)&&N(r)?d(r.value):x(),onParallel:(t,r)=>N(t)&&N(r)?d(Fe(t.value,r.value)):N(t)&&z(r)?d(t.value):z(t)&&N(r)?d(r.value):x()}),rS=e=>Cs(e,{onEmpty:x(),onFail:t=>d(Le(t)),onDie:t=>d(Le(t)),onInterrupt:()=>x(),onAnnotated:(t,r)=>Me(o=>Po(o,r))(t),onSequential:(t,r)=>N(t)&&N(r)?d(Ce(t.value,r.value)):N(t)&&z(r)?d(t.value):z(t)&&N(r)?d(r.value):x(),onParallel:(t,r)=>N(t)&&N(r)?d(Fe(t.value,r.value)):N(t)&&z(r)?d(t.value):z(t)&&N(r)?d(r.value):x()});var Os=e=>Cs(e,{onEmpty:tt,onFail:()=>tt,onDie:t=>Le(t),onInterrupt:t=>pr(t),onAnnotated:(t,r)=>km(t)?t:Po(t,r),onSequential:Ce,onParallel:Fe}),oS=e=>Cs(e,{onEmpty:tt,onFail:t=>Le(t),onDie:t=>Le(t),onInterrupt:t=>pr(t),onAnnotated:(t,r)=>km(t)?t:Po(t,r),onSequential:(t,r)=>Ce(t,r),onParallel:(t,r)=>Fe(t,r)});var nS=a(2,(e,t)=>Cs(e,{onEmpty:tt,onFail:r=>t(r),onDie:r=>Le(r),onInterrupt:r=>pr(r),onAnnotated:(r,o)=>Po(r,o),onSequential:(r,o)=>Ce(r,o),onParallel:(r,o)=>Fe(r,o)})),Pm=e=>nS(e,F);var Lk=(e,t)=>{let r=Oe(e),o=Oe(t);for(;Ke(r)&&Ke(o);){let[n,s]=gn([$e(),Xe()],([p,u],f)=>{let[m,y]=Am(f);return d([Ve(m)(p),ar(y)(u)])})(Be(r)),[i,c]=gn([$e(),Xe()],([p,u],f)=>{let[m,y]=Am(f);return d([Ve(m)(p),ar(y)(u)])})(Be(o));if(!O(n,i))return!1;r=s,o=c}return!0},Hk=e=>qk(Oe(e),Xe()),qk=(e,t)=>{for(;;){let[r,o]=it([$e(),Xe()],([s,i],c)=>{let[p,u]=Am(c);return[Ve(p)(s),ar(u)(i)]})(e),n=io(r)>0?ve(r)(t):t;if(gs(o))return no(n);e=o,t=n}throw new Error("BUG: Cause.flattenCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")};var Vi=a(2,(e,t)=>{let r=[e];for(;r.length>0;){let o=r.pop(),n=t(o);switch(n._tag){case"None":{switch(o._tag){case xn:case dn:{r.push(o.right),r.push(o.left);break}case hn:{r.push(o.cause);break}}break}case"Some":return n}}return x()});var Am=e=>{let t=e,r=[],o=$e(),n=Xe();for(;t!==void 0;)switch(t._tag){case Fo:{if(r.length===0)return[o,n];t=r.pop();break}case mn:{if(r.length===0)return[wr(t.error)(o),n];o=wr(t.error)(o),t=r.pop();break}case fn:{if(r.length===0)return[wr(t.defect)(o),n];o=wr(t.defect)(o),t=r.pop();break}case _s:{if(r.length===0)return[wr(t.fiberId)(o),n];o=wr(t.fiberId)(o),t=r.pop();break}case hn:{t=t.cause;break}case xn:{switch(t.left._tag){case Fo:{t=t.right;break}case xn:{t=Ce(t.left.left,Ce(t.left.right,t.right));break}case dn:{t=Fe(Ce(t.left.left,t.right),Ce(t.left.right,t.right));break}case hn:{t=Ce(t.left.cause,t.right);break}default:{n=ve(t.right)(n),t=t.left;break}}break}case dn:{r.push(t.right),t=t.left;break}}throw new Error("BUG: Cause.evaluateCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")};var Uk={emptyCase:Or,failCase:Dt,dieCase:Dt,interruptCase:Or,annotatedCase:(e,t)=>t,sequentialCase:(e,t,r)=>t&&r,parallelCase:(e,t,r)=>t&&r};var Yb="SequentialCase",Jb="ParallelCase",Qb="AnnotatedCase",Cs=a(2,(e,{onAnnotated:t,onDie:r,onEmpty:o,onFail:n,onInterrupt:s,onParallel:i,onSequential:c})=>bp(e,void 0,{emptyCase:()=>o,failCase:(p,u)=>n(u),dieCase:(p,u)=>r(u),interruptCase:(p,u)=>s(u),annotatedCase:(p,u,f)=>t(u,f),sequentialCase:(p,u,f)=>c(u,f),parallelCase:(p,u,f)=>i(u,f)})),gn=a(3,(e,t,r)=>{let o=t,n=e,s=[];for(;n!==void 0;){let i=r(o,n);switch(o=N(i)?i.value:o,n._tag){case xn:{s.push(n.right),n=n.left;break}case dn:{s.push(n.right),n=n.left;break}case hn:{n=n.cause;break}default:{n=void 0;break}}n===void 0&&s.length>0&&(n=s.pop())}return o}),bp=a(3,(e,t,r)=>{let o=[e],n=[];for(;o.length>0;){let i=o.pop();switch(i._tag){case Fo:{n.push(P(r.emptyCase(t)));break}case mn:{n.push(P(r.failCase(t,i.error)));break}case fn:{n.push(P(r.dieCase(t,i.defect)));break}case _s:{n.push(P(r.interruptCase(t,i.fiberId)));break}case hn:{o.push(i.cause),n.push(q({_tag:Qb,annotation:i.annotation}));break}case xn:{o.push(i.right),o.push(i.left),n.push(q({_tag:Yb}));break}case dn:{o.push(i.right),o.push(i.left),n.push(q({_tag:Jb}));break}}}let s=[];for(;n.length>0;){let i=n.pop();switch(i._tag){case"Left":{switch(i.left._tag){case Yb:{let c=s.pop(),p=s.pop(),u=r.sequentialCase(t,c,p);s.push(u);break}case Jb:{let c=s.pop(),p=s.pop(),u=r.parallelCase(t,c,p);s.push(u);break}case Qb:{let c=s.pop(),p=r.annotatedCase(t,c,i.left.annotation);s.push(p);break}}break}case"Right":{s.push(i.right);break}}}if(s.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/io/issues");return s.pop()}),Yi=(e,t)=>{let r={value:t,enumerable:!0},o={...e,toString(){return`${this._tag}: ${this.message}`}};return n=>Object.create(o,{_tag:r,message:{value:n,enumerable:!0}})},Mm=Symbol.for("@effect/io/Cause/errors/RuntimeException"),Nm=Yi({[Mm]:Mm},"RuntimeException");var mp=Symbol.for("@effect/io/Cause/errors/InterruptedException"),Wk=Yi({[mp]:mp},"InterruptedException"),Dm=e=>typeof e=="object"&&e!=null&&mp in e,Tm=Symbol.for("@effect/io/Cause/errors/IllegalArgument"),Rs=Yi({[Tm]:Tm},"IllegalArgumentException");var hp=Symbol.for("@effect/io/Cause/errors/NoSuchElement"),po=Yi({[hp]:hp},"NoSuchElementException"),Lm=e=>typeof e=="object"&&e!=null&&hp in e,vm=Symbol.for("@effect/io/Cause/errors/InvalidHubCapacityException"),oz=Yi({[vm]:vm},"InvalidHubCapacityException");var dp=Symbol.for("@effect/io/Cause/SpanAnnotation"),jk=e=>typeof e=="object"&&e!==null&&dp in e,sS=e=>({_tag:"SpanAnnotation",[dp]:dp,span:e});var Zb=e=>{if(typeof e=="object"&&e!=null&&"toString"in e&&typeof e.toString=="function"&&e.toString!==Object.prototype.toString)return e.toString();if(typeof e=="string")return`Error: ${e}`;if(typeof e=="object"&&e!==null&&"message"in e&&typeof e.message=="string"){let t=JSON.parse(JSON.stringify(e)),r=new Set(Object.keys(t));if(r.delete("name"),r.delete("message"),r.delete("_tag"),r.size===0)return`${"name"in e&&typeof e.name=="string"?e.name:"Error"}${"_tag"in e&&typeof e._tag=="string"?`(${e._tag})`:""}: ${e.message}`}return`Error: ${JSON.stringify(e)}`},Xb=e=>e instanceof Error?[Zb(e),e.stack?.split(`
`).filter(t=>!t.startsWith("Error")).join(`
`)]:[Zb(e),void 0];var zk=e=>{let t=e.split(`
`),r=[];for(let o=0;o<t.length;o++){if(t[o].includes("EffectPrimitive")||t[o].includes("Generator.next")||t[o].includes("FiberRuntime"))return r.join(`
`);r.push(t[o])}return r.join(`
`)},uo=e=>{if(No(e))return"All fibers interrupted without errors.";let t=Sp(e).map(r=>{let o=r.message;if(r.stack&&(o+=`\r
${zk(r.stack)}`),r.span){let n=r.span,s=0;for(;n&&n._tag==="Span"&&s<10;)o+=`\r
    at ${n.name}`,n=je(n.parent),s++}return o}).join(`\r
\r
`);return t.includes(`\r
`)?`\r
${t}\r
`:t},Sp=e=>bp(e,void 0,{emptyCase:()=>[],dieCase:(t,r)=>{let o=Xb(r);return[{message:o[0],stack:o[1],span:void 0}]},failCase:(t,r)=>{let o=Xb(r);return[{message:o[0],stack:o[1],span:void 0}]},interruptCase:()=>[],parallelCase:(t,r,o)=>[...r,...o],sequentialCase:(t,r,o)=>[...r,...o],annotatedCase:(t,r,o)=>jk(o)?r.map(n=>({...n,span:n.span??o.span})):r});var iS=uo;var Ji=255,aS=8,Ep=e=>e&Ji,_p=e=>e>>aS&Ji,En=(e,t)=>(e&Ji)+((t&e&Ji)<<aS),Op=En(0,0),cS=e=>En(e,e),pS=e=>En(e,0);var uS=a(2,(e,t)=>En(Ep(e)&~t,_p(e)));var Hm=a(2,(e,t)=>e|t);var lS=e=>~e>>>0&Ji;var mS=0,ur=1,qm=2,Cp=4,Qi=16,Rp=32;var Um=e=>Zi(e,Rp);var Wm=a(2,(e,t)=>e|t);var Fr=e=>As(e)&&!hS(e),As=e=>Zi(e,ur);var Zi=a(2,(e,t)=>(e&t)!==0),Ap=(...e)=>e.reduce((t,r)=>t|r,0),jm=Ap(mS);var Xi=e=>Zi(e,Cp);var hS=e=>Zi(e,Qi);var _n=a(2,(e,t)=>En(e^t,t)),Ms=a(2,(e,t)=>e&(lS(Ep(t))|_p(t))|Ep(t)&_p(t));var zm=sp({empty:Op,diff:(e,t)=>_n(e,t),combine:(e,t)=>Hm(t)(e),patch:(e,t)=>Ms(t,e)});var Tp=Op;var Km=cS,Bm=pS;var Gm=uS;var xS,gS,yS,bS={_tag:"Empty"},On=(e,t)=>({_tag:"Par",left:e,right:t}),vp=(e,t)=>({_tag:"Seq",left:e,right:t}),Ym=(e,t)=>({_tag:"Single",dataSource:e,blockedRequest:t});var SS=e=>{let t=Ki(e),r=cr();for(;;){let[o,n]=qb(t,[ES(),cr()],([s,i],c)=>{let[p,u]=Vk(c);return[_S(s,p),Lb(i,u)]});if(r=Yk(r,o),lt(n))return Ub(r);t=n}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/query/issues")},Vk=e=>{let t=e,r=ES(),o=cr(),n=cr();for(;;)switch(t._tag){case"Empty":{if(lt(o))return[r,n];t=o.head,o=o.tail;break}case"Par":{o=ao(t.right,o),t=t.left;break}case"Seq":{let s=t.left,i=t.right;switch(s._tag){case"Empty":{t=i;break}case"Par":{let c=s.left,p=s.right;t=On(vp(c,i),vp(p,i));break}case"Seq":{let c=s.left,p=s.right;t=vp(c,vp(p,i));break}case"Single":{t=s,n=ao(i,n);break}}break}case"Single":{if(r=_S(r,ew(t.dataSource,t.blockedRequest)),lt(o))return[r,n];t=o.head,o=o.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/query/issues")},Yk=(e,t)=>{if(lt(e))return Ki($m(t));if(tw(t))return e;let r=aw(e.head),o=rw(t);return r.length===1&&o.length===1&&O(r[0],o[0])?ao(iw(e.head,$m(t)),e.tail):ao($m(t),e)},Jk=Symbol.for("@effect/io/RequestBlock.Entry"),Vm=class{constructor(t,r,o,n,s){this.request=t,this.result=r,this.listeners=o,this.ownerId=n,this.state=s,this[xS]=Qk}};xS=Jk;var Qk={_R:e=>e};var Jm=e=>new Vm(e.request,e.result,e.listeners,e.ownerId,e.state),Zk=Symbol.for("@effect/io/RequestBlockParallel"),Xk={_R:e=>e},ea=class{constructor(t){this.map=t,this[gS]=Xk}};gS=Zk;var ES=()=>new ea(oo()),ew=(e,t)=>new ea(By([e,Array.of(t)])),_S=(e,t)=>new ea(Kf(e.map,t.map,(r,o,n)=>vr(r,n,De(Hi(r,n),{onNone:()=>o,onSome:s=>[...s,...o]})))),tw=e=>Gy(e.map),rw=e=>Array.from(zf(e.map)),$m=e=>sw(Vy(e.map,t=>Array.of(t)));var ow=Symbol.for("@effect/io/RequestBlockSequential"),nw={_R:e=>e},Ip=class{constructor(t){this.map=t,this[yS]=nw}};yS=ow;var sw=e=>new Ip(e),iw=(e,t)=>new Ip(Kf(t.map,e.map,(r,o,n)=>vr(r,n,De(Hi(r,n),{onNone:()=>[],onSome:s=>[...s,...o]}))));var aw=e=>Array.from(zf(e.map)),OS=e=>Array.from(e.map);var Cn="Pending",ta="Done";var cw="@effect/io/Deferred",AS=Symbol.for(cw),MS={_E:e=>e,_A:e=>e},kp=e=>({_tag:Cn,joiners:e}),Qm=e=>({_tag:ta,effect:e});var Ts="Async",TS="Commit",fe="Failure",vs="OnFailure",Is="OnSuccess",ks="OnSuccessAndFailure",me="Success",wp="Sync",vS="Tag",lo="UpdateRuntimeFlags",ws="While",Fp="WithRuntime",Fs="Yield",ra="RevertFlags";var Np=class{constructor(){this.buckets=[]}scheduleTask(t,r){let o,n;for(n=0;n<this.buckets.length&&this.buckets[n][0]<=r;n++)o=this.buckets[n];if(o)o[1].push(t);else{let s=[];for(let i=0;i<n;i++)s.push(this.buckets[i]);s.push([r,[t]]);for(let i=n;i<this.buckets.length;i++)s.push(this.buckets[i]);this.buckets=s}}},Zm=class{constructor(t){this.maxNextTickBeforeTimer=t,this.running=!1,this.tasks=new Np}starveInternal(t){let r=this.tasks.buckets;this.tasks.buckets=[];for(let[o,n]of r)for(let s=0;s<n.length;s++)n[s]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}scheduleTask(t,r){this.tasks.scheduleTask(t,r),this.running||(this.running=!0,this.starve())}},Xm=K(Symbol.for("@effect/io/Scheduler/defaultScheduler"),()=>new Zm(2048)),Dp=class{constructor(){this.tasks=new Np,this.deferred=!1}scheduleTask(t,r){this.deferred?Xm.scheduleTask(t,r):this.tasks.scheduleTask(t,r)}flush(){for(;this.tasks.buckets.length>0;){let t=this.tasks.buckets;this.tasks.buckets=[];for(let[r,o]of t)for(let n=0;n<o.length;n++)o[n]()}this.deferred=!0}};var kS,wS,FS,PS,uw="@effect/io/Effect/Error",eh=Symbol.for(uw),DS=e=>typeof e=="object"&&e!=null&&eh in e,LS=e=>({[eh]:eh,_tag:"EffectError",cause:e}),he=(e,t)=>{let r=new Re("Blocked");return r.i0=e,r.i1=t,r},Wp=e=>{let t=new Re("RunBlocked");return t.i0=e,t},Ps=Symbol.for("@effect/io/Effect"),Hp=class{constructor(t,r){this.patch=t,this.op=r,this._tag=ra}},Re=class{constructor(t){this._tag=t,this.i0=void 0,this.i1=void 0,this.i2=void 0,this.trace=void 0,this[kS]=th}[(kS=Ps,M)](t){return this===t}[A](){return Ro(this)}pipe(){return E(this,arguments)}},qp=class{constructor(t){this._tag=t,this.i0=void 0,this.i1=void 0,this.i2=void 0,this.trace=void 0,this[wS]=th}[(wS=Ps,M)](t){return this===t}[A](){return Ro(this)}get cause(){return this.i0}pipe(){return E(this,arguments)}toJSON(){return{_tag:this._tag,cause:this.cause.toJSON()}}toString(){return iS(this.cause)}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}},Up=class{constructor(t){this._tag=t,this.i0=void 0,this.i1=void 0,this.i2=void 0,this.trace=void 0,this[FS]=th}[(FS=Ps,M)](t){return this===t}[A](){return Ro(this)}get value(){return this.i0}pipe(){return E(this,arguments)}toJSON(){return{_tag:this._tag,value:this.value}}toString(){return`Success: ${String(this.value)}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}},th={_R:e=>e,_E:e=>e,_A:e=>e},de=e=>typeof e=="object"&&e!=null&&Ps in e,ue=e=>{let t=new Re(Fp);return t.i0=e,t},Kt=a(3,(e,t,r)=>be(o=>l(e,n=>l(X(T(()=>o(t(n)))),s=>T(()=>r(n,s)).pipe(J({onFailure:i=>{switch(s._tag){case fe:return D(Fe(s.i0,i));case me:return D(i)}},onSuccess:()=>s})))))),Y=a(2,(e,t)=>l(e,()=>h(t))),Z=e=>Y(e,void 0),Bt=(e,t=et)=>T(()=>{let r,o,n=new Re(Ts);if(e.length!==1){let s=new AbortController;o=s,n.i0=i=>{r=e(i,s.signal)}}else n.i0=s=>{r=e(s)};return n.i1=t,Uo(n,()=>(o&&o.abort(),r??k))}),Dr=(e,t=et)=>Bt(r=>{let o=e(r);if(Cr(o))r(o.right);else return o.left},t),Lr=a(2,(e,t)=>{let r=new Re(vs);return r.i0=e,r.i1=t,r}),ft=a(2,(e,t)=>ie(e,{onFailure:t,onSuccess:h})),Do=e=>(...t)=>e(...t),HS=a(2,(e,t)=>J(e,{onFailure:Do(r=>{let o=co(r);switch(o._tag){case"Left":return V(()=>D(r))(t(o.left));case"Right":return D(o.right)}}),onSuccess:h})),qS=e=>ue((t,r)=>e(As(r.runtimeFlags))),rh=e=>D(Le(e)),Ns=e=>Ur(()=>Le(Nm(e))),Lo=e=>Ur(()=>Le(e())),Hr=e=>ie(e,{onFailure:t=>h(q(t)),onSuccess:t=>h(P(t))}),qr=()=>T(()=>Ye(ho)),Ds=e=>l(qr(),e),X=e=>na(e,{onFailure:B,onSuccess:ee}),L=e=>D(bn(e)),lr=e=>Ur(()=>bn(e())),D=e=>{let t=new qp(fe);return t.i0=e,t},Ur=e=>l(g(e),D),Ho=ue(e=>h(e.id())),Gt=e=>ue(t=>e(t.id())),l=a(2,(e,t)=>{let r=new Re(Is);return r.i0=e,r.i1=t,r}),Pr=e=>{let t=new Re("OnStep");return t.i0=e,t.i1=ee,t},Ls=(e,t)=>{let r=new Re("OnStep");return r.i0=e,r.i1=t,r},mt=e=>l(e,F),qo=e=>ie(e,{onFailure:h,onSuccess:L}),na=a(2,(e,{onFailure:t,onSuccess:r})=>J(e,{onFailure:o=>h(t(o)),onSuccess:o=>h(r(o))})),J=a(2,(e,{onFailure:t,onSuccess:r})=>{let o=new Re(ks);return o.i0=e,o.i1=t,o.i2=r,o}),ie=a(2,(e,{onFailure:t,onSuccess:r})=>J(e,{onFailure:o=>{let n=Gi(o);return yp(o).length>0?D(oS(o)):n.length>0?t(un(n)):D(o)},onSuccess:r})),He=a(2,(e,t)=>T(()=>{let r=Q(e),o=new Array(r.length),n=0;return Y(vn({while:()=>n<r.length,body:()=>t(r[n],n),step:s=>{o[n++]=s}}),o)})),ht=a(2,(e,t)=>T(()=>{let r=Q(e),o=0;return vn({while:()=>o<r.length,body:()=>t(r[o],o),step:()=>{o++}})})),jp=a(e=>typeof e[0]=="boolean"||de(e[0]),(e,{onFalse:t,onTrue:r})=>typeof e=="boolean"?e?r:t:l(e,Do(o=>o?r:t))),zp=l(Ho,e=>Kp(e)),Kp=e=>D(pr(e)),zt=e=>{let t=new Re(lo);t.i0=Km(ur);let r=o=>o._tag==="Blocked"?he(o.i0,zt(o.i1)):o;return t.i1=()=>Ls(e,r),t},US=e=>{let t=new Re(lo);t.i0=Km(ur);let r=o=>o._tag==="Blocked"?he(o.i0,zt(o.i1)):o;return t.i1=o=>As(o)?Pr(e(zt)):Pr(e(Nr)),l(t,r)},Wr=a(2,(e,t)=>be(r=>l(X(r(e)),o=>Sh(t,o)))),_=a(2,(e,t)=>l(e,r=>g(()=>t(r)))),Bp=a(2,(e,{onFailure:t,onSuccess:r})=>ie(e,{onFailure:o=>lr(()=>t(o)),onSuccess:o=>g(()=>r(o))})),fo=a(2,(e,t)=>J(e,{onFailure:r=>{let o=co(r);switch(o._tag){case"Left":return lr(()=>t(o.left));case"Right":return D(o.right)}},onSuccess:h})),Gp=a(2,(e,t)=>fr(e,Do(r=>nu(r)?k:t(r.i0)))),fr=a(2,(e,t)=>be(r=>J(r(e),{onFailure:o=>{let n=B(o);return J(t(n),{onFailure:s=>B(Ce(o,s)),onSuccess:()=>n})},onSuccess:o=>{let n=ee(o);return W(t(n),n)}}))),Uo=a(2,(e,t)=>fr(e,au({onFailure:r=>No(r)?Z(t($i(r))):k,onSuccess:()=>k}))),An=a(2,(e,t)=>lw(e,t,h)),Mn=e=>oh(e,F),oh=a(2,(e,t)=>ie(e,{onFailure:r=>rh(t(r)),onSuccess:h})),WS=(e,t)=>Q(e).reduceRight(([r,o],n)=>{let s=t(n);switch(s._tag){case"Left":return[[s.left,...r],o];case"Right":return[r,[s.right,...o]]}},[new Array,new Array]),At=a(2,(e,t)=>Ee(ho,t)(e)),jS=a(2,(e,t)=>qe(ho,r=>en(r,t))(e)),Tn=a(2,(e,t)=>Ds(r=>At(e,t(r)))),$p=ue((e,t)=>h(t.runtimeFlags)),h=e=>{let t=new Up(me);return t.i0=e,t},T=e=>l(g(e),F),g=e=>{let t=new Re(wp);return t.i0=e,t},Mt=a(2,(e,t)=>l(e,r=>Y(t(r),r))),Vp=e=>ue(t=>{let r=t.getFiberRef(oa),o=V(()=>t.scope())(r);return e(Ee(oa,d(o)))}),lw=a(3,(e,t,r)=>J(e,{onFailure:o=>yp(o).length>0?D(Gg(rS(o))):t(),onSuccess:r})),Nr=e=>{let t=new Re(lo);t.i0=Bm(ur),t.i1=()=>Ls(e,r);let r=o=>o._tag==="Blocked"?he(o.i0,Nr(o.i1)):o;return t},be=e=>{let t=new Re(lo);t.i0=Bm(ur);let r=o=>o._tag==="Blocked"?he(o.i0,Nr(o.i1)):o;return t.i1=o=>As(o)?Pr(e(zt)):Pr(e(Nr)),l(t,r)},k=h(void 0),Hs=e=>{let t=new Re(lo);return t.i0=e,t.i1=void 0,t},qs=a(2,(e,t)=>l(t,r=>r?_(d)(e):h(x()))),vn=e=>{let t=new Re(ws);return t.i0=e.while,t.i1=e.body,t.i2=e.step,t},zS=a(2,(e,t)=>Ee(e,eu,t)),KS=a(2,(e,t)=>Ee(e,aa,t)),BS=a(2,(e,t)=>{let r=new Re(lo);return r.i0=t,r.i1=()=>e,r}),GS=a(2,(e,t)=>Ee(e,pa,t)),Tt=e=>{let t=new Re(Fs);return typeof e?.priority<"u"?hh(e.priority)(t):t},Yp=a(2,(e,t)=>l(e,r=>_(t,o=>[r,o])));var Us=a(2,(e,t)=>l(e,r=>Y(t,r))),W=a(2,(e,t)=>l(e,()=>t)),mo=a(3,(e,t,r)=>l(e,o=>_(t,n=>r(o,n)))),In=Dr(()=>{let e=setInterval(()=>{},2147483647);return q(g(()=>clearInterval(e)))}),Wo=e=>l(Ho,t=>$t(t)(e)),$t=a(2,(e,t)=>l(e.interruptAsFork(t),()=>e.await())),nh={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return E(this,arguments)}},sh={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return E(this,arguments)}},ih={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return E(this,arguments)}},ah={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return E(this,arguments)}},Jp={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return E(this,arguments)}},Qp={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return E(this,arguments)}},ch={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return E(this,arguments)}},ph={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return E(this,arguments)}},uh=[nh,ch,Qp,Jp,ah,ih,sh,ph],fw="@effect/io/FiberRef",mw=Symbol.for(fw),hw={_A:e=>e},Ye=e=>$S(e,t=>[t,t]);var Se=a(2,(e,t)=>l(Ye(e),t)),Rn=a(2,(e,t)=>$S(e,()=>[void 0,t]));var $S=a(2,(e,t)=>ue(r=>{let[o,n]=t(r.getFiberRef(e));return r.setFiberRef(e,n),h(o)}));var dw="@effect/io/RequestResolver",VS=Symbol.for(dw),xw={_R:e=>e,_A:e=>e},NS=class e{constructor(t,r){this.runAll=t,this.target=r,this[PS]=xw,this.runAll=t}[(PS=VS,A)](){return this.target?S(this.target):Ro(this)}[M](t){return this.target?gw(t)&&O(this.target,t.target):this===t}identified(...t){return new e(this.runAll,Ir(t))}pipe(){return E(this,arguments)}},gw=e=>typeof e=="object"&&e!=null&&VS in e;var Ee=a(3,(e,t,r)=>l(Kt(Us(Ye(t),Rn(t,r)),()=>Pr(e),o=>Rn(t,o)),o=>o._tag==="Blocked"?he(o.i0,Ee(o.i1,t,r)):o)),qe=a(3,(e,t,r)=>Se(t,o=>Ee(e,t,r(o)))),xe=(e,t)=>Ws(e,{differ:Pb(),fork:t?.fork??F,join:t?.join}),lh=e=>Ws(e,{differ:Fb(),fork:np()}),Zp=e=>Ws(e,{differ:wb(),fork:tp()}),Ws=(e,t)=>({[mw]:hw,initial:e,diff:(r,o)=>vb(r,o)(t.differ),combine:(r,o)=>Ib(r,o)(t.differ),patch:r=>o=>kb(r,o)(t.differ),fork:t.fork,join:t.join??((r,o)=>o),pipe(){return E(this,arguments)}}),YS=e=>Ws(e,{differ:zm,fork:Tp}),ho=Zp(Et()),sa=xe(0),fh=xe(2048),ia=K(Symbol.for("@effect/io/FiberRef/currentLogAnnotation"),()=>xe(oo())),mh=xe(Jp),Xp=K(Symbol.for("@effect/io/FiberRef/currentLogSpan"),()=>xe(cr())),xo=K(Symbol.for("@effect/io/FiberRef/currentScheduler"),()=>xe(Xm)),JS=a(2,(e,t)=>Ee(e,xo,t)),hh=a(2,(e,t)=>Ee(e,sa,t)),QS=a(2,(e,t)=>Ee(e,fh,t)),eu=K(Symbol.for("@effect/io/FiberRef/currentConcurrency"),()=>xe("unbounded")),aa=K(Symbol.for("@effect/io/FiberRef/currentRequestBatching"),()=>xe(!0)),ca=K(Symbol.for("@effect/io/FiberRef/currentUnhandledErrorLogLevel"),()=>xe(d(Qp))),ZS=a(2,(e,t)=>Ee(e,ca,t)),go=lh($e()),XS=Ye(go),oa=K(Symbol.for("@effect/io/FiberRef/currentForkScopeOverride"),()=>xe(x(),{fork:()=>x(),join:(e,t)=>e})),kn=K(Symbol.for("@effect/io/FiberRef/currentInterruptedCause"),()=>xe(tt,{fork:()=>tt,join:(e,t)=>e})),yo=K(Symbol.for("@effect/io/FiberRef/currentTracerSpan"),()=>xe(cr())),pa=K(Symbol.for("@effect/io/FiberRef/currentTracerTiming"),()=>xe(!0)),tu=K(Symbol.for("@effect/io/FiberRef/currentTracerSpanAnnotations"),()=>xe(oo())),ru=K(Symbol.for("@effect/io/FiberRef/currentTracerSpanLinks"),()=>xe(Xe())),ou=Symbol.for("@effect/io/Scope"),dh=Symbol.for("@effect/io/CloseableScope");var js=(e,t)=>e.addFinalizer(t),jo=(e,t)=>e.close(t),xh=(e,t)=>e.fork(t),gh=a(2,(e,t)=>_(bw(e,t),De({onNone:()=>()=>k,onSome:r=>o=>yw(r,o)(e)}))),yw=a(3,(e,t,r)=>T(()=>{switch(e.state._tag){case"Exited":return k;case"Running":{let o=e.state.finalizers.get(t);return e.state.finalizers.delete(t),o!=null?e.state.update(o)(r):k}}})),bw=a(2,(e,t)=>T(()=>{switch(e.state._tag){case"Exited":return e.state.nextKey+=1,Y(t(e.state.exit),x());case"Running":{let r=e.state.nextKey;return e.state.finalizers.set(r,t),e.state.nextKey+=1,h(d(r))}}}));var eE=g(()=>({state:{_tag:"Running",nextKey:0,finalizers:new Map,update:F}}));var yh=e=>e._tag==="Failure",nu=e=>e._tag==="Success";var tE=a(2,(e,t)=>{switch(e._tag){case fe:return B(e.i0);case me:return ee(t)}}),ua=e=>tE(e,void 0);var zs=(e,t)=>Sw(e,t?.parallel?Fe:Ce),su=e=>B(Le(e));var mr=e=>B(bn(e)),B=e=>{let t=new qp(fe);return t.i0=e,t},rE=a(2,(e,t)=>{switch(e._tag){case fe:return B(e.i0);case me:return t(e.i0)}});var oE=e=>rE(F)(e);var iu=e=>B(pr(e)),Lp=a(2,(e,t)=>{switch(e._tag){case fe:return B(e.i0);case me:return ee(t(e.i0))}});var au=a(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case fe:return t(e.i0);case me:return r(e.i0)}}),wn=a(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case fe:return t(e.i0);case me:return r(e.i0)}}),ee=e=>{let t=new Up(me);return t.i0=e,t};var jr=ee(void 0);var la=a(3,(e,t,{onFailure:r,onSuccess:o})=>{switch(e._tag){case fe:switch(t._tag){case me:return B(e.i0);case fe:return B(r(e.i0,t.i0))}case me:switch(t._tag){case me:return ee(o(e.i0,t.i0));case fe:return B(t.i0)}}}),Sw=(e,t)=>{let r=Ir(e);return Ke(r)?d(Lp(o=>Array.from(o))(Lp(no)(it(Lp(Oe)(Be(r)),(o,n)=>la(n,{onSuccess:(s,i)=>ve(i)(s),onFailure:t})(o))(Ge(r))))):x()},Ks=e=>({[AS]:MS,state:ct(kp([])),blockingOn:e,pipe(){return E(this,arguments)}}),rt=()=>l(Ho,e=>nE(e)),nE=e=>g(()=>Ks(e)),Ie=e=>Dr(t=>{let r=Ot(e.state);switch(r._tag){case ta:return P(r.effect);case Cn:return Wt(kp([t,...r.joiners]))(e.state),q(Ew(e,t))}},e.blockingOn),bh=a(2,(e,t)=>Wr(t,e)),Bs=a(2,(e,t)=>g(()=>{let r=Ot(e.state);switch(r._tag){case ta:return!1;case Cn:{Wt(Qm(t))(e.state);for(let o=0;o<r.joiners.length;o++)r.joiners[o](t);return!0}}})),Sh=a(2,(e,t)=>Bs(e,t)),fa=a(2,(e,t)=>Bs(e,L(t)));var Fn=a(2,(e,t)=>Bs(e,D(t)));var sE=e=>l(Ho,t=>Bs(e,Kp(t)));var Gs=a(2,(e,t)=>Bs(e,h(t)));var $s=(e,t)=>{let r=Ot(e.state);if(r._tag===Cn){Wt(Qm(t))(e.state);for(let o=r.joiners.length-1;o>=0;o--)r.joiners[o](t)}},Ew=(e,t)=>g(()=>{let r=Ot(e.state);r._tag===Cn&&Wt(kp(r.joiners.filter(o=>o!==t)))(e.state)});var Pn=Ie;var iE=Sh;var aE=sE;var Eh=Ks;var pE=oE;var uE=ee;var hE,_w="@effect/io/Clock",Oh=Symbol.for(_w),zr=at(Oh),Ow=2**31-1,fE={unsafeSchedule(e,t){let r=Mr(t);if(r>Ow)return Dt;let o=!1,n=setTimeout(()=>{o=!0,e()},r);return()=>(clearTimeout(n),!o)}},mE=function(){let e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;let t="timeOrigin"in performance&&typeof performance.timeOrigin=="number"?BigInt(Math.round(performance.timeOrigin*1e6)):BigInt(Date.now())*e;return()=>t+BigInt(Math.round(performance.now()*1e6))}(),Cw=function(){let e=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!e)return mE;let t=mE()-e.bigint();return()=>t+e.bigint()}(),_h=class{constructor(){this[hE]=Oh,this.currentTimeMillis=g(()=>this.unsafeCurrentTimeMillis()),this.currentTimeNanos=g(()=>this.unsafeCurrentTimeNanos())}unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return Cw()}scheduler(){return h(fE)}sleep(t){return Dr(r=>{let o=fE.unsafeSchedule(()=>r(k),t);return q(Z(g(o)))})}};hE=Oh;var dE=()=>new _h;var cu="And",pu="Or",uu="InvalidData",lu="MissingData",fu="SourceUnavailable",mu="Unsupported";var Aw="@effect/io/Config/Error",Ch=Symbol.for(Aw),Vs={[Ch]:Ch},hu=(e,t)=>{let r=Object.create(Vs);return r._tag=cu,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),r},du=(e,t)=>{let r=Object.create(Vs);return r._tag=pu,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),r},Kr=(e,t,r={pathDelim:"."})=>{let o=Object.create(Vs);return o._tag=uu,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Invalid data at ${to(r.pathDelim)(this.path)}: "${this.message}")`}}),o},hr=(e,t,r={pathDelim:"."})=>{let o=Object.create(Vs);return o._tag=lu,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Missing data at ${to(r.pathDelim)(this.path)}: "${this.message}")`}}),o},gE=(e,t,r,o={pathDelim:"."})=>{let n=Object.create(Vs);return n._tag=fu,n.path=e,n.message=t,n.cause=r,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Source unavailable at ${to(o.pathDelim)(this.path)}: "${this.message}")`}}),n},xu=(e,t,r={pathDelim:"."})=>{let o=Object.create(Vs);return o._tag=mu,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${to(r.pathDelim)(this.path)}: "${this.message}")`}}),o};var bo=a(2,(e,t)=>{switch(e._tag){case cu:return hu(bo(t)(e.left),bo(t)(e.right));case pu:return du(bo(t)(e.left),bo(t)(e.right));case uu:return Kr([...t,...e.path],e.message);case lu:return hr([...t,...e.path],e.message);case fu:return gE([...t,...e.path],e.message,e.cause);case mu:return xu([...t,...e.path],e.message)}}),Mw={andCase:(e,t,r)=>t&&r,orCase:(e,t,r)=>t&&r,invalidDataCase:Dt,missingDataCase:Or,sourceUnavailableCase:Dt,unsupportedCase:Dt},yE=a(3,(e,t,r)=>{let o=[e],n=[];for(;o.length>0;){let i=o.pop();switch(i._tag){case cu:{o.push(i.right),o.push(i.left),n.push(q({_tag:"AndCase"}));break}case pu:{o.push(i.right),o.push(i.left),n.push(q({_tag:"OrCase"}));break}case uu:{n.push(P(r.invalidDataCase(t,i.path,i.message)));break}case lu:{n.push(P(r.missingDataCase(t,i.path,i.message)));break}case fu:{n.push(P(r.sourceUnavailableCase(t,i.path,i.message,i.cause)));break}case mu:{n.push(P(r.unsupportedCase(t,i.path,i.message)));break}}}let s=[];for(;n.length>0;){let i=n.pop();switch(i._tag){case"Left":{switch(i.left._tag){case"AndCase":{let c=s.pop(),p=s.pop(),u=r.andCase(t,c,p);s.push(u);break}case"OrCase":{let c=s.pop(),p=s.pop(),u=r.orCase(t,c,p);s.push(u);break}}break}case"Right":{s.push(i.right);break}}}if(s.length===0)throw new Error("BUG: ConfigError.reduceWithContext - please report an issue at https://github.com/Effect-TS/io/issues");return s.pop()}),bE=e=>yE(e,void 0,Mw);var Rh=bE;var SE="@effect/io/Config/Secret",Ah=Symbol.for(SE),vw={[Ah]:Ah,[A](){return I(Xr(this.raw))(S(SE))},[M](e){return Iw(e)&&this.raw.length===e.raw.length&&this.raw.every((t,r)=>O(t,e.raw[r]))}},Iw=e=>typeof e=="object"&&e!=null&&Ah in e,kw=e=>{let t=Object.create(vw);return Object.defineProperty(t,"toString",{enumerable:!1,value(){return"ConfigSecret(<redacted>)"}}),Object.defineProperty(t,"raw",{enumerable:!1,value:e}),t};var EE=e=>kw(e.split("").map(t=>t.charCodeAt(0)));var yu="Constant",bu="Fail",ma="Fallback",Su="Described",Eu="Lazy",_u="MapOrFail",Ou="Nested",Cu="Primitive",Ru="Sequence",Au="HashMap",Mu="ZipWith";var Fw="@effect/io/Config",vu=Symbol.for(Fw),Pw={_A:e=>e},Vt={[vu]:Pw,pipe(){return E(this,arguments)}},CE=e=>{let t=zo("a boolean property",r=>{switch(r){case"true":case"yes":case"on":case"1":return P(!0);case"false":case"no":case"off":case"0":return P(!1);default:{let o=Kr([],`Expected a boolean value, but received ${r}`);return q(o)}}});return e===void 0?t:Yt(e)(t)},RE=(e,t)=>So(Ze)(Iu(e,t)),Iu=(e,t)=>So(t===void 0?Tu(e):Yt(t)(Tu(e)),Ct),AE=e=>{let t=zo("a date property",r=>{let o=Date.parse(r);return Number.isNaN(o)?q(Kr([],`Expected a date value but received ${r}`)):P(new Date(o))});return e===void 0?t:Yt(e)(t)},ME=e=>{let t=Object.create(Vt);return t._tag=bu,t.message=e,t.parse=()=>q(xu([],e)),t},TE=e=>{let t=zo("a number property",r=>{let o=Number.parseFloat(r);return Number.isNaN(o)?q(Kr([],`Expected an number value but received ${r}`)):P(o)});return e===void 0?t:Yt(e)(t)},vE=e=>{let t=zo("an integer property",r=>{let o=Number.parseInt(r,10);return Number.isNaN(o)?q(Kr([],`Expected an integer value but received ${r}`)):P(o)});return e===void 0?t:Yt(e)(t)},IE=e=>{let t=Ys(Mh(),r=>{let o=r.toUpperCase(),n=uh.find(s=>s.label===o);return n===void 0?q(Kr([],`Expected a log level, but found: ${r}`)):P(n)});return e===void 0?t:Yt(t,e)},So=a(2,(e,t)=>Ys(e,r=>P(t(r)))),kE=a(2,(e,t)=>Ys(e,r=>{try{return P(t(r))}catch(o){return q(Kr([],o instanceof Error?o.message:`${o}`))}})),Ys=a(2,(e,t)=>{let r=Object.create(Vt);return r._tag=_u,r.original=e,r.mapOrFail=t,r}),wE=e=>t=>hr([],`Expected ${t.description} with name ${e}`),Yt=a(2,(e,t)=>{let r=Object.create(Vt);return r._tag=Ou,r.name=t,r.config=e,r}),FE=a(2,(e,t)=>{let r=Object.create(Vt);return r._tag=ma,r.first=e,r.second=ha(t),r.condition=Or,r}),ku=a(2,(e,t)=>{let r=Object.create(Vt);return r._tag=ma,r.first=e,r.second=ha(t.orElse),r.condition=t.if,r}),PE=e=>ku({orElse:()=>Js(x()),if:Rh})(So(d)(e)),zo=(e,t)=>{let r=Object.create(Vt);return r._tag=Cu,r.description=e,r.parse=t,r},Tu=e=>{let t=Object.create(Vt);return t._tag=Ru,t.config=e,t},NE=e=>{let t=zo("a secret property",r=>P(EE(r)));return e===void 0?t:Yt(e)(t)},DE=(e,t)=>{let r=So(Iu(e),ut);return t===void 0?r:Yt(t)(r)},Mh=e=>{let t=zo("a text property",P);return e===void 0?t:Yt(e)(t)},LE=e=>Array.isArray(e)?OE(e):Symbol.iterator in e?OE([...e]):HE(e),HE=e=>{let t=Object.entries(e),r=So(n=>({[t[0][0]]:n}))(t[0][1]);if(t.length===1)return r;let o=t.slice(1);for(let[n,s]of o)r=da(s,(i,c)=>({...i,[n]:c}))(r);return r},Js=e=>{let t=Object.create(Vt);return t._tag=yu,t.value=e,t.parse=()=>P(e),t},ha=e=>{let t=Object.create(Vt);return t._tag=Eu,t.config=e,t},qE=e=>ha(()=>Js(e())),UE=(e,t)=>{let r=Object.create(Vt);return r._tag=Au,r.valueConfig=e,t===void 0?r:Yt(t)(r)},Th=e=>typeof e=="object"&&e!=null&&vu in e,OE=e=>{if(e.length===0)return Js([]);if(e.length===1)return So(e[0],r=>[r]);let t=So(e[0],r=>[r]);for(let r=1;r<e.length;r++){let o=e[r];t=da(o,(n,s)=>[...n,s])(t)}return t},vh=e=>Th(e)?e:HE(Object.fromEntries(Object.entries(e).map(([t,r])=>[t,vh(r)]))),WE=a(2,(e,{message:t,validation:r})=>Ys(e,o=>r(o)?P(o):q(Kr([],t)))),jE=a(2,(e,t)=>ku(e,{orElse:()=>Js(t),if:Rh})),zE=a(2,(e,t)=>{let r=Object.create(Vt);return r._tag=Su,r.config=e,r.description=t,r}),KE=a(2,(e,t)=>da(e,t,(r,o)=>[r,o])),da=a(3,(e,t,r)=>{let o=Object.create(Vt);return o._tag=Mu,o.left=e,o.right=t,o.zip=r,o});var GE={_tag:"Empty"};var wu=a(2,(e,t)=>{let r=Ki(t),o=e;for(;zi(r);){let n=r.head;switch(n._tag){case"Empty":{r=r.tail;break}case"AndThen":{r=ao(n.first,ao(n.second,r.tail));break}case"MapName":{o=eo(o,n.f),r=r.tail;break}case"Nested":{o=rr(o,n.name),r=r.tail;break}case"Unnested":{if(Vg(n.name)(kc(o)))o=qt(o),r=r.tail;else return q(hr(o,`Expected ${n.name} to be in path in ConfigProvider#unnested`));break}}}return P(o)});var Fu=(e,t)=>[...e,...t],Dw="@effect/io/Config/Provider",Ih=Symbol.for(Dw),Qs=at(Ih),Lw="@effect/io/Config/Provider/Flat",$E=Symbol.for(Lw),Hw=e=>({[Ih]:Ih,pipe(){return E(this,arguments)},...e}),qw=e=>({[$E]:$E,patch:e.patch,load:(t,r,o=!0)=>e.load(t,r,o),enumerateChildren:e.enumerateChildren}),Uw=e=>Hw({load:t=>l(Jt(e,Xo(),t,!1),r=>De(kc(r),{onNone:()=>L(hr(Xo(),`Expected a single value having structure: ${t}`)),onSome:h})),flattened:e}),VE=(e={})=>{let{pathDelim:t,seqDelim:r}=Object.assign({},{pathDelim:"_",seqDelim:","},e),o=p=>to(t)(p),n=p=>p.split(t),s=()=>typeof process<"u"&&"env"in process&&typeof process.env=="object"?process.env:{};return Uw(qw({load:(p,u,f=!0)=>{let m=o(p),y=s(),b=m in y?d(y[m]):x();return l(C=>Kw(C,p,u,r,f))(fo(()=>hr(p,`Expected ${m} to exist in the process context`))(b))},enumerateChildren:p=>g(()=>{let u=s(),f=Object.keys(u),y=Array.from(f).map(b=>n(b.toUpperCase())).filter(b=>{for(let C=0;C<p.length;C++){let R=yf(C)(p),v=b[C];if(v===void 0||R!==v)return!1}return!0}).flatMap(b=>b.slice(p.length,p.length+1));return ut(y)}),patch:GE}))};var Ww=(e,t,r,o)=>{let n=Ef(r.length,p=>p>=o.length?x():d([e(p),p+1])),s=Ef(o.length,p=>p>=r.length?x():d([t(p),p+1])),i=Fu(r,n),c=Fu(o,s);return[i,c]},Jt=(e,t,r,o)=>{let n=r;switch(n._tag){case yu:return h(St(n.value));case Su:return T(()=>Jt(e,t,n.config,o));case bu:return L(hr(t,n.message));case ma:return ft(s=>n.condition(s)?ft(i=>L(du(s,i)))(Jt(e,t,n.second,o)):L(s))(T(()=>Jt(e,t,n.first,o)));case Eu:return T(()=>Jt(e,t,n.config(),o));case _u:return T(()=>l(He(s=>fo(bo(t))(n.mapOrFail(s))))(Jt(e,t,n.original,o)));case Ou:return T(()=>Jt(e,Fu(t,St(n.name)),n.config,o));case Cu:return l(s=>l(i=>{if(i.length===0){let c=V(()=>"<n/a>")(Qg(s));return L(wE(c))}return h(i)})(e.load(s,n,o)))(wu(t,e.patch));case Ru:return l(s=>l(i=>i.length===0?T(()=>_(Jt(e,s,n.config,!0),St)):_(c=>{let p=Fc(c);return p.length===0?St(Xo()):St(p)})(He(i,c=>Jt(e,Yg(t,`[${c}]`),n.config,!0))))(l($w)(e.enumerateChildren(s))))(wu(t,e.patch));case Au:return T(()=>l(s=>l(i=>_(c=>{if(c.length===0)return St(oo());let p=c.map(u=>Array.from(u));return eo(u=>Yc(Sf(Q(i),u)))(Bw(p))})(He(c=>Jt(e,Fu(s,St(c)),n.valueConfig,o))(i)))(e.enumerateChildren(s)))(wu(t,e.patch)));case Mu:return T(()=>l(s=>l(i=>{if(Ae(s)&&Ae(i))return L(hu(s.left,i.left));if(Ae(s)&&Cr(i))return L(s.left);if(Cr(s)&&Ae(i))return L(i.left);if(Cr(s)&&Cr(i)){let c=to(".")(t),p=jw(t,c),[u,f]=Ww(p,p,eo(P)(s.right),eo(P)(i.right));return He(([m,y])=>_(([b,C])=>n.zip(b,C))(Yp(m,y)))(Sf(f)(u))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/io/issues")})(Hr(Jt(e,t,n.right,o))))(Hr(Jt(e,t,n.left,o))))}},jw=(e,t)=>r=>q(hr(e,`The element at index ${r} in a sequence at path "${t}" was missing`));var zw=(e,t)=>e.split(new RegExp(`\\s*${Gw(t)}\\s*`)),Kw=(e,t,r,o,n)=>n?fo(bo(t))(He(s=>r.parse(s.trim()))(zw(e,o))):fo(bo(t))(_(St)(r.parse(e))),Bw=e=>Object.keys(e[0]).map(t=>e.map(r=>r[t])),Gw=e=>e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&"),$w=e=>_(Tc)(Hr(Bp({onFailure:()=>Xo(),onSuccess:Zo(bt)})(He(e,Yw))));var Vw=/^(\[(\d+)\])$/,Yw=e=>{let t=e.match(Vw);if(t!==null){let r=t[2];return ss(Jw)(r!==void 0&&r.length>0?d(r):x())}return x()};var Jw=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?x():d(t)};var kh=Symbol("@effect/io/Console"),YE=at(kh),JE={[kh]:kh,assert(e,...t){return g(()=>{console.assert(e,...t)})},clear:g(()=>{console.clear()}),count(e){return g(()=>{console.count(e)})},countReset(e){return g(()=>{console.countReset(e)})},debug(...e){return g(()=>{console.debug(...e)})},dir(e,t){return g(()=>{console.dir(e,t)})},dirxml(...e){return g(()=>{console.dirxml(...e)})},error(...e){return g(()=>{console.error(...e)})},group(e){return e?.collapsed?g(()=>console.groupCollapsed(e?.label)):g(()=>console.group(e?.label))},groupEnd:g(()=>{console.groupEnd()}),info(...e){return g(()=>{console.info(...e)})},log(...e){return g(()=>{console.log(...e)})},table(e,t){return g(()=>{console.table(e,t)})},time(e){return g(()=>console.time(e))},timeEnd(e){return g(()=>console.timeEnd(e))},timeLog(e,...t){return g(()=>{console.timeLog(e,...t)})},trace(...e){return g(()=>{console.trace(...e)})},warn(...e){return g(()=>{console.warn(...e)})},withGroup(e,t){return Kt(t?.collapsed?g(()=>console.groupCollapsed(t?.label)):g(()=>console.group(t?.label)),()=>e,()=>g(()=>console.groupEnd()))},withTime(e,t){return Kt(g(()=>console.time(t)),()=>e,()=>g(()=>console.timeEnd(t)))}};var QE,Xw="@effect/io/Random",Fh=Symbol.for(Xw),Ph=at(Fh),wh=class{constructor(t){this.seed=t,this[QE]=Fh,this.PRNG=new rs(t)}next(){return g(()=>this.PRNG.number())}nextBoolean(){return _(this.next(),t=>t>.5)}nextInt(){return g(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,r){return _(this.next(),o=>(r-t)*o+t)}nextIntBetween(t,r){return g(()=>this.PRNG.integer(r-t)+t)}shuffle(t){return eF(t,r=>this.nextIntBetween(0,r+1))}};QE=Fh;var eF=(e,t)=>T(()=>l(r=>{let o=[];for(let n=r.length;n>=2;n=n-1)o.push(n);return Y(Ir(r))(ht(n=>_(s=>tF(r,n-1,s))(t(n)))(o))})(g(()=>Array.from(e)))),tF=(e,t,r)=>{let o=e[t];return e[t]=e[r],e[r]=o,e},ZE=e=>new wh(e);var XE=Symbol.for("@effect/io/Tracer"),oF=e=>({[XE]:XE,...e}),Zs=at(Symbol.for("@effect/io/Tracer")),nF=K("@effect/io/Tracer/SpanId.ids",()=>ct(0)),Nh=class{constructor(t,r,o,n,s){this.name=t,this.parent=r,this.context=o,this.links=n,this.startTime=s,this._tag="Span",this.traceId="native",this.events=[],this.end=(i,c)=>{this.status={_tag:"Ended",endTime:i,exit:c,startTime:this.status.startTime}},this.attribute=(i,c)=>{this.attributes.set(i,c)},this.event=(i,c,p)=>{this.events.push([i,c,p??{}])},this.status={_tag:"Started",startTime:s},this.attributes=new Map,this.spanId=`span${Jy(nF)}`}},e_=oF({span:(e,t,r,o,n)=>new Nh(e,t,r,o,n)});var sF=Te(Zs,e_)(Te(Qs,VE())(Te(Ph,ZE(Math.random()*4294967296>>>0))(Te(YE,JE)(Te(zr,dE())(Et()))))),ot=Zp(sF),r_=e=>{let t=ze(e);return xa(r=>r.sleep(t))},xa=e=>Se(ot,t=>e(Ar(t,zr))),o_=xa(e=>e.currentTimeMillis),n_=xa(e=>e.currentTimeNanos),s_=a(2,(e,t)=>qe(ot,Te(zr,t))(e)),i_=a(2,(e,t)=>qe(ot,Te(Qs,t))(e)),Dh=e=>Se(ot,t=>e(Ar(t,Qs))),a_=e=>Dh(t=>t.load(e));var Pu=e=>Se(ot,t=>e(Ar(t,Ph)));var Nu=e=>Se(ot,t=>e(Ar(t,Zs))),c_=a(2,(e,t)=>qe(ot,Te(Zs,t))(e));var Lh=r_,Du=o_,Hh=n_,p_=xa;var l_;function f_(e){return new Nn(e)}var qh=Symbol.for("@effect/io/FiberRefs"),Nn=class{constructor(t){this.locals=t,this[l_]=qh}pipe(){return E(this,arguments)}};l_=qh;var iF=(e,t,r,o=!1)=>{let n=e,s=t,i=r,c=o,p;for(;p===void 0;)if(Rr(s)&&Rr(i)){let u=_e(s)[0],f=qt(s),m=_e(i)[0],y=_e(i)[1],b=qt(i);u.startTimeMillis<m.startTimeMillis?(i=b,c=!0):u.startTimeMillis>m.startTimeMillis?s=f:u.id<m.id?(i=b,c=!0):u.id>m.id?s=f:p=[y,c]}else p=[n.initial,!0];return p},Lu=a(3,(e,t,r)=>{let o=new Map(e.locals);for(let[n,s]of r.locals){let i=_e(s)[1];if(!O(_e(s)[0],t)){if(!o.has(n)){if(O(i,n.initial))continue;o.set(n,[[t,n.join(n.initial,i)]]);continue}let c=o.get(n),[p,u]=iF(n,c,s);if(u){let f=n.diff(p,i),m=_e(c)[1],y=n.join(m,n.patch(f)(m));if(!O(m,y)){let b,C=_e(c)[0];O(C,t)?b=rr([C,y])(qt(c)):b=rr([t,y])(c),o.set(n,b)}}}}return new Nn(new Map(o))}),Hu=a(2,(e,t)=>{let r=new Map;for(let[o,n]of e.locals.entries()){let s=_e(n)[1],i=o.patch(o.fork)(s);O(s,i)?r.set(o,n):r.set(o,rr([t,i])(n))}return new Nn(r)}),m_=e=>ut(e.locals.keys()),h_=e=>ht(m_(e),t=>Rn(t,Xs(e,t))),ya=a(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new Nn(r)}),ba=a(2,(e,t)=>e.locals.has(t)?d(_e(e.locals.get(t))[1]):x()),Xs=a(2,(e,t)=>V(()=>t.initial)(ba(e,t))),Dn=a(2,(e,{fiberId:t,fiberRef:r,value:o})=>{let n=e.locals.has(r)?e.locals.get(r):Xo(),s;if(gf(n))s=St([t,o]);else{let[c,p]=_e(n);if(O(c,t)){if(O(p,o))return e;s=rr([t,o])(qt(n))}else s=rr([t,o])(n)}let i=new Map(e.locals);return new Nn(i.set(r,s))});var d_=Hu;var x_=Lu,g_=h_,Wh=Dn,y_=f_;var S_="Empty",E_="Add",__="Remove",O_="Update",C_="AndThen",R_={_tag:S_},Uu=(e,t)=>{let r=new Map(e.locals),o=R_;for(let[n,s]of t.locals.entries()){let i=_e(s)[1],c=r.get(n);if(c!==void 0){let p=_e(c)[1];O(p,i)||(o=qu({_tag:O_,fiberRef:n,patch:n.diff(p,i)})(o))}else o=qu({_tag:E_,fiberRef:n,value:i})(o);r.delete(n)}for(let[n]of r.entries())o=qu({_tag:__,fiberRef:n})(o);return o},qu=a(2,(e,t)=>({_tag:C_,first:e,second:t})),Wu=a(3,(e,t,r)=>{let o=r,n=St(e);for(;Rr(n);){let s=_e(n),i=qt(n);switch(s._tag){case S_:{n=i;break}case E_:{o=Dn(o,{fiberId:t,fiberRef:s.fiberRef,value:s.value}),n=i;break}case __:{o=ya(o,s.fiberRef),n=i;break}case O_:{let c=Xs(o,s.fiberRef);o=Dn(o,{fiberId:t,fiberRef:s.fiberRef,value:s.fiberRef.patch(s.patch)(c)}),n=i;break}case C_:{n=rr(s.first)(rr(s.second)(i));break}}}return o});var M_,T_="@effect/io/Metric/Label",jh=Symbol.for(T_),zh=class{constructor(t,r){this.key=t,this.value=r,this[M_]=jh}[(M_=jh,A)](){return I(S(this.value))(I(S(this.key))(S(T_)))}[M](t){return aF(t)&&this.key===t.key&&this.value===t.value}pipe(){return E(this,arguments)}},ju=(e,t)=>new zh(e,t),aF=e=>typeof e=="object"&&e!=null&&jh in e;var zu=class e{constructor(t){this.self=t,this.called=!1}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new e(this.self)}};var pF=nh,Kh=sh,Bh=ih,Gh=ah,$h=Jp,Vh=Qp,Yh=ch,uF=ph;var lF=Mi(e=>e.ordinal)(bt);var I_=ef(lF);var k_=e=>{switch(e){case"All":return pF;case"Debug":return Vh;case"Error":return Bh;case"Fatal":return Kh;case"Info":return $h;case"Trace":return Yh;case"None":return uF;case"Warning":return Gh}};var F_=(e,t)=>({label:e,startTime:t}),P_=e=>t=>`${t.label.replace(/[\s="]/g,"_")}=${e-t.startTime}ms`;var N_=F_,D_=P_;var H_,Ku=Symbol.for("@effect/io/Ref"),Qh={_A:e=>e},Jh=class{constructor(t){this.ref=t,this[H_]=Qh}modify(t){return g(()=>{let r=Ot(this.ref),[o,n]=t(r);return r!==n&&Wt(n)(this.ref),o})}pipe(){return E(this,arguments)}};H_=Ku;var Bu=e=>new Jh(ct(e)),Ln=e=>g(()=>Bu(e)),dr=e=>e.modify(t=>[t,t]),Br=a(2,(e,t)=>e.modify(()=>[void 0,t])),q_=a(2,(e,t)=>e.modify(r=>[r,t]));var Gu=a(2,(e,t)=>e.modify(t));var Sa=a(2,(e,t)=>e.modify(r=>[void 0,t(r)]));var Ea=Ln,Vu=dr,U_=q_;var W_=Gu;var j_=Sa;var K_=Nu;var B_=a(e=>de(e[0]),function(){let e=arguments;return qe(e[0],ia,typeof e[1]=="string"?vr(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[o,n])=>vr(r,o,n),t))}),Yu=e=>_(e,d),G_=e=>fo(e,d),$_=(e,t=et)=>Dr(r=>{let o=e(r);switch(o._tag){case"None":return q(k);case"Some":return P(o.value)}},t),_a=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),g(()=>{try{return t()}catch(o){throw LS(bn(r?r(o):o))}})},V_=a(3,(e,t,r)=>ft(e,o=>typeof o=="object"&&o!=null&&t in o&&o[t]===r.failure?r.onFailure(o):L(o))),Y_=a(2,(e,t)=>Lr(e,Do(r=>{let o=Vi(r,n=>gp(n)?d(n):x());switch(o._tag){case"None":return D(r);case"Some":return t(o.value.defect)}}))),J_=a(2,(e,t)=>J(e,{onFailure:r=>{let o=t(r);switch(o._tag){case"None":return D(r);case"Some":return o.value}},onSuccess:h})),Q_=a(2,(e,t)=>Lr(e,Do(r=>{let o=Vi(r,n=>gp(n)?d(n):x());switch(o._tag){case"None":return D(r);case"Some":{let n=t(o.value.defect);return n._tag==="Some"?n.value:D(r)}}}))),Z_=a(3,(e,t,r)=>ft(e,o=>pe(o)&&"_tag"in o&&o._tag===t?r(o):L(o))),X_=a(2,(e,t)=>ft(e,r=>{let o=Object.keys(t);return pe(r)&&"_tag"in r&&o.includes(r._tag)?t[r._tag](r):L(r)})),eO=e=>na(e,{onFailure:F,onSuccess:()=>tt}),Gr=p_,tO=Gr(h),rO=a(2,(e,t)=>W(Lh(t),e)),Ju=e=>ue((t,r)=>e({id:t.id(),status:r,interruptors:$i(t.getFiberRef(kn))})),oO=Ju(e=>io(e.interruptors)>0?zp:k),nO=Ju(h),Hn=e=>Qu(e,ed,Uu),sO=h({}),iO=a(3,(e,t,r)=>l(e,o=>_(r(o),n=>({...o,[t]:n})))),aO=a(2,(e,t)=>_(e,r=>({[t]:r}))),cO=a(3,(e,t,r)=>_(e,o=>({...o,[t]:r(o)}))),pO=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!1),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>u?(o.push(c),h(!0)):t(c,p))}return _(s,()=>o)})),uO=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!0),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>_(u?t(c,p):h(!1),f=>(f||o.push(c),f)))}return _(s,()=>o)})),lO=e=>_(qr(),e),Xh=e=>An(e,()=>l(Tt(),()=>Xh(e)));var fO=a(3,(e,t,r)=>Oa(e,t,()=>Lo(r))),mO=a(3,(e,t,r)=>Oa(e,t,()=>Ns(r))),Oa=a(3,(e,t,r)=>l(e,o=>t(o)?h(o):r(o))),hO=a(3,(e,t,r)=>Oa(e,t,o=>lr(()=>r(o)))),dO=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=r.next();return o.done?h(x()):xO(r,0,t,o.value)})),xO=(e,t,r,o)=>l(r(o,t),n=>{if(n)return h(d(o));let s=e.next();return s.done?h(x()):xO(e,t+1,r,s.value)}),gO=e=>T(()=>{let t=Ir(e);return Ke(t)?it(Be(t),(r,o)=>An(r,()=>o))(Ge(t)):Lo(()=>Rs("Received an empty collection of effects"))}),yO=a(2,(e,t)=>qo(t(qo(e)))),Ca=a(2,(e,{onFailure:t,onSuccess:r})=>ie(e,{onFailure:o=>h(t(o)),onSuccess:o=>h(r(o))})),bO=a(2,(e,t)=>T(()=>SO(e[Symbol.iterator](),0,t))),SO=(e,t,r)=>{let o=e.next();return o.done?h(!0):l(r(o.value,t),n=>n?SO(e,t+1,r):h(n))},EO=e=>{let t=l(l(e,()=>Tt()),()=>t);return t},Zh=class{constructor(t){this.value=t}[Symbol.iterator](){return new zu(this)}},hF=function(){let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return new Zh(e)},_O=e=>T(()=>{let t=e(hF),r=t.next(),o=n=>n.done?h(n.value):l(s=>o(t.next(s)))(n.value.value);return o(r)}),ed=ue(e=>h(e.unsafeGetFiberRefs())),OO=e=>ie(e,{onFailure:t=>L(d(t)),onSuccess:t=>{let o=t[Symbol.iterator]().next();return o.done?L(x()):h(o.value)}}),CO=e=>Ca(e,{onFailure:es,onSuccess:es}),RO=e=>J(e,{onFailure:t=>rd(t,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>k}),AO=e=>Zu((t,r)=>x_(r,t,e)),MO=e=>Ca(e,{onFailure:Or,onSuccess:Dt}),TO=e=>Ca(e,{onFailure:Dt,onSuccess:Or}),td=(e,t)=>T(()=>t.while(e)?l(t.body(e),r=>td(r,t)):h(e)),qn=e=>(t,r)=>{let o=Ht(e),n,s;return xp(t)?(s=t,n=r??""):(n=t,s=r??tt),ue(i=>(i.log(n,s,o),k))},vO=qn(),IO=qn(Yh),rd=qn(Vh),kO=qn($h),wO=qn(Gh),FO=qn(Bh),PO=qn(Kh),NO=a(2,(e,t)=>l(Du,r=>qe(e,Xp,ko(N_(t,r))))),DO=Ye(ia),LO=(e,t)=>t.discard?qO(e,t.while,t.step,t.body):_(HO(e,t.while,t.step,t.body),r=>Array.from(r)),HO=(e,t,r,o)=>T(()=>t(e)?l(o(e),n=>_(HO(r(e),t,r,o),ko(n))):g(()=>cr())),qO=(e,t,r,o)=>T(()=>t(e)?l(o(e),()=>qO(r(e),t,r,o)):k),UO=a(3,(e,t,r)=>T(()=>{let o=e[Symbol.iterator](),n=[],s=h(t),i,c=0;for(;!(i=o.next()).done;){let p=c++;s=l(s,u=>_(r(u,i.value,p),([f,m])=>(n.push(m),f)))}return _(s,p=>[p,n])})),ei=a(2,(e,t)=>J(e,{onFailure:r=>Ur(()=>t(r)),onSuccess:h})),od=e=>l(t=>_(r=>W(r,l(([o,n])=>Y(Un(o),n))(Ie(t))))(nd(Wr(t)(Hn(e)))))(rt()),WO=e=>ie(e,{onFailure:t=>h(t),onSuccess:h}),Ra=e=>_(e,t=>!t),jO=e=>ie(e,{onFailure:t=>L(d(t)),onSuccess:t=>{switch(t._tag){case"None":return k;case"Some":return L(x())}}}),nd=e=>_(Ea(!0),t=>Z(qs(e,U_(t,!1)))),zO=e=>ie(e,{onFailure:()=>h(x()),onSuccess:t=>h(d(t))}),KO=a(2,(e,t)=>An(e,()=>lr(t))),BO=a(2,(e,t)=>An(e,()=>g(t))),GO=e=>J(e,{onFailure:t=>{let r=Array.from(Gi(t));return r.length===0?D(t):L(r)},onSuccess:h}),Un=e=>Zu((t,r)=>Wu(t,r)(e)),$O=e=>e.length>=1?Bt((t,r)=>{e(r).then(o=>t(ee(o))).catch(o=>t(su(o)))}):Bt(t=>{e().then(r=>t(ee(r))).catch(r=>t(su(r)))}),VO=a(3,(e,t,r)=>sd(e,t,h(r))),sd=a(3,(e,t,r)=>Ds(o=>l(r,n=>At(e,Te(t,n)(o))))),YO=Pu(h),JO=a(3,(e,t,r)=>Q(e).reduce((o,n,s)=>l(o,i=>r(i,n,s)),h(t))),QO=a(3,(e,t,r)=>Q(e).reduceRight((o,n,s)=>l(o,i=>r(n,i,s)),h(t))),ZO=a(3,(e,t,r)=>l(g(()=>e[Symbol.iterator]()),o=>XO(o,0,t,r.while,r.body))),XO=(e,t,r,o,n)=>{let s=e.next();return!s.done&&o(r)?l(n(r,s.value,t),i=>XO(e,t+1,i,o,n)):h(r)},eC=a(2,(e,t)=>T(()=>tC(e,t))),tC=(e,t)=>l(e,r=>t<=0?h(r):W(Tt(),tC(e,t-1))),rC=e=>J(e,{onFailure:L,onSuccess:h}),oC=e=>T(()=>g_(e)),ti=Lh,nC=e=>ie(e,{onFailure:t=>L(d(t)),onSuccess:t=>{switch(t._tag){case"None":return L(x());case"Some":return h(t.value)}}}),ri=h(x()),id=e=>h(d(e)),Qu=a(3,(e,t,r)=>l(t,o=>l(e,n=>_(t,s=>[r(o,s),n])))),sC=a(3,(e,t,r)=>ad(e,[ju(t,r)])),ad=a(2,(e,t)=>cd(e,ut(t))),cd=a(2,(e,t)=>qe(go,r=>Ve(t)(r))(e)),iC=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!1),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>u?h(!0):(o.push(c),t(c,p)))}return _(s,()=>o)})),aC=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!0),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>_(f=>(f&&o.push(c),f))(u?t(c,p):h(!1)))}return _(s,()=>o)})),cC=a(2,(e,{onFailure:t,onSuccess:r})=>J(e,{onFailure:o=>{let n=co(o);switch(n._tag){case"Left":return W(t(n.left),D(o));case"Right":return D(o)}},onSuccess:o=>Y(r(o),o)})),pC=a(2,(e,t)=>Lr(e,r=>De(Fm(r),{onNone:()=>D(r),onSome:o=>W(t(o),D(r))}))),pd=a(2,(e,t)=>J(e,{onFailure:r=>{let o=co(r);switch(o._tag){case"Left":return W(t(o.left),D(r));case"Right":return D(r)}},onSuccess:h})),uC=a(3,(e,t,r)=>pd(e,o=>pe(o)&&"_tag"in o&&o._tag===t?r(o):k)),lC=a(2,(e,t)=>J(e,{onFailure:r=>W(t(r),D(r)),onSuccess:h})),fC=e=>ud(e,Hh),ud=a(2,(e,t)=>Qu(e,t,(r,o)=>Lc(o-r))),mC=K_,hC=mC(h),ld=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),t.length>=1?T(()=>{let o=new AbortController;return l(_a(()=>t(o.signal)),n=>Bt(s=>(n.then(i=>s(ee(i))).catch(i=>s(mr(r?r(i):i))),g(()=>o.abort()))))}):l(_a(e),o=>Bt(n=>{o.then(s=>n(ee(s))).catch(s=>n(mr(r?r(s):s)))}))},dC=a(2,(e,t)=>l(e,r=>_a({try:()=>t.try(r),catch:t.catch}))),xC=a(2,(e,t)=>l(e,r=>ld({try:t.try.length>=1?o=>t.try(r,o):()=>t.try(r),catch:t.catch}))),gC=a(2,(e,t)=>T(()=>t()?ri:Yu(e))),yC=a(2,(e,t)=>l(t,r=>r?ri:Yu(e))),bC=e=>ei(e,Pm),Zu=e=>ue(t=>(t.setFiberRefs(e(t.id(),t.unsafeGetFiberRefs())),k)),SC=a(3,(e,t,r)=>Tn(e,o=>Te(o,t,r(as(o,t))))),Xu=a(2,(e,t)=>T(()=>t()?_(e,d):h(x()))),EC=a(3,(e,t,r)=>l(Ye(t),o=>r(o)?_(e,n=>[o,d(n)]):h([o,x()]))),_C=a(3,(e,t,r)=>l(Vu(t),o=>r(o)?_(e,n=>[o,d(n)]):h([o,x()]))),OC=a(2,(e,t)=>t(e)),CC=(e,t)=>(...r)=>l(e,o=>t(o)(...r)),RC=(e,t)=>(...r)=>_(e,o=>t(o)(...r)),fd=e=>new Proxy({},{get(t,r,o){return(...n)=>l(e,s=>s[r](...n))}}),md=e=>new Proxy({},{get(t,r,o){return l(e,n=>n[r])}}),AC=e=>({functions:fd(e),constants:md(e)}),MC=function(){let e=arguments;return l(dd,t=>t._tag==="Some"?g(()=>{if(typeof e[0]=="string")t.value.attribute(e[0],e[1]);else for(let r in e[0])t.value.attribute(r,e[0][r])}):k)},TC=a(e=>de(e[0]),function(){let e=arguments;return qe(e[0],tu,typeof e[1]=="string"?vr(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[o,n])=>vr(r,o,n),t))}),hd=_(Ye(yo),ip),dd=_(Ye(yo),Hb(e=>e._tag==="Span")),dF=BigInt(0),el=Se(pa,e=>e?Hh:h(dF)),vC=a(e=>de(e[0]),(e,t,r)=>qe(e,ru,Xc({_tag:"SpanLink",span:t,attributes:r??{}}))),oi=(e,t)=>mC(r=>l(t?.parent?id(t.parent):t?.root?ri:hd,o=>l(Ye(tu),n=>l(Ye(ru),s=>l(el,i=>g(()=>{let c=t?.links?[...Ze(s),...t.links]:Ze(s),p=r.span(e,o,t?.context??Et(),c,i);return Yy(n,(u,f)=>p.attribute(f,u)),Object.entries(t?.attributes??{}).forEach(([u,f])=>p.attribute(u,f)),p})))))),IC=Ye(tu),kC=Ye(ru),xd=(e,...t)=>{let r=t.length===1?void 0:t[0],o=t[t.length-1];return Kt(oi(e,r),o,(n,s)=>l(el,i=>g(()=>n.end(i,s))))},gd=a(2,(e,t)=>qe(e,yo,ko(t))),wC=a(e=>typeof e[0]!="string",(e,t,r)=>xd(t,r??{},o=>gd(e,o))),FC=e=>T(()=>{let t=e();return t==null?L(po()):h(t)}),PC=e=>ft(_(e,d),t=>Lm(t)?ri:L(t));var NC,DC,LC,tl="@effect/io/Fiber/Status",Ko=Symbol.for(tl),yd="Done",HC="Running",qC="Suspended",bd=class{constructor(){this[NC]=Ko,this._tag=yd}[(NC=Ko,A)](){return I(S(this._tag))(S(tl))}[M](t){return rl(t)&&t._tag===yd}},Sd=class{constructor(t){this.runtimeFlags=t,this[DC]=Ko,this._tag=HC}[(DC=Ko,A)](){return I(S(this.runtimeFlags))(I(S(this._tag))(S(tl)))}[M](t){return rl(t)&&t._tag===HC&&this.runtimeFlags===t.runtimeFlags}},Ed=class{constructor(t,r){this.runtimeFlags=t,this.blockingOn=r,this[LC]=Ko,this._tag=qC}[(LC=Ko,A)](){return I(S(this.blockingOn))(I(S(this.runtimeFlags))(I(S(this._tag))(S(tl))))}[M](t){return rl(t)&&t._tag===qC&&this.runtimeFlags===t.runtimeFlags&&O(this.blockingOn,t.blockingOn)}},UC=new bd,WC=e=>new Sd(e),jC=(e,t)=>new Ed(e,t),rl=e=>typeof e=="object"&&e!=null&&Ko in e,zC=e=>e._tag===yd;var KC=UC,_d=WC,BC=jC;var GC=zC;var si=Uu;var Od=Wu;var ol=K(Symbol.for("@effect/io/FiberRef/currentRequestMap"),()=>xe(new Map));var Cd=(e,t,r,o)=>{switch(e?.concurrency){case void 0:return t();case"unbounded":return r();case"inherit":return Se(eu,n=>n==="unbounded"?r():n>1?o(n):t());default:return e.concurrency>1?o(e.concurrency):t()}},Aa=(e,t,r)=>{switch(e?.concurrency){case void 0:return t();case"unbounded":return r();case"inherit":return Se(eu,o=>o==="unbounded"||o>1?r():t());default:return e.concurrency>1?r():t()}};var VC="Sequential",YC="Parallel";var ii={_tag:VC},JC={_tag:YC};var QC=e=>e._tag===VC,ZC=e=>e._tag===YC;var nl="InterruptSignal",sl="Stateful",il="Resume",al="YieldNow",Rd=e=>({_tag:nl,cause:e}),ai=e=>({_tag:sl,onFiber:e}),Wn=e=>({_tag:il,effect:e}),eR=()=>({_tag:al});var rR,oR,SF="@effect/io/Fiber/Scope",cl=Symbol.for(SF),Ad=class{constructor(){this[rR]=cl,this.fiberId=et,this.roots=new Set}add(t,r){this.roots.add(r),r.unsafeAddObserver(()=>{this.roots.delete(r)})}};rR=cl;var Md=class{constructor(t,r){this.fiberId=t,this.parent=r,this[oR]=cl}add(t,r){this.parent.tell(ai(o=>{o.addChild(r),r.unsafeAddObserver(()=>{o.removeChild(r)})}))}};oR=cl;var nR=e=>new Md(e.id(),e),jn=K(Symbol.for("@effect/io/FiberScope/Global"),()=>new Ad);var EF="@effect/io/Fiber",Ma=Symbol.for(EF),Ta={_E:e=>e,_A:e=>e},_F={[Ma]:Ta,pipe(){return E(this,arguments)}},OF="@effect/io/Fiber",iR=Symbol.for(OF);var Td=e=>e.await();var aR=e=>e.inheritAll();var cR=a(2,(e,t)=>e.interruptAsFork(t)),zn=e=>Us(mt(e.await()),e.inheritAll());var nB={..._F,id:()=>et,await:()=>In,children:()=>h([]),inheritAll:()=>In,poll:()=>h(x()),interruptAsFork:()=>In};var Bo="@effect/io/Fiber/Current";var CF="@effect/io/Logger",uR=Symbol.for(CF),lR={_Message:e=>e,_Output:e=>e},pl=e=>({[uR]:lR,log:e,pipe(){return E(this,arguments)}});var aB={[uR]:lR,log:es,pipe(){return E(this,arguments)}};var fR=pl(({annotations:e,cause:t,date:r,fiberId:o,logLevel:n,message:s,spans:i})=>{let c=r.getTime(),u=[`timestamp=${r.toISOString()}`,`level=${n.label}`,`fiber=${lp(o)}`].join(" "),f=RF(s);if(f.length>0&&(u=u+" message=",u=vd(f,u)),t!=null&&t!=tt&&(u=u+" cause=",u=vd(uo(t),u)),zi(i)){u=u+" ";let m=!0;for(let y of i)m?m=!1:u=u+" ",u=u+D_(c)(y)}if(Jc(e)>0){u=u+" ";let m=!0;for(let[y,b]of e)m?m=!1:u=u+" ",u=u+TF(y),u=u+"=",u=vd(String(b),u)}return u}),RF=e=>{try{return typeof e=="object"?JSON.stringify(e):String(e)}catch{return String(e)}},AF=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,MF=/^[^\s"=]+$/,vd=(e,t)=>t+(e.match(MF)?e:AF(e));var TF=e=>e.replace(/[\s="]/g,"_");var mR,hR="@effect/io/Metric/Boundaries",Id=Symbol.for(hR),kd=class{constructor(t){this.values=t,this[mR]=Id}[(mR=Id,A)](){return I(S(this.values))(S(hR))}[M](t){return IF(t)&&O(this.values,t.values)}pipe(){return E(this,arguments)}},IF=e=>typeof e=="object"&&e!=null&&Id in e,kF=e=>{let t=ob(ar(Oe(Number.POSITIVE_INFINITY))(e));return new kd(t)};var dR=e=>kF(Ct(xf(e.count-1,t=>e.start*Math.pow(e.factor,t))));var xR,gR,yR,bR,SR,ER,_R,OR,CR,RR,FF="@effect/io/Metric/KeyType",va=Symbol.for(FF),vR="effect/io/Metric/KeyType/Counter",wd=Symbol.for(vR),IR="effect/io/Metric/KeyType/Frequency",Fd=Symbol.for(IR),kR="effect/io/Metric/KeyType/Gauge",Pd=Symbol.for(kR),wR="effect/io/Metric/KeyType/Histogram",Nd=Symbol.for(wR),FR="effect/io/Metric/KeyType/Summary",Dd=Symbol.for(FR),Ia={_In:e=>e,_Out:e=>e},Ld=class{constructor(){this[xR]=Ia,this[gR]=wd}[(xR=va,gR=wd,A)](){return S(vR)}[M](t){return qd(t)}pipe(){return E(this,arguments)}},AR=class{constructor(){this[yR]=Ia,this[bR]=Fd}[(yR=va,bR=Fd,A)](){return S(IR)}[M](t){return Ud(t)}pipe(){return E(this,arguments)}},MR=class{constructor(){this[SR]=Ia,this[ER]=Pd}[(SR=va,ER=Pd,A)](){return S(kR)}[M](t){return Wd(t)}pipe(){return E(this,arguments)}},Hd=class{constructor(t){this.boundaries=t,this[_R]=Ia,this[OR]=Nd}[(_R=va,OR=Nd,A)](){return I(S(this.boundaries))(S(wR))}[M](t){return jd(t)&&O(this.boundaries,t.boundaries)}pipe(){return E(this,arguments)}},TR=class{constructor(t,r,o,n){this.maxAge=t,this.maxSize=r,this.error=o,this.quantiles=n,this[CR]=Ia,this[RR]=Dd}[(CR=va,RR=Dd,A)](){return I(S(this.quantiles))(I(S(this.error))(I(S(this.maxSize))(I(S(this.maxAge))(S(FR)))))}[M](t){return zd(t)&&O(this.maxAge,t.maxAge)&&this.maxSize===t.maxSize&&this.error===t.error&&O(this.quantiles,t.quantiles)}pipe(){return E(this,arguments)}},PR=new Ld;var NR=e=>new Hd(e);var qd=e=>typeof e=="object"&&e!=null&&wd in e,Ud=e=>typeof e=="object"&&e!=null&&Fd in e,Wd=e=>typeof e=="object"&&e!=null&&Pd in e,jd=e=>typeof e=="object"&&e!=null&&Nd in e,zd=e=>typeof e=="object"&&e!=null&&Dd in e;var LR,PF="@effect/io/Metric/Key",HR=Symbol.for(PF),NF={_Type:e=>e},ka=class{constructor(t,r,o,n=$e()){this.name=t,this.keyType=r,this.description=o,this.tags=n,this[LR]=NF}[(LR=HR,A)](){return I(S(this.tags))(I(S(this.description))(I(S(this.keyType))(S(this.name))))}[M](t){return DF(t)&&this.name===t.name&&O(this.keyType,t.keyType)&&O(this.description,t.description)&&O(this.tags,t.tags)}pipe(){return E(this,arguments)}},DF=e=>typeof e=="object"&&e!=null&&HR in e,qR=(e,t)=>new ka(e,PR,Ht(t));var UR=(e,t,r)=>new ka(e,NR(t),Ht(r));var WR=a(2,(e,t)=>io(t)===0?e:new ka(e.name,e.keyType,e.description,Ve(t)(e.tags)));var jR,zR,KR,BR,GR,$R,VR,YR,JR,QR,HF="@effect/io/Metric/State",wa=Symbol.for(HF),ZR="effect/io/Metric/State/Counter",Kd=Symbol.for(ZR),XR="effect/io/Metric/State/Frequency",Bd=Symbol.for(XR),eA="effect/io/Metric/State/Gauge",Gd=Symbol.for(eA),tA="effect/io/Metric/State/Histogram",$d=Symbol.for(tA),rA="effect/io/Metric/State/Summary",Vd=Symbol.for(rA),Fa={_A:e=>e},Yd=class{constructor(t){this.count=t,this[jR]=Fa,this[zR]=Kd}[(jR=wa,zR=Kd,A)](){return I(S(this.count))(S(ZR))}[M](t){return qF(t)&&this.count===t.count}pipe(){return E(this,arguments)}},Jd=class{constructor(t){this.occurrences=t,this[KR]=Fa,this[BR]=Bd}[(KR=wa,BR=Bd,A)](){return I(S(this.occurrences))(S(XR))}[M](t){return UF(t)&&O(this.occurrences,t.occurrences)}pipe(){return E(this,arguments)}},Qd=class{constructor(t){this.value=t,this[GR]=Fa,this[$R]=Gd}[(GR=wa,$R=Gd,A)](){return I(S(this.value))(S(eA))}[M](t){return WF(t)&&this.value===t.value}pipe(){return E(this,arguments)}},Zd=class{constructor(t,r,o,n,s){this.buckets=t,this.count=r,this.min=o,this.max=n,this.sum=s,this[VR]=Fa,this[YR]=$d}[(VR=wa,YR=$d,A)](){return I(S(this.sum))(I(S(this.max))(I(S(this.min))(I(S(this.count))(I(S(this.buckets))(S(tA))))))}[M](t){return jF(t)&&O(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return E(this,arguments)}},Xd=class{constructor(t,r,o,n,s,i){this.error=t,this.quantiles=r,this.count=o,this.min=n,this.max=s,this.sum=i,this[JR]=Fa,this[QR]=Vd}[(JR=wa,QR=Vd,A)](){return I(S(this.sum))(I(S(this.max))(I(S(this.min))(I(S(this.count))(I(S(this.quantiles))(I(S(this.error))(S(rA)))))))}[M](t){return zF(t)&&this.error===t.error&&O(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return E(this,arguments)}},oA=e=>new Yd(e),nA=e=>new Jd(e),sA=e=>new Qd(e),iA=e=>new Zd(e.buckets,e.count,e.min,e.max,e.sum),aA=e=>new Xd(e.error,e.quantiles,e.count,e.min,e.max,e.sum);var qF=e=>typeof e=="object"&&e!=null&&Kd in e,UF=e=>typeof e=="object"&&e!=null&&Bd in e,WF=e=>typeof e=="object"&&e!=null&&Gd in e,jF=e=>typeof e=="object"&&e!=null&&$d in e,zF=e=>typeof e=="object"&&e!=null&&Vd in e;var BF="@effect/io/Metric/Hook",GF=Symbol.for(BF),$F={_In:e=>e,_Out:e=>e},Pa=e=>({[GF]:$F,pipe(){return E(this,arguments)},...e});var pA=e=>{let t=0;return Pa({get:()=>oA(t),update:r=>{t=t+r}})},uA=e=>{let t=0,r=new Map,o=s=>{t=t+1;let i=r.get(s)??0;r.set(s,i+1)},n=()=>Yc(r.entries());return Pa({get:()=>nA(n()),update:o})},lA=(e,t)=>{let r=t;return Pa({get:()=>sA(r),update:o=>{r=o}})},fA=e=>{let t=e.keyType.boundaries.values,r=t.length,o=new Uint32Array(r+1),n=new Float32Array(r),s=0,i=0,c=Number.MAX_VALUE,p=Number.MIN_VALUE;Qf((m,y)=>{n[y]=m})(ep(bt)(t));let u=m=>{let y=0,b=r;for(;y!==b;){let C=Math.floor(y+(b-y)/2),R=n[C];m<=R?b=C:y=C,b===y+1&&(m<=n[y]?b=y:y=b)}o[y]=o[y]+1,s=s+1,i=i+m,m<c&&(c=m),m>p&&(p=m)},f=()=>{let m=Array(r),y=0;for(let b=0;b<r;b++){let C=n[b],R=o[b];y=y+R,m[b]=[C,y]}return Ct(m)};return Pa({get:()=>iA({buckets:f(),count:s,min:c,max:p,sum:i}),update:u})},mA=e=>{let{error:t,maxAge:r,maxSize:o,quantiles:n}=e.keyType,s=ep(bt)(n),i=Array(o),c=0,p=0,u=0,f=Number.MAX_VALUE,m=Number.MIN_VALUE,y=C=>{let R=[],v=0;for(;v!==o-1;){let w=i[v];if(w!=null){let[H,U]=w,re=cs(C-H);kf(re,vf)&&re<=r&&R.push(U)}v=v+1}return VF(t,s,ep(bt)(Ct(R)))},b=(C,R)=>{if(o>0){c=c+1;let v=c%o;i[v]=[R,C]}p=p+1,u=u+C,C<f&&(f=C),C>m&&(m=C)};return Pa({get:()=>aA({error:t,quantiles:y(Date.now()),count:p,min:f,max:m,sum:u}),update:([C,R])=>b(C,R)})},VF=(e,t,r)=>{let o=r.length;if(gs(t))return Xe();let n=un(t),s=xs(1)(t),i=it(Oe(cA(e,o,x(),0,n,r)),(c,p)=>{let u=un(c);return Xc(cA(e,o,u.value,u.consumed,p,u.rest))(c)})(s);return Qf(c=>[c.quantile,c.value])(i)},cA=(e,t,r,o,n,s)=>{let i=e,c=t,p=r,u=o,f=n,m=s,y=e,b=t,C=r,R=o,v=n,w=s;for(;;){if(gs(m))return{quantile:f,value:x(),consumed:u,rest:Xe()};if(f===1)return{quantile:f,value:d(tb(m)),consumed:u+m.length,rest:Xe()};let H=rb(ce=>ce>un(m))(m),U=f*c,re=i/2*U,ge=u+H[0].length,ke=Math.abs(ge-U);if(ge<U-re){y=i,b=c,C=pn(m),R=ge,v=f,w=H[1],i=y,c=b,p=C,u=R,f=v,m=w;continue}if(ge>U+re)return{quantile:f,value:p,consumed:u,rest:m};switch(p._tag){case"None":{y=i,b=c,C=pn(m),R=ge,v=f,w=H[1],i=y,c=b,p=C,u=R,f=v,m=w;continue}case"Some":{let ce=Math.abs(U-p.value);if(ke<ce){y=i,b=c,C=pn(m),R=ge,v=f,w=H[1],i=y,c=b,p=C,u=R,f=v,m=w;continue}return{quantile:f,value:d(p.value),consumed:u,rest:m}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/io/issues")};var JF="@effect/io/Metric/Pair",QF=Symbol.for(JF),ZF={_Type:e=>e};var hA=(e,t)=>({[QF]:ZF,metricKey:e,metricState:t,pipe(){return E(this,arguments)}});var dA,e0="@effect/io/Metric/Registry",xA=Symbol.for(e0),ex=class{constructor(){this[dA]=xA,this.map=an()}snapshot(){let t=[];for(let[r,o]of this.map)t.push(hA(r,o.get()));return ut(t)}get(t){let r=je(ye(t)(this.map));if(r==null){if(qd(t.keyType))return this.getCounter(t);if(Wd(t.keyType))return this.getGauge(t);if(Ud(t.keyType))return this.getFrequency(t);if(jd(t.keyType))return this.getHistogram(t);if(zd(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/io/issues")}else return r}getCounter(t){let r=je(ye(t)(this.map));if(r==null){let o=pA(t);sr(t)(this.map)||pt(t,o)(this.map),r=o}return r}getFrequency(t){let r=je(ye(t)(this.map));if(r==null){let o=uA(t);sr(t)(this.map)||pt(t,o)(this.map),r=o}return r}getGauge(t){let r=je(ye(t)(this.map));if(r==null){let o=lA(t,0);sr(t)(this.map)||pt(t,o)(this.map),r=o}return r}getHistogram(t){let r=je(ye(t)(this.map));if(r==null){let o=fA(t);sr(t)(this.map)||pt(t,o)(this.map),r=o}return r}getSummary(t){let r=je(ye(t)(this.map));if(r==null){let o=mA(t);sr(t)(this.map)||pt(t,o)(this.map),r=o}return r}};dA=xA;var gA=()=>new ex;var r0="@effect/io/Metric",o0=Symbol.for(r0),n0={_Type:e=>e,_In:e=>e,_Out:e=>e},s0=K(Symbol.for("@effect/io/Metric/globalMetricRegistry"),()=>gA()),i0=function(e,t,r){return Object.assign(n=>Mt(n,s=>g(()=>t(s,$e()))),{[o0]:n0,keyType:e,unsafeUpdate:t,unsafeValue:r,pipe(){return E(this,arguments)}})};var Na=(e,t)=>yA(qR(e,t));var yA=e=>{let t=r=>{let o=WR(r)(e);return s0.get(o)};return i0(e.keyType,(r,o)=>t(o).update(r),r=>t(r).get())};var bA=(e,t,r)=>yA(UR(e,t,r));var SA=a(2,(e,t)=>Se(ol,r=>g(()=>{if(r.has(e)){let o=r.get(e);o.state.completed||(o.state.completed=!0,$s(o.result,t))}})));var Da=class{constructor(){this.count=0,this.observers=new Set}addObserver(t){this.observers.add(t)}removeObserver(t){this.observers.delete(t)}increment(){this.count++,this.observers.forEach(t=>t(this.count))}decrement(){this.count--,this.observers.forEach(t=>t(this.count))}};var EA,_A,OA,CA,c0,p0="@effect/io/Supervisor",Ha=Symbol.for(p0),ul={_T:e=>e},La=class e{constructor(t,r){this.underlying=t,this.value0=r,this[EA]=ul}value(){return this.value0()}onStart(t,r,o,n){this.underlying.onStart(t,r,o,n)}onEnd(t,r){this.underlying.onEnd(t,r)}onEffect(t,r){this.underlying.onEffect(t,r)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new e(this,()=>_(t)(this.value()))}zip(t){return new Go(this,t)}onRun(t,r){return this.underlying.onRun(t,r)}};EA=Ha;var Go=class e{constructor(t,r){this.left=t,this.right=r,this[_A]=ul}value(){return Yp(this.left.value(),this.right.value())}onStart(t,r,o,n){this.left.onStart(t,r,o,n),this.right.onStart(t,r,o,n)}onEnd(t,r){this.left.onEnd(t,r),this.right.onEnd(t,r)}onEffect(t,r){this.left.onEffect(t,r),this.right.onEffect(t,r)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new La(this,()=>_(t)(this.value()))}zip(t){return new e(this,t)}onRun(t,r){return this.right.onRun(()=>this.left.onRun(t,r),r)}};_A=Ha;var tx=class{constructor(){this[OA]=ul,this.fibers=new Set}value(){return g(()=>Array.from(this.fibers))}onStart(t,r,o,n){this.fibers.add(n)}onEnd(t,r){this.fibers.delete(r)}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new La(this,()=>_(t)(this.value()))}zip(t){return new Go(this,t)}onRun(t,r){return t()}};OA=Ha;var rx=class{constructor(t){this.effect=t,this[CA]=ul}value(){return this.effect}onStart(t,r,o,n){}onEnd(t,r){}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new La(this,()=>_(t)(this.value()))}zip(t){return new Go(this,t)}onRun(t,r){return t()}};CA=Ha;c0=Ha;var u0=()=>new tx,RA=g(u0),l0=e=>new rx(e),Kn=l0(k);var AA="Empty",MA="AddSupervisor",TA="RemoveSupervisor",vA="AndThen",ci={_tag:AA},fl=(e,t)=>({_tag:vA,first:e,second:t}),f0=(e,t)=>m0(t,Oe(e)),m0=(e,t)=>{let r=e,o=t;for(;Ke(o);){let n=Be(o);switch(n._tag){case AA:{o=Ge(o);break}case MA:{r=r.zip(n.supervisor),o=Ge(o);break}case TA:{r=ox(r,n.supervisor),o=Ge(o);break}case vA:{o=ve(n.first)(ve(n.second)(Ge(o)));break}}}return r},ox=(e,t)=>O(e,t)?Kn:e instanceof Go?ox(e.left,t).zip(ox(e.right,t)):e,ml=e=>O(e,Kn)?$e():e instanceof Go?Ve(ml(e.right))(ml(e.left)):so(e),h0=(e,t)=>{if(O(e,t))return ci;let r=ml(e),o=ml(t),n=ln(ci,(i,c)=>fl(i,{_tag:MA,supervisor:c}))(um(r)(o)),s=ln(ci,(i,c)=>fl(i,{_tag:TA,supervisor:c}))(um(o)(r));return fl(n,s)},IA=sp({empty:ci,patch:f0,combine:fl,diff:h0});var kA,wA,x0=Na("effect_fiber_started"),FA=Na("effect_fiber_active"),g0=Na("effect_fiber_successes"),y0=Na("effect_fiber_failures"),b0=bA("effect_fiber_lifetimes",dR({start:1,factor:2,count:100})),qa="Continue",S0="Done",PA="Yield",E0={_E:e=>e,_A:e=>e},Ua=e=>{throw new Error(`BUG: FiberRuntime - ${JSON.stringify(e)} - please report an issue at https://github.com/Effect-TS/io/issues`)},hl={[Is]:(e,t,r)=>t.i1(r),OnStep:(e,t,r)=>t.i1(ee(r)),[ks]:(e,t,r)=>t.i2(r),[ra]:(e,t,r)=>(e.patchRuntimeFlags(e._runtimeFlags,t.patch),Fr(e._runtimeFlags)&&e.isInterrupted()?B(e.getInterruptedCause()):ee(r)),[ws]:(e,t,r)=>(t.i2(r),t.i0()?(e.pushStack(t),t.i1()):k)},_0={[nl]:(e,t,r,o)=>(e.processNewInterruptSignal(o.cause),Fr(t)?B(o.cause):r),[il]:(e,t,r,o)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[sl]:(e,t,r,o)=>(o.onFiber(e,_d(t)),r),[al]:(e,t,r,o)=>l(Tt(),()=>r)},O0=e=>ht(SS(e),t=>ui(OS(t),([r,o])=>{let n=new Map;for(let s of o)for(let i of s)n.set(i.request,i);return Ee(P0(r.runAll(o),o.flat()),ol,n)},!1)),Wa=class{pipe(){return E(this,arguments)}constructor(t,r,o){if(this[kA]=Ta,this[wA]=E0,this._queue=new Array,this._children=null,this._observers=new Array,this._running=!1,this._stack=[],this._asyncInterruptor=null,this._asyncBlockingOn=null,this._exitValue=null,this._steps=[!1],this.run=()=>{this.drainQueueOnCurrentThread()},this._runtimeFlags=o,this._fiberId=t,this._fiberRefs=r,this._supervisor=this.getFiberRef(pi),Xi(o)){let n=this.getFiberRef(go);x0.unsafeUpdate(1,n),FA.unsafeUpdate(1,n)}}id(){return this._fiberId}resume(t){this.tell(Wn(t))}status(){return this.ask((t,r)=>r)}runtimeFlags(){return this.ask((t,r)=>GC(r)?t._runtimeFlags:r.runtimeFlags)}scope(){return nR(this)}children(){return this.ask(t=>Array.from(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(kn)}fiberRefs(){return this.ask(t=>t.unsafeGetFiberRefs())}ask(t){return T(()=>{let r=Ks(this._fiberId);return this.tell(ai((o,n)=>{$s(r,g(()=>t(o,n)))})),Ie(r)})}tell(t){this._queue.push(t),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}await(){return Bt(t=>{let r=o=>t(h(o));return this.tell(ai((o,n)=>{o._exitValue!==null?r(this._exitValue):o.unsafeAddObserver(r)})),g(()=>this.tell(ai((o,n)=>{o.unsafeRemoveObserver(r)})))},this.id())}inheritAll(){return ue((t,r)=>{let o=t.id(),n=t.unsafeGetFiberRefs(),s=r.runtimeFlags,i=this.unsafeGetFiberRefs(),c=Lu(n,o,i);t.setFiberRefs(c);let p=t.getFiberRef(DA),u=Gm(Qi)(Gm(ur)(_n(s,p)));return Hs(u)})}poll(){return g(()=>Ht(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(t){return g(()=>this.tell(Rd(pr(t))))}unsafeAddObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}unsafeRemoveObserver(t){this._observers=this._observers.filter(r=>r!==t)}unsafeGetFiberRefs(){return this.setFiberRef(DA,this._runtimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=ya(this._fiberRefs,t)}getFiberRef(t){return this._fiberRefs.locals.has(t)?this._fiberRefs.locals.get(t)[0][1]:t.initial}setFiberRef(t,r){this._fiberRefs=Dn(this._fiberRefs,{fiberId:this._fiberId,fiberRef:t,value:r}),t===pi&&(this._supervisor=r)}setFiberRefs(t){this._fiberRefs=t,this._supervisor=this.getFiberRef(pi)}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let r=qa,o=globalThis[Bo];globalThis[Bo]=this;try{for(;r===qa;)r=this._queue.length===0?S0:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[Bo]=o}this._queue.length>0&&!this._running?(this._running=!0,r===PA?(this.drainQueueLaterOnExecutor(),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(){this.getFiberRef(xo).scheduleTask(this.run,this.getFiberRef(sa))}drainQueueWhileRunning(t,r){let o=r;for(;this._queue.length>0;){let n=this._queue.splice(0,1)[0];o=_0[n._tag](this,t,o,n)}return o}isInterrupted(){return!wm(this.getFiberRef(kn))}addInterruptedCause(t){let r=this.getFiberRef(kn);this.setFiberRef(kn,Ce(r,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(let r of this._children)r.tell(Rd(pr(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let t=this._children.values();this._children=null;let r=!1;return vn({while:()=>!r,body:()=>{let n=t.next();return n.done?g(()=>{r=!0}):Z(n.value.await())},step:()=>{}})}return null}reportExitValue(t){if(Xi(this._runtimeFlags)){let r=this.getFiberRef(go);switch(FA.unsafeUpdate(-1,r),t._tag){case me:{g0.unsafeUpdate(1,r);break}case fe:{y0.unsafeUpdate(1,r);break}}}if(t._tag==="Failure"){let r=this.getFiberRef(ca);!No(t.cause)&&r._tag==="Some"&&this.log("Fiber terminated with a non handled error",t.cause,r)}}setExitValue(t){if(this._exitValue=t,Xi(this._runtimeFlags)){let r=this.getFiberRef(go),o=this.id().startTimeMillis,n=new Date().getTime();b0.unsafeUpdate((n-o)/1e3,r)}this.reportExitValue(t);for(let r=this._observers.length-1;r>=0;r--)this._observers[r](t)}getLoggers(){return this.getFiberRef(qA)}log(t,r,o){let n=N(o)?o.value:this.getFiberRef(mh),s=this.getFiberRef(HA);if(I_(s,n))return;let i=this.getFiberRef(Xp),c=this.getFiberRef(ia),p=this.getLoggers(),u=this.unsafeGetFiberRefs();if(io(p)>0){let f=Ar(this.getFiberRef(ot),zr),m=new Date(f.unsafeCurrentTimeMillis());for(let y of p)y.log({fiberId:this.id(),logLevel:n,message:t,cause:r,context:u,spans:i,annotations:c,date:m})}}evaluateMessageWhileSuspended(t){switch(t._tag){case al:return PA;case nl:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(B(t.cause)),this._asyncInterruptor=null),qa;case il:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),qa;case sl:return t.onFiber(this,this._exitValue!==null?KC:BC(this._runtimeFlags,this._asyncBlockingOn)),qa;default:return Ua(t)}}evaluateEffect(t){this._supervisor.onResume(this);try{let r=Fr(this._runtimeFlags)&&this.isInterrupted()?B(this.getInterruptedCause()):t;for(;r!==null;)try{let o=r,n=this.runLoop(o);this._runtimeFlags=Wm(Qi)(this._runtimeFlags);let s=this.interruptAllChildren();s!==null?r=l(s,()=>n):(this._queue.length===0?this.setExitValue(n):this.tell(Wn(n)),r=null)}catch(o){if(de(o))o._tag===Fs?Um(this._runtimeFlags)?(this.tell(eR()),this.tell(Wn(jr)),r=null):r=jr:o._tag===Ts&&(r=null);else throw o}}finally{this._supervisor.onSuspend(this)}}start(t){if(this._running)this.tell(Wn(t));else{this._running=!0;let r=globalThis[Bo];globalThis[Bo]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[Bo]=r,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(t){this.tell(Wn(t))}patchRuntimeFlags(t,r){let o=Ms(t,r);return globalThis[Bo]=this,this._runtimeFlags=o,o}initiateAsync(t,r){let o=!1,n=s=>{o||(o=!0,this.tell(Wn(s)))};Fr(t)&&(this._asyncInterruptor=n);try{r(n)}catch(s){n(D(Le(s)))}}pushStack(t){this._stack.push(t),t._tag==="OnStep"&&this._steps.push(!0),t._tag==="RevertFlags"&&this._steps.push(!1)}popStack(){let t=this._stack.pop();if(t)return(t._tag==="OnStep"||t._tag==="RevertFlags")&&this._steps.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._tag!==vs)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._tag!==Is&&t._tag!==ws)return t;t=this.popStack()}}[(kA=Ma,wA=iR,vS)](t){return _(Ye(ho),r=>{try{return as(r,t)}catch(o){throw console.log(o),o}})}Left(t){return mr(t.i0)}None(t){return mr(po())}Right(t){return ee(t.i0)}Some(t){return ee(t.i0)}[wp](t){let r=t.i0(),o=this.getNextSuccessCont();if(o!==void 0)return o._tag in hl||Ua(o),hl[o._tag](this,o,r);throw ee(r)}[me](t){let r=t,o=this.getNextSuccessCont();if(o!==void 0)return o._tag in hl||Ua(o),hl[o._tag](this,o,r.i0);throw r}[fe](t){let r=this.getFiberRef(yo),o=lt(r)||r.head._tag==="ExternalSpan"?t.i0:Po(t.i0,sS(r.head)),n=this.getNextFailCont();if(n!==void 0)switch(n._tag){case vs:case ks:return Fr(this._runtimeFlags)&&this.isInterrupted()?B(Os(o)):n.i1(o);case"OnStep":return Fr(this._runtimeFlags)&&this.isInterrupted()?B(Os(o)):n.i1(B(o));case ra:return this.patchRuntimeFlags(this._runtimeFlags,n.patch),Fr(this._runtimeFlags)&&this.isInterrupted()?B(Ce(o,this.getInterruptedCause())):B(o);default:Ua(n)}else throw B(o)}[Fp](t){return t.i0(this,_d(this._runtimeFlags))}Blocked(t){if(this._steps[this._steps.length-1]){let r=this.popStack();if(r)switch(r._tag){case"OnStep":return r.i1(t);case"OnSuccess":return he(t.i0,l(t.i1,r.i1));case"OnSuccessAndFailure":return he(t.i0,J(t.i1,{onFailure:r.i1,onSuccess:r.i2}));case"OnFailure":return he(t.i0,Lr(t.i1,r.i1));case"While":return he(t.i0,l(t.i1,o=>(r.i2(o),r.i0()?vn({while:r.i0,body:r.i1,step:r.i2}):k)));case"RevertFlags":{this.pushStack(r);break}}}return be(r=>l(vt(Wp(t.i0)),()=>r(t.i1)))}RunBlocked(t){return O0(t.i0)}[lo](t){let r=t.i0,o=this._runtimeFlags,n=Ms(o,r);if(Fr(n)&&this.isInterrupted())return B(this.getInterruptedCause());if(this.patchRuntimeFlags(this._runtimeFlags,r),t.i1){let s=_n(n,o);return this.pushStack(new Hp(s,t)),t.i1(o)}else return jr}[Is](t){return this.pushStack(t),t.i0}OnStep(t){return this.pushStack(t),t.i0}[vs](t){return this.pushStack(t),t.i0}[ks](t){return this.pushStack(t),t.i0}[Ts](t){throw this._asyncBlockingOn=t.i1,this.initiateAsync(this._runtimeFlags,t.i0),t}[Fs](t){throw t}[ws](t){let r=t.i0,o=t.i1;return r()?(this.pushStack(t),o()):jr}[TS](t){return t.commit()}runLoop(t){let r=t,o=0;for(;;){if(this._runtimeFlags&qm&&this._supervisor.onEffect(this,r),this._queue.length>0&&(r=this.drainQueueWhileRunning(this._runtimeFlags,r)),o+=1,o>=this.getFiberRef(fh)){o=0;let n=r;r=l(Tt(),()=>n)}try{r._tag in this||(typeof r=="function"&&console.log(r()),Ua(r)),r=this._supervisor.onRun(()=>this[r._tag](r),this)}catch(n){if(de(n)){if(n._tag===Fs||n._tag===Ts)throw n;if(n._tag===me||n._tag===fe)return n}else DS(n)?r=B(n.cause):Dm(n)?r=B(Ce(Le(n),pr(et))):r=B(Le(n))}}}},HA=xe(k_("Info")),C0=pl(e=>{let t=fR.log(e);globalThis.console.log(t)});var R0=pl(({annotations:e,cause:t,context:r,fiberId:o,logLevel:n,message:s})=>{let i=ss(ba(r,yo),ip),c=Me(ba(r,ot),u=>Ar(u,zr));if(i._tag==="None"||i.value._tag==="ExternalSpan"||c._tag==="None")return;let p=Object.fromEntries(e);p["effect.fiberId"]=Vb(o),p["effect.logLevel"]=n.label,t!==null&&t!==tt&&(p["effect.cause"]=uo(t)),i.value.event(String(s),c.value.unsafeCurrentTimeNanos(),p)}),qA=lh(so(C0,R0)),za=a(e=>de(e[0]),(e,t)=>Nr(Mt(e,r=>Ka(o=>t(r,o))))),UA=a(e=>de(e[0]),(e,t)=>$r(e,Ka(r=>t(r)))),Ka=e=>ue(t=>{let r=t.unsafeGetFiberRefs();return l(xl,o=>js(o,n=>ue(s=>{let i=s.unsafeGetFiberRefs(),c=si(i,r),p=si(r,i);return s.setFiberRefs(Od(c,s.id(),r)),$r(e(n),g(()=>{s.setFiberRefs(Od(p,s.id(),s.unsafeGetFiberRefs()))}))})))}),WA=e=>Ee(oa,d(jn))(e),NA=Symbol("@effect/io/Effect/existsPar/found"),jA=a(e=>Lt(e[0]),(e,t,r)=>Aa(r,()=>T(()=>zA(e[Symbol.iterator](),0,t)),()=>ie(Qt(e,(o,n)=>jp(t(o,n),{onTrue:L(NA),onFalse:k}),r),{onFailure:o=>o===NA?h(!0):L(o),onSuccess:()=>h(!1)}))),zA=(e,t,r)=>{let o=e.next();return o.done?h(!1):l(r(o.value,t),n=>n?h(n):zA(e,t+1,r))},KA=a(e=>Lt(e[0]),(e,t,r)=>{let o=r?.negate?(n,s)=>_(t(n,s),wg):t;return Aa(r,()=>T(()=>Q(e).reduceRight((n,s,i)=>mo(n,T(()=>o(s,i)),(c,p)=>p?[s,...c]:c),g(()=>new Array))),()=>_(Qt(e,(n,s)=>_(o(n,s),i=>i?d(n):x()),r),Xg))}),A0=e=>{if(Array.isArray(e)||Lt(e))return[e,x()];let t=Object.keys(e),r=t.length;return[t.map(o=>e[o]),d(o=>{let n={};for(let s=0;s<r;s++)n[t[s]]=o[s];return n})]},M0=(e,t,r)=>{let o=[];for(let n of e)o.push(Hr(n));return l(Qt(o,F,{concurrency:r?.concurrency,batching:r?.batching}),n=>{let s=x(),i=n.length,c=new Array(i),p=new Array(i),u=!1;for(let f=0;f<i;f++){let m=n[f];m._tag==="Left"?(c[f]=d(m.left),u=!0):(p[f]=m.right,c[f]=s)}return u?t._tag==="Some"?L(t.value(c)):L(c):r?.discard?k:t._tag==="Some"?h(t.value(p)):h(p)})},T0=(e,t,r)=>{let o=[];for(let n of e)o.push(Hr(n));return r?.discard?Qt(o,F,{concurrency:r?.concurrency,batching:r?.batching,discard:!0}):_(Qt(o,F,{concurrency:r?.concurrency,batching:r?.batching}),n=>t._tag==="Some"?t.value(n):n)},li=(e,t)=>{let[r,o]=A0(e);return t?.mode==="validate"?M0(r,o,t):t?.mode==="either"?T0(r,o,t):o._tag==="Some"?_(Qt(r,F,t),o.value):Qt(r,F,t)},BA=e=>t=>li(t,e),GA=(e,t)=>_(li(Q(e).map(X),t),Fi(r=>nu(r)?d(r.i0):x())),ax=a(2,(e,t)=>Array.from({length:t},()=>e)),$A=a(e=>de(e[0]),(e,t,r)=>li(ax(t)(e),r)),Qt=a(e=>Lt(e[0]),(e,t,r)=>ue(o=>{let n=r?.batching===!0||r?.batching==="inherit"&&o.getFiberRef(aa);return r?.discard?Cd(r,()=>n?nx(e,t):ht(e,t),()=>ui(e,t,n),s=>cx(e,s,t,n)):Cd(r,()=>n?sx(e,1,t,!0):He(e,t),()=>ja(e,t,n),s=>sx(e,s,t,n))})),ja=(e,t,r)=>T(()=>{let o=Q(e),n=new Array(o.length);return W(ui(o,(i,c)=>l(t(i,c),p=>g(()=>n[c]=p)),r),h(n))}),nx=(e,t)=>T(()=>{let r=Q(e),o=r.length;if(o===0)return k;if(o===1)return Z(t(r[0],0));let n=r.map(t),s=new Array,i=c=>c===n.length?T(()=>{if(s.length>0){let p=s.map(u=>u.i0).reduce(On);return he(p,nx(s.map(u=>u.i1),F))}return k}):Ls(n[c],p=>p._tag==="Blocked"?(s.push(p),i(c+1)):p._tag==="Failure"?T(()=>{if(s.length>0){let u=s.map(f=>f.i0).reduce(On);return he(u,l(nx(s.map(f=>f.i1),F),()=>p))}return k}):i(c+1));return i(0)}),ui=(e,t,r)=>T(()=>{let o=Q(e),n=o.length;return n===0?k:n===1?Z(t(o[0],0)):be(s=>{let i=Ks(et),c=0,p=[],u=[],f=Vp(m=>He(o,(y,b)=>_(C=>(C.unsafeAddObserver(()=>{u.push(C)}),C))(Bn(m(l(C=>{switch(C._tag){case"Failure":{if(p.length>0){let R=p.map(w=>w.i0).reduce(On),v=ui(p,w=>w.i1,r);return he(R,J(v,{onFailure:w=>W(fa(i,void 0),D(Fe(w,C.cause))),onSuccess:()=>W(fa(i,void 0),D(C.cause))}))}return W(fa(i,void 0),D(C.cause))}default:{if(C._tag==="Blocked"&&p.push(C),c+1===n)if(p.length>0){let R=p.map(w=>w.i0).reduce(On),v=ui(p,w=>w.i1,r);return Gs(i,he(R,v))}else $s(i,ee(jr));else c=c+1;return k}}})(T(()=>s((r?Pr:X)(t(y,b))))))))));return l(f,m=>J(s(Ie(i)),{onFailure:y=>l(ja(m,Wo,r),b=>{let C=zs(b,{parallel:!0});return C._tag==="Some"&&yh(C.value)?D(Fe(Os(y),C.value.i0)):D(Os(y))}),onSuccess:y=>l(y,()=>ht(u,b=>b.inheritAll()))}))})}),sx=(e,t,r,o)=>T(()=>{let n=Q(e),s=new Array(n.length);return W(cx(n,t,(c,p)=>_(r(c,p),u=>s[p]=u),o),h(s))}),cx=(e,t,r,o)=>T(()=>{let n=0,s=e[Symbol.iterator](),i=[],c=l(g(()=>s.next()),u=>u.done?k:l((o?Pr:X)(Z(r(u.value,n++))),f=>{switch(f._tag){case"Blocked":return i.push(f),c;case"Failure":return f;case"Success":return c}})),p=[];for(let u=0;u<t;u++)p.push(c);return l(X(ui(p,F,o)),u=>{if(i.length===0)return u;let f=i.map(y=>y.i0).reduce(On),m=cx(i,t,y=>y.i1,o);return u._tag==="Failure"?he(f,J(m,{onFailure:y=>B(Fe(u.cause,y)),onSuccess:()=>u})):he(f,m)})}),vt=e=>ue((t,r)=>h(YA(e,t,r.runtimeFlags))),Bn=e=>v0(e,jn),VA=a(2,(e,t)=>vt(Gp(e,r=>{let o=co(r);switch(o._tag){case"Left":return t(o.left);case"Right":return D(o.right)}}))),YA=(e,t,r,o=null)=>{let n=ix(e,t,r,o);return n.resume(e),n},ix=(e,t,r,o=null)=>{let n=fp(),s=t.unsafeGetFiberRefs(),i=Hu(s,n),c=new Wa(n,i,r),p=Xs(i,ho),u=c._supervisor;return u.onStart(p,e,d(t),c),c.unsafeAddObserver(m=>u.onEnd(m,c)),(o!==null?o:V(()=>t.scope())(t.getFiberRef(oa))).add(r,c),c},v0=(e,t)=>ue((r,o)=>h(YA(e,r,o.runtimeFlags,t))),px=a(e=>Lt(e[0]),(e,t,r,o)=>Aa(o,()=>Q(e).reduce((n,s,i)=>mo(n,s,(c,p)=>r(c,p,i)),h(t)),()=>l(Ea(t),n=>l(Qt(e,(s,i)=>l(s,c=>j_(n,p=>r(p,c,i))),o),()=>Vu(n))))),ux=a(e=>Lt(e[0]),(e,t,r)=>_(o=>WS(o,F))(Qt(e,(o,n)=>Hr(t(o,n)),r))),JA=a(e=>Lt(e[0]),(e,t,r)=>l(ux(e,t,{concurrency:r?.concurrency,batching:r?.batching}),([o,n])=>o.length===0?r?.discard?k:h(n):L(o))),QA=e=>{let t=Ir(e);if(!Ke(t))return Lo(()=>Rs("Received an empty collection of effects"));let r=Be(t),o=Ge(t),n=s=>Y(s[0])(aR(s[1]));return l(s=>l(i=>be(c=>l(p=>l(u=>Uo(()=>it(k,(f,m)=>Us(Wo(m))(f))(u))(c(l(n)(Pn(s)))))(Mt(u=>it(k,(f,m)=>W(Z(vt(l(I0(u,m,s,i))(Td(m)))))(f))(u))(_(u=>ve(p)(u))(_(Ct)(He(u=>vt(zt(u)))(o))))))(vt(zt(r)))))(Ea(o.length)))(rt())},I0=(e,t,r,o)=>n=>wn(n,{onFailure:s=>mt(W_(o,i=>[i===0?Z(Fn(r,s)):k,i-1])),onSuccess:s=>l(i=>i?it(k,(c,p)=>p===t?c:Us(Wo(p))(c))(Ir(e)):k)(Gs(r,[s,t]))}),ZA=a(e=>Lt(e[0]),(e,t,r,o)=>Aa(o,()=>Q(e).reduce((n,s,i)=>mo(n,s,(c,p)=>r(c,p,i)),t),()=>T(()=>_(n=>{switch(n._tag){case"None":throw new Error("BUG: Effect.reduceEffect - please report an issue at https://github.com/Effect-TS/io/issues");case"Some":return n.value}})(px([t,...e],x(),(n,s,i)=>{switch(n._tag){case"None":return d(s);case"Some":return d(r(n.value,s,i))}},o))))),XA=e=>l(xl,t=>l(Gn(JC),r=>W($n(e,r))(t.addFinalizer(o=>r.close(o))))),$o=e=>l(xx,e),lx=e=>l(Gn(),t=>w0(t)(e)),eM=e=>$o(t=>l(r=>$n(r)(e))(xh(t,ii))),tM=(e,t)=>fx([ju(e,t)]),fx=e=>mx(ut(e)),mx=e=>xr(go,t=>Ve(e)(t)),rM=a(2,(e,t)=>Kt(Gn(),r=>l($n(e,r),t),(r,o)=>jo(r,o))),oM=e=>ie(e,{onFailure:t=>{switch(t._tag){case"None":return h(x());case"Some":return L(t.value)}},onSuccess:t=>h(d(t))}),nM=a(e=>de(e[1]),(e,t,r)=>hx(e,t,(o,n)=>[o,n],r)),hx=a(e=>de(e[1]),(e,t,r,o)=>mt(Eo(X(e),X(t),(n,s)=>la(n,s,{onSuccess:r,onFailure:(i,c)=>o?.concurrent?Fe(i,c):Ce(i,c)}),o)));var sM=a(e=>Lt(e[0]),(e,t,r)=>qo(Qt(e,(o,n)=>qo(t(o,n)),r))),iM=e=>xr(ot,Te(zr,e)),dl=e=>xr(ot,Te(Qs,e)),aM=e=>$o(t=>l(xh(t,ii),r=>_(o=>[Gt(n=>jo(r,iu(n))),o])($n(r)(e)))),cM=a(e=>de(e[1]),(e,t,r)=>Eo(e,t,(o,n)=>[o,n],r)),pM=a(e=>de(e[1]),(e,t,r)=>Eo(e,t,(o,n)=>o,r)),uM=a(e=>de(e[1]),(e,t,r)=>Eo(e,t,(o,n)=>n,r)),Eo=a(e=>de(e[1]),(e,t,r,o)=>_(li([e,t],{concurrency:o?.concurrent?2:1,batching:o?.batching}),([n,s])=>r(n,s))),dx=e=>e===Tp?k:Nr(l(t=>{let r=Ms(t,e),o=_n(r,t);return Z(W(Ka(()=>Hs(o)))(Hs(e)))})($p)),k0=(e,t)=>r=>T(()=>{switch(r.state._tag){case"Exited":return k;case"Running":{let o=r.state.finalizers,n=r.state.update,s=Array.from(o.keys()).sort((i,c)=>c-i).map(i=>o.get(i));return r.state={_tag:"Exited",nextKey:r.state.nextKey,exit:t,update:n},QC(e)?l(i=>V(()=>jr)(Me(ua)(zs(i))))(He(i=>X(n(i)(t)))(s)):ZC(e)?l(i=>V(()=>jr)(Me(ua)(zs(i,{parallel:!0}))))(ja(s,i=>X(n(i)(t)),!1)):l(i=>V(()=>jr)(Me(ua)(zs(i,{parallel:!0}))))(sx(s,e.parallelism,i=>X(n(i)(t)),!1))}}}),xx=at(ou),xl=xx,Gn=(e=ii)=>_(eE,t=>({[ou]:ou,[dh]:dh,pipe(){return E(this,arguments)},fork:r=>Nr(l(o=>Y(o)(Mt(n=>js(o,n))(gh(t,n=>jo(o,n)))))(Gn(r))),close:r=>Z(k0(e,r)(t)),addFinalizer:r=>Z(gh(r)(t))})),$n=a(2,(e,t)=>Tn(e,en(Dc(xx,t)))),w0=a(2,(e,t)=>fr(r=>t.close(r))($n(t)(e))),F0=e=>Ws(e,{differ:IA,fork:ci}),Zt=a(2,(e,t)=>Z(za(l(Ye(e),r=>Y(Rn(e,t),r)),r=>Rn(e,r)))),xr=a(2,(e,t)=>Se(e,r=>Zt(e,t(r))));var DA=YS(jm),pi=F0(Kn),lM=e=>Z(Td(gl(e))),gl=e=>({[Ma]:Ta,id:()=>Q(e).reduce((t,r)=>Rm(t,r.id()),et),await:()=>X(ja(e,t=>mt(t.await()),!1)),children:()=>_(ja(e,t=>t.children(),!1),Fc),inheritAll:()=>ht(e,t=>t.inheritAll()),poll:()=>_(He(e,t=>t.poll()),Pc(d(ee(new Array)),(t,r)=>{switch(r._tag){case"None":return x();case"Some":switch(t._tag){case"None":return x();case"Some":return d(la(r.value,t.value,{onSuccess:(o,n)=>[o,...n],onFailure:Fe}))}}})),interruptAsFork:t=>ht(e,r=>r.interruptAsFork(t)),pipe(){return E(this,arguments)}});var gx=a(3,(e,t,r)=>yx(e,t,{onSelfWin:(o,n)=>l(o.await(),s=>{switch(s._tag){case me:return l(o.inheritAll(),()=>r.onSelfDone(s,n));case fe:return r.onSelfDone(s,n)}}),onOtherWin:(o,n)=>l(o.await(),s=>{switch(s._tag){case me:return l(o.inheritAll(),()=>r.onOtherDone(s,n));case fe:return r.onOtherDone(s,n)}})})),fM=e=>be(t=>Gt(r=>l(Bn(t(e)),o=>Uo(()=>cR(r)(o))(t(zn(o)))))),yl=a(2,(e,t)=>Gt(r=>gx(e,t,{onSelfDone:(o,n)=>wn(o,{onFailure:s=>ei(i=>Fe(s,i))(zn(n)),onSuccess:s=>Y(s)($t(r)(n))}),onOtherDone:(o,n)=>wn(o,{onFailure:s=>ei(i=>Fe(i,s))(zn(n)),onSuccess:s=>Y(s)($t(r)(n))})}))),yx=a(3,(e,t,r)=>ue((o,n)=>{let s=n.runtimeFlags,i=ct(!0),c=ix(e,o,s,r.selfScope),p=ix(t,o,s,r.otherScope);return Bt(u=>{c.unsafeAddObserver(()=>LA(c,p,r.onSelfWin,i,u)),p.unsafeAddObserver(()=>LA(p,c,r.onOtherWin,i,u)),c.startFork(e),p.startFork(t)},Rm(c.id(),p.id()))})),LA=(e,t,r,o,n)=>{Qc(!0,!1)(o)&&n(r(e,t))},$r=a(2,(e,t)=>be(r=>J(r(e),{onFailure:o=>J(t,{onFailure:n=>D(Ce(o,n)),onSuccess:()=>D(o)}),onSuccess:o=>Y(t,o)}))),P0=(e,t)=>Gt(r=>l(l(Bn(zt(e)),o=>Bt(n=>{let s=t.map(p=>p.listeners.count),i=()=>{s.every(p=>p===0)&&(c.forEach(p=>p()),n(Wo(o)))};o.unsafeAddObserver(p=>{c.forEach(u=>u()),n(p)});let c=t.map((p,u)=>{let f=m=>{s[u]=m,i()};return p.listeners.addObserver(f),()=>p.listeners.removeObserver(f)});return i(),g(()=>{c.forEach(p=>p())})})),()=>T(()=>{let o=t.flatMap(n=>n.state.completed?[]:[n]);return ht(o,n=>SA(n.request,iu(r)))})));var mM=(e,t)=>za(oi(e,t),(r,o)=>l(el,n=>g(()=>r.end(n,o)))),bl=(e,t)=>l(oi(e,t),r=>xr(yo,ko(r))),Sl=e=>xr(ot,Te(Zs,e)),El=e=>xr(yo,ko(e));var hM,gM,dM=(e,t,r,o)=>ro({_tag:"Complete",key:e,exit:t,entryStats:r,timeToLiveMillis:o}),xM=(e,t)=>ro({_tag:"Pending",key:e,deferred:t}),N0=(e,t)=>ro({_tag:"Refreshing",deferred:e,complete:t}),bx=Symbol.for("@effect/cache/Cache/MapKey"),Sx=class{constructor(t){this.current=t,this[hM]=bx,this.previous=void 0,this.next=void 0}[(hM=bx,A)](){return I(S(this.next))(I(S(this.previous))(S(this.current)))}[M](t){return this===t?!0:D0(t)&&O(this.current,t.current)&&O(this.previous,t.previous)&&O(this.next,t.next)}},fi=e=>new Sx(e),D0=e=>typeof e=="object"&&e!=null&&bx in e,Ex=class{constructor(){this.head=void 0,this.tail=void 0}add(t){if(t!==this.tail)if(this.tail===void 0)this.head=t,this.tail=t;else{let r=t.previous,o=t.next;o!==void 0&&(t.next=void 0,r!==void 0?(r.next=o,o.previous=r):(this.head=o,this.head.previous=void 0)),this.tail.next=t,t.previous=this.tail,this.tail=t}}remove(){let t=this.head;if(t!==void 0){let r=t.next;r!==void 0?(t.next=void 0,this.head=r,this.head.previous=void 0):(this.head=void 0,this.tail=void 0)}return t}},L0=()=>new Ex,H0=(e,t,r,o,n,s)=>({map:e,keys:t,accesses:r,updating:o,hits:n,misses:s}),q0=()=>H0(an(),L0(),cb(),ct(!1),0,0),U0="@effect/cache/Cache",W0=Symbol.for(U0),j0={_Key:e=>e,_Error:e=>e,_Value:e=>e},z0=e=>e,_l=e=>({loadedMillis:e}),_x=class{constructor(t,r,o,n,s){this.capacity=t,this.context=r,this.fiberId=o,this.lookup=n,this.timeToLive=s,this[gM]=j0,this.cacheState=q0()}get(t){return _(this.getEither(t),Tc)}cacheStats(){return g(()=>z0({hits:this.cacheState.hits,misses:this.cacheState.misses,size:Zc(this.cacheState.map)}))}getOption(t){return T(()=>De(ye(this.cacheState.map,t),{onNone:()=>{let r=fi(t);return this.trackAccess(r),this.trackMiss(),h(x())},onSome:r=>this.resolveMapValue(r)}))}getOptionComplete(t){return T(()=>De(ye(this.cacheState.map,t),{onNone:()=>{let r=fi(t);return this.trackAccess(r),this.trackMiss(),h(x())},onSome:r=>this.resolveMapValue(r,!0)}))}contains(t){return g(()=>sr(this.cacheState.map,t))}entryStats(t){return g(()=>{let r=ye(this.cacheState.map,t);if(N(r))switch(r.value._tag){case"Complete":{let o=r.value.entryStats.loadedMillis;return d(_l(o))}case"Pending":return x();case"Refreshing":{let o=r.value.complete.entryStats.loadedMillis;return d(_l(o))}}return x()})}getEither(t){return T(()=>{let r=t,o,n,s=je(ye(this.cacheState.map,r));return s===void 0&&(n=Eh(this.fiberId),o=fi(r),sr(this.cacheState.map,r)?s=je(ye(this.cacheState.map,r)):pt(this.cacheState.map,r,xM(o,n))),s===void 0?(this.trackAccess(o),this.trackMiss(),_(this.lookupValueOf(t,n),P)):l(this.resolveMapValue(s),De({onNone:()=>this.getEither(t),onSome:i=>h(q(i))}))})}invalidate(t){return g(()=>{cn(this.cacheState.map,t)})}invalidateWhen(t,r){return g(()=>{let o=ye(this.cacheState.map,t);N(o)&&o.value._tag==="Complete"&&o.value.exit._tag==="Success"&&r(o.value.exit.value)&&cn(this.cacheState.map,t)})}invalidateAll(){return g(()=>{this.cacheState.map=an()})}refresh(t){return Gr(r=>T(()=>{let o=t,n=Eh(this.fiberId),s=je(ye(this.cacheState.map,o));if(s===void 0&&(sr(this.cacheState.map,o)?s=je(ye(this.cacheState.map,o)):pt(this.cacheState.map,o,xM(fi(o),n))),s===void 0)return Z(this.lookupValueOf(t,n));switch(s._tag){case"Complete":{if(this.hasExpired(r,s.timeToLiveMillis)){let i=je(ye(this.cacheState.map,o));return O(i,s)&&cn(this.cacheState.map,o),Z(this.get(t))}return Z(Xu(()=>{let i=je(ye(this.cacheState.map,o));if(O(i,s)){let c=N0(n,s);return pt(this.cacheState.map,o,c),!0}return!1})(this.lookupValueOf(t,n)))}case"Pending":return Pn(s.deferred);case"Refreshing":return Pn(s.deferred)}}))}set(t,r){return Gr(o=>g(()=>{let n=o.unsafeCurrentTimeMillis(),s=t,i=uE(r),c=dM(fi(s),i,_l(n),n+Mr(ze(this.timeToLive(i))));pt(this.cacheState.map,s,c)}))}size(){return g(()=>Zc(this.cacheState.map))}values(){return g(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[1].exit.value);return t})}entries(){return g(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push([r[0],r[1].exit.value]);return t})}keys(){return g(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[0]);return t})}resolveMapValue(t,r=!1){return Gr(o=>{switch(t._tag){case"Complete":return this.trackAccess(t.key),this.trackHit(),this.hasExpired(o,t.timeToLiveMillis)?(cn(this.cacheState.map,t.key.current),h(x())):_(t.exit,d);case"Pending":return this.trackAccess(t.key),this.trackHit(),r?h(x()):_(Pn(t.deferred),d);case"Refreshing":return this.trackAccess(t.complete.key),this.trackHit(),this.hasExpired(o,t.complete.timeToLiveMillis)?r?h(x()):_(Pn(t.deferred),d):_(t.complete.exit,d)}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(t){if(pb(this.cacheState.accesses,t),Qc(this.cacheState.updating,!1,!0)){let r=!0;for(;r;){let n=ub(this.cacheState.accesses,rm);n===rm?r=!1:this.cacheState.keys.add(n)}let o=Zc(this.cacheState.map);for(r=o>this.capacity;r;){let n=this.cacheState.keys.remove();n!==void 0?sr(this.cacheState.map,n.current)&&(cn(this.cacheState.map,n.current),o=o-1,r=o>this.capacity):r=!1}Wt(this.cacheState.updating,!1)}}hasExpired(t,r){return t.unsafeCurrentTimeMillis()>r}lookupValueOf(t,r){return Gr(o=>T(()=>{let n=t;return Uo(()=>W(aE(r),g(()=>{cn(this.cacheState.map,n)})))(l(s=>{let i=o.unsafeCurrentTimeMillis(),c=_l(i),p=dM(fi(n),s,c,i+Mr(ze(this.timeToLive(s))));return pt(this.cacheState.map,n,p),W(iE(r,s),s)})(X(At(this.context)(this.lookup(t)))))}))}};gM=W0;var yM=(e,t,r)=>new _x(e,Et(),pp,t,o=>ze(r(o)));var K0="@effect/io/Schedule/Interval",Ox=Symbol.for(K0),bM={[Ox]:Ox,startMillis:0,endMillis:0};var SM=bM;var EM=e=>V(()=>SM)(pn(e.intervals)).startMillis;var _M=EM;var Y0="Done";var OM=e=>e._tag===Y0;var CM=OM;var Z0,RM,X0="@effect/io/Schedule",eP=Symbol.for(X0),tP="@effect/io/Schedule/Driver",rP=Symbol.for(tP);var oP={_Env:e=>e,_In:e=>e,_Out:e=>e};Z0=eP;var Cx=class{constructor(t,r){this.schedule=t,this.ref=r,this[RM]=oP}state(){return _(dr(this.ref),t=>t[1])}last(){return l(dr(this.ref),([t,r])=>{switch(t._tag){case"None":return lr(()=>po());case"Some":return h(t.value)}})}reset(){return Br(this.ref,[x(),this.schedule.initial])}next(t){return l(r=>l(o=>l(([n,s,i])=>CM(i)?W(L(x()))(Br(this.ref,[d(s),n])):Y(s)(W(ti(cs(_M(i.intervals)-o)))(Br(this.ref,[d(s),n]))))(T(()=>this.schedule.step(o,t,r))))(Du))(_(dr(this.ref),r=>r[1]))}};RM=rP;var Rx=e=>_(t=>new Cx(e,t))(Ln([x(),e.initial]));var AM=a(2,(e,t)=>Ax(e,t,(r,o)=>L(r))),Ax=a(3,(e,t,r)=>l(Rx(t),o=>ie(e,{onFailure:n=>r(n,x()),onSuccess:n=>MM(e,o,r,n)}))),MM=(e,t,r,o)=>ie(t.next(o),{onFailure:()=>Mn(t.last()),onSuccess:n=>ie(e,{onFailure:s=>r(s,d(n)),onSuccess:s=>MM(e,t,r,s)})}),TM=a(2,(e,t)=>Ga(e,r=>g(()=>t(r)))),Ga=a(2,(e,t)=>l(e,r=>l(t(r),o=>o?h(r):l(Tt(),()=>Ga(e,t))))),vM=a(2,(e,t)=>Mx(e,r=>g(()=>t(r)))),Mx=a(2,(e,t)=>Ga(e,r=>Ra(t(r)))),IM=a(2,(e,t)=>Tx(e,t,(r,o)=>L(r))),kM=a(2,(e,t)=>wM(e,t)),wM=(e,t)=>ft(e,r=>t<0?L(r):l(Tt(),()=>wM(e,t-1))),Tx=a(3,(e,t,r)=>l(Rx(t),o=>FM(e,o,r))),FM=(e,t,r)=>ft(e,o=>ie(t.next(o),{onFailure:()=>l(n=>r(o,n))(Mn(t.last())),onSuccess:()=>FM(e,t,r)})),PM=a(2,(e,t)=>$a(e,r=>g(()=>t(r)))),$a=a(2,(e,t)=>ft(e,r=>l(t(r),o=>o?L(r):l(Tt(),()=>$a(e,t))))),NM=a(2,(e,t)=>vx(e,r=>g(()=>t(r)))),vx=a(2,(e,t)=>$a(e,r=>Ra(t(r)))),Ol=a(2,(e,t)=>Ix(e,void 0,t)),Ix=a(3,(e,t,r)=>l(Rx(r),o=>DM(e,t,o))),DM=(e,t,r)=>ie(r.next(t),{onFailure:()=>Mn(r.last()),onSuccess:()=>l(e,o=>DM(e,o,r))});var HM,UM,WM,wx=class{constructor(t){this.permits=t,this.waiters=new Array,this.taken=0,this.take=r=>Dr(o=>{if(this.free<r){let n=()=>{if(this.free>=r){let s=this.waiters.findIndex(i=>i===n);s!==-1&&this.waiters.splice(s,1),this.taken+=r,o(h(r))}};return this.waiters.push(n),q(g(()=>{let s=this.waiters.findIndex(i=>i===n);s!==-1&&this.waiters.splice(s,1)}))}return this.taken+=r,P(h(r))}),this.release=r=>ue(o=>(this.taken-=r,o.getFiberRef(xo).scheduleTask(()=>{this.waiters.forEach(n=>n())},o.getFiberRef(sa)),k)),this.withPermits=r=>o=>be(n=>l(n(this.take(r)),s=>$r(n(o),this.release(s))))}get free(){return this.permits-this.taken}},Rl=e=>new wx(e),jM=e=>g(()=>Rl(e)),zM=e=>Al(e,lM),KM=a(2,(e,t)=>_(Px(e,t),r=>r[0])),Px=a(2,(e,t)=>{let r=ze(t);return l(qr(),o=>_(Ml(x()),n=>[At(nP(e,r,n),o),sP(n)]))}),qM=(e,t,r)=>{let o=Mr(ze(t));return _(n=>d([r+o,n]))(Mt(n=>Wr(e,n))(rt()))},nP=(e,t,r)=>be(o=>l(n=>z(n)?Ns("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/io/issues"):o(Ie(n.value[1])))(l(n=>uP(r,s=>{switch(s._tag){case"None":return d(qM(e,t,n));case"Some":{let[i]=s.value;return i-n<=0?d(qM(e,t,n)):x()}}}))(Gr(n=>n.currentTimeMillis)))),sP=e=>Br(e,x()),BM=a(2,(e,t)=>Al(e,r=>t(gl(r)))),Al=a(2,(e,t)=>l(RA,r=>$r(l(r.value(),t))(Lx(e,r)))),GM=a(e=>Lt(e[0]),(e,t)=>t?.discard?ht(e,vt):_(He(e,vt),gl)),Nx=a(2,(e,t)=>be(r=>l(t.fork(ii),o=>Mt(n=>o.addFinalizer(()=>Gt(s=>O(s,n.id())?k:Z(Wo(n)))))(Bn(fr(n=>o.close(n))(r(e))))))),Dx=e=>$o(t=>Nx(e,t)),$M=e=>zn(e),VM=e=>T(()=>l(e,zn)),kx=Symbol.for("@effect/io/Effect/memoizeFunction.key"),Cl=class{constructor(t,r){this.a=t,this.eq=r,this[HM]=kx}[(HM=kx,M)](t){return typeof t=="object"&&t!==null&&kx in t?this.eq?this.eq(this.a,t.a):O(this.a,t.a):!1}[A](){return this.eq?0:S(this.a)}},YM=(e,t)=>_(r=>o=>l(([n,s])=>Y(s)(Un(n)))(l(Ie)(r.modifyEffect(n=>{let s=ye(new Cl(o,t))(n);return z(s)?_(i=>[i,pt(new Cl(o,t),i)(n)])(Mt(i=>vt(Wr(i)(Hn(e(o)))))(rt())):h([s.value,n])}))))(l(Ml)(g(()=>an()))),JM=a(2,(e,t)=>(r=>mt(r))(yl(X(t))(X(e)))),QM=a(2,(e,t)=>Dx(Ol(t)(e))),Lx=a(2,(e,t)=>qe(pi,o=>o.zip(t))(e)),ZM=a(2,(e,t)=>Va(e,{onTimeout:x,onSuccess:d,duration:t})),XM=a(2,(e,{duration:t,onTimeout:r})=>mt(Va(e,{onTimeout:()=>lr(r),onSuccess:h,duration:t}))),eT=a(2,(e,{duration:t,onTimeout:r})=>mt(Va(e,{onTimeout:()=>Ur(r),onSuccess:h,duration:t}))),Va=a(2,(e,{duration:t,onSuccess:r,onTimeout:o})=>Gt(n=>yx(e,zt(ti(t)),{onSelfWin:(s,i)=>l(s.await(),c=>c._tag==="Success"?l(s.inheritAll(),()=>Y($t(i,n),r(c.value))):l($t(i,n),()=>B(c.cause))),onOtherWin:(s,i)=>l(s.await(),c=>c._tag==="Success"?l(s.inheritAll(),()=>Y($t(i,n),o())):l($t(i,n),()=>B(c.cause))),otherScope:jn}))),iP="@effect/io/Ref/Synchronized",aP=Symbol.for(iP),cP={_A:e=>e},Fx=class{constructor(t,r){this.ref=t,this.withLock=r,this[UM]=cP,this[WM]=Qh}modify(t){return this.modifyEffect(r=>h(t(r)))}modifyEffect(t){return this.withLock(l(([r,o])=>Y(Br(this.ref,o),r))(l(dr(this.ref),t)))}pipe(){return E(this,arguments)}};UM=aP,WM=Ku;var Ml=e=>g(()=>pP(e)),pP=e=>{let t=Bu(e),r=Rl(1);return new Fx(t,r.withPermits(1))},uP=a(2,(e,t)=>e.modifyEffect(r=>{let o=t(r);switch(o._tag){case"None":return h([r,r]);case"Some":return _(o.value,n=>[n,n])}}));var rT="Fresh",oT="FromEffect",nT="Scoped",sT="Suspend";var iT="ZipWithPar";var aT=$t;var vl=e=>(t,r)=>{let o=fp(),n=t,s=Wh(e.fiberRefs,{fiberId:o,fiberRef:ho,value:e.context});r?.scheduler&&(s=Wh(s,{fiberId:o,fiberRef:xo,value:r.scheduler})),r?.updateRefs&&(s=r.updateRefs(s,o));let i=new Wa(o,d_(s,o),e.runtimeFlags),c=i._supervisor;return c!==Kn&&(c.onStart(e.context,n,x(),i),i.unsafeAddObserver(p=>c.onEnd(p,i))),jn.add(e.runtimeFlags,i),i.start(n),i},Hx=e=>(t,r)=>{let o=vl(e)(t);return r&&o.unsafeAddObserver(n=>{r(n)}),(n,s)=>Hx(e)(aT(n??et)(o),s?i=>s(pE(i)):void 0)},mP=e=>t=>{let r=fT(e)(t);if(r._tag==="Failure")throw uT(r.i0);return r.i0},hP=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new Error;Error.stackTraceLimit=t;let o=`Fiber #${e.id().id} cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work`,n="AsyncFiberException";return Object.defineProperties(r,{_tag:{value:n},message:{value:o},name:{value:n},toString:{get(){return()=>o}},[pT]:{get(){return()=>o}}}),r};var cT=Symbol.for("@effect/io/Runtime/FiberFailure"),dP=Symbol.for("@effect/io/Runtime/FiberFailure/Cause"),pT=Symbol.for("nodejs.util.inspect.custom"),uT=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new Error;Error.stackTraceLimit=t;let o=Sp(e);return o.length>0&&(r.name=o[0].message.split(":")[0],r.message=o[0].message.substring(r.name.length+2),r.stack=`${r.name}: ${r.message}
${o[0].stack}`),r[cT]=cT,r[dP]=e,r.toString=()=>uo(e),r[pT]=()=>r.toString(),r};var lT=e=>{let t=e;switch(t._tag){case"Failure":case"Success":return t;case"Left":return mr(t.left);case"Right":return ee(t.right);case"Some":return ee(t.value);case"None":return mr(po())}},fT=e=>t=>{let r=lT(t);if(r)return r;let o=new Dp,n=vl(e)(t,{scheduler:o});o.flush();let s=n.unsafePoll();if(s)return s;throw hP(n)},xP=e=>t=>mT(e)(t).then(r=>{switch(r._tag){case me:return r.i0;case fe:throw uT(r.i0)}}),mT=e=>t=>new Promise(r=>{let o=lT(t);o&&r(o),vl(e)(t).unsafeAddObserver(n=>{r(n)})}),Tl=class{constructor(t,r,o){this.context=t,this.runtimeFlags=r,this.fiberRefs=o}pipe(){return E(this,arguments)}},gP=e=>new Tl(e.context,e.flags,e.fiberRefs),qx=()=>ue((e,t)=>h(new Tl(e.getFiberRef(ho),t.runtimeFlags,e.unsafeGetFiberRefs()))),yP=Ap(ur,Rp,Cp),gr=gP({context:Et(),flags:yP,fiberRefs:y_(new Map)}),hT=Hx(gr),dT=vl(gr),xT=xP(gr),gT=mT(gr),yT=mP(gr),bT=fT(gr),ST=e=>l(rt(),t=>l(qx(),r=>be(o=>W(vt(o(Lr(e(n=>Hx(r)(Wr(n,t))),n=>Fn(t,n)))),o(Ie(t))))));var ET=a(2,(e,t)=>e.modifyEffect(t));var EP="@effect/io/Layer",_P=Symbol.for(EP),OP={_RIn:e=>e,_E:e=>e,_ROut:e=>e},Il={[_P]:OP,pipe(){return E(this,arguments)}};var CP=e=>e._tag===rT,Ux=class{constructor(t){this.ref=t}getOrElseMemoize(t,r){return mt(ET(this.ref,o=>{let n=o.get(t);if(n!==void 0){let[s,i]=n,c=fr(au({onFailure:()=>k,onSuccess:()=>js(r,i)}))(l(([p,u])=>Y(u)(Un(p)))(s));return h([c,o])}return l(s=>l(i=>_(c=>{let p=be(f=>l(m=>l(y=>{switch(y._tag){case fe:return W(D(y.i0))(W(jo(m,y))(Fn(i,y.i0)));case me:return Y(y.i0[1])(W(Gs(i,y.i0))(W(js(r,b=>l(C=>C(b))(dr(c))))(W(Sa(s,b=>b+1))(Br(c,b=>Z(qs(Gu(s,C=>[C===1,C-1]))(jo(m,b))))))))}})(X(f(l(OT(t,m),y=>Hn(y(this)))))))(Gn())),u=[fr(wn({onFailure:()=>k,onSuccess:()=>Sa(s,f=>f+1)}))(Ie(i)),f=>l(m=>m(f))(dr(c))];return[p,CP(t)?o:o.set(t,u)]})(Ln(()=>k)))(rt()))(Ln(0))}))}},RP=()=>_(Ml(new Map),e=>new Ux(e));var _T=a(2,(e,t)=>l(RP(),r=>l(OT(e,t),o=>o(r)))),OT=(e,t)=>{let r=e;switch(r._tag){case"Locally":return g(()=>o=>r.f(o.getOrElseMemoize(r.self,t)));case"ExtendScope":return g(()=>o=>$o(n=>o.getOrElseMemoize(r.layer,n)));case"Fold":return g(()=>o=>J({onFailure:n=>o.getOrElseMemoize(r.failureK(n),t),onSuccess:n=>o.getOrElseMemoize(r.successK(n),t)})(o.getOrElseMemoize(r.layer,t)));case"Fresh":return g(()=>o=>_T(t)(r.layer));case"FromEffect":return g(()=>o=>r.effect);case"ProvideTo":return g(()=>o=>l(n=>At(n)(o.getOrElseMemoize(r.second,t)))(o.getOrElseMemoize(r.first,t)));case"Scoped":return g(()=>o=>$n(r.effect,t));case"Suspend":return g(()=>o=>o.getOrElseMemoize(r.evaluate(),t));case"ZipWith":return g(()=>o=>mo(o.getOrElseMemoize(r.second,t),r.zipK)(o.getOrElseMemoize(r.first,t)));case"ZipWithPar":return g(()=>o=>Eo(o.getOrElseMemoize(r.second,t),r.zipK,{concurrent:!0})(o.getOrElseMemoize(r.first,t)))}};var AP=()=>MP(qr());function MP(e){let t=Object.create(Il);return t._tag=oT,t.effect=e,t}var TP=a(2,(e,t)=>kP(e,t,(r,o)=>en(o)(r)));var It=e=>vP(Y(Et())(e)),vP=e=>{let t=Object.create(Il);return t._tag=nT,t.effect=e,t};var IP=e=>{let t=Object.create(Il);return t._tag=sT,t.evaluate=e,t};var kP=a(3,(e,t,r)=>IP(()=>{let o=Object.create(Il);return o._tag=iT,o.first=e,o.second=t,o.zipK=r,o})),Wx=a(2,(e,t)=>Kt(Gn(),r=>l(_T(t,r),o=>At(e,o)),(r,o)=>jo(r,o))),CT=a(2,(e,t)=>Wx(e,TP(AP(),t)));var AT=e=>It(dl(e)),MT=e=>It(El(e)),TT=(e,t)=>It(bl(e,t)),vT=e=>It(Sl(e));var jx=_n;var mi=xe(yM(65536,()=>_(rt(),e=>({listeners:new Da,handle:e})),()=>If(60))),Ya=K(Symbol.for("@effect/io/FiberRef/currentCacheEnabled"),()=>xe(!1)),zx=(e,t)=>l(de(t)?t:h(t),r=>Gt(o=>{let n=new Proxy(e,{});return Se(Ya,s=>{if(s)return Se(mi,c=>l(c.getEither(n),p=>{switch(p._tag){case"Left":return p.left.listeners.increment(),he(bS,l(X(Ie(p.left.handle)),u=>u._tag==="Failure"&&No(u.cause)?(p.left.listeners.decrement(),l(c.invalidateWhen(n,f=>f.handle===p.left.handle),()=>zx(n,t))):$r(Ie(p.left.handle),g(()=>p.left.listeners.decrement()))));case"Right":return p.right.listeners.increment(),he(Ym(r,Jm({request:n,result:p.right.handle,listeners:p.right.listeners,ownerId:o,state:{completed:!1}})),be(u=>l(X(u(Ie(p.right.handle))),f=>(p.right.listeners.decrement(),f))))}}));let i=new Da;return i.increment(),l(rt(),c=>he(Ym(r,Jm({request:n,result:c,listeners:i,ownerId:o,state:{completed:!1}})),$r(Ie(c),g(()=>i.decrement()))))})})),IT=(e,t)=>Se(Ya,r=>r?Se(mi,o=>l(o.getEither(e),n=>{switch(n._tag){case"Left":return k;case"Right":return bh(n.right.handle,t)}})):k),kT=a(2,(e,t)=>Ee(e,Ya,t)),wT=a(2,(e,t)=>Ee(e,mi,t));var NP=Ps,DP=de,LP=KM,HP=Px,qP=od,UP=YM,WP=nd,jP=li,zP=BA,KP=GA,BP=pO,GP=uO,$P=bO,VP=jA,YP=KA,JP=dO,QP=gO,Ja=Qt,ZP=OO,XP=px,eN=ux,tN=JO,rN=ZA,oN=QO,nN=ZO,sN=ax,iN=$A,aN=iC,cN=aC,pN=JA,uN=sM,lN=Bt,fN=ST,mN=$_,hN=Dr,dN=L,xN=lr,gN=D,yN=Ur,bN=rh,SN=Ns,EN=Lo,_N=_O,ON=In,CN=jO,RN=$O,AN=h,MN=ri,TN=id,hi=T,vN=g,dt=k,IN=Tt,kN=V_;var wN=ft,FN=Lr,PN=Y_,NN=HS,DN=J_,LN=Q_,HN=Z_,qN=X_,UN=eO,WN=Xh,jN=CO,zN=RO,KN=GO,BN=rC,GN=IM,$N=kM,VN=Tx,YN=PM,JN=$a,QN=NM,ZN=vx,XN=_a;var eD=dC,tD=xC,rD=ld,oD=bC,nD=oO,sD=qS,iD=fM,aD=zp,cD=Kp,pD=zt,uD=US,lD=Uo,fD=Nr,mD=be,hD=Y,dD=Yu,xD=G_,gD=Z,yD=qo,bD=yO,Gx=_,SD=UO,ED=Bp,_D=fo,OD=ei,CD=WO,RD=Ra,AD=za,MD=UA,FT=Kt,TD=Ka,vD=$r,ID=Gp,kD=fr,wD=XA,FD=eM,PD=xl,ND=$o,DD=lx,LD=rM,HD=aM,qD=zM,UD=WA,WD=nO,jD=Ju,zD=Hn,KD=BM,BD=Al,GD=Ho,$D=Gt,VD=vt,YD=Bn,JD=GM,QD=Nx,ZD=Dx,XD=VA,eL=$M,tL=VM,rL=Lx,oL=Vp,nL=zS,sL=e=>It(Zt(xo,e)),iL=QS,aL=JS,cL=hh,pL=tO,uL=Gr,lL=e=>It(xr(ot,Te(zr,e))),fL=iM,mL=s_,hL=rO,dL=ti,xL=fC,gL=ud,yL=ZM,bL=XM,SL=eT,EL=Va,_L=a_,OL=Dh,CL=AT,RL=i_,AL=dl,ML=qr,PT=lO,TL=Ds,vL=Tn,IL=At,NT=jS,kL=a(2,(e,t)=>{let r=jx(gr.runtimeFlags,t.runtimeFlags),o=jx(t.runtimeFlags,gr.runtimeFlags),n=si(gr.fiberRefs,t.fiberRefs),s=si(t.fiberRefs,gr.fiberRefs);return FT(l(Bx(r),()=>Kx(n)),()=>NT(e,t.context),()=>l(Bx(o),()=>Kx(s)))}),wL=Wx,FL=VO,PL=sd,NL=CT,DL=RC,LL=CC,HL=fd,qL=md,UL=AC,WL=e=>PT(t=>Mf(t,e)),jL=SC,zL=sO,KL=iO,BL=aO,GL=cO;var Vo=Hr,$L=X,VL=Wr,YL=zO,JL=nC,QL=oM,ZL=jp;var XL=fO,e2=mO,t2=Oa,r2=hO,o2=gC,n2=yC,s2=Xu,i2=qs,a2=EC,c2=_C,kt=l,p2=mt,u2=QA,l2=yl,f2=JM,m2=gx,h2=Qu,d2=Mt,x2=cC,g2=pC,y2=pd,b2=uC,S2=lC,E2=EO,_2=td,O2=LO,C2=AM,R2=eC,A2=Ax,M2=TM,T2=Ga,v2=vM,I2=Mx,k2=Ol,w2=QM,F2=Ix,P2=vn,N2=ed,D2=AO,L2=Ee,H2=qe,q2=Zt,U2=xr,Kx=Un,W2=oC,j2=Zu,z2=MO,K2=TO,B2=Ca,G2=na,$2=J,V2=ie,Y2=vO,J2=IO,Q2=rd,Z2=kO,X2=wO,eH=FO,tH=PO,rH=NO,oH=B_,nH=DO,sH=ZS,iH=e=>It(Zt(ca,e)),aH=Mn,cH=oh,pH=An,uH=KO,lH=BO,fH=YO,mH=Pu,hH=qx,dH=$p,Bx=Hs,xH=BS,gH=dx,yH=sC,bH=ad,SH=cd,EH=tM,_H=fx,OH=mx,CH=XS,RH=OC,AH=Do,MH=F,TH=Rl,vH=jM,IH=dT,kH=hT,DT=xT,wH=gT,FH=yT,PH=bT,NH=nM,DH=hx,LH=cM,HH=pM,qH=uM,UH=Eo,WH=he,jH=Wp,zH=Pr,KH=Ls,BH=zx,GH=IT,$H=KS,VH=e=>It(Zt(aa,e)),YH=e=>It(Zt(Ya,e)),JH=e=>It(de(e)?l(e,t=>Zt(mi,t)):Zt(mi,e)),QH=kT,ZH=wT,XH=vT,eq=hC,tq=Nu,rq=c_,oq=Sl,nq=GS,sq=e=>It(Zt(pa,e)),iq=TC,aq=MC,cq=dd,pq=hd,uq=IC,lq=kC,fq=vC,mq=oi,hq=MT,dq=TT,xq=xd,gq=mM,yq=wC,bq=bl,Sq=gd,Eq=El,_q=FC,Oq=PC;var xt={};Ci(xt,{ConfigTypeId:()=>Cq,all:()=>Rq,array:()=>Aq,boolean:()=>Mq,chunk:()=>Tq,date:()=>vq,fail:()=>Iq,hashMap:()=>Jq,hashSet:()=>Bq,integer:()=>wq,isConfig:()=>Pq,logLevel:()=>Fq,map:()=>Nq,mapAttempt:()=>Dq,mapOrFail:()=>Lq,nested:()=>Hq,number:()=>kq,option:()=>Wq,orElse:()=>qq,orElseIf:()=>Uq,primitive:()=>jq,repeat:()=>zq,secret:()=>Kq,string:()=>Gq,succeed:()=>$q,suspend:()=>Vq,sync:()=>Yq,unwrap:()=>Qq,validate:()=>Zq,withDefault:()=>Xq,withDescription:()=>e1,zip:()=>t1,zipWith:()=>r1});var Cq=vu,Rq=LE,Aq=RE,Mq=CE,Tq=Iu,vq=AE,Iq=ME,kq=TE,wq=vE,Fq=IE,Pq=Th,Nq=So,Dq=kE,Lq=Ys,Hq=Yt,qq=FE,Uq=ku,Wq=PE,jq=zo,zq=Tu,Kq=NE,Bq=DE,Gq=Mh,$q=Js,Vq=ha,Yq=qE,Jq=UE,Qq=vh,Zq=WE,Xq=jE,e1=zE,t1=KE,r1=da;var kl={};Ci(kl,{Tag:()=>at,add:()=>Te,empty:()=>Et,get:()=>Ar,getOption:()=>Mf,isContext:()=>HI,isTag:()=>ly,make:()=>Dc,merge:()=>en,omit:()=>UI,pick:()=>qI,unsafeGet:()=>as});var di={};Ci(di,{Class:()=>hy,TaggedClass:()=>GI,array:()=>KI,case:()=>BI,struct:()=>ro,tagged:()=>my,taggedEnum:()=>$I,tuple:()=>zI,unsafeArray:()=>Tf,unsafeStruct:()=>fy});var j={};Ci(j,{Do:()=>zL,EffectTypeId:()=>NP,acquireRelease:()=>AD,acquireReleaseInterruptible:()=>MD,acquireUseRelease:()=>FT,addFinalizer:()=>TD,all:()=>jP,allSuccesses:()=>KP,allWith:()=>zP,allowInterrupt:()=>nD,annotateCurrentSpan:()=>aq,annotateLogs:()=>oH,annotateSpans:()=>iq,as:()=>hD,asSome:()=>dD,asSomeError:()=>xD,asUnit:()=>gD,async:()=>lN,asyncEffect:()=>fN,asyncEither:()=>hN,asyncOption:()=>mN,awaitAllChildren:()=>qD,bind:()=>KL,bindTo:()=>BL,blocked:()=>WH,cacheRequestResult:()=>GH,cached:()=>qP,cachedFunction:()=>UP,cachedInvalidateWithTTL:()=>HP,cachedWithTTL:()=>LP,catch:()=>kN,catchAll:()=>wN,catchAllCause:()=>FN,catchAllDefect:()=>PN,catchSome:()=>NN,catchSomeCause:()=>DN,catchSomeDefect:()=>LN,catchTag:()=>HN,catchTags:()=>qN,cause:()=>UN,checkInterruptible:()=>sD,clock:()=>pL,clockWith:()=>uL,config:()=>_L,configProviderWith:()=>OL,context:()=>ML,contextWith:()=>PT,contextWithEffect:()=>TL,currentParentSpan:()=>pq,currentSpan:()=>cq,daemonChildren:()=>UD,delay:()=>hL,descriptor:()=>WD,descriptorWith:()=>jD,die:()=>bN,dieMessage:()=>SN,dieSync:()=>EN,diffFiberRefs:()=>zD,disconnect:()=>iD,dropUntil:()=>BP,dropWhile:()=>GP,either:()=>Vo,ensuring:()=>vD,ensuringChild:()=>KD,ensuringChildren:()=>BD,eventually:()=>WN,every:()=>$P,exists:()=>VP,exit:()=>$L,fail:()=>dN,failCause:()=>gN,failCauseSync:()=>yN,failSync:()=>xN,fiberId:()=>GD,fiberIdWith:()=>$D,filter:()=>YP,filterOrDie:()=>XL,filterOrDieMessage:()=>e2,filterOrElse:()=>t2,filterOrFail:()=>r2,findFirst:()=>JP,firstSuccessOf:()=>QP,flatMap:()=>kt,flatMapStep:()=>KH,flatten:()=>p2,flip:()=>yD,flipWith:()=>bD,forEach:()=>Ja,forever:()=>E2,fork:()=>VD,forkAll:()=>JD,forkDaemon:()=>YD,forkIn:()=>QD,forkScoped:()=>ZD,forkWithErrorHandler:()=>XD,fromFiber:()=>eL,fromFiberEffect:()=>tL,fromNullable:()=>_q,gen:()=>_N,getFiberRefs:()=>N2,head:()=>ZP,if:()=>ZL,ignore:()=>jN,ignoreLogged:()=>zN,inheritFiberRefs:()=>D2,interrupt:()=>aD,interruptWith:()=>cD,interruptible:()=>pD,interruptibleMask:()=>uD,intoDeferred:()=>VL,isEffect:()=>DP,isFailure:()=>z2,isSuccess:()=>K2,iterate:()=>_2,labelMetrics:()=>bH,labelMetricsScoped:()=>_H,labelMetricsScopedSet:()=>OH,labelMetricsSet:()=>SH,let:()=>GL,linkSpans:()=>fq,locally:()=>L2,locallyScoped:()=>q2,locallyScopedWith:()=>U2,locallyWith:()=>H2,log:()=>Y2,logAnnotations:()=>nH,logDebug:()=>Q2,logError:()=>eH,logFatal:()=>tH,logInfo:()=>Z2,logTrace:()=>J2,logWarning:()=>X2,loop:()=>O2,makeSemaphore:()=>vH,makeSpan:()=>mq,map:()=>Gx,mapAccum:()=>SD,mapBoth:()=>ED,mapError:()=>_D,mapErrorCause:()=>OD,mapInputContext:()=>vL,match:()=>B2,matchCause:()=>G2,matchCauseEffect:()=>$2,matchEffect:()=>V2,merge:()=>CD,mergeAll:()=>XP,metricLabels:()=>CH,negate:()=>RD,never:()=>ON,none:()=>CN,onError:()=>ID,onExit:()=>kD,onInterrupt:()=>lD,once:()=>WP,option:()=>YL,optionFromOptional:()=>Oq,orDie:()=>aH,orDieWith:()=>cH,orElse:()=>pH,orElseFail:()=>uH,orElseSucceed:()=>lH,parallelErrors:()=>KN,parallelFinalizers:()=>wD,partition:()=>eN,patchFiberRefs:()=>Kx,promise:()=>RN,provideContext:()=>IL,provideLayer:()=>wL,provideService:()=>FL,provideServiceEffect:()=>PL,provideSomeContext:()=>NT,provideSomeLayer:()=>NL,provideSomeRuntime:()=>kL,race:()=>l2,raceAll:()=>u2,raceFirst:()=>f2,raceWith:()=>m2,random:()=>fH,randomWith:()=>mH,reduce:()=>tN,reduceEffect:()=>rN,reduceRight:()=>oN,reduceWhile:()=>nN,repeat:()=>C2,repeatN:()=>R2,repeatOrElse:()=>A2,repeatUntil:()=>M2,repeatUntilEffect:()=>T2,repeatWhile:()=>v2,repeatWhileEffect:()=>I2,replicate:()=>sN,replicateEffect:()=>iN,request:()=>BH,retry:()=>GN,retryN:()=>$N,retryOrElse:()=>VN,retryUntil:()=>YN,retryUntilEffect:()=>JN,retryWhile:()=>QN,retryWhileEffect:()=>ZN,runCallback:()=>kH,runFork:()=>IH,runPromise:()=>DT,runPromiseExit:()=>wH,runRequestBlock:()=>jH,runSync:()=>FH,runSyncExit:()=>PH,runtime:()=>hH,runtimeFlags:()=>dH,sandbox:()=>BN,schedule:()=>k2,scheduleForked:()=>w2,scheduleFrom:()=>F2,scope:()=>PD,scopeWith:()=>ND,scoped:()=>DD,sequentialFinalizers:()=>FD,serviceConstants:()=>qL,serviceFunction:()=>DL,serviceFunctionEffect:()=>LL,serviceFunctions:()=>HL,serviceMembers:()=>UL,serviceOption:()=>WL,setClock:()=>lL,setConfigProvider:()=>CL,setFiberRefs:()=>W2,setParentSpan:()=>hq,setRequestBatching:()=>VH,setRequestCache:()=>JH,setRequestCaching:()=>YH,setScheduler:()=>sL,setSpan:()=>dq,setTracer:()=>XH,setTracerTiming:()=>sq,setUnhandledErrorLogLevel:()=>iH,sleep:()=>dL,some:()=>JL,spanAnnotations:()=>uq,spanLinks:()=>lq,step:()=>zH,succeed:()=>AN,succeedNone:()=>MN,succeedSome:()=>TN,summarized:()=>h2,supervised:()=>rL,suspend:()=>hi,sync:()=>vN,tagMetrics:()=>yH,tagMetricsScoped:()=>EH,takeUntil:()=>aN,takeWhile:()=>cN,tap:()=>d2,tapBoth:()=>x2,tapDefect:()=>g2,tapError:()=>y2,tapErrorCause:()=>S2,tapErrorTag:()=>b2,timed:()=>xL,timedWith:()=>gL,timeout:()=>yL,timeoutFail:()=>bL,timeoutFailCause:()=>SL,timeoutTo:()=>EL,tracer:()=>eq,tracerWith:()=>tq,transplant:()=>oL,try:()=>XN,tryMap:()=>eD,tryMapPromise:()=>tD,tryPromise:()=>rD,unified:()=>MH,unifiedFn:()=>AH,uninterruptible:()=>fD,uninterruptibleMask:()=>mD,unit:()=>dt,unless:()=>o2,unlessEffect:()=>n2,unsafeMakeSemaphore:()=>TH,unsandbox:()=>oD,unsome:()=>QL,updateFiberRefs:()=>j2,updateRuntimeFlags:()=>Bx,updateService:()=>jL,useSpan:()=>xq,useSpanScoped:()=>gq,using:()=>LD,validate:()=>NH,validateAll:()=>pN,validateFirst:()=>uN,validateWith:()=>DH,when:()=>s2,whenEffect:()=>i2,whenFiberRef:()=>a2,whenRef:()=>c2,whileLoop:()=>P2,withClock:()=>mL,withClockScoped:()=>fL,withConcurrency:()=>nL,withConfigProvider:()=>RL,withConfigProviderScoped:()=>AL,withEarlyRelease:()=>HD,withLogSpan:()=>rH,withMaxFiberOps:()=>iL,withMetric:()=>RH,withParentSpan:()=>Sq,withParentSpanScoped:()=>Eq,withRequestBatching:()=>$H,withRequestCache:()=>ZH,withRequestCaching:()=>QH,withRuntimeFlags:()=>xH,withRuntimeFlagsScoped:()=>gH,withScheduler:()=>aL,withSchedulingPriority:()=>cL,withSpan:()=>yq,withSpanScoped:()=>bq,withTracer:()=>rq,withTracerScoped:()=>oq,withTracerTiming:()=>nq,withUnhandledErrorLogLevel:()=>sH,yieldNow:()=>IN,zip:()=>LH,zipLeft:()=>HH,zipRight:()=>qH,zipWith:()=>UH});var Za={};Ci(Za,{SafeRefinementId:()=>d1,any:()=>S1,bigint:()=>R1,boolean:()=>_1,date:()=>A1,defined:()=>E1,discriminator:()=>HT,discriminators:()=>Yx,discriminatorsExhaustive:()=>qT,either:()=>wl,exhaustive:()=>jT,instanceOf:()=>UT,instanceOfUnsafe:()=>T1,is:()=>g1,nonEmptyString:()=>x1,not:()=>h1,null:()=>C1,number:()=>b1,option:()=>I1,orElse:()=>WT,orElseAbsurd:()=>v1,record:()=>M1,string:()=>y1,tag:()=>f1,tags:()=>m1,tagsExhaustive:()=>Jx,type:()=>s1,typeTags:()=>c1,undefined:()=>O1,value:()=>i1,valueTags:()=>a1,when:()=>p1,whenAnd:()=>l1,whenOr:()=>u1});var Qa=class e{constructor(t){this.cases=t,this._tag="TypeMatcher",this._input=F,this._filters=F,this._remaining=F,this._result=F}add(t){return new e([...this.cases,t])}pipe(){return E(this,arguments)}},$x=class e{constructor(t,r){this.provided=t,this.value=r,this._tag="ValueMatcher",this._input=F,this._filters=F,this._result=F}add(t){return this.value._tag==="Right"?this:t._tag==="When"&&t.guard(this.provided)===!0?new e(this.provided,P(t.evaluate(this.provided))):t._tag==="Not"&&t.guard(this.provided)===!1?new e(this.provided,P(t.evaluate(this.provided))):this}pipe(){return E(this,arguments)}},Vn=class{constructor(t,r){this.guard=t,this.evaluate=r,this._tag="When"}},Vx=class{constructor(t,r){this.guard=t,this.evaluate=r,this._tag="Not"}},xi=e=>{if(typeof e=="function")return e;if(Array.isArray(e)){let t=e.map(xi),r=t.length;return o=>{if(!Array.isArray(o))return!1;for(let n=0;n<r;n++)if(t[n](o[n])===!1)return!1;return!0}}else if(e!==null&&typeof e=="object"){let t=Object.entries(e).map(([o,n])=>[o,xi(n)]),r=t.length;return o=>{if(typeof o!="object"||o===null)return!1;for(let n=0;n<r;n++){let[s,i]=t[n];if(!(s in o)||i(o[s])===!1)return!1}return!0}}return t=>t===e},o1=e=>{let t=e.map(xi),r=t.length;return o=>{for(let n=0;n<r;n++)if(t[n](o)===!0)return!0;return!1}},n1=e=>{let t=e.map(xi),r=t.length;return o=>{for(let n=0;n<r;n++)if(t[n](o)===!1)return!1;return!0}},s1=()=>new Qa([]),i1=e=>new $x(e,q(e)),a1=e=>{let t=Jx(e)(new Qa([]));return r=>t(r)},c1=()=>e=>{let t=Jx(e)(new Qa([]));return r=>t(r)},p1=(e,t)=>r=>r.add(new Vn(xi(e),t)),u1=(...e)=>t=>{let r=e[e.length-1],o=e.slice(0,-1);return t.add(new Vn(o1(o),r))},l1=(...e)=>t=>{let r=e[e.length-1],o=e.slice(0,-1);return t.add(new Vn(n1(o),r))},HT=e=>(...t)=>{let r=t[t.length-1],o=t.slice(0,-1),n=o.length===1?s=>s[e]===o[0]:s=>o.includes(s[e]);return s=>s.add(new Vn(n,r))},Yx=e=>t=>{let r=[];for(let n in t){let s=c=>c[e]===n,i=t[n];i&&r.push(new Vn(s,i))}let o=r.length;return n=>{let s=n;for(let i=0;i<o;i++)s=s.add(r[i]);return s}},qT=e=>t=>{let r=Yx(e)(t);return o=>jT(r(o))},f1=HT("_tag"),m1=Yx("_tag"),Jx=qT("_tag"),h1=(e,t)=>r=>r.add(new Vx(xi(e),t)),d1=Symbol.for("@effect/match/SafeRefinementId"),x1=e=>typeof e=="string"&&e.length>0,g1=(...e)=>{let t=e.length;return r=>{for(let o=0;o<t;o++)if(r===e[o])return!0;return!1}},y1=Ti,b1=Jo,S1=()=>!0,E1=e=>e!=null,_1=bc,O1=vi;var C1=vg;var R1=ts,A1=Sc,M1=Ii,UT=e=>t=>t instanceof e,T1=UT,WT=e=>t=>{let r=wl(t);return Ac(r)?r._tag==="Right"?r.right:e(r.left):o=>{let n=r(o);return n._tag==="Right"?n.right:e(n.left)}},v1=e=>WT(()=>{throw new Error("absurd")})(e),wl=e=>{if(e._tag==="ValueMatcher")return e.value;let t=e.cases.length;return r=>{for(let o=0;o<t;o++){let n=e.cases[o];if(n._tag==="When"&&n.guard(r)===!0)return P(n.evaluate(r));if(n._tag==="Not"&&n.guard(r)===!1)return P(n.evaluate(r))}return q(r)}},I1=e=>{let t=wl(e);return Ac(t)?Mc(t,{onLeft:()=>x(),onRight:d}):r=>Mc(t(r),{onLeft:()=>x(),onRight:o=>d(o)})},jT=e=>{let t=wl(e);if(Ac(t)){if(t._tag==="Right")return t.right;throw new Error("@effect/match: exhaustive absurd")}return r=>{let o=t(r);if(o._tag==="Right")return o.right;throw new Error("@effect/match: exhaustive absurd")}};var Fl="@effect/schema/ArbitraryHookId",Qx="@effect/schema/PrettyHookId",Zx=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return Zx(e,t.from)}},Xa=e=>Object.keys(e).concat(Object.getOwnPropertySymbols(e)),Pl=e=>{let t=!1,r;return()=>(t||(r=e(),t=!0),r)};var Xx=e=>({_tag:"ParseError",errors:e}),yr=(e,t,r)=>({_tag:"Type",expected:e,actual:t,message:Ht(r)}),KT={_tag:"Forbidden"},_o=(e,t)=>({_tag:"Index",index:e,errors:t}),Vr=(e,t)=>({_tag:"Key",key:e,errors:t}),Nl={_tag:"Missing"},eg=e=>({_tag:"Unexpected",actual:e}),tg=e=>({_tag:"UnionMember",errors:e}),Je=P,Xt=e=>q(Xx([e])),Ue=e=>q(Xx(e)),Yr=e=>{let t=e;if(t._tag==="Left"||t._tag==="Right")return t},gi=(e,t)=>{let r=e;return r._tag==="Left"?r:r._tag==="Right"?t(r.right):kt(e,t)},BT=(e,t)=>{let r=e;return r._tag==="Left"?r:r._tag==="Right"?P(t(r.right)):Gx(e,t)};var ng="@effect/schema/TypeAnnotationId",Ll="@effect/schema/MessageAnnotationId",yi="@effect/schema/IdentifierAnnotationId",nt="@effect/schema/TitleAnnotationId",Yo="@effect/schema/DescriptionAnnotationId",VT="@effect/schema/ExamplesAnnotationId",YT="@effect/schema/JSONSchemaAnnotationId",JT="@effect/schema/DocumentationAnnotationId",rc=e=>t=>Object.prototype.hasOwnProperty.call(t.annotations,e)?d(t.annotations[e]):x(),bi=(e,t,r,o={})=>({_tag:"Declaration",typeParameters:e,type:t,decode:r,annotations:o});var QT=e=>({_tag:"Literal",literal:e,annotations:{}}),Yn=e=>e._tag==="Literal";var k1=e=>e._tag==="UniqueSymbol",w1={_tag:"UndefinedKeyword",annotations:{[nt]:"undefined"}};var F1={_tag:"VoidKeyword",annotations:{[nt]:"void"}};var oc={_tag:"NeverKeyword",annotations:{[nt]:"never"}};var Si={_tag:"UnknownKeyword",annotations:{[nt]:"unknown"}},P1=e=>e._tag==="UnknownKeyword",ZT={_tag:"AnyKeyword",annotations:{[nt]:"any"}},N1=e=>e._tag==="AnyKeyword",Hl={_tag:"StringKeyword",annotations:{[nt]:"string"}},tc=e=>e._tag==="StringKeyword",XT={_tag:"NumberKeyword",annotations:{[nt]:"number"}},Dl=e=>e._tag==="NumberKeyword",D1={_tag:"BooleanKeyword",annotations:{[nt]:"boolean"}},GT=e=>e._tag==="BooleanKeyword",L1={_tag:"BigIntKeyword",annotations:{[nt]:"bigint"}},$T=e=>e._tag==="BigIntKeyword",sg={_tag:"SymbolKeyword",annotations:{[nt]:"symbol"}},og=e=>e._tag==="SymbolKeyword",H1={_tag:"ObjectKeyword",annotations:{[nt]:"object"}};var nc=(e,t)=>({type:e,isOptional:t}),Jn=(e,t,r,o={})=>({_tag:"Tuple",elements:e,rest:t,isReadonly:r,annotations:o});var Ne=(e,t,r,o,n={})=>({name:e,type:t,isOptional:r,isReadonly:o,annotations:n}),ev=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return ev(e.from);default:return!1}},Ei=(e,t,r)=>{if(ev(e))return{parameter:e,type:t,isReadonly:r};throw new Error("An index signature parameter type must be 'string', 'symbol', a template literal type or a refinement of the previous types")},Oo=(e,t,r={})=>{let o={};for(let s=0;s<e.length;s++){let i=e[s].name;if(Object.prototype.hasOwnProperty.call(o,i))throw new Error(`Duplicate property signature ${String(i)}`);o[i]=null}let n={string:!1,symbol:!1};for(let s=0;s<t.length;s++){let i=Ul(t[s].parameter);if(tc(i)){if(n.string)throw new Error("Duplicate index signature for type `string`");n.string=!0}else if(og(i)){if(n.symbol)throw new Error("Duplicate index signature for type `symbol`");n.symbol=!0}}return{_tag:"TypeLiteral",propertySignatures:q1(e),indexSignatures:t,annotations:r}};var Co=(e,t={})=>{let r=z1(e);switch(r.length){case 0:return oc;case 1:return r[0];default:return{_tag:"Union",types:j1(r),annotations:t}}};var sc=(e,t={})=>({_tag:"Lazy",f:Pl(e),annotations:t});var ic=(e,t,r,o={})=>({_tag:"Refinement",from:e,decode:t,isReversed:r,annotations:o}),tv=e=>e._tag==="Refinement",ac=(e,t,r,o)=>({from:e,to:t,decode:r,encode:o}),ql=(e,t,r,o,n,s={})=>({_tag:"Transform",from:e,to:t,decode:r,encode:o,propertySignatureTransformations:n,annotations:s}),rv=(e,t,r,o,n={})=>ql(e,t,r,o,[],n),ov=(e,t,r,o={})=>ql(e,t,n=>{for(let s=0;s<r.length;s++){let i=r[s],c=i.from,p=Object.prototype.hasOwnProperty.call(n,c)?d(n[c]):x();delete n[c];let u=i.decode(p);N(u)&&(n[i.to]=u.value)}return Je(n)},n=>{for(let s=0;s<r.length;s++){let i=r[s],c=i.to,p=Object.prototype.hasOwnProperty.call(n,c)?d(n[c]):x();delete n[c];let u=i.encode(p);N(u)&&(n[i.from]=u.value)}return Je(n)},r,o);var nv=(e,t,r)=>({...e,annotations:{...e.annotations,[t]:r}});var sv=e=>e.map(t=>Ne(t.name,Pe(t.type),t.isOptional,t.isReadonly,t.annotations)),iv=e=>e.map(t=>Ei(t.parameter,Pe(t.type),t.isReadonly)),Pe=e=>{switch(e._tag){case"Declaration":return bi(e.typeParameters.map(Pe),Pe(e.type),e.decode,e.annotations);case"Tuple":return Jn(e.elements.map(t=>nc(Pe(t.type),t.isOptional)),Me(e.rest,is(Pe)),e.isReadonly,e.annotations);case"TypeLiteral":return Oo(sv(e.propertySignatures),iv(e.indexSignatures),e.annotations);case"Union":return Co(e.types.map(Pe),e.annotations);case"Lazy":return sc(()=>Pe(e.f()),e.annotations);case"Refinement":return ic(Pe(e.from),e.decode,!1,e.annotations);case"Transform":return Pe(e.to)}return e},er=e=>{switch(e._tag){case"Declaration":return bi(e.typeParameters.map(er),er(e.type),e.decode,e.annotations);case"Tuple":return Jn(e.elements.map(t=>nc(er(t.type),t.isOptional)),Me(e.rest,is(er)),e.isReadonly);case"TypeLiteral":return Oo(e.propertySignatures.map(t=>Ne(t.name,er(t.type),t.isOptional,t.isReadonly)),e.indexSignatures.map(t=>Ei(t.parameter,er(t.type),t.isReadonly)));case"Union":return Co(e.types.map(er));case"Lazy":return sc(()=>er(e.f()));case"Refinement":case"Transform":return er(e.from)}return e},av=e=>{switch(e._tag){case"Declaration":return av(e.type);case"NeverKeyword":return 0;case"Literal":case"UndefinedKeyword":case"VoidKeyword":case"UniqueSymbol":return 1;case"BooleanKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3;case"ObjectKeyword":return 5;case"UnknownKeyword":case"AnyKeyword":return 6;default:return 4}},q1=Zo(ne(bt,Mi(e=>av(e.type)))),cv=Ag(bt,bt,bt),U1=tf(cv),pv=[0,0,0],W1=e=>e.reduce(U1,pv),ec=e=>{switch(e._tag){case"Tuple":{let t=e.elements.length,r=N(e.rest)?e.rest.value.length:0;return[2,t,r]}case"TypeLiteral":{let t=e.propertySignatures.length,r=e.indexSignatures.length;return t+r===0?[-4,0,0]:[4,t,r]}case"Declaration":{let[t,r,o]=ec(e.type);return[6,r,o]}case"Lazy":return[8,0,0];case"Union":return W1(e.types.map(ec));case"Refinement":{let[t,r,o]=ec(e.from);return[t+1,r,o]}case"Transform":return ec(e.from);case"ObjectKeyword":return[-2,0,0];case"UnknownKeyword":case"AnyKeyword":return[-4,0,0];default:return pv}},j1=Zo(Rg(Mi(cv,ec))),z1=e=>{let t=ne(e,wc(o=>{switch(o._tag){case"NeverKeyword":return[];case"Union":return o.types;default:return[o]}}));if(t.some(N1))return[ZT];if(t.some(P1))return[Si];let r;return(r=t.findIndex(tc))!==-1&&(t=t.filter((o,n)=>n===r||!tc(o)&&!(Yn(o)&&typeof o.literal=="string"))),(r=t.findIndex(Dl))!==-1&&(t=t.filter((o,n)=>n===r||!Dl(o)&&!(Yn(o)&&typeof o.literal=="number"))),(r=t.findIndex(GT))!==-1&&(t=t.filter((o,n)=>n===r||!GT(o)&&!(Yn(o)&&typeof o.literal=="boolean"))),(r=t.findIndex($T))!==-1&&(t=t.filter((o,n)=>n===r||!$T(o)&&!(Yn(o)&&typeof o.literal=="bigint"))),(r=t.findIndex(og))!==-1&&(t=t.filter((o,n)=>n===r||!og(o)&&!k1(o))),t},Ul=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return Ul(e.from)}};var Jr=(e,t=[])=>({value:e,forest:t}),uv=e=>K1(Jr("error(s) found",e.map(jl))),K1=e=>e.value+lv(`
`,e.forest),lv=(e,t)=>{let r="",o=t.length,n;for(let s=0;s<o;s++){n=t[s];let i=s===o-1;r+=e+(i?"\u2514":"\u251C")+"\u2500 "+n.value,r+=lv(e+(o>1&&!i?"\u2502  ":"   "),n.forest)}return r},cc=e=>{if(e==null||typeof e=="number"||typeof e=="symbol"||e instanceof Date)return String(e);if(typeof e=="bigint")return String(e)+"n";try{return JSON.stringify(e)}catch{return String(e)}},B1=e=>{switch(e.type._tag){case"StringKeyword":return"${string}";case"NumberKeyword":return"${number}"}},G1=e=>e.head+e.spans.map(t=>B1(t)+t.literal).join(""),$1=rc(Ll),V1=rc(nt),Y1=rc(yi),J1=rc(Yo),br=e=>ne(Y1(e),ns(()=>V1(e)),ns(()=>J1(e))),Wl=e=>{switch(e._tag){case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"UndefinedKeyword":case"SymbolKeyword":case"ObjectKeyword":case"AnyKeyword":case"UnknownKeyword":case"VoidKeyword":case"NeverKeyword":return V(br(e),()=>e._tag);case"Literal":return V(br(e),()=>cc(e.literal));case"UniqueSymbol":return V(br(e),()=>cc(e.symbol));case"Union":return e.types.map(Wl).join(" or ");case"TemplateLiteral":return V(br(e),()=>G1(e));case"Tuple":return V(br(e),()=>"<anonymous tuple or array schema>");case"TypeLiteral":return V(br(e),()=>"<anonymous type literal schema>");case"Enums":return V(br(e),()=>e.enums.map((t,r)=>JSON.stringify(r)).join(" | "));case"Lazy":return V(br(e),()=>"<anonymous lazy schema>");case"Declaration":return V(br(e),()=>"<anonymous declaration schema>");case"Refinement":return V(br(e),()=>"<anonymous refinement schema>");case"Transform":return V(br(e),()=>`${Wl(e.from)} -> ${Wl(e.to)}`)}},jl=e=>{switch(e._tag){case"Type":return Jr(ne($1(e.expected),Me(t=>t(e.actual)),ns(()=>e.message),V(()=>`Expected ${Wl(e.expected)}, actual ${cc(e.actual)}`)));case"Forbidden":return Jr("is forbidden");case"Index":{let t=e.errors.map(jl);return t.length===1&&t[0].forest.length!==0?Jr(`[${e.index}]${t[0].value}`,t[0].forest):Jr(`[${e.index}]`,t)}case"Unexpected":return Jr("is unexpected");case"Key":{let t=e.errors.map(jl);return t.length===1&&t[0].forest.length!==0?Jr(`[${cc(e.key)}]${t[0].value}`,t[0].forest):Jr(`[${cc(e.key)}]`,t)}case"Missing":return Jr("is missing");case"UnionMember":return Jr("union member",e.errors.map(jl))}};var mv=e=>{let t=st(e);return(r,o)=>t(r,{...o,isEffectAllowed:!0})};var cg=e=>st(e.ast);var pg=e=>mv(e.ast);var ug=e=>mv(Sr(e.ast)),st=(e,t=!0)=>{switch(e._tag){case"Refinement":if(e.isReversed){let r=st(Pe(e),t),o=st(Sr(hv(e.from)),!1);return(n,s)=>pc(gi(r(n,s),i=>o(i,s)),s)}else{let r=st(e.from,t);return(o,n)=>pc(gi(r(o,n),s=>e.decode(s,n)),n)}case"Transform":{let r=st(e.to,!1);if(t){let o=st(e.from);return(n,s)=>pc(gi(o(n,s),i=>gi(e.decode(i,s),c=>r(c,s))),s)}else return(o,n)=>pc(gi(e.decode(o,n),s=>r(s,n)),n)}case"Declaration":{let r=e.decode(...e.typeParameters);return(o,n)=>pc(r(o,n),n)}case"Literal":return gt(e,r=>r===e.literal);case"UniqueSymbol":return gt(e,r=>r===e.symbol);case"UndefinedKeyword":return gt(e,vi);case"VoidKeyword":return gt(e,vi);case"NeverKeyword":return gt(e,Ig);case"UnknownKeyword":case"AnyKeyword":return Je;case"StringKeyword":return gt(e,Ti);case"NumberKeyword":return gt(e,Jo);case"BooleanKeyword":return gt(e,bc);case"BigIntKeyword":return gt(e,ts);case"SymbolKeyword":return gt(e,Mg);case"ObjectKeyword":return gt(e,pe);case"Enums":return gt(e,r=>e.enums.some(([o,n])=>n===r));case"TemplateLiteral":{let r=X1(e);return gt(e,o=>Ti(o)&&r.test(o))}case"Tuple":{let r=e.elements.map(s=>st(s.type,t)),o=ne(e.rest,Me(is(s=>st(s)))),n=e.elements.filter(s=>!s.isOptional).length;return N(e.rest)&&(n+=e.rest.value.length-1),(s,i)=>{if(!Array.isArray(s))return Xt(yr(Z1,s));let c=i?.errors==="all",p=[],u=0,f=s.length;for(let R=f;R<=n-1;R++){let v=_o(R,[Nl]);if(c){p.push([u++,v]);continue}else return Xt(v)}if(z(e.rest))for(let R=e.elements.length;R<=f-1;R++){let v=_o(R,[eg(s[R])]);if(c){p.push([u++,v]);continue}else return Ue(wt(We(p),v))}let m=[],y=0,b;for(;y<r.length;y++)if(f<y+1){if(e.elements[y].isOptional)continue}else{let R=r[y],v=R(s[y],i),w=Yr(v);if(w){if(Ae(w)){let H=_o(y,w.left.errors);if(c){p.push([u++,H]);continue}else return Ue(wt(We(p),H))}m.push([u++,w.right])}else{let H=u++,U=y;b||(b=[]),b.push(({es:re,output:ge})=>kt(Vo(v),ke=>{if(Ae(ke)){let ce=_o(U,ke.left.errors);return c?(re.push([H,ce]),dt):Ue(wt(We(re),ce))}return ge.push([H,ke.right]),dt}))}}if(N(o)){let R=_e(o.value),v=qt(o.value);for(;y<f-v.length;y++){let w=R(s[y],i),H=Yr(w);if(H)if(Ae(H)){let U=_o(y,H.left.errors);if(c){p.push([u++,U]);continue}else return Ue(wt(We(p),U))}else m.push([u++,H.right]);else{let U=u++,re=y;b||(b=[]),b.push(({es:ge,output:ke})=>kt(Vo(w),ce=>{if(Ae(ce)){let _r=_o(re,ce.left.errors);return c?(ge.push([U,_r]),dt):Ue(wt(We(ge),_r))}else return ke.push([U,ce.right]),dt}))}}for(let w=0;w<v.length;w++)if(y+=w,!(f<y+1)){let H=v[w](s[y],i),U=Yr(H);if(U){if(Ae(U)){let re=_o(y,U.left.errors);if(c){p.push([u++,re]);continue}else return Ue(wt(We(p),re))}m.push([u++,U.right])}else{let re=u++,ge=y;b||(b=[]),b.push(({es:ke,output:ce})=>kt(Vo(H),_r=>{if(Ae(_r)){let Qr=_o(ge,_r.left.errors);return c?(ke.push([re,Qr]),dt):Ue(wt(We(ke),Qr))}return ce.push([re,_r.right]),dt}))}}}let C=({es:R,output:v})=>Ic(R)?Ue(We(R)):Je(We(v));if(b&&b.length>0){let R=b;return hi(()=>{let v={es:Array.from(p),output:Array.from(m)};return kt(Ja(R,w=>w(v),{concurrency:"unbounded",discard:!0}),()=>C(v))})}return C({output:m,es:p})}}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return gt(e,kg);let r=e.propertySignatures.map(i=>st(i.type,t)),o=e.indexSignatures.map(i=>[st(i.parameter,t),st(i.type,t)]),n=st(Co(e.indexSignatures.map(i=>Ul(i.parameter)))),s={};for(let i=0;i<r.length;i++)s[e.propertySignatures[i].name]=null;return(i,c)=>{if(!Ii(i))return Xt(yr(fv,i));let p=c?.errors==="all",u=[],f=0;if(c?.onExcessProperty==="error"){for(let R of Xa(i))if(!Object.prototype.hasOwnProperty.call(s,R)){let v=n(R),w=Yr(v);if(w&&Ae(w)){let H=Vr(R,[eg(i[R])]);if(p){u.push([f++,H]);continue}else return Ue(wt(We(u),H))}}}let y={},b;for(let R=0;R<r.length;R++){let v=e.propertySignatures[R],w=r[R],H=v.name;if(Object.prototype.hasOwnProperty.call(i,H)){let U=w(i[H],c),re=Yr(U);if(re){if(Ae(re)){let ge=Vr(H,re.left.errors);if(p){u.push([f++,ge]);continue}else return Ue(wt(We(u),ge))}y[H]=re.right}else{let ge=f++,ke=H;b||(b=[]),b.push(({es:ce,output:_r})=>kt(Vo(U),Qr=>{if(Ae(Qr)){let hc=Vr(ke,Qr.left.errors);return p?(ce.push([ge,hc]),dt):Ue(wt(We(ce),hc))}return _r[ke]=Qr.right,dt}))}}else if(!v.isOptional){let U=Vr(H,[Nl]);if(p){u.push([f++,U]);continue}else return Xt(U)}}for(let R=0;R<o.length;R++){let v=o[R][0],w=o[R][1],H=Zx(i,e.indexSignatures[R].parameter);for(let U of H){if(Object.prototype.hasOwnProperty.call(s,U))continue;let re=Yr(v(U,c));if(re&&Ae(re)){let ce=Vr(U,re.left.errors);if(p){u.push([f++,ce]);continue}else return Ue(wt(We(u),ce))}let ge=w(i[U],c),ke=Yr(ge);if(ke)if(Ae(ke)){let ce=Vr(U,ke.left.errors);if(p){u.push([f++,ce]);continue}else return Ue(wt(We(u),ce))}else y[U]=ke.right;else{let ce=f++,_r=U;b||(b=[]),b.push(({es:Qr,output:hc})=>kt(Vo(ge),Zl=>{if(Ae(Zl)){let Sg=Vr(_r,Zl.left.errors);return p?(Qr.push([ce,Sg]),dt):Ue(wt(We(Qr),Sg))}else return hc[U]=Zl.right,dt}))}}}let C=({es:R,output:v})=>Ic(R)?Ue(We(R)):Je(v);if(b&&b.length>0){let R=b;return hi(()=>{let v={es:Array.from(u),output:Object.assign({},y)};return kt(Ja(R,w=>w(v),{concurrency:"unbounded",discard:!0}),()=>C(v))})}return C({es:u,output:y})}}case"Union":{let r=Q1(e.types),o=Xa(r.keys),n=o.length,s=new Map;for(let i=0;i<e.types.length;i++)s.set(e.types[i],st(e.types[i],!0));return(i,c)=>{let p=[],u=0,f=[];if(n>0)if(Ii(i))for(let b=0;b<n;b++){let C=o[b],R=r.keys[C].buckets;if(Object.prototype.hasOwnProperty.call(i,C)){let v=String(i[C]);Object.prototype.hasOwnProperty.call(R,v)?f=f.concat(R[v]):p.push([u++,Vr(C,[yr(r.keys[C].ast,i[C])])])}else p.push([u++,Vr(C,[Nl])])}else p.push([u++,yr(fv,i)]);r.otherwise.length>0&&(f=f.concat(r.otherwise));let m;for(let b=0;b<f.length;b++){let C=s.get(f[b])(i,c),R=!m||m.length===0?Yr(C):void 0;if(R){if(Cr(R))return Je(R.right);p.push([u++,tg(R.left.errors)])}else{let v=u++;m||(m=[]),m.push(w=>hi(()=>"finalResult"in w?dt:kt(Vo(C),H=>(Cr(H)?w.finalResult=Je(H.right):w.es.push([v,tg(H.left.errors)]),dt))))}}let y=b=>Ic(b)?Ue(We(b)):Xt(yr(oc,i));if(m&&m.length>0){let b=m;return hi(()=>{let C={es:Array.from(p)};return kt(Ja(b,R=>R(C),{concurrency:1,discard:!0}),()=>"finalResult"in C?C.finalResult:y(C.es))})}return y(p)}}case"Lazy":{let r=Pl(()=>st(e.f(),t));return(o,n)=>r()(o,n)}}},gt=(e,t)=>r=>t(r)?Je(r):Xt(yr(e,r)),ag=e=>{switch(e._tag){case"Declaration":return ag(e.type);case"TypeLiteral":{let t=[];for(let r=0;r<e.propertySignatures.length;r++){let o=e.propertySignatures[r],n=er(o.type);Yn(n)&&!o.isOptional&&t.push([o.name,n])}return t}case"Refinement":case"Transform":return ag(e.from)}return[]},Q1=e=>{let t={},r=[];for(let o=0;o<e.length;o++){let n=e[o],s=ag(n);if(s.length>0)for(let i=0;i<s.length;i++){let[c,p]=s[i],u=String(p.literal);t[c]=t[c]||{buckets:{},ast:oc};let f=t[c].buckets;if(Object.prototype.hasOwnProperty.call(f,u)){if(i<s.length-1)continue;f[u].push(n),t[c].ast=Co([t[c].ast,p])}else{f[u]=[n],t[c].ast=Co([t[c].ast,p]);break}}else r.push(n)}return{keys:t,otherwise:r}},hv=e=>tv(e)?hv(e.from):e,pc=(e,t)=>{let r=Yr(e);return r||(t?.isEffectAllowed===!0?e:Xt(KT))},Z1=Jn([],d([Si]),!0,{[Yo]:"a generic array"}),fv=Oo([],[Ei(Hl,Si,!0),Ei(sg,Si,!0)],{[Yo]:"a generic object"}),wt=(e,t)=>(e.push(t),e),X1=e=>{let t=`^${e.head}`;for(let r of e.spans)tc(r.type)?t+=".*":Dl(r.type)&&(t+="-?\\d+(\\.\\d+)?"),t+=r.literal;return t+="$",new RegExp(t)};function We(e){return e.sort(([t],[r])=>t>r?1:t<r?-1:0).map(([t,r])=>r)}var Sr=e=>{switch(e._tag){case"Declaration":return bi(e.typeParameters.map(Sr),e.type,e.decode,e.annotations);case"Tuple":return Jn(e.elements.map(t=>nc(Sr(t.type),t.isOptional)),Me(e.rest,is(Sr)),e.isReadonly);case"TypeLiteral":return Oo(e.propertySignatures.map(t=>Ne(t.name,Sr(t.type),t.isOptional,t.isReadonly,t.annotations)),e.indexSignatures.map(t=>Ei(t.parameter,Sr(t.type),t.isReadonly)));case"Union":return Co(e.types.map(Sr));case"Lazy":return sc(()=>Sr(e.f()));case"Refinement":return ic(e.from,e.decode,!e.isReversed,e.annotations);case"Transform":return ql(Sr(e.to),Sr(e.from),e.encode,e.decode,e.propertySignatureTransformations.map(t=>ac(t.to,t.from,t.encode,t.decode)))}return e};var sU=Symbol.for("@effect/schema/Schema");var lg=class{constructor(t){Nt(this,"ast");Nt(this,"_id",sU);Nt(this,"From");Nt(this,"To");this.ast=t}pipe(){return E(this,arguments)}},Ft=e=>new lg(e);var iU=e=>Ft(QT(e)),zl=(...e)=>Bl(...e.map(t=>iU(t)));var dv=(e,t,r,o)=>Ft(bi(e.map(n=>n.ast),t.ast,(...n)=>r(...n.map(Ft)),o)),Bl=(...e)=>Ft(Co(e.map(t=>t.ast)));var fg=e=>Ft(Jn([],d([e.ast]),!0));var Kl=class e{constructor(t,r,o){Nt(this,"_from");Nt(this,"_annotations");Nt(this,"_optional");Nt(this,"From");Nt(this,"FromIsOptional");Nt(this,"To");Nt(this,"ToIsOptional");this._from=t,this._annotations=r,this._optional=o}optional(){if(this._optional)throw new Error("duplicate optional configuration");return new e(this._from,this._annotations,{to:"optional"})}withDefault(t){if(this._optional&&this._optional.to!=="optional")throw new Error("duplicate optional configuration");return new e(this._from,this._annotations,{to:"default",value:t})}toOption(){if(this._optional&&this._optional.to!=="optional")throw new Error("duplicate optional configuration");return new e(this._from,this._annotations,{to:"Option"})}},aU=(e,t)=>new Kl(e.ast,t),Zn=(e,t)=>aU(e,t).optional(),Qn=e=>{let t=Xa(e),r=[],o=[],n=[],s=[];for(let i=0;i<t.length;i++){let c=t[i],p=e[c];if(p instanceof Kl){let u=p._optional;if(u)switch(u.to){case"optional":{r.push(Ne(c,p._from,!0,!0,p._annotations)),o.push(Ne(c,p._from,!0,!0)),n.push(Ne(c,Pe(p._from),!0,!0,p._annotations));break}case"default":{o.push(Ne(c,p._from,!0,!0)),n.push(Ne(c,Pe(p._from),!1,!0,p._annotations)),s.push(ac(c,c,ns(()=>d(u.value())),F));break}case"Option":{o.push(Ne(c,p._from,!0,!0)),n.push(Ne(c,yU(Ft(Pe(p._from))).ast,!1,!0,p._annotations)),s.push(ac(c,c,d,$g));break}}else r.push(Ne(c,p._from,!1,!0,p._annotations)),o.push(Ne(c,p._from,!1,!0)),n.push(Ne(c,Pe(p._from),!1,!0,p._annotations))}else r.push(Ne(c,p.ast,!1,!0)),o.push(Ne(c,p.ast,!1,!0)),n.push(Ne(c,Pe(p.ast),!1,!0))}return s.length>0?Ft(ov(Oo(o,[]),Oo(n,[]),s)):Ft(Oo(r,[]))};var cU=e=>{let t={};if(e?.typeId!==void 0){let r=e?.typeId;typeof r=="object"?(t[ng]=r.id,t[r.id]=r.params):t[ng]=r}return e?.message!==void 0&&(t[Ll]=e?.message),e?.identifier!==void 0&&(t[yi]=e?.identifier),e?.title!==void 0&&(t[nt]=e?.title),e?.description!==void 0&&(t[Yo]=e?.description),e?.examples!==void 0&&(t[VT]=e?.examples),e?.documentation!==void 0&&(t[JT]=e?.documentation),e?.jsonSchema!==void 0&&(t[YT]=e?.jsonSchema),e?.arbitrary!==void 0&&(t[Fl]=e?.arbitrary),t};function xv(e,t){return r=>{let o=s=>e(s)?Je(s):Xt(yr(n,s)),n=ic(r.ast,o,!1,cU(t));return Ft(n)}}var pU=a(4,(e,t,r,o)=>Ft(rv(e.ast,t.ast,r,o)));var uc=e=>t=>Ft(nv(t.ast,Yo,e));var Xn=Ft(Hl),mg=Ft(XT);var uU=()=>e=>e.date(),lU=()=>e=>`new Date(${JSON.stringify(e)})`,gv=dv([],Qn({}),()=>e=>Sc(e)?Je(e):Xt(yr(gv.ast,e)),{[yi]:"Date",[Qx]:lU,[Fl]:uU}),fU="@effect/schema/ValidDateTypeId",mU=e=>t=>t.pipe(xv(r=>!isNaN(r.getTime()),{typeId:fU,description:"a valid Date",...e})),hU=gv.pipe(mU()),hg=e=>pU(e,hU,r=>Je(new Date(r)),r=>Je(r.toISOString()));var dU=e=>t=>t.oneof(t.constant(x()),e(t).map(d)),xU=e=>De({onNone:()=>"none()",onSome:t=>`some(${e(t)})`}),gU=e=>Bl(Qn({_tag:zl("None")}),Qn({_tag:zl("Some"),value:e})),yU=e=>{let t=dv([e],gU(e),r=>{let o=cg(r);return(n,s)=>Bg(n)?z(n)?Je(x()):BT(o(n.value,s),d):Xt(yr(t.ast,n))},{[yi]:"Option",[Qx]:xU,[Fl]:dU});return t};var bU="@effect/schema/MaxLengthTypeId",lc=(e,t)=>r=>r.pipe(xv(o=>o.length<=e,{typeId:bU,description:`a string at most ${e} character(s) long`,jsonSchema:{maxLength:e},...t}));var Sv=Ri(require("fs/promises")),Ev=Ri(require("@actions/glob"));var Gl=require("@actions/core");var Pt=class extends di.TaggedClass("GenericError"){},yv=e=>j.sync(()=>((0,Gl.error)(e.message),(0,Gl.debug)(`cause: ${e.error}`),process.exitCode=1,j.unit));var _U=xt.string("INPUT_FILE").pipe(xt.map(e=>({_tag:"File",path:e})),xt.orElse(()=>xt.string("JSON").pipe(xt.map(e=>({_tag:"Json",stringified:e})))),xt.orElse(()=>ne(xt.all({key:xt.string("KEY"),value:xt.number("VALUE")}),xt.map(({key:e,value:t})=>({_tag:"KeyVal",key:e,value:t})))),xt.nested("INPUT")),_v=ne(j.config(_U),j.mapError(e=>new Pt({error:e,message:"Failed to read input"}))),Ov=e=>j.try({try:()=>JSON.parse(e),catch:t=>new Pt({message:"Failed to parse JSON",error:t})}),Cv=zl("lower-is-better","higher-is-better"),OU=Qn({key:ne(Xn,lc(120)),sortDate:ne(Xn,hg,Zn),value:mg,units:ne(Xn,lc(32),Zn),trend:ne(Cv,Zn)}),m$=Qn({metrics:ne(OU,fg)}),bv=Qn({key:ne(Xn,lc(120),uc("a key to identify the metric across runs")),value:ne(mg,uc("the value of the metric")),sortDate:ne(Xn,hg,uc("the date to apply sorting by. defaults to the commit time"),Zn),units:ne(Xn,lc(32),uc("the units of the metric. example: ms, MiB"),Zn),trend:ne(Cv,Zn)}),Rv=Bl(ne(bv,fg),bv),h$=ug(Rv),Av=e=>pg(Rv)(e).pipe(j.map(t=>[t].flat()),j.mapError(t=>new Pt({error:t,message:`Failed to parse given JSON:
${uv(t.errors)}`}))),CU=e=>j.tryPromise({try:()=>Sv.default.readFile(e,"utf-8"),catch:t=>new Pt({message:"Failed to read file",error:t})}).pipe(j.flatMap(Ov),j.flatMap(Av)),RU=e=>j.gen(function*(t){let r=yield*t(j.tryPromise({try:()=>Ev.create(e),catch:s=>new Pt({message:"Failed to parse glob syntax",error:s})})),o=yield*t(j.tryPromise({try:()=>r.glob(),catch:s=>new Pt({message:"Failed to iterate through glob",error:s})}));return(yield*t(j.all(o.map(CU),{concurrency:5}))).flat()}),Mv=ne(Za.type(),Za.tagsExhaustive({File:({path:e})=>RU(e),Json:({stringified:e})=>Ov(e).pipe(j.flatMap(Av)),KeyVal:({key:e,value:t})=>j.succeed([{key:e,value:t}])}));var Jv=require("@actions/http-client");var Tv=e=>e;var vv=(e=0)=>t=>`\x1B[${t+e}m`,Iv=(e=0)=>t=>`\x1B[${38+e};5;${t}m`,kv=(e=0)=>(t,r,o)=>`\x1B[${38+e};2;${t};${r};${o}m`,ae={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}},g$=Object.keys(ae.modifier),AU=Object.keys(ae.color),MU=Object.keys(ae.bgColor),y$=[...AU,...MU];function TU(){let e=new Map;for(let[t,r]of Object.entries(ae)){for(let[o,n]of Object.entries(r))ae[o]={open:`\x1B[${n[0]}m`,close:`\x1B[${n[1]}m`},r[o]=ae[o],e.set(n[0],n[1]);Object.defineProperty(ae,t,{value:r,enumerable:!1})}return Object.defineProperty(ae,"codes",{value:e,enumerable:!1}),ae.color.close="\x1B[39m",ae.bgColor.close="\x1B[49m",ae.color.ansi=vv(),ae.color.ansi256=Iv(),ae.color.ansi16m=kv(),ae.bgColor.ansi=vv(10),ae.bgColor.ansi256=Iv(10),ae.bgColor.ansi16m=kv(10),Object.defineProperties(ae,{rgbToAnsi256:{value(t,r,o){return t===r&&r===o?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(o/255*5)},enumerable:!1},hexToRgb:{value(t){let r=/[a-f\d]{6}|[a-f\d]{3}/i.exec(t.toString(16));if(!r)return[0,0,0];let[o]=r;o.length===3&&(o=[...o].map(s=>s+s).join(""));let n=Number.parseInt(o,16);return[n>>16&255,n>>8&255,n&255]},enumerable:!1},hexToAnsi256:{value:t=>ae.rgbToAnsi256(...ae.hexToRgb(t)),enumerable:!1},ansi256ToAnsi:{value(t){if(t<8)return 30+t;if(t<16)return 90+(t-8);let r,o,n;if(t>=232)r=((t-232)*10+8)/255,o=r,n=r;else{t-=16;let c=t%36;r=Math.floor(t/36)/5,o=Math.floor(c/6)/5,n=c%6/5}let s=Math.max(r,o,n)*2;if(s===0)return 30;let i=30+(Math.round(n)<<2|Math.round(o)<<1|Math.round(r));return s===2&&(i+=60),i},enumerable:!1},rgbToAnsi:{value:(t,r,o)=>ae.ansi256ToAnsi(ae.rgbToAnsi256(t,r,o)),enumerable:!1},hexToAnsi:{value:t=>ae.ansi256ToAnsi(ae.hexToAnsi256(t)),enumerable:!1}}),ae}var vU=TU(),Er=vU;var Vl=Ri(require("process"),1),Fv=Ri(require("os"),1),dg=Ri(require("tty"),1);function tr(e,t=globalThis.Deno?globalThis.Deno.args:Vl.default.argv){let r=e.startsWith("-")?"":e.length===1?"-":"--",o=t.indexOf(r+e),n=t.indexOf("--");return o!==-1&&(n===-1||o<n)}var{env:le}=Vl.default,$l;tr("no-color")||tr("no-colors")||tr("color=false")||tr("color=never")?$l=0:(tr("color")||tr("colors")||tr("color=true")||tr("color=always"))&&($l=1);function IU(){if("FORCE_COLOR"in le)return le.FORCE_COLOR==="true"?1:le.FORCE_COLOR==="false"?0:le.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(le.FORCE_COLOR,10),3)}function kU(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function wU(e,{streamIsTTY:t,sniffFlags:r=!0}={}){let o=IU();o!==void 0&&($l=o);let n=r?$l:o;if(n===0)return 0;if(r){if(tr("color=16m")||tr("color=full")||tr("color=truecolor"))return 3;if(tr("color=256"))return 2}if("TF_BUILD"in le&&"AGENT_NAME"in le)return 1;if(e&&!t&&n===void 0)return 0;let s=n||0;if(le.TERM==="dumb")return s;if(Vl.default.platform==="win32"){let i=Fv.default.release().split(".");return Number(i[0])>=10&&Number(i[2])>=10586?Number(i[2])>=14931?3:2:1}if("CI"in le)return"GITHUB_ACTIONS"in le||"GITEA_ACTIONS"in le?3:["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some(i=>i in le)||le.CI_NAME==="codeship"?1:s;if("TEAMCITY_VERSION"in le)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(le.TEAMCITY_VERSION)?1:0;if(le.COLORTERM==="truecolor"||le.TERM==="xterm-kitty")return 3;if("TERM_PROGRAM"in le){let i=Number.parseInt((le.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(le.TERM_PROGRAM){case"iTerm.app":return i>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(le.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(le.TERM)||"COLORTERM"in le?1:s}function wv(e,t={}){let r=wU(e,{streamIsTTY:e&&e.isTTY,...t});return kU(r)}var FU={stdout:wv({isTTY:dg.default.isatty(1)}),stderr:wv({isTTY:dg.default.isatty(2)})},Pv=FU;function Nv(e,t,r){let o=e.indexOf(t);if(o===-1)return e;let n=t.length,s=0,i="";do i+=e.slice(s,o)+t+r,s=o+n,o=e.indexOf(t,s);while(o!==-1);return i+=e.slice(s),i}function Dv(e,t,r,o){let n=0,s="";do{let i=e[o-1]==="\r";s+=e.slice(n,i?o-1:o)+t+(i?`\r
`:`
`)+r,n=o+1,o=e.indexOf(`
`,n)}while(o!==-1);return s+=e.slice(n),s}var{stdout:Lv,stderr:Hv}=Pv,xg=Symbol("GENERATOR"),_i=Symbol("STYLER"),fc=Symbol("IS_EMPTY"),qv=["ansi","ansi","ansi256","ansi16m"],Oi=Object.create(null),PU=(e,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");let r=Lv?Lv.level:0;e.level=t.level===void 0?r:t.level},Yl=class{constructor(t){return Uv(t)}},Uv=e=>{let t=(...r)=>r.join(" ");return PU(t,e),Object.setPrototypeOf(t,mc.prototype),t};function mc(e){return Uv(e)}Object.setPrototypeOf(mc.prototype,Function.prototype);for(let[e,t]of Object.entries(Er))Oi[e]={get(){let r=Jl(this,yg(t.open,t.close,this[_i]),this[fc]);return Object.defineProperty(this,e,{value:r}),r}};Oi.visible={get(){let e=Jl(this,this[_i],!0);return Object.defineProperty(this,"visible",{value:e}),e}};var gg=(e,t,r,...o)=>e==="rgb"?t==="ansi16m"?Er[r].ansi16m(...o):t==="ansi256"?Er[r].ansi256(Er.rgbToAnsi256(...o)):Er[r].ansi(Er.rgbToAnsi(...o)):e==="hex"?gg("rgb",t,r,...Er.hexToRgb(...o)):Er[r][e](...o),NU=["rgb","hex","ansi256"];for(let e of NU){Oi[e]={get(){let{level:r}=this;return function(...o){let n=yg(gg(e,qv[r],"color",...o),Er.color.close,this[_i]);return Jl(this,n,this[fc])}}};let t="bg"+e[0].toUpperCase()+e.slice(1);Oi[t]={get(){let{level:r}=this;return function(...o){let n=yg(gg(e,qv[r],"bgColor",...o),Er.bgColor.close,this[_i]);return Jl(this,n,this[fc])}}}}var DU=Object.defineProperties(()=>{},{...Oi,level:{enumerable:!0,get(){return this[xg].level},set(e){this[xg].level=e}}}),yg=(e,t,r)=>{let o,n;return r===void 0?(o=e,n=t):(o=r.openAll+e,n=t+r.closeAll),{open:e,close:t,openAll:o,closeAll:n,parent:r}},Jl=(e,t,r)=>{let o=(...n)=>LU(o,n.length===1?""+n[0]:n.join(" "));return Object.setPrototypeOf(o,DU),o[xg]=e,o[_i]=t,o[fc]=r,o},LU=(e,t)=>{if(e.level<=0||!t)return e[fc]?"":t;let r=e[_i];if(r===void 0)return t;let{openAll:o,closeAll:n}=r;if(t.includes("\x1B"))for(;r!==void 0;)t=Nv(t,r.close,r.open),r=r.parent;let s=t.indexOf(`
`);return s!==-1&&(t=Dv(t,n,o,s)),o+t+n};Object.defineProperties(mc.prototype,Oi);var R$=mc(),A$=mc({level:Hv?Hv.level:0});var Ql=kl.Tag(),Wv=j.sync(()=>new Yl({level:2}));function zv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,o)}return r}function Kv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?zv(Object(r),!0).forEach(function(o){HU(e,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zv(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))})}return e}function HU(e,t,r){return t=qU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function qU(e){var t=UU(e,"string");return typeof t=="symbol"?t:String(t)}function UU(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var o=r.call(e,t||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Bv=Gv({});function Gv(e){return t.withOptions=r=>Gv(Kv(Kv({},e),r)),t;function t(r,...o){let n=typeof r=="string"?[r]:r.raw,{escapeSpecialCharacters:s=Array.isArray(r)}=e,i="";for(let u=0;u<n.length;u++){let f=n[u];s&&(f=f.replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`").replace(/\\\$/g,"$").replace(/\\{/g,"{")),i+=f,u<o.length&&(i+=o[u])}let c=i.split(`
`),p=null;for(let u of c){let f=u.match(/^(\s+)\S+/);if(f){let m=f[1].length;p?p=Math.min(p,m):p=m}}if(p!==null){let u=p;i=c.map(f=>f[0]===" "||f[0]==="	"?f.slice(u):f).join(`
`)}return i.trim().replace(/\\n/g,`
`)}}var $v=require("@actions/core"),bg=class extends di.TaggedClass("IdTokenError"){},Vv=e=>j.gen(function*(t){let r=yield*t(Ql),o=r.cyan("`id-token`"),n=Bv`
      Failed to read GitHub Actions ID token.

      This means you probably forgot to add permissions for ${o} in your workflow/job definition.
      The ${o} permissions allows GitHub to sign your requests to the Benchy API. This does not
      give GitHub access to your Benchy account: it's merely a way to prove that the request is coming
      from your GitHub workflow.

      An example of a workflow with the ${o} permission:

      \`\`\`yaml
       jobs:
         test:
           runs-on: ubuntu-latest
      ${r.green("+    permissions:")}
      ${r.green("+      id-token: write")}
           steps:
             # ...
      \`\`\`

      For more information about the ${o} permisison, see the GitHub documentation on OpenID Connect: https://docs.github.com/en/actions/deployment/security-hardening-your-deployments/about-security-hardening-with-openid-connect#overview-of-openid-connect
   `;return yield*t(j.fail(new Pt({message:n,error:e.error})))}),Yv=j.tryPromise({try:()=>(0,$v.getIDToken)(),catch:e=>new bg({error:e})});var jU=j.gen(function*(e){let t=yield*e(Yv);return new Jv.HttpClient("bnz-action",[],{headers:{Authorization:`Bearer ${t}`}})}),zU=j.gen(function*(e){let t=yield*e(_v),r=yield*e(Mv(t)),o=yield*e(jU),n=yield*e(j.tryPromise({try:()=>o.postJson("https://bnz-web.vercel.app/api/metrics",{metrics:r}),catch:s=>new Pt({message:"Failed to send metrics",error:s})}));console.log("received",n)});zU.pipe(j.catchTag("IdTokenError",e=>Vv(e)),j.catchTag("GenericError",e=>yv(e)),Tv,j.provideServiceEffect(Ql,Wv),j.runPromise);
