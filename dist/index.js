"use strict";var qv=Object.create;var mc=Object.defineProperty;var Uv=Object.getOwnPropertyDescriptor;var Wv=Object.getOwnPropertyNames;var jv=Object.getPrototypeOf,zv=Object.prototype.hasOwnProperty;var Kv=(e,t,r)=>t in e?mc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var hc=(e,t)=>{for(var r in t)mc(e,r,{get:t[r],enumerable:!0})},Bv=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of Wv(t))!zv.call(e,n)&&n!==r&&mc(e,n,{get:()=>t[n],enumerable:!(o=Uv(t,n))||o.enumerable});return e};var _i=(e,t,r)=>(r=e!=null?qv(jv(e)):{},Bv(t||!e||!e.__esModule?mc(r,"default",{value:e,enumerable:!0}):r,e));var Ft=(e,t,r)=>(Kv(e,typeof t!="symbol"?t+"":t,r),r);var dg=e=>typeof e=="function",a=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):r=>t(r,...arguments)};switch(e){case 0:return t;case 1:return function(r){return arguments.length>=1?t(r):function(){return t(r)}};case 2:return function(r,o){return arguments.length>=2?t(r,o):function(n){return t(n,r)}};case 3:return function(r,o,n){return arguments.length>=3?t(r,o,n):function(s){return t(s,r,o)}};case 4:return function(r,o,n,s){return arguments.length>=4?t(r,o,n,s):function(i){return t(i,r,o,n)}};case 5:return function(r,o,n,s,i){return arguments.length>=5?t(r,o,n,s,i):function(c){return t(c,r,o,n,s)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(o){return t(o,...r)}}}};var F=e=>e;var Oi=e=>()=>e,_r=Oi(!0),Pt=Oi(!1);var dc=Oi(void 0),Xn=dc;function ne(e,t,r,o,n,s,i,c,p){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return o(r(t(e)));case 5:return n(o(r(t(e))));case 6:return s(n(o(r(t(e)))));case 7:return i(s(n(o(r(t(e))))));case 8:return c(i(s(n(o(r(t(e)))))));case 9:return p(c(i(s(n(o(r(t(e))))))));default:{let u=arguments[0];for(let f=1;f<arguments.length;f++)u=arguments[f](u);return u}}}var xc=e=>(t,r)=>t===r||e(t,r);var xg=a(2,(e,t)=>xc((r,o)=>e(t(r),t(o))));var gg=e=>xc((t,r)=>{if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(!e(t[o],r[o]))return!1;return!0});var gc=e=>(t,r)=>t===r?0:e(t,r);var yg=gc((e,t)=>e<t?-1:1);var bg=e=>gc((t,r)=>e(r,t));var Ci=a(2,(e,t)=>gc((r,o)=>e(t(r),t(o))));var Gv=e=>gc((t,r)=>{let o=Math.min(t.length,r.length),n=0;for(let s of e){if(n>=o)break;let i=s(t[n],r[n]);if(i!==0)return i;n++}return 0});var Sg=(...e)=>Gv(e);var Ql=e=>a(2,(t,r)=>e(t,r)===1);var Zl=e=>a(2,(t,r)=>t===r||e(t,r)>-1?t:r);var Ri=e=>typeof e=="string",Jo=e=>typeof e=="number",yc=e=>typeof e=="boolean",es=e=>typeof e=="bigint",Eg=e=>typeof e=="symbol",_g=dg,Ai=e=>e===void 0;var Og=e=>e===null;var Cg=e=>!1;var pe=e=>typeof e=="object"&&e!=null||_g(e);var Qo=e=>e==null,Rg=e=>e!=null;var bc=e=>e instanceof Date,Nt=e=>pe(e)&&Symbol.iterator in e,Mi=e=>pe(e)&&!Array.isArray(e);var Ag=e=>!e;var Vv=335903614,Yv=4150755663,Jv=1481765933,Qv=1284865837,Zv=9007199254740992,Xv=134217728,ts=class{constructor(t,r,o,n){return Qo(r)&&Qo(t)?(r=Math.random()*4294967295>>>0,t=0):Qo(r)&&(r=t,t=0),Qo(n)&&Qo(o)?(n=this._state?this._state[3]:Yv,o=this._state?this._state[2]:Vv):Qo(n)&&(n=o,o=0),this._state=new Int32Array([0,0,o>>>0,((n||0)|1)>>>0]),this._next(),Mg(this._state,this._state[0],this._state[1],t>>>0,r>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){if(!t)return this._next();if(t=t>>>0,!(t&t-1))return this._next()&t-1;let r=0,o=(-t>>>0)%t>>>0;for(r=this._next();r<o;r=this._next());return r%t}number(){let t=(this._next()&67108863)*1,r=(this._next()&134217727)*1;return(t*Xv+r)/Zv}_next(){let t=this._state[0]>>>0,r=this._state[1]>>>0;eI(this._state,t,r,Jv,Qv),Mg(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let o=t>>>18,n=(r>>>18|t<<14)>>>0;o=(o^t)>>>0,n=(n^r)>>>0;let s=(n>>>27|o<<5)>>>0,i=t>>>27,c=(-i>>>0&31)>>>0;return(s>>>i|s<<c)>>>0}};function eI(e,t,r,o,n){let s=(r>>>16)*(n&65535)>>>0,i=(r&65535)*(n>>>16)>>>0,c=(r&65535)*(n&65535)>>>0,p=(r>>>16)*(n>>>16)+((i>>>16)+(s>>>16))>>>0;i=i<<16>>>0,c=c+i>>>0,c>>>0<i>>>0&&(p=p+1>>>0),s=s<<16>>>0,c=c+s>>>0,c>>>0<s>>>0&&(p=p+1>>>0),p=p+Math.imul(r,o)>>>0,p=p+Math.imul(t,n)>>>0,e[0]=p,e[1]=c}function Mg(e,t,r,o,n){let s=t+o>>>0,i=r+n>>>0;i>>>0<r>>>0&&(s=s+1|0),e[0]=s,e[1]=i}var tf=Symbol.for("@effect/data/Global/globalStoreId");tf in globalThis||(globalThis[tf]=new Map);var ef=globalThis[tf],z=(e,t)=>(ef.has(e)||ef.set(e,t()),ef.get(e));var rf=z(Symbol.for("@effect/data/Hash/randomHashCache"),()=>new WeakMap),oI=z(Symbol.for("@effect/data/Hash/pcgr"),()=>new ts),A=Symbol.for("@effect/data/Hash"),S=e=>{switch(typeof e){case"number":return Ec(e);case"bigint":return ke(e.toString(10));case"boolean":return ke(String(e));case"symbol":return ke(String(e));case"string":return ke(e);case"undefined":return ke("undefined");case"function":case"object":return e===null?ke("null"):nI(e)?e[A]():Ro(e);default:throw new Error("Bug in Equal.hash")}},Ro=e=>(rf.has(e)||rf.set(e,Ec(oI.integer(Number.MAX_SAFE_INTEGER))),rf.get(e)),I=e=>t=>t*53^e,Sc=e=>e&3221225471|e>>>1&1073741824,nI=e=>typeof e=="object"&&e!==null&&A in e,Ec=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return Sc(e)},ke=e=>{let t=5381,r=e.length;for(;r;)t=t*33^e.charCodeAt(--r);return Sc(t)},sI=(e,t)=>{let r=12289;for(let o=0;o<t.length;o++)r^=I(S(e[t[o]]))(ke(t[o]));return Sc(r)},vi=e=>sI(e,Object.keys(e)),Qr=e=>{let t=6151;for(let r=0;r<e.length;r++)t=I(S(e[r]))(t);return Sc(t)};var M=Symbol.for("@effect/data/Equal");function O(){return arguments.length===1?e=>Tg(e,arguments[0]):Tg(arguments[0],arguments[1])}function Tg(e,t){if(e===t)return!0;let r=typeof e;return r!==typeof t?!1:(r==="object"||r==="function")&&e!==null&&t!==null&&rs(e)&&rs(t)?S(e)===S(t)&&e[M](t):!1}var rs=e=>typeof e=="object"&&e!==null&&M in e,_c=()=>(e,t)=>S(e)===S(t)&&O(e,t);var Ao=Symbol.for("@effect/io/Effect"),Mo={_R:e=>e,_E:e=>e,_A:e=>e};var E=(e,t)=>{switch(t.length){case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let o=0,n=t.length;o<n;o++)r=t[o](r);return r}}};var vg,Ig,Oc=Symbol.for("@effect/data/Option"),of=class{[(vg=Ao,M)](t){return kg(t)&&af(t)&&O(t.i0,this.i0)}[A](){return S(this.i0)}toString(){return`Some(${String(this.i0)})`}toJSON(){return{_tag:this._tag,value:this.i0}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}get[Oc](){return{_A:t=>t}}get value(){return this.i0}constructor(t){this.i0=t,this._tag="Some",this._id=Oc,this.i1=void 0,this.i2=void 0,this[vg]=Mo}pipe(){return E(this,arguments)}},nf=class{constructor(){this._tag="None",this._id=Oc,this.i0=void 0,this.i1=void 0,this.i2=void 0,this[Ig]=Mo}[(Ig=Ao,M)](t){return kg(t)&&sf(t)}[A](){return S(this._tag)}toString(){return"None()"}toJSON(){return{_tag:this._tag}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}get[Oc](){return{_A:t=>t}}pipe(){return E(this,arguments)}},kg=e=>typeof e=="object"&&e!=null&&"_tag"in e&&(e._tag==="None"||e._tag==="Some")&&rs(e),sf=e=>e._tag==="None",af=e=>e._tag==="Some",wg=new nf,Fg=e=>new of(e);var Pg,Ng,Cc=Symbol.for("@effect/data/Either"),cf=class{[(Pg=Ao,M)](t){return Dg(t)&&lf(t)&&O(t.i0,this.i0)}[A](){return S(this.i0)}get right(){return this.i0}constructor(t){this.i0=t,this._tag="Right",this._id=Cc,this.i1=void 0,this.i2=void 0,this[Pg]=Mo}get[Cc](){return{_E:t=>t,_A:t=>t}}toString(){return`right(${String(this.i0)})`}toJSON(){return{_tag:this._tag,right:this.i0}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},pf=class{[(Ng=Ao,M)](t){return Dg(t)&&uf(t)&&O(t.i0,this.i0)}[A](){return S(this.i0)}get[Cc](){return{_E:t=>t,_A:t=>t}}get left(){return this.i0}constructor(t){this.i0=t,this._tag="Left",this._id=Cc,this.i1=void 0,this.i2=void 0,this[Ng]=Mo}toString(){return`left(${String(this.i0)})`}toJSON(){return{_tag:this._tag,left:this.i0}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},Dg=e=>typeof e=="object"&&e!=null&&"_tag"in e&&(e._tag==="Left"||e._tag==="Right")&&rs(e),uf=e=>e._tag==="Left",lf=e=>e._tag==="Right",Lg=e=>new pf(e),Hg=e=>new cf(e);var pI=Symbol.for("@effect/data/Either"),P=Hg,q=Lg;var Rc=e=>pe(e)&&"_id"in e&&e._id===pI,Ae=uf,Or=lf;var Ac=a(2,(e,{onLeft:t,onRight:r})=>Ae(e)?t(e.left):r(e.right)),Mc=Ac({onLeft:F,onRight:F});var yt=yg;var mI=Symbol.for("@effect/data/Option"),x=()=>wg,d=Fg,qg=e=>pe(e)&&"_id"in e&&e._id===mI,j=sf,N=af,De=a(2,(e,{onNone:t,onSome:r})=>j(e)?t():r(e.value));var $=a(2,(e,t)=>j(e)?t():e.value),os=a(2,(e,t)=>j(e)?t():e);var Dt=e=>e==null?x():d(e);var je=$(dc);var hI=a(2,(e,t)=>{if(N(e))return e.value;throw t()}),Ug=hI(()=>new Error("getOrThrow called on a None")),Me=a(2,(e,t)=>j(e)?x():d(t(e.value)));var ns=a(2,(e,t)=>j(e)?x():t(e.value));var Wg=ns(F);var dI=e=>a(2,(t,r)=>j(t)?!1:e(t.value,r)),xI=_c(),jg=dI(xI);var ff=e=>e.length>0;var mf=(e,t)=>{let r=Math.max(1,Math.floor(e)),o=[t(0)];for(let n=1;n<r;n++)o.push(t(n));return o};var J=e=>Array.isArray(e)?e:Array.from(e);var rr=a(2,(e,t)=>[t,...e]);var zg=a(2,(e,t)=>[...e,t]);var yI=e=>e.length===0,hf=yI,vc=ff,Cr=ff;var Kg=(e,t)=>e<0||e>=t.length;var bI=a(2,(e,t)=>{let r=Math.floor(t);return Kg(r,e)?x():d(e[r])}),df=a(2,(e,t)=>{let r=Math.floor(t);if(Kg(r,e))throw new Error(`Index ${r} out of bounds`);return e[r]});var Ic=bI(0),_e=df(0),Bg=e=>Cr(e)?d(SI(e)):x(),SI=e=>e[e.length-1];var Lt=e=>e.slice(1);var xf=e=>Array.from(e).reverse();var Zo=a(2,(e,t)=>{let r=Array.from(e);return r.sort(t),r});var gf=a(2,(e,t)=>Gg(e,t,(r,o)=>[r,o])),Gg=a(3,(e,t,r)=>{let o=J(e),n=J(t);return Cr(o)&&Cr(n)?EI(n,r)(o):[]});var EI=a(3,(e,t,r)=>{let o=[r(_e(e),_e(t))],n=Math.min(e.length,t.length);for(let s=1;s<n;s++)o[s]=r(e[s],t[s]);return o});var _I=a(2,(e,t)=>{let r=[_e(e)],o=Lt(e);for(let n of o)r.every(s=>!t(n,s))&&r.push(n);return r});var Xo=()=>[],bt=e=>[e],Zr=a(2,(e,t)=>e.map(t)),ss=Zr,kc=a(2,(e,t)=>{if(hf(e))return[];let r=[];for(let o=0;o<e.length;o++)r.push(...t(e[o],o));return r});var wc=kc(F);var Ii=a(2,(e,t)=>{let r=J(e),o=[];for(let n=0;n<r.length;n++){let s=t(r[n],n);N(s)&&o.push(s.value)}return o});var $g=Ii(F);var it=a(3,(e,t,r)=>J(e).reduce((o,n,s)=>r(o,n,s),t)),Fc=a(3,(e,t,r)=>J(e).reduceRight((o,n,s)=>r(o,n,s),t));var yf=(e,t)=>{let r=[],o=e,n;for(;N(n=t(o));){let[s,i]=n.value;r.push(s),o=i}return r};var Vg=gg;var OI=a(2,(e,t)=>{let r=J(e);return Cr(r)?_I(t)(r):[]}),Yg=OI(_c());var Xr=a(2,(e,t)=>J(e).join(t));var Jg,Qg=Symbol.for("@effect/data/Context/Tag"),Pc=class{[(Jg=Ao,M)](t){return this===t}[A](){return Ro(this)}get[Qg](){return{_S:t=>t,_I:t=>t}}constructor(t){this._tag="Tag",this.i0=void 0,this.i1=void 0,this.i2=void 0,this[Jg]=Mo;let r=Error.stackTraceLimit;if(Error.stackTraceLimit=3,this.creationError=new Error,Error.stackTraceLimit=r,typeof t<"u")return this.i0=t,z(t,()=>this)}get stack(){return this.creationError.stack}toString(){return JSON.stringify(this)}toJSON(){return{_tag:"Tag",identifier:this.i0,stack:this.stack}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}of(t){return t}context(t){return Sf(this,t)}},bf=Symbol.for("@effect/data/Context"),eo=class{[M](t){if(Zg(t)&&this.unsafeMap.size===t.unsafeMap.size){for(let r of this.unsafeMap.keys())if(!t.unsafeMap.has(r)||!O(this.unsafeMap.get(r),t.unsafeMap.get(r)))return!1;return!0}return!1}[A](){return Ec(this.unsafeMap.size)}constructor(t){this.unsafeMap=t,this._id=bf,this._S=r=>r}pipe(){return E(this,arguments)}},CI=e=>{let t=new Error(`Service not found${e.i0?`: ${String(e.i0)}`:""}`);if(e.stack){let r=e.stack.split(`
`);if(r.length>2){let o=r[3].match(/at (.*)/);o&&(t.message=t.message+` (defined at ${o[1]})`)}}if(t.stack){let r=t.stack.split(`
`);r.splice(1,3),t.stack=r.join(`
`)}return t},Zg=e=>typeof e=="object"&&e!==null&&"_id"in e&&e._id===bf;var Xg=()=>new eo(new Map),Sf=(e,t)=>new eo(new Map([[e,t]])),ey=a(3,(e,t,r)=>{let o=new Map(e.unsafeMap);return o.set(t,r),new eo(o)}),Ef=a(2,(e,t)=>{if(!e.unsafeMap.has(t))throw CI(t);return e.unsafeMap.get(t)}),ty=Ef,ry=a(2,(e,t)=>e.unsafeMap.has(t)?d(e.unsafeMap.get(t)):x()),oy=a(2,(e,t)=>{let r=new Map(e.unsafeMap);for(let[o,n]of t.unsafeMap)r.set(o,n);return new eo(r)});var St=e=>new Pc(e);var Ht=Xg,_f=Sf,we=ey,to=ty,ki=Ef,ny=ry,is=oy;var AI=(()=>{let e={[A](){return Qr(this)},[M](t){return Array.isArray(t)&&this.length===t.length?this.every((r,o)=>O(r,t[o])):!1}};return Object.setPrototypeOf(e,Array.prototype)})(),MI=(()=>{let e={[A](){return vi(this)},[M](t){let r=Object.keys(this),o=Object.keys(t);if(r.length!==o.length)return!1;for(let n of r)if(!(n in t&&O(this[n],t[n])))return!1;return!0}};return Object.setPrototypeOf(e,Object.prototype)})(),ro=e=>sy(Object.assign({},e)),sy=e=>Object.setPrototypeOf(e,MI),TI=(...e)=>Of(e),vI=e=>Of(e.slice(0)),Of=e=>Object.setPrototypeOf(e,AI),II=()=>e=>ro(e===void 0?{}:e);var iy=e=>t=>ro(t===void 0?{_tag:e}:{...t,_tag:e}),kI=e=>{class t extends ay{constructor(){super(...arguments),this._tag=e}}return t},ay=(()=>{class e{constructor(r){r&&Object.assign(this,r)}[A](){return vi(this)}[M](r){let o=Object.keys(this),n=Object.keys(r);if(o.length!==n.length)return!1;for(let s of o)if(!(s in r&&O(this[s],r[s])))return!1;return!0}}return e})(),wI=()=>iy;var ly=Symbol.for("@effect/data/Duration"),PI=BigInt(1e3),cy=BigInt(1e9),py=/^(-?\d+(?:\.\d+)?)\s+(nanos|micros|millis|seconds|minutes|hours|days|weeks)$/,ze=e=>{if(fy(e))return e;if(Jo(e))return as(e);if(es(e))return Nc(e);{py.lastIndex=0;let t=py.exec(e);if(t){let[r,o,n]=t,s=Number(o);switch(n){case"nanos":return Nc(BigInt(o));case"micros":return DI(BigInt(o));case"millis":return as(s);case"seconds":return Rf(s);case"minutes":return LI(s);case"hours":return HI(s);case"days":return qI(s);case"weeks":return UI(s)}}}throw new Error("Invalid duration input")},uy={_tag:"Millis",millis:0},NI={_tag:"Infinity"},or=class{constructor(t){this._id=ly,Jo(t)?isNaN(t)||t<0?this.value=uy:Number.isFinite(t)?Number.isInteger(t)?this.value={_tag:"Millis",millis:t}:this.value={_tag:"Nanos",nanos:BigInt(Math.round(t*1e6))}:this.value=NI:t<BigInt(0)?this.value=uy:this.value={_tag:"Nanos",nanos:t}}[A](){return vi(this.value)}[M](t){return fy(t)&&zI(this,t)}toString(){switch(this.value._tag){case"Millis":return`Duration("${this.value.millis} millis")`;case"Nanos":return`Duration("${this.value.nanos} nanos")`;case"Infinity":return"Duration(Infinity)"}}toJSON(){return this.value._tag==="Nanos"?{_tag:"Duration",value:{_tag:"Nanos",hrtime:WI(this)}}:{_tag:"Duration",value:this.value}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},fy=e=>pe(e)&&"_id"in e&&e._id===ly,Cf=new or(0);var Nc=e=>new or(e),DI=e=>new or(e*PI),as=e=>new or(e),Rf=e=>new or(e*1e3),LI=e=>new or(e*6e4),HI=e=>new or(e*36e5),qI=e=>new or(e*864e5),UI=e=>new or(e*6048e5),Rr=e=>{let t=ze(e);switch(t.value._tag){case"Infinity":return 1/0;case"Nanos":return Number(t.value.nanos)/1e6;case"Millis":return t.value.millis}};var WI=e=>{let t=ze(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/cy),Number(t.value.nanos%cy)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}};var my=a(3,(e,t,r)=>{let o=ze(e),n=ze(t);if(o.value._tag==="Infinity"||n.value._tag==="Infinity")return r.onMillis(Rr(o),Rr(n));if(o.value._tag==="Nanos"||n.value._tag==="Nanos"){let s=o.value._tag==="Nanos"?o.value.nanos:BigInt(Math.round(o.value.millis*1e6)),i=n.value._tag==="Nanos"?n.value.nanos:BigInt(Math.round(n.value.millis*1e6));return r.onNanos(s,i)}return r.onMillis(o.value.millis,n.value.millis)});var jI=(e,t)=>my(e,t,{onMillis:(r,o)=>r===o,onNanos:(r,o)=>r===o});var Af=a(2,(e,t)=>my(e,t,{onMillis:(r,o)=>r>=o,onNanos:(r,o)=>r>=o})),zI=a(2,(e,t)=>jI(ze(e),ze(t)));var Mf=Math.pow(2,5),hy=Mf-1,dy=Mf/2,xy=Mf/4;function KI(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function To(e,t){return t>>>e&hy}function vo(e){return 1<<e}function Dc(e,t){return KI(e&t-1)}function tn(e,t,r,o){let n=o;if(!e){let s=o.length;n=new Array(s);for(let i=0;i<s;++i)n[i]=o[i]}return n[t]=r,n}function Tf(e,t,r){let o=r.length-1,n=0,s=0,i=r;if(e)n=s=t;else for(i=new Array(o);n<t;)i[s++]=r[n++];for(++n;n<=o;)i[s++]=r[n++];return e&&(i.length=o),i}function gy(e,t,r,o){let n=o.length;if(e){let p=n;for(;p>=t;)o[p--]=o[p];return o[t]=r,o}let s=0,i=0,c=new Array(n+1);for(;s<t;)c[i++]=o[s++];for(c[t]=r;s<n;)c[++i]=o[s++];return c}var Lc=class{constructor(t,r){this.value=t,this.previous=r}};var Ar=class e{constructor(){this._tag="EmptyNode"}modify(t,r,o,n,s,i){let c=o(x());return j(c)?new e:(++i.value,new cs(t,n,s,c))}};function qt(e){return e instanceof Ar}function BI(e){return qt(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function Hc(e,t){return qt(e)?!1:t===e.edit}var cs=class e{constructor(t,r,o,n){this.edit=t,this.hash=r,this.key=o,this.value=n,this._tag="LeafNode"}modify(t,r,o,n,s,i){if(O(s,this.key)){let p=o(this.value);return p===this.value?this:j(p)?(--i.value,new Ar):Hc(this,t)?(this.value=p,this):new e(t,n,s,p)}let c=o(x());return j(c)?this:(++i.value,yy(t,r,this.hash,this,n,new e(t,n,s,c)))}},vf=class e{constructor(t,r,o){this.edit=t,this.hash=r,this.children=o,this._tag="CollisionNode"}modify(t,r,o,n,s,i){if(n===this.hash){let p=Hc(this,t),u=this.updateCollisionList(p,t,this.hash,this.children,o,s,i);return u===this.children?this:u.length>1?new e(t,this.hash,u):u[0]}let c=o(x());return j(c)?this:(++i.value,yy(t,r,this.hash,this,n,new cs(t,n,s,c)))}updateCollisionList(t,r,o,n,s,i,c){let p=n.length;for(let f=0;f<p;++f){let m=n[f];if("key"in m&&O(i,m.key)){let y=m.value,b=s(y);return b===y?n:j(b)?(--c.value,Tf(t,f,n)):tn(t,f,new cs(r,o,i,b),n)}}let u=s(x());return j(u)?n:(++c.value,tn(t,p,new cs(r,o,i,u),n))}},wi=class e{constructor(t,r,o){this.edit=t,this.mask=r,this.children=o,this._tag="IndexedNode"}modify(t,r,o,n,s,i){let c=this.mask,p=this.children,u=To(r,n),f=vo(u),m=Dc(c,f),y=c&f,b=Hc(this,t);if(!y){let H=new Ar().modify(t,r+5,o,n,s,i);return H?p.length>=dy?$I(t,u,H,c,p):new e(t,c|f,gy(b,m,H,p)):this}let C=p[m],R=C.modify(t,r+5,o,n,s,i);if(C===R)return this;let v=c,w;if(qt(R)){if(v&=~f,!v)return new Ar;if(p.length<=2&&BI(p[m^1]))return p[m^1];w=Tf(b,m,p)}else w=tn(b,m,R,p);return b?(this.mask=v,this.children=w,this):new e(t,v,w)}},If=class e{constructor(t,r,o){this.edit=t,this.size=r,this.children=o,this._tag="ArrayNode"}modify(t,r,o,n,s,i){let c=this.size,p=this.children,u=To(r,n),f=p[u],m=(f||new Ar).modify(t,r+5,o,n,s,i);if(f===m)return this;let y=Hc(this,t),b;if(qt(f)&&!qt(m))++c,b=tn(y,u,m,p);else if(!qt(f)&&qt(m)){if(--c,c<=xy)return GI(t,c,u,p);b=tn(y,u,new Ar,p)}else b=tn(y,u,m,p);return y?(this.size=c,this.children=b,this):new e(t,c,b)}};function GI(e,t,r,o){let n=new Array(t-1),s=0,i=0;for(let c=0,p=o.length;c<p;++c)if(c!==r){let u=o[c];u&&!qt(u)&&(n[s++]=u,i|=1<<c)}return new wi(e,i,n)}function $I(e,t,r,o,n){let s=[],i=o,c=0;for(let p=0;i;++p)i&1&&(s[p]=n[c++]),i>>>=1;return s[t]=r,new If(e,c+1,s)}function VI(e,t,r,o,n,s){if(r===n)return new vf(e,r,[s,o]);let i=To(t,r),c=To(t,n);if(i===c)return p=>new wi(e,vo(i)|vo(c),[p]);{let p=i<c?[o,s]:[s,o];return new wi(e,vo(i)|vo(c),p)}}function yy(e,t,r,o,n,s){let i,c=t;for(;;){let p=VI(e,c,r,o,n,s);if(typeof p=="function")i=new Lc(p,i),c=c+5;else{let u=p;for(;i!=null;)u=i.value(u),i=i.previous;return u}}}var kf=Symbol.for("@effect/data/HashMap"),Fi=class{constructor(t,r,o,n){this._editable=t,this._edit=r,this._root=o,this._size=n,this._id=kf}[Symbol.iterator](){return new qc(this,(t,r)=>[t,r])}[A](){let t=S("HashMap");for(let r of this)t^=I(S(r[0]))(S(r[1]));return t}[M](t){if(_y(t)){if(t._size!==this._size)return!1;for(let r of this){let o=Wc(r[0],S(r[0]))(t);if(j(o))return!1;if(!O(r[1],o.value))return!1}return!0}return!1}toString(){return`HashMap(${Array.from(this).map(([t,r])=>`[${String(t)}, ${String(r)}]`).join(", ")})`}toJSON(){return{_tag:"HashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},qc=class e{constructor(t,r){this.map=t,this.f=r,this.v=by(this.map._root,this.f,void 0)}next(){if(j(this.v))return{done:!0,value:void 0};let t=this.v.value;return this.v=Uc(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new e(this.map,this.f)}},Uc=e=>e?Sy(e[0],e[1],e[2],e[3],e[4]):x(),by=(e,t,r=void 0)=>{switch(e._tag){case"LeafNode":return N(e.value)?d({value:t(e.key,e.value.value),cont:r}):Uc(r);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let o=e.children;return Sy(o.length,o,0,t,r)}default:return Uc(r)}},Sy=(e,t,r,o,n)=>{for(;r<e;){let s=t[r++];if(s&&!qt(s))return by(s,o,[e,t,r,o,n])}return Uc(n)},us=()=>new Fi(!1,0,new Ar,0),Ey=(...e)=>wf(e),wf=e=>{let t=zc(us());for(let r of e)rn(r[0],r[1])(t);return Ry(t)},_y=e=>pe(e)&&"_id"in e&&e._id===kf,Oy=e=>e&&qt(e._root),Cy=a(2,(e,t)=>Wc(e,t,S(t))),Wc=a(3,(e,t,r)=>{let o=e._root,n=0;for(;;)switch(o._tag){case"LeafNode":return O(t,o.key)?o.value:x();case"CollisionNode":{if(r===o.hash){let s=o.children;for(let i=0,c=s.length;i<c;++i){let p=s[i];if("key"in p&&O(t,p.key))return p.value}}return x()}case"IndexedNode":{let s=To(n,r),i=vo(s);if(o.mask&i){o=o.children[Dc(o.mask,i)],n+=5;break}return x()}case"ArrayNode":{if(o=o.children[To(n,r)],o){n+=5;break}return x()}default:return x()}});var Ff=a(2,(e,t)=>N(Wc(e,t,S(t))));var rn=a(3,(e,t,r)=>Pf(e,t,()=>d(r))),JI=a(3,(e,t,r)=>e._editable?(e._root=t,e._size=r,e):t===e._root?e:new Fi(e._editable,e._edit,t,r)),jc=e=>new qc(e,t=>t);var ls=e=>e._size,zc=e=>new Fi(!0,e._edit+1,e._root,e._size),Ry=e=>(e._editable=!1,e);var Pf=a(3,(e,t,r)=>Ay(e,t,S(t),r)),Ay=a(4,(e,t,r,o)=>{let n={value:e._size},s=e._root.modify(e._editable?e._edit:NaN,0,o,r,t,n);return JI(s,n.value)(e)});var Pi=a(2,(e,t)=>Pf(e,t,x));var My=a(2,(e,t)=>fs(e,us(),(r,o,n)=>rn(r,n,t(o,n))));var Kc=a(2,(e,t)=>fs(e,void 0,(r,o,n)=>t(o,n))),fs=a(3,(e,t,r)=>{let o=e._root;if(o._tag==="LeafNode")return N(o.value)?r(t,o.value.value,o.key):t;if(o._tag==="EmptyNode")return t;let n=[o.children],s;for(;s=n.pop();)for(let i=0,c=s.length;i<c;){let p=s[i++];p&&!qt(p)&&(p._tag==="LeafNode"?N(p.value)&&(t=r(t,p.value.value,p.key)):n.push(p.children))}return t});var Nf=Symbol.for("@effect/data/HashSet"),ms=class{constructor(t){this._keyMap=t,this._id=Nf}[Symbol.iterator](){return jc(this._keyMap)}[A](){return I(S(this._keyMap))(S("HashSet"))}[M](t){return vy(t)?ls(this._keyMap)===ls(t._keyMap)&&O(this._keyMap,t._keyMap):!1}toString(){return`HashSet(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"HashSet",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},vy=e=>pe(e)&&"_id"in e&&e._id===Nf,Ni=()=>new ms(us()),Iy=e=>{let t=Bc(Ni());for(let r of e)hs(t,r);return Gc(t)},ky=(...e)=>{let t=Bc(Ni());for(let r of e)hs(t,r);return Gc(t)},wy=a(2,(e,t)=>Ff(e._keyMap,t));var Fy=e=>ls(e._keyMap),Bc=e=>new ms(zc(e._keyMap)),Gc=e=>(e._keyMap._editable=!1,e),Df=a(2,(e,t)=>{let r=Bc(e);return t(r),Gc(r)}),hs=a(2,(e,t)=>e._keyMap._editable?(rn(t,!0)(e._keyMap),e):new ms(rn(t,!0)(e._keyMap))),Lf=a(2,(e,t)=>e._keyMap._editable?(Pi(t)(e._keyMap),e):new ms(Pi(t)(e._keyMap))),Py=a(2,(e,t)=>Df(e,r=>{for(let o of t)Lf(r,o)}));var Ny=a(2,(e,t)=>Df(Ni(),r=>{Dy(e,o=>hs(r,o));for(let o of t)hs(r,o)}));var Dy=a(2,(e,t)=>Kc(e._keyMap,(r,o)=>t(o))),Ly=a(3,(e,t,r)=>fs(e._keyMap,t,(o,n,s)=>r(o,s)));var oo=us,Hy=Ey,$c=wf,qy=Oy,Di=Cy;var Mr=rn,Hf=jc;var Vc=ls;var Uy=Pi;var Wy=My;var jy=Kc,qf=fs;var ZI=Symbol.for("@effect/data/MutableRef"),Uf=class{constructor(t){this.current=t,this._T=r=>r,this._id=ZI}toString(){return`MutableRef(${String(this.current)})`}toJSON(){return{_tag:"MutableRef",current:this.current}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},at=e=>new Uf(e),Yc=a(3,(e,t,r)=>O(t,e.current)?(e.current=r,!0):!1);var _t=e=>e.current;var zy=e=>ek(e,t=>t+1),Ut=a(2,(e,t)=>(e.current=t,e)),XI=a(2,(e,t)=>(e.current=t,e.current)),Wf=a(2,(e,t)=>Ut(e,t(_t(e)))),ek=a(2,(e,t)=>XI(e,t(_t(e))));var tk=Symbol.for("@effect/data/MutableHashMap"),jf=class{constructor(){this._id=tk,this.backingMap=at(oo())}[Symbol.iterator](){return this.backingMap.current[Symbol.iterator]()}toString(){return`MutableHashMap(${Array.from(this).map(([t,r])=>`[${String(t)}, ${String(r)}]`).join(", ")})`}toJSON(){return{_tag:"MutableHashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},sn=()=>new jf;var ye=a(2,(e,t)=>Di(e.backingMap.current,t)),nr=a(2,(e,t)=>N(ye(e,t)));var an=a(2,(e,t)=>(Wf(e.backingMap,Uy(t)),e)),ct=a(3,(e,t,r)=>(Wf(e.backingMap,Mr(t,r)),e)),Jc=e=>Vc(_t(e.backingMap));var Ky=Symbol.for("@effect/data/Chunk");function rk(e,t,r,o,n){for(let s=t;s<Math.min(e.length,t+n);s++)r[o+s-t]=e[s];return r}var By=[],ok=e=>xc((t,r)=>Ze(t).every((o,n)=>e(o,Io(r,n)))),nk=ok(O),re=class{constructor(t){switch(this.backing=t,this._id=Ky,t._tag){case"IEmpty":{this.length=0,this.depth=0,this.left=this,this.right=this;break}case"IConcat":{this.length=t.left.length+t.right.length,this.depth=1+Math.max(t.left.depth,t.right.depth),this.left=t.left,this.right=t.right;break}case"IArray":{this.length=t.array.length,this.depth=0,this.left=sr,this.right=sr;break}case"ISingleton":{this.length=1,this.depth=0,this.left=sr,this.right=sr;break}case"ISlice":{this.length=t.length,this.depth=t.chunk.depth+1,this.left=sr,this.right=sr;break}}}toString(){return`Chunk(${Ze(this).map(String).join(", ")})`}toJSON(){return{_tag:"Chunk",values:Ze(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}[M](t){return Gy(t)&&nk(this,t)}[A](){return Qr(Ze(this))}[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return By[Symbol.iterator]();default:return Ze(this)[Symbol.iterator]()}}pipe(){return E(this,arguments)}},Gy=e=>pe(e)&&"_id"in e&&e._id===Ky,sr=new re({_tag:"IEmpty"}),Xe=()=>sr;var Oe=e=>new re({_tag:"ISingleton",a:e}),Tr=e=>Gy(e)?e:new re({_tag:"IArray",array:J(e)}),Kf=(e,t,r)=>{switch(e.backing._tag){case"IArray":{rk(e.backing.array,0,t,r,e.length);break}case"IConcat":{Kf(e.left,t,r),Kf(e.right,t,r+e.left.length);break}case"ISingleton":{t[r]=e.backing.a;break}case"ISlice":{let o=0,n=r;for(;o<e.length;)t[n]=Io(e,o),o+=1,n+=1;break}}},Ze=e=>{switch(e.backing._tag){case"IEmpty":return By;case"IArray":return e.backing.array;default:{let t=new Array(e.length);return Kf(e,t,0),e.backing={_tag:"IArray",array:t},e.left=sr,e.right=sr,e.depth=0,t}}},no=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return new re({_tag:"IArray",array:xf(e.backing.array)});case"IConcat":return new re({_tag:"IConcat",left:no(e.backing.right),right:no(e.backing.left)});case"ISlice":return Ot(xf(Ze(e)))}},sk=a(2,(e,t)=>t<0||t>=e.length?x():d(Io(e,t))),Ot=e=>new re({_tag:"IArray",array:e});var Io=a(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?Io(e.left,t):Io(e.right,t-e.left.length);case"ISlice":return Io(e.backing.chunk,t+e.backing.offset)}}),Qc=a(2,(e,t)=>$y(e,Oe(t))),Te=a(2,(e,t)=>$y(Oe(t),e)),Bf=a(2,(e,t)=>{if(t<=0)return sr;if(t>=e.length)return e;switch(e.backing._tag){case"ISlice":return new re({_tag:"ISlice",chunk:e.backing.chunk,length:t,offset:e.backing.offset});case"IConcat":return t>e.left.length?new re({_tag:"IConcat",left:e.left,right:Bf(e.right,t-e.left.length)}):Bf(e.left,t);default:return new re({_tag:"ISlice",chunk:e,offset:0,length:t})}}),ds=a(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return sr;switch(e.backing._tag){case"ISlice":return new re({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?ds(e.right,t-e.left.length):new re({_tag:"IConcat",left:ds(e.left,t),right:e.right});default:return new re({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}});var ir=a(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;let r=t.depth-e.depth;if(Math.abs(r)<=1)return new re({_tag:"IConcat",left:e,right:t});if(r<-1)if(e.left.depth>=e.right.depth){let o=ir(e.right,t);return new re({_tag:"IConcat",left:e.left,right:o})}else{let o=ir(e.right.right,t);if(o.depth===e.depth-3){let n=new re({_tag:"IConcat",left:e.right.left,right:o});return new re({_tag:"IConcat",left:e.left,right:n})}else{let n=new re({_tag:"IConcat",left:e.left,right:e.right.left});return new re({_tag:"IConcat",left:n,right:o})}}else if(t.right.depth>=t.left.depth){let o=ir(e,t.left);return new re({_tag:"IConcat",left:o,right:t.right})}else{let o=ir(e,t.left.left);if(o.depth===t.depth-3){let n=new re({_tag:"IConcat",left:o,right:t.left.right});return new re({_tag:"IConcat",left:n,right:t.right})}else{let n=new re({_tag:"IConcat",left:t.left.right,right:t.right});return new re({_tag:"IConcat",left:o,right:n})}}}),$y=a(2,(e,t)=>ir(e,t));var xs=e=>e.length===0,Ke=e=>e.length>0,cn=sk(0),pn=e=>Io(e,0),Be=pn;var Vy=e=>Io(e,e.length-1),Gf=a(2,(e,t)=>e.backing._tag==="ISingleton"?Oe(t(e.backing.a,0)):Ot(Zr((r,o)=>t(r,o))(Ze(e))));var Zc=a(2,(e,t)=>Ot(Zo(Ze(e),t)));var ik=a(2,(e,t)=>[Bf(e,t),ds(e,t)]);var Yy=a(2,(e,t)=>{let r=0;for(let o of Ze(e)){if(t(o))break;r++}return ik(e,r)});var Ge=e=>ds(e,1);var Jy=e=>Ot(Yg(Ze(e)));var ak=Symbol.for("@effect/data/MutableList"),$f=class{constructor(){this._id=ak,this.head=void 0,this.tail=void 0,this._length=0}[Symbol.iterator](){let t=!1,r=this.head;return{next(){if(t)return this.return();if(r==null)return t=!0,this.return();let o=r.value;return r=r.next,{done:t,value:o}},return(o){return t||(t=!0),{done:!0,value:o}}}}toString(){return`MutableList(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableList",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},Vf=class{constructor(t){this.value=t,this.removed=!1,this.prev=void 0,this.next=void 0}},Qy=()=>new $f;var Zy=e=>Yf(e)===0,Yf=e=>e._length;var Xy=a(2,(e,t)=>{let r=new Vf(t);return e.head===void 0&&(e.head=r),e.tail===void 0||(e.tail.next=r,r.prev=e.tail),e.tail=r,e._length+=1,e}),eb=e=>{let t=e.head;if(t!==void 0)return ck(e,t),t.value};var ck=(e,t)=>{t.removed||(t.removed=!0,t.prev!==void 0&&t.next!==void 0?(t.prev.next=t.next,t.next.prev=t.prev):t.prev!==void 0?(e.tail=t.prev,t.prev.next=void 0):t.next!==void 0?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))};var uk=Symbol.for("@effect/data/MutableQueue"),Qf=Symbol.for("@effect/data/mutable/MutableQueue/Empty"),Jf=class{constructor(t=void 0){this.capacity=t,this._tag="Bounded",this._id=uk,this.queue=Qy()}[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()}toString(){return`MutableQueue(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableQueue",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}};var tb=()=>new Jf;var rb=a(2,(e,t)=>{let r=Yf(e.queue);return e.capacity!==void 0&&r===e.capacity?!1:(Xy(t)(e.queue),!0)});var ob=a(2,(e,t)=>Zy(e.queue)?t:eb(e.queue));var gs=Symbol.for("@effect/data/Differ/ContextPatch");function vr(e){return e}var Zf=class{constructor(){this._tag="Empty",this._Input=vr,this._Output=vr,this._id=gs}[A](){return ke("ContextPatch(Empty)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}},Xf=class{constructor(t,r){this.first=t,this.second=r,this._tag="AndThen",this._id=gs,this._Input=vr,this._Output=vr}[A](){return ke("ContextPatch(AndThen)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.first,t.first)&&O(this.second,t.second)}},em=class{constructor(t,r){this.tag=t,this.service=r,this._tag="AddService",this._id=gs,this._Input=vr,this._Output=vr}[A](){return ke("ContextPatch(AddService)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.tag,t.tag)&&O(this.service,t.service)}},tm=class{constructor(t){this.tag=t,this._tag="RemoveService",this._id=gs,this._Input=vr,this._Output=vr}[A](){return ke("ContextPatch(RemoveService)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.tag,t.tag)}},rm=class{constructor(t,r){this.tag=t,this.update=r,this._tag="UpdateService",this._id=gs,this._Input=vr,this._Output=vr}[A](){return ke("ContextPatch(AndThen)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.tag,t.tag)&&O(this.update,t.update)}},om=()=>new Zf,nb=(e,t)=>{let r=new Map(e.unsafeMap),o=om();for(let[n,s]of t.unsafeMap.entries())if(r.has(n)){let i=r.get(n);r.delete(n),O(i,s)||(o=Li(new rm(n,()=>s))(o))}else r.delete(n),o=Li(new em(n,s))(o);for(let[n]of r.entries())o=Li(new tm(n))(o);return o},Li=a(2,(e,t)=>new Xf(e,t)),sb=a(2,(e,t)=>{let r=!1,o=Oe(e),n=new Map(t.unsafeMap);for(;Ke(o);){let i=Be(o),c=Ge(o);switch(i._tag){case"Empty":{o=c;break}case"AddService":{n.set(i.tag,i.service),o=c;break}case"AndThen":{o=Te(Te(c,i.second),i.first);break}case"RemoveService":{n.delete(i.tag),o=c;break}case"UpdateService":{n.set(i.tag,i.update(n.get(i.tag))),r=!0,o=c;break}}}if(!r)return new eo(n);let s=new Map;for(let[i]of t.unsafeMap)n.has(i)&&(s.set(i,n.get(i)),n.delete(i));for(let[i,c]of n)s.set(i,c);return new eo(s)});var Xc=om,ib=nb,ab=Li,cb=sb;var $e=Ni,pt=Iy,so=ky,ub=wy;var io=Fy;var Ir=hs,nm=Lf,sm=Py;var Ve=Ny;var un=Ly;var Hi=Symbol.for("@effect/data/Differ/HashSetPatch");function tp(e){return e}var im=class{constructor(){this._tag="Empty",this._Value=tp,this._id=Hi}[A](){return ke("HashSetPatch(Empty)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}},am=class{constructor(t,r){this.first=t,this.second=r,this._tag="AndThen",this._Value=tp,this._id=Hi}[A](){return ke("HashSetPatch(AndThen)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.first,t.first)&&O(this.second,t.second)}},cm=class{constructor(t){this.value=t,this._tag="Add",this._Value=tp,this._id=Hi}[A](){return ke("HashSetPatch(Add)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.value,t.value)}},pm=class{constructor(t){this.value=t,this._tag="Remove",this._Value=tp,this._id=Hi}[A](){return ke("HashSetPatch(Remove)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.value,t.value)}},um=()=>new im,lb=(e,t)=>{let[r,o]=un([e,um()],([n,s],i)=>ub(i)(n)?[nm(i)(n),s]:[n,ep(new cm(i))(s)])(t);return un(o,(n,s)=>ep(new pm(s))(n))(r)},ep=a(2,(e,t)=>new am(e,t)),fb=a(2,(e,t)=>{let r=t,o=Oe(e);for(;Ke(o);){let n=Be(o),s=Ge(o);switch(n._tag){case"Empty":{o=s;break}case"AndThen":{o=Te(n.first)(Te(n.second)(s));break}case"Add":{r=Ir(n.value)(r),o=s;break}case"Remove":r=nm(n.value)(r),o=s}}return r});var rp=um,mb=lb,hb=ep,db=fb;var gb=Symbol.for("@effect/data/Differ"),lm=class{constructor(t){this._id=gb,this._P=F,this._V=F,this.empty=t.empty,this.diff=t.diff,this.combine=t.combine,this.patch=t.patch}},qi=e=>new lm(e),yb=()=>qi({empty:Xc(),combine:(e,t)=>ab(t)(e),diff:(e,t)=>ib(e,t),patch:(e,t)=>cb(t)(e)});var bb=()=>qi({empty:rp(),combine:(e,t)=>hb(t)(e),diff:(e,t)=>mb(e,t),patch:(e,t)=>db(t)(e)});var Sb=()=>Eb((e,t)=>t),Eb=e=>qi({empty:F,combine:(t,r)=>t===F?r:r===F?t:o=>r(t(o)),diff:(t,r)=>O(t,r)?F:Oi(r),patch:(t,r)=>e(r,t(r))});var _b=a(3,(e,t,r)=>e.diff(t,r)),Ob=a(3,(e,t,r)=>e.combine(t,r)),Cb=a(3,(e,t,r)=>e.patch(t,r)),op=qi,Rb=yb;var Ab=bb;var Mb=Sb;var hm=Symbol.for("@effect/data/List"),Ui=e=>Array.from(e),xk=e=>xg(Vg(e),Ui),gk=xk(O),ys=class{constructor(t,r){this.head=t,this.tail=r,this._tag="Cons",this._id=hm}toString(){return`List.Cons(${Ui(this).map(String).join(", ")})`}toJSON(){return{_tag:"List.Cons",values:Ui(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}[M](t){return Tb(t)&&this._tag===t._tag&&gk(this,t)}[A](){return Qr(Ui(this))}[Symbol.iterator](){let t=!1,r=this;return{next(){if(t)return this.return();if(r._tag==="Nil")return t=!0,this.return();let o=r.head;return r=r.tail,{done:t,value:o}},return(o){return t||(t=!0),{done:!0,value:o}}}}pipe(){return E(this,arguments)}},mm=class{constructor(){this._tag="Nil",this._id=hm}toString(){return"List.Nil"}toJSON(){return{_tag:"List.Nil"}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}[A](){return Qr(Ui(this))}[M](t){return Tb(t)&&this._tag===t._tag}[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}}pipe(){return E(this,arguments)}},Tb=e=>pe(e)&&"_id"in e&&e._id===hm,ut=e=>e._tag==="Nil",Wi=e=>e._tag==="Cons";var vb=new mm,yk=()=>vb,ao=(e,t)=>new ys(e,t),ar=yk,ji=e=>new ys(e,vb);var Ib=a(2,(e,t)=>bk(t,e));var ko=a(2,(e,t)=>ao(t,e)),bk=a(2,(e,t)=>{if(ut(e))return t;if(ut(t))return e;{let r=new ys(t.head,e),o=r,n=t.tail;for(;!ut(n);){let s=new ys(n.head,e);o.tail=s,o=s,n=n.tail}return r}});var kb=a(2,(e,t)=>{let r=e;for(;!ut(r);){if(t(r.head))return d(r.head);r=r.tail}return x()});var np=e=>ut(e)?x():d(e.head);var wb=a(3,(e,t,r)=>{let o=t,n=e;for(;!ut(n);)o=r(o,n.head),n=n.tail;return o});var Fb=e=>{let t=ar(),r=e;for(;!ut(r);)t=ko(t,r.head),r=r.tail;return t};var Pb,Nb,Db,ip="@effect/io/Fiber/Id",wo=Symbol.for(ip),zi="None",dm="Runtime",xm="Composite",gm=class{constructor(){this[Pb]=wo,this._tag=zi}[(Pb=wo,A)](){return I(S(this._tag))(S(ip))}[M](t){return cp(t)&&t._tag===zi}},ym=class{constructor(t,r){this.id=t,this.startTimeMillis=r,this[Nb]=wo,this._tag=dm}[(Nb=wo,A)](){return I(S(this.startTimeMillis))(I(S(this.id))(I(S(this._tag))(S(ip))))}[M](t){return cp(t)&&t._tag===dm&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}},bm=class{constructor(t,r){this.left=t,this.right=r,this[Db]=wo,this._tag=xm}[(Db=wo,A)](){return I(S(this.right))(I(S(this.left))(I(S(this._tag))(S(ip))))}[M](t){return cp(t)&&t._tag===xm&&O(this.left,t.left)&&O(this.right,t.right)}},ap=new gm;var cp=e=>typeof e=="object"&&e!=null&&wo in e;var Hb=a(2,(e,t)=>e._tag===zi?t:t._tag===zi?e:new bm(e,t));var sp=e=>{switch(e._tag){case zi:return $e();case dm:return so(e.id);case xm:return Ve(sp(e.right))(sp(e.left))}},Lb=z(Symbol.for("@effect/io/Fiber/Id/_fiberCounter"),()=>at(0));var pp=e=>Array.from(sp(e)).map(r=>`#${r}`).join(",");var qb=()=>{let e=_t(Lb);return Ut(e+1)(Lb),new ym(e,new Date().getTime())};var et=ap;var Sm=Hb;var Wb=pp;var up=qb;var ln="Die",Fo="Empty",fn="Fail",Es="Interrupt",mn="Annotated",hn="Parallel",dn="Sequential";var $b="@effect/io/Cause",Rm=Symbol.for($b),Ek={_E:e=>e},gn={[Rm]:Ek,[A](){return I(S(Ok(this)))(S($b))},[M](e){return hp(e)&&_k(this,e)},pipe(){return E(this,arguments)},toJSON(){return{_tag:"Cause",errors:yp(this)}},toString(){return uo(this)},[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}},tt=(()=>{let e=Object.create(gn);return e._tag=Fo,e})(),yn=e=>{let t=Object.create(gn);return t._tag=fn,t.error=e,t},Le=e=>{let t=Object.create(gn);return t._tag=ln,t.defect=e,t},cr=e=>{let t=Object.create(gn);return t._tag=Es,t.fiberId=e,t},Po=(e,t)=>{let r=Object.create(gn);return r._tag=mn,r.cause=e,r.annotation=t,r},Fe=(e,t)=>{let r=Object.create(gn);return r._tag=hn,r.left=e,r.right=t,r},Ce=(e,t)=>{let r=Object.create(gn);return r._tag=dn,r.left=e,r.right=t,r},hp=e=>typeof e=="object"&&e!=null&&Rm in e,Am=e=>e._tag===Fo;var dp=e=>e._tag===ln;var Mm=e=>e._tag===Fo?!0:xn(e,!0,(t,r)=>{switch(r._tag){case Fo:return d(t);case ln:case fn:case Es:return d(!1);default:return x()}});var No=e=>gp(void 0,Rk)(e),Ki=e=>no(xn(e,Xe(),(t,r)=>r._tag===fn?d(Te(r.error)(t)):x())),xp=e=>no(xn(e,Xe(),(t,r)=>r._tag===ln?d(Te(r.defect)(t)):x())),Bi=e=>xn(e,$e(),(t,r)=>r._tag===Es?d(Ir(r.fiberId)(t)):x()),Vb=e=>Gi(e,t=>t._tag===fn?d(t.error):x()),co=e=>{let t=Vb(e);switch(t._tag){case"None":return P(e);case"Some":return q(t.value)}};var Tm=e=>Os(e,{onEmpty:x(),onFail:()=>x(),onDie:t=>d(Le(t)),onInterrupt:()=>x(),onAnnotated:(t,r)=>Me(o=>Po(o,r))(t),onSequential:(t,r)=>N(t)&&N(r)?d(Ce(t.value,r.value)):N(t)&&j(r)?d(t.value):j(t)&&N(r)?d(r.value):x(),onParallel:(t,r)=>N(t)&&N(r)?d(Fe(t.value,r.value)):N(t)&&j(r)?d(t.value):j(t)&&N(r)?d(r.value):x()}),Yb=e=>Os(e,{onEmpty:x(),onFail:t=>d(Le(t)),onDie:t=>d(Le(t)),onInterrupt:()=>x(),onAnnotated:(t,r)=>Me(o=>Po(o,r))(t),onSequential:(t,r)=>N(t)&&N(r)?d(Ce(t.value,r.value)):N(t)&&j(r)?d(t.value):j(t)&&N(r)?d(r.value):x(),onParallel:(t,r)=>N(t)&&N(r)?d(Fe(t.value,r.value)):N(t)&&j(r)?d(t.value):j(t)&&N(r)?d(r.value):x()});var _s=e=>Os(e,{onEmpty:tt,onFail:()=>tt,onDie:t=>Le(t),onInterrupt:t=>cr(t),onAnnotated:(t,r)=>Am(t)?t:Po(t,r),onSequential:Ce,onParallel:Fe}),Jb=e=>Os(e,{onEmpty:tt,onFail:t=>Le(t),onDie:t=>Le(t),onInterrupt:t=>cr(t),onAnnotated:(t,r)=>Am(t)?t:Po(t,r),onSequential:(t,r)=>Ce(t,r),onParallel:(t,r)=>Fe(t,r)});var Qb=a(2,(e,t)=>Os(e,{onEmpty:tt,onFail:r=>t(r),onDie:r=>Le(r),onInterrupt:r=>cr(r),onAnnotated:(r,o)=>Po(r,o),onSequential:(r,o)=>Ce(r,o),onParallel:(r,o)=>Fe(r,o)})),vm=e=>Qb(e,F);var _k=(e,t)=>{let r=Oe(e),o=Oe(t);for(;Ke(r)&&Ke(o);){let[n,s]=xn([$e(),Xe()],([p,u],f)=>{let[m,y]=Em(f);return d([Ve(m)(p),ir(y)(u)])})(Be(r)),[i,c]=xn([$e(),Xe()],([p,u],f)=>{let[m,y]=Em(f);return d([Ve(m)(p),ir(y)(u)])})(Be(o));if(!O(n,i))return!1;r=s,o=c}return!0},Ok=e=>Ck(Oe(e),Xe()),Ck=(e,t)=>{for(;;){let[r,o]=it([$e(),Xe()],([s,i],c)=>{let[p,u]=Em(c);return[Ve(p)(s),ir(u)(i)]})(e),n=io(r)>0?Te(r)(t):t;if(xs(o))return no(n);e=o,t=n}throw new Error("BUG: Cause.flattenCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")};var Gi=a(2,(e,t)=>{let r=[e];for(;r.length>0;){let o=r.pop(),n=t(o);switch(n._tag){case"None":{switch(o._tag){case dn:case hn:{r.push(o.right),r.push(o.left);break}case mn:{r.push(o.cause);break}}break}case"Some":return n}}return x()});var Em=e=>{let t=e,r=[],o=$e(),n=Xe();for(;t!==void 0;)switch(t._tag){case Fo:{if(r.length===0)return[o,n];t=r.pop();break}case fn:{if(r.length===0)return[Ir(t.error)(o),n];o=Ir(t.error)(o),t=r.pop();break}case ln:{if(r.length===0)return[Ir(t.defect)(o),n];o=Ir(t.defect)(o),t=r.pop();break}case Es:{if(r.length===0)return[Ir(t.fiberId)(o),n];o=Ir(t.fiberId)(o),t=r.pop();break}case mn:{t=t.cause;break}case dn:{switch(t.left._tag){case Fo:{t=t.right;break}case dn:{t=Ce(t.left.left,Ce(t.left.right,t.right));break}case hn:{t=Fe(Ce(t.left.left,t.right),Ce(t.left.right,t.right));break}case mn:{t=Ce(t.left.cause,t.right);break}default:{n=Te(t.right)(n),t=t.left;break}}break}case hn:{r.push(t.right),t=t.left;break}}throw new Error("BUG: Cause.evaluateCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")};var Rk={emptyCase:_r,failCase:Pt,dieCase:Pt,interruptCase:_r,annotatedCase:(e,t)=>t,sequentialCase:(e,t,r)=>t&&r,parallelCase:(e,t,r)=>t&&r};var jb="SequentialCase",zb="ParallelCase",Kb="AnnotatedCase",Os=a(2,(e,{onAnnotated:t,onDie:r,onEmpty:o,onFail:n,onInterrupt:s,onParallel:i,onSequential:c})=>gp(e,void 0,{emptyCase:()=>o,failCase:(p,u)=>n(u),dieCase:(p,u)=>r(u),interruptCase:(p,u)=>s(u),annotatedCase:(p,u,f)=>t(u,f),sequentialCase:(p,u,f)=>c(u,f),parallelCase:(p,u,f)=>i(u,f)})),xn=a(3,(e,t,r)=>{let o=t,n=e,s=[];for(;n!==void 0;){let i=r(o,n);switch(o=N(i)?i.value:o,n._tag){case dn:{s.push(n.right),n=n.left;break}case hn:{s.push(n.right),n=n.left;break}case mn:{n=n.cause;break}default:{n=void 0;break}}n===void 0&&s.length>0&&(n=s.pop())}return o}),gp=a(3,(e,t,r)=>{let o=[e],n=[];for(;o.length>0;){let i=o.pop();switch(i._tag){case Fo:{n.push(P(r.emptyCase(t)));break}case fn:{n.push(P(r.failCase(t,i.error)));break}case ln:{n.push(P(r.dieCase(t,i.defect)));break}case Es:{n.push(P(r.interruptCase(t,i.fiberId)));break}case mn:{o.push(i.cause),n.push(q({_tag:Kb,annotation:i.annotation}));break}case dn:{o.push(i.right),o.push(i.left),n.push(q({_tag:jb}));break}case hn:{o.push(i.right),o.push(i.left),n.push(q({_tag:zb}));break}}}let s=[];for(;n.length>0;){let i=n.pop();switch(i._tag){case"Left":{switch(i.left._tag){case jb:{let c=s.pop(),p=s.pop(),u=r.sequentialCase(t,c,p);s.push(u);break}case zb:{let c=s.pop(),p=s.pop(),u=r.parallelCase(t,c,p);s.push(u);break}case Kb:{let c=s.pop(),p=r.annotatedCase(t,c,i.left.annotation);s.push(p);break}}break}case"Right":{s.push(i.right);break}}}if(s.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/io/issues");return s.pop()}),$i=(e,t)=>{let r={value:t,enumerable:!0},o={...e,toString(){return`${this._tag}: ${this.message}`}};return n=>Object.create(o,{_tag:r,message:{value:n,enumerable:!0}})},_m=Symbol.for("@effect/io/Cause/errors/RuntimeException"),Im=$i({[_m]:_m},"RuntimeException");var lp=Symbol.for("@effect/io/Cause/errors/InterruptedException"),Ak=$i({[lp]:lp},"InterruptedException"),km=e=>typeof e=="object"&&e!=null&&lp in e,Om=Symbol.for("@effect/io/Cause/errors/IllegalArgument"),Cs=$i({[Om]:Om},"IllegalArgumentException");var fp=Symbol.for("@effect/io/Cause/errors/NoSuchElement"),po=$i({[fp]:fp},"NoSuchElementException"),wm=e=>typeof e=="object"&&e!=null&&fp in e,Cm=Symbol.for("@effect/io/Cause/errors/InvalidHubCapacityException"),Bj=$i({[Cm]:Cm},"InvalidHubCapacityException");var mp=Symbol.for("@effect/io/Cause/SpanAnnotation"),Mk=e=>typeof e=="object"&&e!==null&&mp in e,Zb=e=>({_tag:"SpanAnnotation",[mp]:mp,span:e});var Bb=e=>{if(typeof e=="object"&&e!=null&&"toString"in e&&typeof e.toString=="function"&&e.toString!==Object.prototype.toString)return e.toString();if(typeof e=="string")return`Error: ${e}`;if(typeof e=="object"&&e!==null&&"message"in e&&typeof e.message=="string"){let t=JSON.parse(JSON.stringify(e)),r=new Set(Object.keys(t));if(r.delete("name"),r.delete("message"),r.delete("_tag"),r.size===0)return`${"name"in e&&typeof e.name=="string"?e.name:"Error"}${"_tag"in e&&typeof e._tag=="string"?`(${e._tag})`:""}: ${e.message}`}return`Error: ${JSON.stringify(e)}`},Gb=e=>e instanceof Error?[Bb(e),e.stack?.split(`
`).filter(t=>!t.startsWith("Error")).join(`
`)]:[Bb(e),void 0];var Tk=e=>{let t=e.split(`
`),r=[];for(let o=0;o<t.length;o++){if(t[o].includes("EffectPrimitive")||t[o].includes("Generator.next")||t[o].includes("FiberRuntime"))return r.join(`
`);r.push(t[o])}return r.join(`
`)},uo=e=>{if(No(e))return"All fibers interrupted without errors.";let t=yp(e).map(r=>{let o=r.message;if(r.stack&&(o+=`\r
${Tk(r.stack)}`),r.span){let n=r.span,s=0;for(;n&&n._tag==="Span"&&s<10;)o+=`\r
    at ${n.name}`,n=je(n.parent),s++}return o}).join(`\r
\r
`);return t.includes(`\r
`)?`\r
${t}\r
`:t},yp=e=>gp(e,void 0,{emptyCase:()=>[],dieCase:(t,r)=>{let o=Gb(r);return[{message:o[0],stack:o[1],span:void 0}]},failCase:(t,r)=>{let o=Gb(r);return[{message:o[0],stack:o[1],span:void 0}]},interruptCase:()=>[],parallelCase:(t,r,o)=>[...r,...o],sequentialCase:(t,r,o)=>[...r,...o],annotatedCase:(t,r,o)=>Mk(o)?r.map(n=>({...n,span:n.span??o.span})):r});var Xb=uo;var Vi=255,eS=8,bp=e=>e&Vi,Sp=e=>e>>eS&Vi,Sn=(e,t)=>(e&Vi)+((t&e&Vi)<<eS),Ep=Sn(0,0),tS=e=>Sn(e,e),rS=e=>Sn(e,0);var oS=a(2,(e,t)=>Sn(bp(e)&~t,Sp(e)));var Fm=a(2,(e,t)=>e|t);var nS=e=>~e>>>0&Vi;var iS=0,pr=1,Pm=2,_p=4,Yi=16,Op=32;var Nm=e=>Ji(e,Op);var Dm=a(2,(e,t)=>e|t);var kr=e=>Rs(e)&&!aS(e),Rs=e=>Ji(e,pr);var Ji=a(2,(e,t)=>(e&t)!==0),Cp=(...e)=>e.reduce((t,r)=>t|r,0),Lm=Cp(iS);var Qi=e=>Ji(e,_p);var aS=e=>Ji(e,Yi);var En=a(2,(e,t)=>Sn(e^t,t)),As=a(2,(e,t)=>e&(nS(bp(t))|Sp(t))|bp(t)&Sp(t));var Hm=op({empty:Ep,diff:(e,t)=>En(e,t),combine:(e,t)=>Fm(t)(e),patch:(e,t)=>As(t,e)});var Ap=Ep;var qm=tS,Um=rS;var Wm=oS;var pS,uS,lS,fS={_tag:"Empty"},_n=(e,t)=>({_tag:"Par",left:e,right:t}),Mp=(e,t)=>({_tag:"Seq",left:e,right:t}),Km=(e,t)=>({_tag:"Single",dataSource:e,blockedRequest:t});var mS=e=>{let t=ji(e),r=ar();for(;;){let[o,n]=wb(t,[hS(),ar()],([s,i],c)=>{let[p,u]=Fk(c);return[dS(s,p),Ib(i,u)]});if(r=Pk(r,o),ut(n))return Fb(r);t=n}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/query/issues")},Fk=e=>{let t=e,r=hS(),o=ar(),n=ar();for(;;)switch(t._tag){case"Empty":{if(ut(o))return[r,n];t=o.head,o=o.tail;break}case"Par":{o=ao(t.right,o),t=t.left;break}case"Seq":{let s=t.left,i=t.right;switch(s._tag){case"Empty":{t=i;break}case"Par":{let c=s.left,p=s.right;t=_n(Mp(c,i),Mp(p,i));break}case"Seq":{let c=s.left,p=s.right;t=Mp(c,Mp(p,i));break}case"Single":{t=s,n=ao(i,n);break}}break}case"Single":{if(r=dS(r,qk(t.dataSource,t.blockedRequest)),ut(o))return[r,n];t=o.head,o=o.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/query/issues")},Pk=(e,t)=>{if(ut(e))return ji(jm(t));if(Uk(t))return e;let r=Gk(e.head),o=Wk(t);return r.length===1&&o.length===1&&O(r[0],o[0])?ao(Bk(e.head,jm(t)),e.tail):ao(jm(t),e)},Nk=Symbol.for("@effect/io/RequestBlock.Entry"),zm=class{constructor(t,r,o,n,s){this.request=t,this.result=r,this.listeners=o,this.ownerId=n,this.state=s,this[pS]=Dk}};pS=Nk;var Dk={_R:e=>e};var Bm=e=>new zm(e.request,e.result,e.listeners,e.ownerId,e.state),Lk=Symbol.for("@effect/io/RequestBlockParallel"),Hk={_R:e=>e},Zi=class{constructor(t){this.map=t,this[uS]=Hk}};uS=Lk;var hS=()=>new Zi(oo()),qk=(e,t)=>new Zi(Hy([e,Array.of(t)])),dS=(e,t)=>new Zi(qf(e.map,t.map,(r,o,n)=>Mr(r,n,De(Di(r,n),{onNone:()=>o,onSome:s=>[...s,...o]})))),Uk=e=>qy(e.map),Wk=e=>Array.from(Hf(e.map)),jm=e=>Kk(Wy(e.map,t=>Array.of(t)));var jk=Symbol.for("@effect/io/RequestBlockSequential"),zk={_R:e=>e},Tp=class{constructor(t){this.map=t,this[lS]=zk}};lS=jk;var Kk=e=>new Tp(e),Bk=(e,t)=>new Tp(qf(t.map,e.map,(r,o,n)=>Mr(r,n,De(Di(r,n),{onNone:()=>[],onSome:s=>[...s,...o]}))));var Gk=e=>Array.from(Hf(e.map)),xS=e=>Array.from(e.map);var On="Pending",Xi="Done";var $k="@effect/io/Deferred",bS=Symbol.for($k),SS={_E:e=>e,_A:e=>e},vp=e=>({_tag:On,joiners:e}),Gm=e=>({_tag:Xi,effect:e});var Ms="Async",ES="Commit",fe="Failure",Ts="OnFailure",vs="OnSuccess",Is="OnSuccessAndFailure",me="Success",Ip="Sync",_S="Tag",lo="UpdateRuntimeFlags",ks="While",kp="WithRuntime",ws="Yield",ea="RevertFlags";var Fp=class{constructor(){this.buckets=[]}scheduleTask(t,r){let o,n;for(n=0;n<this.buckets.length&&this.buckets[n][0]<=r;n++)o=this.buckets[n];if(o)o[1].push(t);else{let s=[];for(let i=0;i<n;i++)s.push(this.buckets[i]);s.push([r,[t]]);for(let i=n;i<this.buckets.length;i++)s.push(this.buckets[i]);this.buckets=s}}},$m=class{constructor(t){this.maxNextTickBeforeTimer=t,this.running=!1,this.tasks=new Fp}starveInternal(t){let r=this.tasks.buckets;this.tasks.buckets=[];for(let[o,n]of r)for(let s=0;s<n.length;s++)n[s]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}scheduleTask(t,r){this.tasks.scheduleTask(t,r),this.running||(this.running=!0,this.starve())}},Vm=z(Symbol.for("@effect/io/Scheduler/defaultScheduler"),()=>new $m(2048)),Pp=class{constructor(){this.tasks=new Fp,this.deferred=!1}scheduleTask(t,r){this.deferred?Vm.scheduleTask(t,r):this.tasks.scheduleTask(t,r)}flush(){for(;this.tasks.buckets.length>0;){let t=this.tasks.buckets;this.tasks.buckets=[];for(let[r,o]of t)for(let n=0;n<o.length;n++)o[n]()}this.deferred=!0}};var CS,RS,AS,MS,Yk="@effect/io/Effect/Error",Ym=Symbol.for(Yk),vS=e=>typeof e=="object"&&e!=null&&Ym in e,IS=e=>({[Ym]:Ym,_tag:"EffectError",cause:e}),he=(e,t)=>{let r=new Re("Blocked");return r.i0=e,r.i1=t,r},qp=e=>{let t=new Re("RunBlocked");return t.i0=e,t},Fs=Symbol.for("@effect/io/Effect"),Dp=class{constructor(t,r){this.patch=t,this.op=r,this._tag=ea}},Re=class{constructor(t){this._tag=t,this.i0=void 0,this.i1=void 0,this.i2=void 0,this.trace=void 0,this[CS]=Jm}[(CS=Fs,M)](t){return this===t}[A](){return Ro(this)}pipe(){return E(this,arguments)}},Lp=class{constructor(t){this._tag=t,this.i0=void 0,this.i1=void 0,this.i2=void 0,this.trace=void 0,this[RS]=Jm}[(RS=Fs,M)](t){return this===t}[A](){return Ro(this)}get cause(){return this.i0}pipe(){return E(this,arguments)}toJSON(){return{_tag:this._tag,cause:this.cause.toJSON()}}toString(){return Xb(this.cause)}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}},Hp=class{constructor(t){this._tag=t,this.i0=void 0,this.i1=void 0,this.i2=void 0,this.trace=void 0,this[AS]=Jm}[(AS=Fs,M)](t){return this===t}[A](){return Ro(this)}get value(){return this.i0}pipe(){return E(this,arguments)}toJSON(){return{_tag:this._tag,value:this.value}}toString(){return`Success: ${String(this.value)}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}},Jm={_R:e=>e,_E:e=>e,_A:e=>e},de=e=>typeof e=="object"&&e!=null&&Fs in e,ue=e=>{let t=new Re(kp);return t.i0=e,t},zt=a(3,(e,t,r)=>be(o=>l(e,n=>l(Z(T(()=>o(t(n)))),s=>T(()=>r(n,s)).pipe(Y({onFailure:i=>{switch(s._tag){case fe:return D(Fe(s.i0,i));case me:return D(i)}},onSuccess:()=>s})))))),V=a(2,(e,t)=>l(e,()=>h(t))),Q=e=>V(e,void 0),Kt=(e,t=et)=>T(()=>{let r,o,n=new Re(Ms);if(e.length!==1){let s=new AbortController;o=s,n.i0=i=>{r=e(i,s.signal)}}else n.i0=s=>{r=e(s)};return n.i1=t,Uo(n,()=>(o&&o.abort(),r??k))}),Pr=(e,t=et)=>Kt(r=>{let o=e(r);if(Or(o))r(o.right);else return o.left},t),Nr=a(2,(e,t)=>{let r=new Re(Ts);return r.i0=e,r.i1=t,r}),lt=a(2,(e,t)=>ie(e,{onFailure:t,onSuccess:h})),Do=e=>(...t)=>e(...t),kS=a(2,(e,t)=>Y(e,{onFailure:Do(r=>{let o=co(r);switch(o._tag){case"Left":return $(()=>D(r))(t(o.left));case"Right":return D(o.right)}}),onSuccess:h})),wS=e=>ue((t,r)=>e(Rs(r.runtimeFlags))),Qm=e=>D(Le(e)),Ps=e=>Hr(()=>Le(Im(e))),Lo=e=>Hr(()=>Le(e())),Dr=e=>ie(e,{onFailure:t=>h(q(t)),onSuccess:t=>h(P(t))}),Lr=()=>T(()=>Ye(ho)),Ns=e=>l(Lr(),e),Z=e=>ra(e,{onFailure:K,onSuccess:X}),L=e=>D(yn(e)),ur=e=>Hr(()=>yn(e())),D=e=>{let t=new Lp(fe);return t.i0=e,t},Hr=e=>l(g(e),D),Ho=ue(e=>h(e.id())),Bt=e=>ue(t=>e(t.id())),l=a(2,(e,t)=>{let r=new Re(vs);return r.i0=e,r.i1=t,r}),wr=e=>{let t=new Re("OnStep");return t.i0=e,t.i1=X,t},Ds=(e,t)=>{let r=new Re("OnStep");return r.i0=e,r.i1=t,r},ft=e=>l(e,F),qo=e=>ie(e,{onFailure:h,onSuccess:L}),ra=a(2,(e,{onFailure:t,onSuccess:r})=>Y(e,{onFailure:o=>h(t(o)),onSuccess:o=>h(r(o))})),Y=a(2,(e,{onFailure:t,onSuccess:r})=>{let o=new Re(Is);return o.i0=e,o.i1=t,o.i2=r,o}),ie=a(2,(e,{onFailure:t,onSuccess:r})=>Y(e,{onFailure:o=>{let n=Ki(o);return xp(o).length>0?D(Jb(o)):n.length>0?t(pn(n)):D(o)},onSuccess:r})),He=a(2,(e,t)=>T(()=>{let r=J(e),o=new Array(r.length),n=0;return V(Tn({while:()=>n<r.length,body:()=>t(r[n],n),step:s=>{o[n++]=s}}),o)})),mt=a(2,(e,t)=>T(()=>{let r=J(e),o=0;return Tn({while:()=>o<r.length,body:()=>t(r[o],o),step:()=>{o++}})})),Up=a(e=>typeof e[0]=="boolean"||de(e[0]),(e,{onFalse:t,onTrue:r})=>typeof e=="boolean"?e?r:t:l(e,Do(o=>o?r:t))),Wp=l(Ho,e=>jp(e)),jp=e=>D(cr(e)),jt=e=>{let t=new Re(lo);t.i0=qm(pr);let r=o=>o._tag==="Blocked"?he(o.i0,jt(o.i1)):o;return t.i1=()=>Ds(e,r),t},FS=e=>{let t=new Re(lo);t.i0=qm(pr);let r=o=>o._tag==="Blocked"?he(o.i0,jt(o.i1)):o;return t.i1=o=>Rs(o)?wr(e(jt)):wr(e(Fr)),l(t,r)},qr=a(2,(e,t)=>be(r=>l(Z(r(e)),o=>dh(t,o)))),_=a(2,(e,t)=>l(e,r=>g(()=>t(r)))),zp=a(2,(e,{onFailure:t,onSuccess:r})=>ie(e,{onFailure:o=>ur(()=>t(o)),onSuccess:o=>g(()=>r(o))})),fo=a(2,(e,t)=>Y(e,{onFailure:r=>{let o=co(r);switch(o._tag){case"Left":return ur(()=>t(o.left));case"Right":return D(o.right)}},onSuccess:h})),Kp=a(2,(e,t)=>lr(e,Do(r=>ru(r)?k:t(r.i0)))),lr=a(2,(e,t)=>be(r=>Y(r(e),{onFailure:o=>{let n=K(o);return Y(t(n),{onFailure:s=>K(Ce(o,s)),onSuccess:()=>n})},onSuccess:o=>{let n=X(o);return W(t(n),n)}}))),Uo=a(2,(e,t)=>lr(e,su({onFailure:r=>No(r)?Q(t(Bi(r))):k,onSuccess:()=>k}))),Rn=a(2,(e,t)=>Jk(e,t,h)),An=e=>Zm(e,F),Zm=a(2,(e,t)=>ie(e,{onFailure:r=>Qm(t(r)),onSuccess:h})),PS=(e,t)=>J(e).reduceRight(([r,o],n)=>{let s=t(n);switch(s._tag){case"Left":return[[s.left,...r],o];case"Right":return[r,[s.right,...o]]}},[new Array,new Array]),Rt=a(2,(e,t)=>Ee(ho,t)(e)),NS=a(2,(e,t)=>qe(ho,r=>is(r,t))(e)),Mn=a(2,(e,t)=>Ns(r=>Rt(e,t(r)))),Bp=ue((e,t)=>h(t.runtimeFlags)),h=e=>{let t=new Hp(me);return t.i0=e,t},T=e=>l(g(e),F),g=e=>{let t=new Re(Ip);return t.i0=e,t},At=a(2,(e,t)=>l(e,r=>V(t(r),r))),Gp=e=>ue(t=>{let r=t.getFiberRef(ta),o=$(()=>t.scope())(r);return e(Ee(ta,d(o)))}),Jk=a(3,(e,t,r)=>Y(e,{onFailure:o=>xp(o).length>0?D(Ug(Yb(o))):t(),onSuccess:r})),Fr=e=>{let t=new Re(lo);t.i0=Um(pr),t.i1=()=>Ds(e,r);let r=o=>o._tag==="Blocked"?he(o.i0,Fr(o.i1)):o;return t},be=e=>{let t=new Re(lo);t.i0=Um(pr);let r=o=>o._tag==="Blocked"?he(o.i0,Fr(o.i1)):o;return t.i1=o=>Rs(o)?wr(e(jt)):wr(e(Fr)),l(t,r)},k=h(void 0),Ls=e=>{let t=new Re(lo);return t.i0=e,t.i1=void 0,t},Hs=a(2,(e,t)=>l(t,r=>r?_(d)(e):h(x()))),Tn=e=>{let t=new Re(ks);return t.i0=e.while,t.i1=e.body,t.i2=e.step,t},DS=a(2,(e,t)=>Ee(e,Zp,t)),LS=a(2,(e,t)=>Ee(e,sa,t)),HS=a(2,(e,t)=>{let r=new Re(lo);return r.i0=t,r.i1=()=>e,r}),qS=a(2,(e,t)=>Ee(e,aa,t)),Mt=e=>{let t=new Re(ws);return typeof e?.priority<"u"?ph(e.priority)(t):t},$p=a(2,(e,t)=>l(e,r=>_(t,o=>[r,o])));var qs=a(2,(e,t)=>l(e,r=>V(t,r))),W=a(2,(e,t)=>l(e,()=>t)),mo=a(3,(e,t,r)=>l(e,o=>_(t,n=>r(o,n)))),vn=Pr(()=>{let e=setInterval(()=>{},2147483647);return q(g(()=>clearInterval(e)))}),Wo=e=>l(Ho,t=>Gt(t)(e)),Gt=a(2,(e,t)=>l(e.interruptAsFork(t),()=>e.await())),Xm={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return E(this,arguments)}},eh={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return E(this,arguments)}},th={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return E(this,arguments)}},rh={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return E(this,arguments)}},Vp={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return E(this,arguments)}},Yp={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return E(this,arguments)}},oh={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return E(this,arguments)}},nh={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return E(this,arguments)}},sh=[Xm,oh,Yp,Vp,rh,th,eh,nh],Qk="@effect/io/FiberRef",Zk=Symbol.for(Qk),Xk={_A:e=>e},Ye=e=>US(e,t=>[t,t]);var Se=a(2,(e,t)=>l(Ye(e),t)),Cn=a(2,(e,t)=>US(e,()=>[void 0,t]));var US=a(2,(e,t)=>ue(r=>{let[o,n]=t(r.getFiberRef(e));return r.setFiberRef(e,n),h(o)}));var ew="@effect/io/RequestResolver",WS=Symbol.for(ew),tw={_R:e=>e,_A:e=>e},TS=class e{constructor(t,r){this.runAll=t,this.target=r,this[MS]=tw,this.runAll=t}[(MS=WS,A)](){return this.target?S(this.target):Ro(this)}[M](t){return this.target?rw(t)&&O(this.target,t.target):this===t}identified(...t){return new e(this.runAll,Tr(t))}pipe(){return E(this,arguments)}},rw=e=>typeof e=="object"&&e!=null&&WS in e;var Ee=a(3,(e,t,r)=>l(zt(qs(Ye(t),Cn(t,r)),()=>wr(e),o=>Cn(t,o)),o=>o._tag==="Blocked"?he(o.i0,Ee(o.i1,t,r)):o)),qe=a(3,(e,t,r)=>Se(t,o=>Ee(e,t,r(o)))),xe=(e,t)=>Us(e,{differ:Mb(),fork:t?.fork??F,join:t?.join}),ih=e=>Us(e,{differ:Ab(),fork:rp()}),Jp=e=>Us(e,{differ:Rb(),fork:Xc()}),Us=(e,t)=>({[Zk]:Xk,initial:e,diff:(r,o)=>_b(r,o)(t.differ),combine:(r,o)=>Ob(r,o)(t.differ),patch:r=>o=>Cb(r,o)(t.differ),fork:t.fork,join:t.join??((r,o)=>o),pipe(){return E(this,arguments)}}),jS=e=>Us(e,{differ:Hm,fork:Ap}),ho=Jp(Ht()),oa=xe(0),ah=xe(2048),na=z(Symbol.for("@effect/io/FiberRef/currentLogAnnotation"),()=>xe(oo())),ch=xe(Vp),Qp=z(Symbol.for("@effect/io/FiberRef/currentLogSpan"),()=>xe(ar())),xo=z(Symbol.for("@effect/io/FiberRef/currentScheduler"),()=>xe(Vm)),zS=a(2,(e,t)=>Ee(e,xo,t)),ph=a(2,(e,t)=>Ee(e,oa,t)),KS=a(2,(e,t)=>Ee(e,ah,t)),Zp=z(Symbol.for("@effect/io/FiberRef/currentConcurrency"),()=>xe("unbounded")),sa=z(Symbol.for("@effect/io/FiberRef/currentRequestBatching"),()=>xe(!0)),ia=z(Symbol.for("@effect/io/FiberRef/currentUnhandledErrorLogLevel"),()=>xe(d(Yp))),BS=a(2,(e,t)=>Ee(e,ia,t)),go=ih($e()),GS=Ye(go),ta=z(Symbol.for("@effect/io/FiberRef/currentForkScopeOverride"),()=>xe(x(),{fork:()=>x(),join:(e,t)=>e})),In=z(Symbol.for("@effect/io/FiberRef/currentInterruptedCause"),()=>xe(tt,{fork:()=>tt,join:(e,t)=>e})),yo=z(Symbol.for("@effect/io/FiberRef/currentTracerSpan"),()=>xe(ar())),aa=z(Symbol.for("@effect/io/FiberRef/currentTracerTiming"),()=>xe(!0)),Xp=z(Symbol.for("@effect/io/FiberRef/currentTracerSpanAnnotations"),()=>xe(oo())),eu=z(Symbol.for("@effect/io/FiberRef/currentTracerSpanLinks"),()=>xe(Xe())),tu=Symbol.for("@effect/io/Scope"),uh=Symbol.for("@effect/io/CloseableScope");var Ws=(e,t)=>e.addFinalizer(t),jo=(e,t)=>e.close(t),lh=(e,t)=>e.fork(t),fh=a(2,(e,t)=>_(nw(e,t),De({onNone:()=>()=>k,onSome:r=>o=>ow(r,o)(e)}))),ow=a(3,(e,t,r)=>T(()=>{switch(e.state._tag){case"Exited":return k;case"Running":{let o=e.state.finalizers.get(t);return e.state.finalizers.delete(t),o!=null?e.state.update(o)(r):k}}})),nw=a(2,(e,t)=>T(()=>{switch(e.state._tag){case"Exited":return e.state.nextKey+=1,V(t(e.state.exit),x());case"Running":{let r=e.state.nextKey;return e.state.finalizers.set(r,t),e.state.nextKey+=1,h(d(r))}}}));var $S=g(()=>({state:{_tag:"Running",nextKey:0,finalizers:new Map,update:F}}));var mh=e=>e._tag==="Failure",ru=e=>e._tag==="Success";var VS=a(2,(e,t)=>{switch(e._tag){case fe:return K(e.i0);case me:return X(t)}}),ca=e=>VS(e,void 0);var js=(e,t)=>sw(e,t?.parallel?Fe:Ce),ou=e=>K(Le(e));var fr=e=>K(yn(e)),K=e=>{let t=new Lp(fe);return t.i0=e,t},YS=a(2,(e,t)=>{switch(e._tag){case fe:return K(e.i0);case me:return t(e.i0)}});var JS=e=>YS(F)(e);var nu=e=>K(cr(e)),Np=a(2,(e,t)=>{switch(e._tag){case fe:return K(e.i0);case me:return X(t(e.i0))}});var su=a(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case fe:return t(e.i0);case me:return r(e.i0)}}),kn=a(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case fe:return t(e.i0);case me:return r(e.i0)}}),X=e=>{let t=new Hp(me);return t.i0=e,t};var Ur=X(void 0);var pa=a(3,(e,t,{onFailure:r,onSuccess:o})=>{switch(e._tag){case fe:switch(t._tag){case me:return K(e.i0);case fe:return K(r(e.i0,t.i0))}case me:switch(t._tag){case me:return X(o(e.i0,t.i0));case fe:return K(t.i0)}}}),sw=(e,t)=>{let r=Tr(e);return Ke(r)?d(Np(o=>Array.from(o))(Np(no)(it(Np(Oe)(Be(r)),(o,n)=>pa(n,{onSuccess:(s,i)=>Te(i)(s),onFailure:t})(o))(Ge(r))))):x()},zs=e=>({[bS]:SS,state:at(vp([])),blockingOn:e,pipe(){return E(this,arguments)}}),rt=()=>l(Ho,e=>QS(e)),QS=e=>g(()=>zs(e)),ve=e=>Pr(t=>{let r=_t(e.state);switch(r._tag){case Xi:return P(r.effect);case On:return Ut(vp([t,...r.joiners]))(e.state),q(iw(e,t))}},e.blockingOn),hh=a(2,(e,t)=>qr(t,e)),Ks=a(2,(e,t)=>g(()=>{let r=_t(e.state);switch(r._tag){case Xi:return!1;case On:{Ut(Gm(t))(e.state);for(let o=0;o<r.joiners.length;o++)r.joiners[o](t);return!0}}})),dh=a(2,(e,t)=>Ks(e,t)),ua=a(2,(e,t)=>Ks(e,L(t)));var wn=a(2,(e,t)=>Ks(e,D(t)));var ZS=e=>l(Ho,t=>Ks(e,jp(t)));var Bs=a(2,(e,t)=>Ks(e,h(t)));var Gs=(e,t)=>{let r=_t(e.state);if(r._tag===On){Ut(Gm(t))(e.state);for(let o=r.joiners.length-1;o>=0;o--)r.joiners[o](t)}},iw=(e,t)=>g(()=>{let r=_t(e.state);r._tag===On&&Ut(vp(r.joiners.filter(o=>o!==t)))(e.state)});var Fn=ve;var XS=dh;var eE=ZS;var xh=zs;var rE=JS;var oE=X;var aE,aw="@effect/io/Clock",yh=Symbol.for(aw),Wr=St(yh),cw=2**31-1,sE={unsafeSchedule(e,t){let r=Rr(t);if(r>cw)return Pt;let o=!1,n=setTimeout(()=>{o=!0,e()},r);return()=>(clearTimeout(n),!o)}},iE=function(){let e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;let t="timeOrigin"in performance&&typeof performance.timeOrigin=="number"?BigInt(Math.round(performance.timeOrigin*1e6)):BigInt(Date.now())*e;return()=>t+BigInt(Math.round(performance.now()*1e6))}(),pw=function(){let e=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!e)return iE;let t=iE()-e.bigint();return()=>t+e.bigint()}(),gh=class{constructor(){this[aE]=yh,this.currentTimeMillis=g(()=>this.unsafeCurrentTimeMillis()),this.currentTimeNanos=g(()=>this.unsafeCurrentTimeNanos())}unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return pw()}scheduler(){return h(sE)}sleep(t){return Pr(r=>{let o=sE.unsafeSchedule(()=>r(k),t);return q(Q(g(o)))})}};aE=yh;var cE=()=>new gh;var iu="And",au="Or",cu="InvalidData",pu="MissingData",uu="SourceUnavailable",lu="Unsupported";var lw="@effect/io/Config/Error",bh=Symbol.for(lw),$s={[bh]:bh},fu=(e,t)=>{let r=Object.create($s);return r._tag=iu,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),r},mu=(e,t)=>{let r=Object.create($s);return r._tag=au,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),r},jr=(e,t,r={pathDelim:"."})=>{let o=Object.create($s);return o._tag=cu,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Invalid data at ${Xr(r.pathDelim)(this.path)}: "${this.message}")`}}),o},mr=(e,t,r={pathDelim:"."})=>{let o=Object.create($s);return o._tag=pu,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Missing data at ${Xr(r.pathDelim)(this.path)}: "${this.message}")`}}),o},uE=(e,t,r,o={pathDelim:"."})=>{let n=Object.create($s);return n._tag=uu,n.path=e,n.message=t,n.cause=r,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Source unavailable at ${Xr(o.pathDelim)(this.path)}: "${this.message}")`}}),n},hu=(e,t,r={pathDelim:"."})=>{let o=Object.create($s);return o._tag=lu,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${Xr(r.pathDelim)(this.path)}: "${this.message}")`}}),o};var bo=a(2,(e,t)=>{switch(e._tag){case iu:return fu(bo(t)(e.left),bo(t)(e.right));case au:return mu(bo(t)(e.left),bo(t)(e.right));case cu:return jr([...t,...e.path],e.message);case pu:return mr([...t,...e.path],e.message);case uu:return uE([...t,...e.path],e.message,e.cause);case lu:return hu([...t,...e.path],e.message)}}),fw={andCase:(e,t,r)=>t&&r,orCase:(e,t,r)=>t&&r,invalidDataCase:Pt,missingDataCase:_r,sourceUnavailableCase:Pt,unsupportedCase:Pt},lE=a(3,(e,t,r)=>{let o=[e],n=[];for(;o.length>0;){let i=o.pop();switch(i._tag){case iu:{o.push(i.right),o.push(i.left),n.push(q({_tag:"AndCase"}));break}case au:{o.push(i.right),o.push(i.left),n.push(q({_tag:"OrCase"}));break}case cu:{n.push(P(r.invalidDataCase(t,i.path,i.message)));break}case pu:{n.push(P(r.missingDataCase(t,i.path,i.message)));break}case uu:{n.push(P(r.sourceUnavailableCase(t,i.path,i.message,i.cause)));break}case lu:{n.push(P(r.unsupportedCase(t,i.path,i.message)));break}}}let s=[];for(;n.length>0;){let i=n.pop();switch(i._tag){case"Left":{switch(i.left._tag){case"AndCase":{let c=s.pop(),p=s.pop(),u=r.andCase(t,c,p);s.push(u);break}case"OrCase":{let c=s.pop(),p=s.pop(),u=r.orCase(t,c,p);s.push(u);break}}break}case"Right":{s.push(i.right);break}}}if(s.length===0)throw new Error("BUG: ConfigError.reduceWithContext - please report an issue at https://github.com/Effect-TS/io/issues");return s.pop()}),fE=e=>lE(e,void 0,fw);var Sh=fE;var mE="@effect/io/Config/Secret",Eh=Symbol.for(mE),hw={[Eh]:Eh,[A](){return I(Qr(this.raw))(S(mE))},[M](e){return dw(e)&&this.raw.length===e.raw.length&&this.raw.every((t,r)=>O(t,e.raw[r]))}},dw=e=>typeof e=="object"&&e!=null&&Eh in e,xw=e=>{let t=Object.create(hw);return Object.defineProperty(t,"toString",{enumerable:!1,value(){return"ConfigSecret(<redacted>)"}}),Object.defineProperty(t,"raw",{enumerable:!1,value:e}),t};var hE=e=>xw(e.split("").map(t=>t.charCodeAt(0)));var xu="Constant",gu="Fail",la="Fallback",yu="Described",bu="Lazy",Su="MapOrFail",Eu="Nested",_u="Primitive",Ou="Sequence",Cu="HashMap",Ru="ZipWith";var yw="@effect/io/Config",Mu=Symbol.for(yw),bw={_A:e=>e},$t={[Mu]:bw,pipe(){return E(this,arguments)}},gE=e=>{let t=zo("a boolean property",r=>{switch(r){case"true":case"yes":case"on":case"1":return P(!0);case"false":case"no":case"off":case"0":return P(!1);default:{let o=jr([],`Expected a boolean value, but received ${r}`);return q(o)}}});return e===void 0?t:Vt(e)(t)},yE=(e,t)=>So(Ze)(Tu(e,t)),Tu=(e,t)=>So(t===void 0?Au(e):Vt(t)(Au(e)),Ot),bE=e=>{let t=zo("a date property",r=>{let o=Date.parse(r);return Number.isNaN(o)?q(jr([],`Expected a date value but received ${r}`)):P(new Date(o))});return e===void 0?t:Vt(e)(t)},SE=e=>{let t=Object.create($t);return t._tag=gu,t.message=e,t.parse=()=>q(hu([],e)),t},EE=e=>{let t=zo("a number property",r=>{let o=Number.parseFloat(r);return Number.isNaN(o)?q(jr([],`Expected an number value but received ${r}`)):P(o)});return e===void 0?t:Vt(e)(t)},_E=e=>{let t=zo("an integer property",r=>{let o=Number.parseInt(r,10);return Number.isNaN(o)?q(jr([],`Expected an integer value but received ${r}`)):P(o)});return e===void 0?t:Vt(e)(t)},OE=e=>{let t=Vs(_h(),r=>{let o=r.toUpperCase(),n=sh.find(s=>s.label===o);return n===void 0?q(jr([],`Expected a log level, but found: ${r}`)):P(n)});return e===void 0?t:Vt(t,e)},So=a(2,(e,t)=>Vs(e,r=>P(t(r)))),CE=a(2,(e,t)=>Vs(e,r=>{try{return P(t(r))}catch(o){return q(jr([],o instanceof Error?o.message:`${o}`))}})),Vs=a(2,(e,t)=>{let r=Object.create($t);return r._tag=Su,r.original=e,r.mapOrFail=t,r}),RE=e=>t=>mr([],`Expected ${t.description} with name ${e}`),Vt=a(2,(e,t)=>{let r=Object.create($t);return r._tag=Eu,r.name=t,r.config=e,r}),AE=a(2,(e,t)=>{let r=Object.create($t);return r._tag=la,r.first=e,r.second=fa(t),r.condition=_r,r}),vu=a(2,(e,t)=>{let r=Object.create($t);return r._tag=la,r.first=e,r.second=fa(t.orElse),r.condition=t.if,r}),ME=e=>vu({orElse:()=>Ys(x()),if:Sh})(So(d)(e)),zo=(e,t)=>{let r=Object.create($t);return r._tag=_u,r.description=e,r.parse=t,r},Au=e=>{let t=Object.create($t);return t._tag=Ou,t.config=e,t},TE=e=>{let t=zo("a secret property",r=>P(hE(r)));return e===void 0?t:Vt(e)(t)},vE=(e,t)=>{let r=So(Tu(e),pt);return t===void 0?r:Vt(t)(r)},_h=e=>{let t=zo("a text property",P);return e===void 0?t:Vt(e)(t)},IE=e=>Array.isArray(e)?xE(e):Symbol.iterator in e?xE([...e]):kE(e),kE=e=>{let t=Object.entries(e),r=So(n=>({[t[0][0]]:n}))(t[0][1]);if(t.length===1)return r;let o=t.slice(1);for(let[n,s]of o)r=ma(s,(i,c)=>({...i,[n]:c}))(r);return r},Ys=e=>{let t=Object.create($t);return t._tag=xu,t.value=e,t.parse=()=>P(e),t},fa=e=>{let t=Object.create($t);return t._tag=bu,t.config=e,t},wE=e=>fa(()=>Ys(e())),FE=(e,t)=>{let r=Object.create($t);return r._tag=Cu,r.valueConfig=e,t===void 0?r:Vt(t)(r)},Oh=e=>typeof e=="object"&&e!=null&&Mu in e,xE=e=>{if(e.length===0)return Ys([]);if(e.length===1)return So(e[0],r=>[r]);let t=So(e[0],r=>[r]);for(let r=1;r<e.length;r++){let o=e[r];t=ma(o,(n,s)=>[...n,s])(t)}return t},Ch=e=>Oh(e)?e:kE(Object.fromEntries(Object.entries(e).map(([t,r])=>[t,Ch(r)]))),PE=a(2,(e,{message:t,validation:r})=>Vs(e,o=>r(o)?P(o):q(jr([],t)))),NE=a(2,(e,t)=>vu(e,{orElse:()=>Ys(t),if:Sh})),DE=a(2,(e,t)=>{let r=Object.create($t);return r._tag=yu,r.config=e,r.description=t,r}),LE=a(2,(e,t)=>ma(e,t,(r,o)=>[r,o])),ma=a(3,(e,t,r)=>{let o=Object.create($t);return o._tag=Ru,o.left=e,o.right=t,o.zip=r,o});var qE={_tag:"Empty"};var Iu=a(2,(e,t)=>{let r=ji(t),o=e;for(;Wi(r);){let n=r.head;switch(n._tag){case"Empty":{r=r.tail;break}case"AndThen":{r=ao(n.first,ao(n.second,r.tail));break}case"MapName":{o=Zr(o,n.f),r=r.tail;break}case"Nested":{o=rr(o,n.name),r=r.tail;break}case"Unnested":{if(jg(n.name)(Ic(o)))o=Lt(o),r=r.tail;else return q(mr(o,`Expected ${n.name} to be in path in ConfigProvider#unnested`));break}}}return P(o)});var ku=(e,t)=>[...e,...t],Ew="@effect/io/Config/Provider",Rh=Symbol.for(Ew),Js=St(Rh),_w="@effect/io/Config/Provider/Flat",UE=Symbol.for(_w),Ow=e=>({[Rh]:Rh,pipe(){return E(this,arguments)},...e}),Cw=e=>({[UE]:UE,patch:e.patch,load:(t,r,o=!0)=>e.load(t,r,o),enumerateChildren:e.enumerateChildren}),Rw=e=>Ow({load:t=>l(Yt(e,Xo(),t,!1),r=>De(Ic(r),{onNone:()=>L(mr(Xo(),`Expected a single value having structure: ${t}`)),onSome:h})),flattened:e}),WE=(e={})=>{let{pathDelim:t,seqDelim:r}=Object.assign({},{pathDelim:"_",seqDelim:","},e),o=p=>Xr(t)(p),n=p=>p.split(t),s=()=>typeof process<"u"&&"env"in process&&typeof process.env=="object"?process.env:{};return Rw(Cw({load:(p,u,f=!0)=>{let m=o(p),y=s(),b=m in y?d(y[m]):x();return l(C=>vw(C,p,u,r,f))(fo(()=>mr(p,`Expected ${m} to exist in the process context`))(b))},enumerateChildren:p=>g(()=>{let u=s(),f=Object.keys(u),y=Array.from(f).map(b=>n(b.toUpperCase())).filter(b=>{for(let C=0;C<p.length;C++){let R=df(C)(p),v=b[C];if(v===void 0||R!==v)return!1}return!0}).flatMap(b=>b.slice(p.length,p.length+1));return pt(y)}),patch:qE}))};var Aw=(e,t,r,o)=>{let n=yf(r.length,p=>p>=o.length?x():d([e(p),p+1])),s=yf(o.length,p=>p>=r.length?x():d([t(p),p+1])),i=ku(r,n),c=ku(o,s);return[i,c]},Yt=(e,t,r,o)=>{let n=r;switch(n._tag){case xu:return h(bt(n.value));case yu:return T(()=>Yt(e,t,n.config,o));case gu:return L(mr(t,n.message));case la:return lt(s=>n.condition(s)?lt(i=>L(mu(s,i)))(Yt(e,t,n.second,o)):L(s))(T(()=>Yt(e,t,n.first,o)));case bu:return T(()=>Yt(e,t,n.config(),o));case Su:return T(()=>l(He(s=>fo(bo(t))(n.mapOrFail(s))))(Yt(e,t,n.original,o)));case Eu:return T(()=>Yt(e,ku(t,bt(n.name)),n.config,o));case _u:return l(s=>l(i=>{if(i.length===0){let c=$(()=>"<n/a>")(Bg(s));return L(RE(c))}return h(i)})(e.load(s,n,o)))(Iu(t,e.patch));case Ou:return l(s=>l(i=>i.length===0?T(()=>_(Yt(e,s,n.config,!0),bt)):_(c=>{let p=wc(c);return p.length===0?bt(Xo()):bt(p)})(He(i,c=>Yt(e,zg(t,`[${c}]`),n.config,!0))))(l(ww)(e.enumerateChildren(s))))(Iu(t,e.patch));case Cu:return T(()=>l(s=>l(i=>_(c=>{if(c.length===0)return bt(oo());let p=c.map(u=>Array.from(u));return Zr(u=>$c(gf(J(i),u)))(Iw(p))})(He(c=>Yt(e,ku(s,bt(c)),n.valueConfig,o))(i)))(e.enumerateChildren(s)))(Iu(t,e.patch)));case Ru:return T(()=>l(s=>l(i=>{if(Ae(s)&&Ae(i))return L(fu(s.left,i.left));if(Ae(s)&&Or(i))return L(s.left);if(Or(s)&&Ae(i))return L(i.left);if(Or(s)&&Or(i)){let c=Xr(".")(t),p=Mw(t,c),[u,f]=Aw(p,p,Zr(P)(s.right),Zr(P)(i.right));return He(([m,y])=>_(([b,C])=>n.zip(b,C))($p(m,y)))(gf(f)(u))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/io/issues")})(Dr(Yt(e,t,n.right,o))))(Dr(Yt(e,t,n.left,o))))}},Mw=(e,t)=>r=>q(mr(e,`The element at index ${r} in a sequence at path "${t}" was missing`));var Tw=(e,t)=>e.split(new RegExp(`\\s*${kw(t)}\\s*`)),vw=(e,t,r,o,n)=>n?fo(bo(t))(He(s=>r.parse(s.trim()))(Tw(e,o))):fo(bo(t))(_(bt)(r.parse(e))),Iw=e=>Object.keys(e[0]).map(t=>e.map(r=>r[t])),kw=e=>e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&"),ww=e=>_(Mc)(Dr(zp({onFailure:()=>Xo(),onSuccess:Zo(yt)})(He(e,Pw))));var Fw=/^(\[(\d+)\])$/,Pw=e=>{let t=e.match(Fw);if(t!==null){let r=t[2];return ns(Nw)(r!==void 0&&r.length>0?d(r):x())}return x()};var Nw=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?x():d(t)};var Ah=Symbol("@effect/io/Console"),jE=St(Ah),zE={[Ah]:Ah,assert(e,...t){return g(()=>{console.assert(e,...t)})},clear:g(()=>{console.clear()}),count(e){return g(()=>{console.count(e)})},countReset(e){return g(()=>{console.countReset(e)})},debug(...e){return g(()=>{console.debug(...e)})},dir(e,t){return g(()=>{console.dir(e,t)})},dirxml(...e){return g(()=>{console.dirxml(...e)})},error(...e){return g(()=>{console.error(...e)})},group(e){return e?.collapsed?g(()=>console.groupCollapsed(e?.label)):g(()=>console.group(e?.label))},groupEnd:g(()=>{console.groupEnd()}),info(...e){return g(()=>{console.info(...e)})},log(...e){return g(()=>{console.log(...e)})},table(e,t){return g(()=>{console.table(e,t)})},time(e){return g(()=>console.time(e))},timeEnd(e){return g(()=>console.timeEnd(e))},timeLog(e,...t){return g(()=>{console.timeLog(e,...t)})},trace(...e){return g(()=>{console.trace(...e)})},warn(...e){return g(()=>{console.warn(...e)})},withGroup(e,t){return zt(t?.collapsed?g(()=>console.groupCollapsed(t?.label)):g(()=>console.group(t?.label)),()=>e,()=>g(()=>console.groupEnd()))},withTime(e,t){return zt(g(()=>console.time(t)),()=>e,()=>g(()=>console.timeEnd(t)))}};var KE,Hw="@effect/io/Random",Th=Symbol.for(Hw),vh=St(Th),Mh=class{constructor(t){this.seed=t,this[KE]=Th,this.PRNG=new ts(t)}next(){return g(()=>this.PRNG.number())}nextBoolean(){return _(this.next(),t=>t>.5)}nextInt(){return g(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,r){return _(this.next(),o=>(r-t)*o+t)}nextIntBetween(t,r){return g(()=>this.PRNG.integer(r-t)+t)}shuffle(t){return qw(t,r=>this.nextIntBetween(0,r+1))}};KE=Th;var qw=(e,t)=>T(()=>l(r=>{let o=[];for(let n=r.length;n>=2;n=n-1)o.push(n);return V(Tr(r))(mt(n=>_(s=>Uw(r,n-1,s))(t(n)))(o))})(g(()=>Array.from(e)))),Uw=(e,t,r)=>{let o=e[t];return e[t]=e[r],e[r]=o,e},BE=e=>new Mh(e);var GE=Symbol.for("@effect/io/Tracer"),jw=e=>({[GE]:GE,...e}),Qs=St(Symbol.for("@effect/io/Tracer")),zw=z("@effect/io/Tracer/SpanId.ids",()=>at(0)),Ih=class{constructor(t,r,o,n,s){this.name=t,this.parent=r,this.context=o,this.links=n,this.startTime=s,this._tag="Span",this.traceId="native",this.events=[],this.end=(i,c)=>{this.status={_tag:"Ended",endTime:i,exit:c,startTime:this.status.startTime}},this.attribute=(i,c)=>{this.attributes.set(i,c)},this.event=(i,c,p)=>{this.events.push([i,c,p??{}])},this.status={_tag:"Started",startTime:s},this.attributes=new Map,this.spanId=`span${zy(zw)}`}},$E=jw({span:(e,t,r,o,n)=>new Ih(e,t,r,o,n)});var Kw=we(Qs,$E)(we(Js,WE())(we(vh,BE(Math.random()*4294967296>>>0))(we(jE,zE)(we(Wr,cE())(Ht()))))),ot=Jp(Kw),YE=e=>{let t=ze(e);return ha(r=>r.sleep(t))},ha=e=>Se(ot,t=>e(to(t,Wr))),JE=ha(e=>e.currentTimeMillis),QE=ha(e=>e.currentTimeNanos),ZE=a(2,(e,t)=>qe(ot,we(Wr,t))(e)),XE=a(2,(e,t)=>qe(ot,we(Js,t))(e)),kh=e=>Se(ot,t=>e(to(t,Js))),e_=e=>kh(t=>t.load(e));var wu=e=>Se(ot,t=>e(to(t,vh)));var Fu=e=>Se(ot,t=>e(to(t,Qs))),t_=a(2,(e,t)=>qe(ot,we(Qs,t))(e));var wh=YE,Pu=JE,Fh=QE,r_=ha;var n_;function s_(e){return new Pn(e)}var Ph=Symbol.for("@effect/io/FiberRefs"),Pn=class{constructor(t){this.locals=t,this[n_]=Ph}pipe(){return E(this,arguments)}};n_=Ph;var Bw=(e,t,r,o=!1)=>{let n=e,s=t,i=r,c=o,p;for(;p===void 0;)if(Cr(s)&&Cr(i)){let u=_e(s)[0],f=Lt(s),m=_e(i)[0],y=_e(i)[1],b=Lt(i);u.startTimeMillis<m.startTimeMillis?(i=b,c=!0):u.startTimeMillis>m.startTimeMillis?s=f:u.id<m.id?(i=b,c=!0):u.id>m.id?s=f:p=[y,c]}else p=[n.initial,!0];return p},Nu=a(3,(e,t,r)=>{let o=new Map(e.locals);for(let[n,s]of r.locals){let i=_e(s)[1];if(!O(_e(s)[0],t)){if(!o.has(n)){if(O(i,n.initial))continue;o.set(n,[[t,n.join(n.initial,i)]]);continue}let c=o.get(n),[p,u]=Bw(n,c,s);if(u){let f=n.diff(p,i),m=_e(c)[1],y=n.join(m,n.patch(f)(m));if(!O(m,y)){let b,C=_e(c)[0];O(C,t)?b=rr([C,y])(Lt(c)):b=rr([t,y])(c),o.set(n,b)}}}}return new Pn(new Map(o))}),Du=a(2,(e,t)=>{let r=new Map;for(let[o,n]of e.locals.entries()){let s=_e(n)[1],i=o.patch(o.fork)(s);O(s,i)?r.set(o,n):r.set(o,rr([t,i])(n))}return new Pn(r)}),i_=e=>pt(e.locals.keys()),a_=e=>mt(i_(e),t=>Cn(t,Zs(e,t))),xa=a(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new Pn(r)}),ga=a(2,(e,t)=>e.locals.has(t)?d(_e(e.locals.get(t))[1]):x()),Zs=a(2,(e,t)=>$(()=>t.initial)(ga(e,t))),Nn=a(2,(e,{fiberId:t,fiberRef:r,value:o})=>{let n=e.locals.has(r)?e.locals.get(r):Xo(),s;if(hf(n))s=bt([t,o]);else{let[c,p]=_e(n);if(O(c,t)){if(O(p,o))return e;s=rr([t,o])(Lt(n))}else s=rr([t,o])(n)}let i=new Map(e.locals);return new Pn(i.set(r,s))});var c_=Du;var p_=Nu,u_=a_,Dh=Nn,l_=s_;var m_="Empty",h_="Add",d_="Remove",x_="Update",g_="AndThen",y_={_tag:m_},Hu=(e,t)=>{let r=new Map(e.locals),o=y_;for(let[n,s]of t.locals.entries()){let i=_e(s)[1],c=r.get(n);if(c!==void 0){let p=_e(c)[1];O(p,i)||(o=Lu({_tag:x_,fiberRef:n,patch:n.diff(p,i)})(o))}else o=Lu({_tag:h_,fiberRef:n,value:i})(o);r.delete(n)}for(let[n]of r.entries())o=Lu({_tag:d_,fiberRef:n})(o);return o},Lu=a(2,(e,t)=>({_tag:g_,first:e,second:t})),qu=a(3,(e,t,r)=>{let o=r,n=bt(e);for(;Cr(n);){let s=_e(n),i=Lt(n);switch(s._tag){case m_:{n=i;break}case h_:{o=Nn(o,{fiberId:t,fiberRef:s.fiberRef,value:s.value}),n=i;break}case d_:{o=xa(o,s.fiberRef),n=i;break}case x_:{let c=Zs(o,s.fiberRef);o=Nn(o,{fiberId:t,fiberRef:s.fiberRef,value:s.fiberRef.patch(s.patch)(c)}),n=i;break}case g_:{n=rr(s.first)(rr(s.second)(i));break}}}return o});var S_,E_="@effect/io/Metric/Label",Lh=Symbol.for(E_),Hh=class{constructor(t,r){this.key=t,this.value=r,this[S_]=Lh}[(S_=Lh,A)](){return I(S(this.value))(I(S(this.key))(S(E_)))}[M](t){return Gw(t)&&this.key===t.key&&this.value===t.value}pipe(){return E(this,arguments)}},Uu=(e,t)=>new Hh(e,t),Gw=e=>typeof e=="object"&&e!=null&&Lh in e;var Wu=class e{constructor(t){this.self=t,this.called=!1}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new e(this.self)}};var Vw=Xm,qh=eh,Uh=th,Wh=rh,jh=Vp,zh=Yp,Kh=oh,Yw=nh;var Jw=Ci(e=>e.ordinal)(yt);var O_=Ql(Jw);var C_=e=>{switch(e){case"All":return Vw;case"Debug":return zh;case"Error":return Uh;case"Fatal":return qh;case"Info":return jh;case"Trace":return Kh;case"None":return Yw;case"Warning":return Wh}};var A_=(e,t)=>({label:e,startTime:t}),M_=e=>t=>`${t.label.replace(/[\s="]/g,"_")}=${e-t.startTime}ms`;var T_=A_,v_=M_;var k_,ju=Symbol.for("@effect/io/Ref"),Gh={_A:e=>e},Bh=class{constructor(t){this.ref=t,this[k_]=Gh}modify(t){return g(()=>{let r=_t(this.ref),[o,n]=t(r);return r!==n&&Ut(n)(this.ref),o})}pipe(){return E(this,arguments)}};k_=ju;var zu=e=>new Bh(at(e)),Dn=e=>g(()=>zu(e)),hr=e=>e.modify(t=>[t,t]),zr=a(2,(e,t)=>e.modify(()=>[void 0,t])),w_=a(2,(e,t)=>e.modify(r=>[r,t]));var Ku=a(2,(e,t)=>e.modify(t));var ya=a(2,(e,t)=>e.modify(r=>[void 0,t(r)]));var ba=Dn,Gu=hr,F_=w_;var P_=Ku;var N_=ya;var L_=Fu;var H_=a(e=>de(e[0]),function(){let e=arguments;return qe(e[0],na,typeof e[1]=="string"?Mr(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[o,n])=>Mr(r,o,n),t))}),$u=e=>_(e,d),q_=e=>fo(e,d),U_=(e,t=et)=>Pr(r=>{let o=e(r);switch(o._tag){case"None":return q(k);case"Some":return P(o.value)}},t),Sa=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),g(()=>{try{return t()}catch(o){throw IS(yn(r?r(o):o))}})},W_=a(3,(e,t,r)=>lt(e,o=>typeof o=="object"&&o!=null&&t in o&&o[t]===r.failure?r.onFailure(o):L(o))),j_=a(2,(e,t)=>Nr(e,Do(r=>{let o=Gi(r,n=>dp(n)?d(n):x());switch(o._tag){case"None":return D(r);case"Some":return t(o.value.defect)}}))),z_=a(2,(e,t)=>Y(e,{onFailure:r=>{let o=t(r);switch(o._tag){case"None":return D(r);case"Some":return o.value}},onSuccess:h})),K_=a(2,(e,t)=>Nr(e,Do(r=>{let o=Gi(r,n=>dp(n)?d(n):x());switch(o._tag){case"None":return D(r);case"Some":{let n=t(o.value.defect);return n._tag==="Some"?n.value:D(r)}}}))),B_=a(3,(e,t,r)=>lt(e,o=>pe(o)&&"_tag"in o&&o._tag===t?r(o):L(o))),G_=a(2,(e,t)=>lt(e,r=>{let o=Object.keys(t);return pe(r)&&"_tag"in r&&o.includes(r._tag)?t[r._tag](r):L(r)})),$_=e=>ra(e,{onFailure:F,onSuccess:()=>tt}),Kr=r_,V_=Kr(h),Y_=a(2,(e,t)=>W(wh(t),e)),Vu=e=>ue((t,r)=>e({id:t.id(),status:r,interruptors:Bi(t.getFiberRef(In))})),J_=Vu(e=>io(e.interruptors)>0?Wp:k),Q_=Vu(h),Ln=e=>Yu(e,Yh,Hu),Z_=h({}),X_=a(3,(e,t,r)=>l(e,o=>_(r(o),n=>({...o,[t]:n})))),eO=a(2,(e,t)=>_(e,r=>({[t]:r}))),tO=a(3,(e,t,r)=>_(e,o=>({...o,[t]:r(o)}))),rO=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!1),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>u?(o.push(c),h(!0)):t(c,p))}return _(s,()=>o)})),oO=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!0),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>_(u?t(c,p):h(!1),f=>(f||o.push(c),f)))}return _(s,()=>o)})),nO=e=>_(Lr(),e),Vh=e=>Rn(e,()=>l(Mt(),()=>Vh(e)));var sO=a(3,(e,t,r)=>Ea(e,t,()=>Lo(r))),iO=a(3,(e,t,r)=>Ea(e,t,()=>Ps(r))),Ea=a(3,(e,t,r)=>l(e,o=>t(o)?h(o):r(o))),aO=a(3,(e,t,r)=>Ea(e,t,o=>ur(()=>r(o)))),cO=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=r.next();return o.done?h(x()):pO(r,0,t,o.value)})),pO=(e,t,r,o)=>l(r(o,t),n=>{if(n)return h(d(o));let s=e.next();return s.done?h(x()):pO(e,t+1,r,s.value)}),uO=e=>T(()=>{let t=Tr(e);return Ke(t)?it(Be(t),(r,o)=>Rn(r,()=>o))(Ge(t)):Lo(()=>Cs("Received an empty collection of effects"))}),lO=a(2,(e,t)=>qo(t(qo(e)))),_a=a(2,(e,{onFailure:t,onSuccess:r})=>ie(e,{onFailure:o=>h(t(o)),onSuccess:o=>h(r(o))})),fO=a(2,(e,t)=>T(()=>mO(e[Symbol.iterator](),0,t))),mO=(e,t,r)=>{let o=e.next();return o.done?h(!0):l(r(o.value,t),n=>n?mO(e,t+1,r):h(n))},hO=e=>{let t=l(l(e,()=>Mt()),()=>t);return t},$h=class{constructor(t){this.value=t}[Symbol.iterator](){return new Wu(this)}},Xw=function(){let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return new $h(e)},dO=e=>T(()=>{let t=e(Xw),r=t.next(),o=n=>n.done?h(n.value):l(s=>o(t.next(s)))(n.value.value);return o(r)}),Yh=ue(e=>h(e.unsafeGetFiberRefs())),xO=e=>ie(e,{onFailure:t=>L(d(t)),onSuccess:t=>{let o=t[Symbol.iterator]().next();return o.done?L(x()):h(o.value)}}),gO=e=>_a(e,{onFailure:Xn,onSuccess:Xn}),yO=e=>Y(e,{onFailure:t=>Qh(t,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>k}),bO=e=>Ju((t,r)=>p_(r,t,e)),SO=e=>_a(e,{onFailure:_r,onSuccess:Pt}),EO=e=>_a(e,{onFailure:Pt,onSuccess:_r}),Jh=(e,t)=>T(()=>t.while(e)?l(t.body(e),r=>Jh(r,t)):h(e)),Hn=e=>(t,r)=>{let o=Dt(e),n,s;return hp(t)?(s=t,n=r??""):(n=t,s=r??tt),ue(i=>(i.log(n,s,o),k))},_O=Hn(),OO=Hn(Kh),Qh=Hn(zh),CO=Hn(jh),RO=Hn(Wh),AO=Hn(Uh),MO=Hn(qh),TO=a(2,(e,t)=>l(Pu,r=>qe(e,Qp,ko(T_(t,r))))),vO=Ye(na),IO=(e,t)=>t.discard?wO(e,t.while,t.step,t.body):_(kO(e,t.while,t.step,t.body),r=>Array.from(r)),kO=(e,t,r,o)=>T(()=>t(e)?l(o(e),n=>_(kO(r(e),t,r,o),ko(n))):g(()=>ar())),wO=(e,t,r,o)=>T(()=>t(e)?l(o(e),()=>wO(r(e),t,r,o)):k),FO=a(3,(e,t,r)=>T(()=>{let o=e[Symbol.iterator](),n=[],s=h(t),i,c=0;for(;!(i=o.next()).done;){let p=c++;s=l(s,u=>_(r(u,i.value,p),([f,m])=>(n.push(m),f)))}return _(s,p=>[p,n])})),Xs=a(2,(e,t)=>Y(e,{onFailure:r=>Hr(()=>t(r)),onSuccess:h})),Zh=e=>l(t=>_(r=>W(r,l(([o,n])=>V(qn(o),n))(ve(t))))(Xh(qr(t)(Ln(e)))))(rt()),PO=e=>ie(e,{onFailure:t=>h(t),onSuccess:h}),Oa=e=>_(e,t=>!t),NO=e=>ie(e,{onFailure:t=>L(d(t)),onSuccess:t=>{switch(t._tag){case"None":return k;case"Some":return L(x())}}}),Xh=e=>_(ba(!0),t=>Q(Hs(e,F_(t,!1)))),DO=e=>ie(e,{onFailure:()=>h(x()),onSuccess:t=>h(d(t))}),LO=a(2,(e,t)=>Rn(e,()=>ur(t))),HO=a(2,(e,t)=>Rn(e,()=>g(t))),qO=e=>Y(e,{onFailure:t=>{let r=Array.from(Ki(t));return r.length===0?D(t):L(r)},onSuccess:h}),qn=e=>Ju((t,r)=>qu(t,r)(e)),UO=e=>e.length>=1?Kt((t,r)=>{e(r).then(o=>t(X(o))).catch(o=>t(ou(o)))}):Kt(t=>{e().then(r=>t(X(r))).catch(r=>t(ou(r)))}),WO=a(3,(e,t,r)=>ed(e,t,h(r))),ed=a(3,(e,t,r)=>Ns(o=>l(r,n=>Rt(e,we(t,n)(o))))),jO=wu(h),zO=a(3,(e,t,r)=>J(e).reduce((o,n,s)=>l(o,i=>r(i,n,s)),h(t))),KO=a(3,(e,t,r)=>J(e).reduceRight((o,n,s)=>l(o,i=>r(n,i,s)),h(t))),BO=a(3,(e,t,r)=>l(g(()=>e[Symbol.iterator]()),o=>GO(o,0,t,r.while,r.body))),GO=(e,t,r,o,n)=>{let s=e.next();return!s.done&&o(r)?l(n(r,s.value,t),i=>GO(e,t+1,i,o,n)):h(r)},$O=a(2,(e,t)=>T(()=>VO(e,t))),VO=(e,t)=>l(e,r=>t<=0?h(r):W(Mt(),VO(e,t-1))),YO=e=>Y(e,{onFailure:L,onSuccess:h}),JO=e=>T(()=>u_(e)),ei=wh,QO=e=>ie(e,{onFailure:t=>L(d(t)),onSuccess:t=>{switch(t._tag){case"None":return L(x());case"Some":return h(t.value)}}}),ti=h(x()),td=e=>h(d(e)),Yu=a(3,(e,t,r)=>l(t,o=>l(e,n=>_(t,s=>[r(o,s),n])))),ZO=a(3,(e,t,r)=>rd(e,[Uu(t,r)])),rd=a(2,(e,t)=>od(e,pt(t))),od=a(2,(e,t)=>qe(go,r=>Ve(t)(r))(e)),XO=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!1),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>u?h(!0):(o.push(c),t(c,p)))}return _(s,()=>o)})),eC=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!0),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>_(f=>(f&&o.push(c),f))(u?t(c,p):h(!1)))}return _(s,()=>o)})),tC=a(2,(e,{onFailure:t,onSuccess:r})=>Y(e,{onFailure:o=>{let n=co(o);switch(n._tag){case"Left":return W(t(n.left),D(o));case"Right":return D(o)}},onSuccess:o=>V(r(o),o)})),rC=a(2,(e,t)=>Nr(e,r=>De(Tm(r),{onNone:()=>D(r),onSome:o=>W(t(o),D(r))}))),nd=a(2,(e,t)=>Y(e,{onFailure:r=>{let o=co(r);switch(o._tag){case"Left":return W(t(o.left),D(r));case"Right":return D(r)}},onSuccess:h})),oC=a(3,(e,t,r)=>nd(e,o=>pe(o)&&"_tag"in o&&o._tag===t?r(o):k)),nC=a(2,(e,t)=>Y(e,{onFailure:r=>W(t(r),D(r)),onSuccess:h})),sC=e=>sd(e,Fh),sd=a(2,(e,t)=>Yu(e,t,(r,o)=>Nc(o-r))),iC=L_,aC=iC(h),id=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),t.length>=1?T(()=>{let o=new AbortController;return l(Sa(()=>t(o.signal)),n=>Kt(s=>(n.then(i=>s(X(i))).catch(i=>s(fr(r?r(i):i))),g(()=>o.abort()))))}):l(Sa(e),o=>Kt(n=>{o.then(s=>n(X(s))).catch(s=>n(fr(r?r(s):s)))}))},cC=a(2,(e,t)=>l(e,r=>Sa({try:()=>t.try(r),catch:t.catch}))),pC=a(2,(e,t)=>l(e,r=>id({try:t.try.length>=1?o=>t.try(r,o):()=>t.try(r),catch:t.catch}))),uC=a(2,(e,t)=>T(()=>t()?ti:$u(e))),lC=a(2,(e,t)=>l(t,r=>r?ti:$u(e))),fC=e=>Xs(e,vm),Ju=e=>ue(t=>(t.setFiberRefs(e(t.id(),t.unsafeGetFiberRefs())),k)),mC=a(3,(e,t,r)=>Mn(e,o=>we(o,t,r(ki(o,t))))),Qu=a(2,(e,t)=>T(()=>t()?_(e,d):h(x()))),hC=a(3,(e,t,r)=>l(Ye(t),o=>r(o)?_(e,n=>[o,d(n)]):h([o,x()]))),dC=a(3,(e,t,r)=>l(Gu(t),o=>r(o)?_(e,n=>[o,d(n)]):h([o,x()]))),xC=a(2,(e,t)=>t(e)),gC=(e,t)=>(...r)=>l(e,o=>t(o)(...r)),yC=(e,t)=>(...r)=>_(e,o=>t(o)(...r)),ad=e=>new Proxy({},{get(t,r,o){return(...n)=>l(e,s=>s[r](...n))}}),cd=e=>new Proxy({},{get(t,r,o){return l(e,n=>n[r])}}),bC=e=>({functions:ad(e),constants:cd(e)}),SC=function(){let e=arguments;return l(ud,t=>t._tag==="Some"?g(()=>{if(typeof e[0]=="string")t.value.attribute(e[0],e[1]);else for(let r in e[0])t.value.attribute(r,e[0][r])}):k)},EC=a(e=>de(e[0]),function(){let e=arguments;return qe(e[0],Xp,typeof e[1]=="string"?Mr(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[o,n])=>Mr(r,o,n),t))}),pd=_(Ye(yo),np),ud=_(Ye(yo),kb(e=>e._tag==="Span")),eF=BigInt(0),Zu=Se(aa,e=>e?Fh:h(eF)),_C=a(e=>de(e[0]),(e,t,r)=>qe(e,eu,Qc({_tag:"SpanLink",span:t,attributes:r??{}}))),ri=(e,t)=>iC(r=>l(t?.parent?td(t.parent):t?.root?ti:pd,o=>l(Ye(Xp),n=>l(Ye(eu),s=>l(Zu,i=>g(()=>{let c=t?.links?[...Ze(s),...t.links]:Ze(s),p=r.span(e,o,t?.context??Ht(),c,i);return jy(n,(u,f)=>p.attribute(f,u)),Object.entries(t?.attributes??{}).forEach(([u,f])=>p.attribute(u,f)),p})))))),OC=Ye(Xp),CC=Ye(eu),ld=(e,...t)=>{let r=t.length===1?void 0:t[0],o=t[t.length-1];return zt(ri(e,r),o,(n,s)=>l(Zu,i=>g(()=>n.end(i,s))))},fd=a(2,(e,t)=>qe(e,yo,ko(t))),RC=a(e=>typeof e[0]!="string",(e,t,r)=>ld(t,r??{},o=>fd(e,o))),AC=e=>T(()=>{let t=e();return t==null?L(po()):h(t)}),MC=e=>lt(_(e,d),t=>wm(t)?ti:L(t));var TC,vC,IC,Xu="@effect/io/Fiber/Status",Ko=Symbol.for(Xu),md="Done",kC="Running",wC="Suspended",hd=class{constructor(){this[TC]=Ko,this._tag=md}[(TC=Ko,A)](){return I(S(this._tag))(S(Xu))}[M](t){return el(t)&&t._tag===md}},dd=class{constructor(t){this.runtimeFlags=t,this[vC]=Ko,this._tag=kC}[(vC=Ko,A)](){return I(S(this.runtimeFlags))(I(S(this._tag))(S(Xu)))}[M](t){return el(t)&&t._tag===kC&&this.runtimeFlags===t.runtimeFlags}},xd=class{constructor(t,r){this.runtimeFlags=t,this.blockingOn=r,this[IC]=Ko,this._tag=wC}[(IC=Ko,A)](){return I(S(this.blockingOn))(I(S(this.runtimeFlags))(I(S(this._tag))(S(Xu))))}[M](t){return el(t)&&t._tag===wC&&this.runtimeFlags===t.runtimeFlags&&O(this.blockingOn,t.blockingOn)}},FC=new hd,PC=e=>new dd(e),NC=(e,t)=>new xd(e,t),el=e=>typeof e=="object"&&e!=null&&Ko in e,DC=e=>e._tag===md;var LC=FC,gd=PC,HC=NC;var qC=DC;var ni=Hu;var yd=qu;var tl=z(Symbol.for("@effect/io/FiberRef/currentRequestMap"),()=>xe(new Map));var bd=(e,t,r,o)=>{switch(e?.concurrency){case void 0:return t();case"unbounded":return r();case"inherit":return Se(Zp,n=>n==="unbounded"?r():n>1?o(n):t());default:return e.concurrency>1?o(e.concurrency):t()}},Ca=(e,t,r)=>{switch(e?.concurrency){case void 0:return t();case"unbounded":return r();case"inherit":return Se(Zp,o=>o==="unbounded"||o>1?r():t());default:return e.concurrency>1?r():t()}};var WC="Sequential",jC="Parallel";var si={_tag:WC},zC={_tag:jC};var KC=e=>e._tag===WC,BC=e=>e._tag===jC;var rl="InterruptSignal",ol="Stateful",nl="Resume",sl="YieldNow",Sd=e=>({_tag:rl,cause:e}),ii=e=>({_tag:ol,onFiber:e}),Un=e=>({_tag:nl,effect:e}),$C=()=>({_tag:sl});var YC,JC,sF="@effect/io/Fiber/Scope",il=Symbol.for(sF),Ed=class{constructor(){this[YC]=il,this.fiberId=et,this.roots=new Set}add(t,r){this.roots.add(r),r.unsafeAddObserver(()=>{this.roots.delete(r)})}};YC=il;var _d=class{constructor(t,r){this.fiberId=t,this.parent=r,this[JC]=il}add(t,r){this.parent.tell(ii(o=>{o.addChild(r),r.unsafeAddObserver(()=>{o.removeChild(r)})}))}};JC=il;var QC=e=>new _d(e.id(),e),Wn=z(Symbol.for("@effect/io/FiberScope/Global"),()=>new Ed);var iF="@effect/io/Fiber",Ra=Symbol.for(iF),Aa={_E:e=>e,_A:e=>e},aF={[Ra]:Aa,pipe(){return E(this,arguments)}},cF="@effect/io/Fiber",XC=Symbol.for(cF);var Od=e=>e.await();var eR=e=>e.inheritAll();var tR=a(2,(e,t)=>e.interruptAsFork(t)),jn=e=>qs(ft(e.await()),e.inheritAll());var GK={...aF,id:()=>et,await:()=>vn,children:()=>h([]),inheritAll:()=>vn,poll:()=>h(x()),interruptAsFork:()=>vn};var Bo="@effect/io/Fiber/Current";var pF="@effect/io/Logger",oR=Symbol.for(pF),nR={_Message:e=>e,_Output:e=>e},al=e=>({[oR]:nR,log:e,pipe(){return E(this,arguments)}});var YK={[oR]:nR,log:Xn,pipe(){return E(this,arguments)}};var sR=al(({annotations:e,cause:t,date:r,fiberId:o,logLevel:n,message:s,spans:i})=>{let c=r.getTime(),u=[`timestamp=${r.toISOString()}`,`level=${n.label}`,`fiber=${pp(o)}`].join(" "),f=uF(s);if(f.length>0&&(u=u+" message=",u=Cd(f,u)),t!=null&&t!=tt&&(u=u+" cause=",u=Cd(uo(t),u)),Wi(i)){u=u+" ";let m=!0;for(let y of i)m?m=!1:u=u+" ",u=u+v_(c)(y)}if(Vc(e)>0){u=u+" ";let m=!0;for(let[y,b]of e)m?m=!1:u=u+" ",u=u+mF(y),u=u+"=",u=Cd(String(b),u)}return u}),uF=e=>{try{return typeof e=="object"?JSON.stringify(e):String(e)}catch{return String(e)}},lF=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,fF=/^[^\s"=]+$/,Cd=(e,t)=>t+(e.match(fF)?e:lF(e));var mF=e=>e.replace(/[\s="]/g,"_");var iR,aR="@effect/io/Metric/Boundaries",Rd=Symbol.for(aR),Ad=class{constructor(t){this.values=t,this[iR]=Rd}[(iR=Rd,A)](){return I(S(this.values))(S(aR))}[M](t){return dF(t)&&O(this.values,t.values)}pipe(){return E(this,arguments)}},dF=e=>typeof e=="object"&&e!=null&&Rd in e,xF=e=>{let t=Jy(ir(Oe(Number.POSITIVE_INFINITY))(e));return new Ad(t)};var cR=e=>xF(Ot(mf(e.count-1,t=>e.start*Math.pow(e.factor,t))));var pR,uR,lR,fR,mR,hR,dR,xR,gR,yR,yF="@effect/io/Metric/KeyType",Ma=Symbol.for(yF),_R="effect/io/Metric/KeyType/Counter",Md=Symbol.for(_R),OR="effect/io/Metric/KeyType/Frequency",Td=Symbol.for(OR),CR="effect/io/Metric/KeyType/Gauge",vd=Symbol.for(CR),RR="effect/io/Metric/KeyType/Histogram",Id=Symbol.for(RR),AR="effect/io/Metric/KeyType/Summary",kd=Symbol.for(AR),Ta={_In:e=>e,_Out:e=>e},wd=class{constructor(){this[pR]=Ta,this[uR]=Md}[(pR=Ma,uR=Md,A)](){return S(_R)}[M](t){return Pd(t)}pipe(){return E(this,arguments)}},bR=class{constructor(){this[lR]=Ta,this[fR]=Td}[(lR=Ma,fR=Td,A)](){return S(OR)}[M](t){return Nd(t)}pipe(){return E(this,arguments)}},SR=class{constructor(){this[mR]=Ta,this[hR]=vd}[(mR=Ma,hR=vd,A)](){return S(CR)}[M](t){return Dd(t)}pipe(){return E(this,arguments)}},Fd=class{constructor(t){this.boundaries=t,this[dR]=Ta,this[xR]=Id}[(dR=Ma,xR=Id,A)](){return I(S(this.boundaries))(S(RR))}[M](t){return Ld(t)&&O(this.boundaries,t.boundaries)}pipe(){return E(this,arguments)}},ER=class{constructor(t,r,o,n){this.maxAge=t,this.maxSize=r,this.error=o,this.quantiles=n,this[gR]=Ta,this[yR]=kd}[(gR=Ma,yR=kd,A)](){return I(S(this.quantiles))(I(S(this.error))(I(S(this.maxSize))(I(S(this.maxAge))(S(AR)))))}[M](t){return Hd(t)&&O(this.maxAge,t.maxAge)&&this.maxSize===t.maxSize&&this.error===t.error&&O(this.quantiles,t.quantiles)}pipe(){return E(this,arguments)}},MR=new wd;var TR=e=>new Fd(e);var Pd=e=>typeof e=="object"&&e!=null&&Md in e,Nd=e=>typeof e=="object"&&e!=null&&Td in e,Dd=e=>typeof e=="object"&&e!=null&&vd in e,Ld=e=>typeof e=="object"&&e!=null&&Id in e,Hd=e=>typeof e=="object"&&e!=null&&kd in e;var IR,bF="@effect/io/Metric/Key",kR=Symbol.for(bF),SF={_Type:e=>e},va=class{constructor(t,r,o,n=$e()){this.name=t,this.keyType=r,this.description=o,this.tags=n,this[IR]=SF}[(IR=kR,A)](){return I(S(this.tags))(I(S(this.description))(I(S(this.keyType))(S(this.name))))}[M](t){return EF(t)&&this.name===t.name&&O(this.keyType,t.keyType)&&O(this.description,t.description)&&O(this.tags,t.tags)}pipe(){return E(this,arguments)}},EF=e=>typeof e=="object"&&e!=null&&kR in e,wR=(e,t)=>new va(e,MR,Dt(t));var FR=(e,t,r)=>new va(e,TR(t),Dt(r));var PR=a(2,(e,t)=>io(t)===0?e:new va(e.name,e.keyType,e.description,Ve(t)(e.tags)));var NR,DR,LR,HR,qR,UR,WR,jR,zR,KR,OF="@effect/io/Metric/State",Ia=Symbol.for(OF),BR="effect/io/Metric/State/Counter",qd=Symbol.for(BR),GR="effect/io/Metric/State/Frequency",Ud=Symbol.for(GR),$R="effect/io/Metric/State/Gauge",Wd=Symbol.for($R),VR="effect/io/Metric/State/Histogram",jd=Symbol.for(VR),YR="effect/io/Metric/State/Summary",zd=Symbol.for(YR),ka={_A:e=>e},Kd=class{constructor(t){this.count=t,this[NR]=ka,this[DR]=qd}[(NR=Ia,DR=qd,A)](){return I(S(this.count))(S(BR))}[M](t){return CF(t)&&this.count===t.count}pipe(){return E(this,arguments)}},Bd=class{constructor(t){this.occurrences=t,this[LR]=ka,this[HR]=Ud}[(LR=Ia,HR=Ud,A)](){return I(S(this.occurrences))(S(GR))}[M](t){return RF(t)&&O(this.occurrences,t.occurrences)}pipe(){return E(this,arguments)}},Gd=class{constructor(t){this.value=t,this[qR]=ka,this[UR]=Wd}[(qR=Ia,UR=Wd,A)](){return I(S(this.value))(S($R))}[M](t){return AF(t)&&this.value===t.value}pipe(){return E(this,arguments)}},$d=class{constructor(t,r,o,n,s){this.buckets=t,this.count=r,this.min=o,this.max=n,this.sum=s,this[WR]=ka,this[jR]=jd}[(WR=Ia,jR=jd,A)](){return I(S(this.sum))(I(S(this.max))(I(S(this.min))(I(S(this.count))(I(S(this.buckets))(S(VR))))))}[M](t){return MF(t)&&O(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return E(this,arguments)}},Vd=class{constructor(t,r,o,n,s,i){this.error=t,this.quantiles=r,this.count=o,this.min=n,this.max=s,this.sum=i,this[zR]=ka,this[KR]=zd}[(zR=Ia,KR=zd,A)](){return I(S(this.sum))(I(S(this.max))(I(S(this.min))(I(S(this.count))(I(S(this.quantiles))(I(S(this.error))(S(YR)))))))}[M](t){return TF(t)&&this.error===t.error&&O(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return E(this,arguments)}},JR=e=>new Kd(e),QR=e=>new Bd(e),ZR=e=>new Gd(e),XR=e=>new $d(e.buckets,e.count,e.min,e.max,e.sum),eA=e=>new Vd(e.error,e.quantiles,e.count,e.min,e.max,e.sum);var CF=e=>typeof e=="object"&&e!=null&&qd in e,RF=e=>typeof e=="object"&&e!=null&&Ud in e,AF=e=>typeof e=="object"&&e!=null&&Wd in e,MF=e=>typeof e=="object"&&e!=null&&jd in e,TF=e=>typeof e=="object"&&e!=null&&zd in e;var IF="@effect/io/Metric/Hook",kF=Symbol.for(IF),wF={_In:e=>e,_Out:e=>e},wa=e=>({[kF]:wF,pipe(){return E(this,arguments)},...e});var rA=e=>{let t=0;return wa({get:()=>JR(t),update:r=>{t=t+r}})},oA=e=>{let t=0,r=new Map,o=s=>{t=t+1;let i=r.get(s)??0;r.set(s,i+1)},n=()=>$c(r.entries());return wa({get:()=>QR(n()),update:o})},nA=(e,t)=>{let r=t;return wa({get:()=>ZR(r),update:o=>{r=o}})},sA=e=>{let t=e.keyType.boundaries.values,r=t.length,o=new Uint32Array(r+1),n=new Float32Array(r),s=0,i=0,c=Number.MAX_VALUE,p=Number.MIN_VALUE;Gf((m,y)=>{n[y]=m})(Zc(yt)(t));let u=m=>{let y=0,b=r;for(;y!==b;){let C=Math.floor(y+(b-y)/2),R=n[C];m<=R?b=C:y=C,b===y+1&&(m<=n[y]?b=y:y=b)}o[y]=o[y]+1,s=s+1,i=i+m,m<c&&(c=m),m>p&&(p=m)},f=()=>{let m=Array(r),y=0;for(let b=0;b<r;b++){let C=n[b],R=o[b];y=y+R,m[b]=[C,y]}return Ot(m)};return wa({get:()=>XR({buckets:f(),count:s,min:c,max:p,sum:i}),update:u})},iA=e=>{let{error:t,maxAge:r,maxSize:o,quantiles:n}=e.keyType,s=Zc(yt)(n),i=Array(o),c=0,p=0,u=0,f=Number.MAX_VALUE,m=Number.MIN_VALUE,y=C=>{let R=[],v=0;for(;v!==o-1;){let w=i[v];if(w!=null){let[H,U]=w,te=as(C-H);Af(te,Cf)&&te<=r&&R.push(U)}v=v+1}return FF(t,s,Zc(yt)(Ot(R)))},b=(C,R)=>{if(o>0){c=c+1;let v=c%o;i[v]=[R,C]}p=p+1,u=u+C,C<f&&(f=C),C>m&&(m=C)};return wa({get:()=>eA({error:t,quantiles:y(Date.now()),count:p,min:f,max:m,sum:u}),update:([C,R])=>b(C,R)})},FF=(e,t,r)=>{let o=r.length;if(xs(t))return Xe();let n=pn(t),s=ds(1)(t),i=it(Oe(tA(e,o,x(),0,n,r)),(c,p)=>{let u=pn(c);return Qc(tA(e,o,u.value,u.consumed,p,u.rest))(c)})(s);return Gf(c=>[c.quantile,c.value])(i)},tA=(e,t,r,o,n,s)=>{let i=e,c=t,p=r,u=o,f=n,m=s,y=e,b=t,C=r,R=o,v=n,w=s;for(;;){if(xs(m))return{quantile:f,value:x(),consumed:u,rest:Xe()};if(f===1)return{quantile:f,value:d(Vy(m)),consumed:u+m.length,rest:Xe()};let H=Yy(ce=>ce>pn(m))(m),U=f*c,te=i/2*U,ge=u+H[0].length,Ie=Math.abs(ge-U);if(ge<U-te){y=i,b=c,C=cn(m),R=ge,v=f,w=H[1],i=y,c=b,p=C,u=R,f=v,m=w;continue}if(ge>U+te)return{quantile:f,value:p,consumed:u,rest:m};switch(p._tag){case"None":{y=i,b=c,C=cn(m),R=ge,v=f,w=H[1],i=y,c=b,p=C,u=R,f=v,m=w;continue}case"Some":{let ce=Math.abs(U-p.value);if(Ie<ce){y=i,b=c,C=cn(m),R=ge,v=f,w=H[1],i=y,c=b,p=C,u=R,f=v,m=w;continue}return{quantile:f,value:d(p.value),consumed:u,rest:m}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/io/issues")};var NF="@effect/io/Metric/Pair",DF=Symbol.for(NF),LF={_Type:e=>e};var aA=(e,t)=>({[DF]:LF,metricKey:e,metricState:t,pipe(){return E(this,arguments)}});var cA,qF="@effect/io/Metric/Registry",pA=Symbol.for(qF),Yd=class{constructor(){this[cA]=pA,this.map=sn()}snapshot(){let t=[];for(let[r,o]of this.map)t.push(aA(r,o.get()));return pt(t)}get(t){let r=je(ye(t)(this.map));if(r==null){if(Pd(t.keyType))return this.getCounter(t);if(Dd(t.keyType))return this.getGauge(t);if(Nd(t.keyType))return this.getFrequency(t);if(Ld(t.keyType))return this.getHistogram(t);if(Hd(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/io/issues")}else return r}getCounter(t){let r=je(ye(t)(this.map));if(r==null){let o=rA(t);nr(t)(this.map)||ct(t,o)(this.map),r=o}return r}getFrequency(t){let r=je(ye(t)(this.map));if(r==null){let o=oA(t);nr(t)(this.map)||ct(t,o)(this.map),r=o}return r}getGauge(t){let r=je(ye(t)(this.map));if(r==null){let o=nA(t,0);nr(t)(this.map)||ct(t,o)(this.map),r=o}return r}getHistogram(t){let r=je(ye(t)(this.map));if(r==null){let o=sA(t);nr(t)(this.map)||ct(t,o)(this.map),r=o}return r}getSummary(t){let r=je(ye(t)(this.map));if(r==null){let o=iA(t);nr(t)(this.map)||ct(t,o)(this.map),r=o}return r}};cA=pA;var uA=()=>new Yd;var WF="@effect/io/Metric",jF=Symbol.for(WF),zF={_Type:e=>e,_In:e=>e,_Out:e=>e},KF=z(Symbol.for("@effect/io/Metric/globalMetricRegistry"),()=>uA()),BF=function(e,t,r){return Object.assign(n=>At(n,s=>g(()=>t(s,$e()))),{[jF]:zF,keyType:e,unsafeUpdate:t,unsafeValue:r,pipe(){return E(this,arguments)}})};var Fa=(e,t)=>lA(wR(e,t));var lA=e=>{let t=r=>{let o=PR(r)(e);return KF.get(o)};return BF(e.keyType,(r,o)=>t(o).update(r),r=>t(r).get())};var fA=(e,t,r)=>lA(FR(e,t,r));var mA=a(2,(e,t)=>Se(tl,r=>g(()=>{if(r.has(e)){let o=r.get(e);o.state.completed||(o.state.completed=!0,Gs(o.result,t))}})));var Pa=class{constructor(){this.count=0,this.observers=new Set}addObserver(t){this.observers.add(t)}removeObserver(t){this.observers.delete(t)}increment(){this.count++,this.observers.forEach(t=>t(this.count))}decrement(){this.count--,this.observers.forEach(t=>t(this.count))}};var hA,dA,xA,gA,$F,VF="@effect/io/Supervisor",Da=Symbol.for(VF),cl={_T:e=>e},Na=class e{constructor(t,r){this.underlying=t,this.value0=r,this[hA]=cl}value(){return this.value0()}onStart(t,r,o,n){this.underlying.onStart(t,r,o,n)}onEnd(t,r){this.underlying.onEnd(t,r)}onEffect(t,r){this.underlying.onEffect(t,r)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new e(this,()=>_(t)(this.value()))}zip(t){return new Go(this,t)}onRun(t,r){return this.underlying.onRun(t,r)}};hA=Da;var Go=class e{constructor(t,r){this.left=t,this.right=r,this[dA]=cl}value(){return $p(this.left.value(),this.right.value())}onStart(t,r,o,n){this.left.onStart(t,r,o,n),this.right.onStart(t,r,o,n)}onEnd(t,r){this.left.onEnd(t,r),this.right.onEnd(t,r)}onEffect(t,r){this.left.onEffect(t,r),this.right.onEffect(t,r)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new Na(this,()=>_(t)(this.value()))}zip(t){return new e(this,t)}onRun(t,r){return this.right.onRun(()=>this.left.onRun(t,r),r)}};dA=Da;var Jd=class{constructor(){this[xA]=cl,this.fibers=new Set}value(){return g(()=>Array.from(this.fibers))}onStart(t,r,o,n){this.fibers.add(n)}onEnd(t,r){this.fibers.delete(r)}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new Na(this,()=>_(t)(this.value()))}zip(t){return new Go(this,t)}onRun(t,r){return t()}};xA=Da;var Qd=class{constructor(t){this.effect=t,this[gA]=cl}value(){return this.effect}onStart(t,r,o,n){}onEnd(t,r){}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new Na(this,()=>_(t)(this.value()))}zip(t){return new Go(this,t)}onRun(t,r){return t()}};gA=Da;$F=Da;var YF=()=>new Jd,yA=g(YF),JF=e=>new Qd(e),zn=JF(k);var bA="Empty",SA="AddSupervisor",EA="RemoveSupervisor",_A="AndThen",ai={_tag:bA},ul=(e,t)=>({_tag:_A,first:e,second:t}),QF=(e,t)=>ZF(t,Oe(e)),ZF=(e,t)=>{let r=e,o=t;for(;Ke(o);){let n=Be(o);switch(n._tag){case bA:{o=Ge(o);break}case SA:{r=r.zip(n.supervisor),o=Ge(o);break}case EA:{r=Zd(r,n.supervisor),o=Ge(o);break}case _A:{o=Te(n.first)(Te(n.second)(Ge(o)));break}}}return r},Zd=(e,t)=>O(e,t)?zn:e instanceof Go?Zd(e.left,t).zip(Zd(e.right,t)):e,ll=e=>O(e,zn)?$e():e instanceof Go?Ve(ll(e.right))(ll(e.left)):so(e),XF=(e,t)=>{if(O(e,t))return ai;let r=ll(e),o=ll(t),n=un(ai,(i,c)=>ul(i,{_tag:SA,supervisor:c}))(sm(r)(o)),s=un(ai,(i,c)=>ul(i,{_tag:EA,supervisor:c}))(sm(o)(r));return ul(n,s)},OA=op({empty:ai,patch:QF,combine:ul,diff:XF});var CA,RA,t0=Fa("effect_fiber_started"),AA=Fa("effect_fiber_active"),r0=Fa("effect_fiber_successes"),o0=Fa("effect_fiber_failures"),n0=fA("effect_fiber_lifetimes",cR({start:1,factor:2,count:100})),La="Continue",s0="Done",MA="Yield",i0={_E:e=>e,_A:e=>e},Ha=e=>{throw new Error(`BUG: FiberRuntime - ${JSON.stringify(e)} - please report an issue at https://github.com/Effect-TS/io/issues`)},fl={[vs]:(e,t,r)=>t.i1(r),OnStep:(e,t,r)=>t.i1(X(r)),[Is]:(e,t,r)=>t.i2(r),[ea]:(e,t,r)=>(e.patchRuntimeFlags(e._runtimeFlags,t.patch),kr(e._runtimeFlags)&&e.isInterrupted()?K(e.getInterruptedCause()):X(r)),[ks]:(e,t,r)=>(t.i2(r),t.i0()?(e.pushStack(t),t.i1()):k)},a0={[rl]:(e,t,r,o)=>(e.processNewInterruptSignal(o.cause),kr(t)?K(o.cause):r),[nl]:(e,t,r,o)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[ol]:(e,t,r,o)=>(o.onFiber(e,gd(t)),r),[sl]:(e,t,r,o)=>l(Mt(),()=>r)},c0=e=>mt(mS(e),t=>pi(xS(t),([r,o])=>{let n=new Map;for(let s of o)for(let i of s)n.set(i.request,i);return Ee(b0(r.runAll(o),o.flat()),tl,n)},!1)),qa=class{pipe(){return E(this,arguments)}constructor(t,r,o){if(this[CA]=Aa,this[RA]=i0,this._queue=new Array,this._children=null,this._observers=new Array,this._running=!1,this._stack=[],this._asyncInterruptor=null,this._asyncBlockingOn=null,this._exitValue=null,this._steps=[!1],this.run=()=>{this.drainQueueOnCurrentThread()},this._runtimeFlags=o,this._fiberId=t,this._fiberRefs=r,this._supervisor=this.getFiberRef(ci),Qi(o)){let n=this.getFiberRef(go);t0.unsafeUpdate(1,n),AA.unsafeUpdate(1,n)}}id(){return this._fiberId}resume(t){this.tell(Un(t))}status(){return this.ask((t,r)=>r)}runtimeFlags(){return this.ask((t,r)=>qC(r)?t._runtimeFlags:r.runtimeFlags)}scope(){return QC(this)}children(){return this.ask(t=>Array.from(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(In)}fiberRefs(){return this.ask(t=>t.unsafeGetFiberRefs())}ask(t){return T(()=>{let r=zs(this._fiberId);return this.tell(ii((o,n)=>{Gs(r,g(()=>t(o,n)))})),ve(r)})}tell(t){this._queue.push(t),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}await(){return Kt(t=>{let r=o=>t(h(o));return this.tell(ii((o,n)=>{o._exitValue!==null?r(this._exitValue):o.unsafeAddObserver(r)})),g(()=>this.tell(ii((o,n)=>{o.unsafeRemoveObserver(r)})))},this.id())}inheritAll(){return ue((t,r)=>{let o=t.id(),n=t.unsafeGetFiberRefs(),s=r.runtimeFlags,i=this.unsafeGetFiberRefs(),c=Nu(n,o,i);t.setFiberRefs(c);let p=t.getFiberRef(vA),u=Wm(Yi)(Wm(pr)(En(s,p)));return Ls(u)})}poll(){return g(()=>Dt(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(t){return g(()=>this.tell(Sd(cr(t))))}unsafeAddObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}unsafeRemoveObserver(t){this._observers=this._observers.filter(r=>r!==t)}unsafeGetFiberRefs(){return this.setFiberRef(vA,this._runtimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=xa(this._fiberRefs,t)}getFiberRef(t){return this._fiberRefs.locals.has(t)?this._fiberRefs.locals.get(t)[0][1]:t.initial}setFiberRef(t,r){this._fiberRefs=Nn(this._fiberRefs,{fiberId:this._fiberId,fiberRef:t,value:r}),t===ci&&(this._supervisor=r)}setFiberRefs(t){this._fiberRefs=t,this._supervisor=this.getFiberRef(ci)}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let r=La,o=globalThis[Bo];globalThis[Bo]=this;try{for(;r===La;)r=this._queue.length===0?s0:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[Bo]=o}this._queue.length>0&&!this._running?(this._running=!0,r===MA?(this.drainQueueLaterOnExecutor(),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(){this.getFiberRef(xo).scheduleTask(this.run,this.getFiberRef(oa))}drainQueueWhileRunning(t,r){let o=r;for(;this._queue.length>0;){let n=this._queue.splice(0,1)[0];o=a0[n._tag](this,t,o,n)}return o}isInterrupted(){return!Mm(this.getFiberRef(In))}addInterruptedCause(t){let r=this.getFiberRef(In);this.setFiberRef(In,Ce(r,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(let r of this._children)r.tell(Sd(cr(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let t=this._children.values();this._children=null;let r=!1;return Tn({while:()=>!r,body:()=>{let n=t.next();return n.done?g(()=>{r=!0}):Q(n.value.await())},step:()=>{}})}return null}reportExitValue(t){if(Qi(this._runtimeFlags)){let r=this.getFiberRef(go);switch(AA.unsafeUpdate(-1,r),t._tag){case me:{r0.unsafeUpdate(1,r);break}case fe:{o0.unsafeUpdate(1,r);break}}}if(t._tag==="Failure"){let r=this.getFiberRef(ia);!No(t.cause)&&r._tag==="Some"&&this.log("Fiber terminated with a non handled error",t.cause,r)}}setExitValue(t){if(this._exitValue=t,Qi(this._runtimeFlags)){let r=this.getFiberRef(go),o=this.id().startTimeMillis,n=new Date().getTime();n0.unsafeUpdate((n-o)/1e3,r)}this.reportExitValue(t);for(let r=this._observers.length-1;r>=0;r--)this._observers[r](t)}getLoggers(){return this.getFiberRef(wA)}log(t,r,o){let n=N(o)?o.value:this.getFiberRef(ch),s=this.getFiberRef(kA);if(O_(s,n))return;let i=this.getFiberRef(Qp),c=this.getFiberRef(na),p=this.getLoggers(),u=this.unsafeGetFiberRefs();if(io(p)>0){let f=to(this.getFiberRef(ot),Wr),m=new Date(f.unsafeCurrentTimeMillis());for(let y of p)y.log({fiberId:this.id(),logLevel:n,message:t,cause:r,context:u,spans:i,annotations:c,date:m})}}evaluateMessageWhileSuspended(t){switch(t._tag){case sl:return MA;case rl:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(K(t.cause)),this._asyncInterruptor=null),La;case nl:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),La;case ol:return t.onFiber(this,this._exitValue!==null?LC:HC(this._runtimeFlags,this._asyncBlockingOn)),La;default:return Ha(t)}}evaluateEffect(t){this._supervisor.onResume(this);try{let r=kr(this._runtimeFlags)&&this.isInterrupted()?K(this.getInterruptedCause()):t;for(;r!==null;)try{let o=r,n=this.runLoop(o);this._runtimeFlags=Dm(Yi)(this._runtimeFlags);let s=this.interruptAllChildren();s!==null?r=l(s,()=>n):(this._queue.length===0?this.setExitValue(n):this.tell(Un(n)),r=null)}catch(o){if(de(o))o._tag===ws?Nm(this._runtimeFlags)?(this.tell($C()),this.tell(Un(Ur)),r=null):r=Ur:o._tag===Ms&&(r=null);else throw o}}finally{this._supervisor.onSuspend(this)}}start(t){if(this._running)this.tell(Un(t));else{this._running=!0;let r=globalThis[Bo];globalThis[Bo]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[Bo]=r,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(t){this.tell(Un(t))}patchRuntimeFlags(t,r){let o=As(t,r);return globalThis[Bo]=this,this._runtimeFlags=o,o}initiateAsync(t,r){let o=!1,n=s=>{o||(o=!0,this.tell(Un(s)))};kr(t)&&(this._asyncInterruptor=n);try{r(n)}catch(s){n(D(Le(s)))}}pushStack(t){this._stack.push(t),t._tag==="OnStep"&&this._steps.push(!0),t._tag==="RevertFlags"&&this._steps.push(!1)}popStack(){let t=this._stack.pop();if(t)return(t._tag==="OnStep"||t._tag==="RevertFlags")&&this._steps.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._tag!==Ts)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._tag!==vs&&t._tag!==ks)return t;t=this.popStack()}}[(CA=Ra,RA=XC,_S)](t){return _(Ye(ho),r=>{try{return ki(r,t)}catch(o){throw console.log(o),o}})}Left(t){return fr(t.i0)}None(t){return fr(po())}Right(t){return X(t.i0)}Some(t){return X(t.i0)}[Ip](t){let r=t.i0(),o=this.getNextSuccessCont();if(o!==void 0)return o._tag in fl||Ha(o),fl[o._tag](this,o,r);throw X(r)}[me](t){let r=t,o=this.getNextSuccessCont();if(o!==void 0)return o._tag in fl||Ha(o),fl[o._tag](this,o,r.i0);throw r}[fe](t){let r=this.getFiberRef(yo),o=ut(r)||r.head._tag==="ExternalSpan"?t.i0:Po(t.i0,Zb(r.head)),n=this.getNextFailCont();if(n!==void 0)switch(n._tag){case Ts:case Is:return kr(this._runtimeFlags)&&this.isInterrupted()?K(_s(o)):n.i1(o);case"OnStep":return kr(this._runtimeFlags)&&this.isInterrupted()?K(_s(o)):n.i1(K(o));case ea:return this.patchRuntimeFlags(this._runtimeFlags,n.patch),kr(this._runtimeFlags)&&this.isInterrupted()?K(Ce(o,this.getInterruptedCause())):K(o);default:Ha(n)}else throw K(o)}[kp](t){return t.i0(this,gd(this._runtimeFlags))}Blocked(t){if(this._steps[this._steps.length-1]){let r=this.popStack();if(r)switch(r._tag){case"OnStep":return r.i1(t);case"OnSuccess":return he(t.i0,l(t.i1,r.i1));case"OnSuccessAndFailure":return he(t.i0,Y(t.i1,{onFailure:r.i1,onSuccess:r.i2}));case"OnFailure":return he(t.i0,Nr(t.i1,r.i1));case"While":return he(t.i0,l(t.i1,o=>(r.i2(o),r.i0()?Tn({while:r.i0,body:r.i1,step:r.i2}):k)));case"RevertFlags":{this.pushStack(r);break}}}return be(r=>l(Tt(qp(t.i0)),()=>r(t.i1)))}RunBlocked(t){return c0(t.i0)}[lo](t){let r=t.i0,o=this._runtimeFlags,n=As(o,r);if(kr(n)&&this.isInterrupted())return K(this.getInterruptedCause());if(this.patchRuntimeFlags(this._runtimeFlags,r),t.i1){let s=En(n,o);return this.pushStack(new Dp(s,t)),t.i1(o)}else return Ur}[vs](t){return this.pushStack(t),t.i0}OnStep(t){return this.pushStack(t),t.i0}[Ts](t){return this.pushStack(t),t.i0}[Is](t){return this.pushStack(t),t.i0}[Ms](t){throw this._asyncBlockingOn=t.i1,this.initiateAsync(this._runtimeFlags,t.i0),t}[ws](t){throw t}[ks](t){let r=t.i0,o=t.i1;return r()?(this.pushStack(t),o()):Ur}[ES](t){return t.commit()}runLoop(t){let r=t,o=0;for(;;){if(this._runtimeFlags&Pm&&this._supervisor.onEffect(this,r),this._queue.length>0&&(r=this.drainQueueWhileRunning(this._runtimeFlags,r)),o+=1,o>=this.getFiberRef(ah)){o=0;let n=r;r=l(Mt(),()=>n)}try{r._tag in this||(typeof r=="function"&&console.log(r()),Ha(r)),r=this._supervisor.onRun(()=>this[r._tag](r),this)}catch(n){if(de(n)){if(n._tag===ws||n._tag===Ms)throw n;if(n._tag===me||n._tag===fe)return n}else vS(n)?r=K(n.cause):km(n)?r=K(Ce(Le(n),cr(et))):r=K(Le(n))}}}},kA=xe(C_("Info")),p0=al(e=>{let t=sR.log(e);globalThis.console.log(t)});var u0=al(({annotations:e,cause:t,context:r,fiberId:o,logLevel:n,message:s})=>{let i=ns(ga(r,yo),np),c=Me(ga(r,ot),u=>to(u,Wr));if(i._tag==="None"||i.value._tag==="ExternalSpan"||c._tag==="None")return;let p=Object.fromEntries(e);p["effect.fiberId"]=Wb(o),p["effect.logLevel"]=n.label,t!==null&&t!==tt&&(p["effect.cause"]=uo(t)),i.value.event(String(s),c.value.unsafeCurrentTimeNanos(),p)}),wA=ih(so(p0,u0)),Wa=a(e=>de(e[0]),(e,t)=>Fr(At(e,r=>ja(o=>t(r,o))))),FA=a(e=>de(e[0]),(e,t)=>Br(e,ja(r=>t(r)))),ja=e=>ue(t=>{let r=t.unsafeGetFiberRefs();return l(hl,o=>Ws(o,n=>ue(s=>{let i=s.unsafeGetFiberRefs(),c=ni(i,r),p=ni(r,i);return s.setFiberRefs(yd(c,s.id(),r)),Br(e(n),g(()=>{s.setFiberRefs(yd(p,s.id(),s.unsafeGetFiberRefs()))}))})))}),PA=e=>Ee(ta,d(Wn))(e),TA=Symbol("@effect/io/Effect/existsPar/found"),NA=a(e=>Nt(e[0]),(e,t,r)=>Ca(r,()=>T(()=>DA(e[Symbol.iterator](),0,t)),()=>ie(Jt(e,(o,n)=>Up(t(o,n),{onTrue:L(TA),onFalse:k}),r),{onFailure:o=>o===TA?h(!0):L(o),onSuccess:()=>h(!1)}))),DA=(e,t,r)=>{let o=e.next();return o.done?h(!1):l(r(o.value,t),n=>n?h(n):DA(e,t+1,r))},LA=a(e=>Nt(e[0]),(e,t,r)=>{let o=r?.negate?(n,s)=>_(t(n,s),Ag):t;return Ca(r,()=>T(()=>J(e).reduceRight((n,s,i)=>mo(n,T(()=>o(s,i)),(c,p)=>p?[s,...c]:c),g(()=>new Array))),()=>_(Jt(e,(n,s)=>_(o(n,s),i=>i?d(n):x()),r),$g))}),l0=e=>{if(Array.isArray(e)||Nt(e))return[e,x()];let t=Object.keys(e),r=t.length;return[t.map(o=>e[o]),d(o=>{let n={};for(let s=0;s<r;s++)n[t[s]]=o[s];return n})]},f0=(e,t,r)=>{let o=[];for(let n of e)o.push(Dr(n));return l(Jt(o,F,{concurrency:r?.concurrency,batching:r?.batching}),n=>{let s=x(),i=n.length,c=new Array(i),p=new Array(i),u=!1;for(let f=0;f<i;f++){let m=n[f];m._tag==="Left"?(c[f]=d(m.left),u=!0):(p[f]=m.right,c[f]=s)}return u?t._tag==="Some"?L(t.value(c)):L(c):r?.discard?k:t._tag==="Some"?h(t.value(p)):h(p)})},m0=(e,t,r)=>{let o=[];for(let n of e)o.push(Dr(n));return r?.discard?Jt(o,F,{concurrency:r?.concurrency,batching:r?.batching,discard:!0}):_(Jt(o,F,{concurrency:r?.concurrency,batching:r?.batching}),n=>t._tag==="Some"?t.value(n):n)},ui=(e,t)=>{let[r,o]=l0(e);return t?.mode==="validate"?f0(r,o,t):t?.mode==="either"?m0(r,o,t):o._tag==="Some"?_(Jt(r,F,t),o.value):Jt(r,F,t)},HA=e=>t=>ui(t,e),qA=(e,t)=>_(ui(J(e).map(Z),t),Ii(r=>ru(r)?d(r.i0):x())),rx=a(2,(e,t)=>Array.from({length:t},()=>e)),UA=a(e=>de(e[0]),(e,t,r)=>ui(rx(t)(e),r)),Jt=a(e=>Nt(e[0]),(e,t,r)=>ue(o=>{let n=r?.batching===!0||r?.batching==="inherit"&&o.getFiberRef(sa);return r?.discard?bd(r,()=>n?Xd(e,t):mt(e,t),()=>pi(e,t,n),s=>ox(e,s,t,n)):bd(r,()=>n?ex(e,1,t,!0):He(e,t),()=>Ua(e,t,n),s=>ex(e,s,t,n))})),Ua=(e,t,r)=>T(()=>{let o=J(e),n=new Array(o.length);return W(pi(o,(i,c)=>l(t(i,c),p=>g(()=>n[c]=p)),r),h(n))}),Xd=(e,t)=>T(()=>{let r=J(e),o=r.length;if(o===0)return k;if(o===1)return Q(t(r[0],0));let n=r.map(t),s=new Array,i=c=>c===n.length?T(()=>{if(s.length>0){let p=s.map(u=>u.i0).reduce(_n);return he(p,Xd(s.map(u=>u.i1),F))}return k}):Ds(n[c],p=>p._tag==="Blocked"?(s.push(p),i(c+1)):p._tag==="Failure"?T(()=>{if(s.length>0){let u=s.map(f=>f.i0).reduce(_n);return he(u,l(Xd(s.map(f=>f.i1),F),()=>p))}return k}):i(c+1));return i(0)}),pi=(e,t,r)=>T(()=>{let o=J(e),n=o.length;return n===0?k:n===1?Q(t(o[0],0)):be(s=>{let i=zs(et),c=0,p=[],u=[],f=Gp(m=>He(o,(y,b)=>_(C=>(C.unsafeAddObserver(()=>{u.push(C)}),C))(Kn(m(l(C=>{switch(C._tag){case"Failure":{if(p.length>0){let R=p.map(w=>w.i0).reduce(_n),v=pi(p,w=>w.i1,r);return he(R,Y(v,{onFailure:w=>W(ua(i,void 0),D(Fe(w,C.cause))),onSuccess:()=>W(ua(i,void 0),D(C.cause))}))}return W(ua(i,void 0),D(C.cause))}default:{if(C._tag==="Blocked"&&p.push(C),c+1===n)if(p.length>0){let R=p.map(w=>w.i0).reduce(_n),v=pi(p,w=>w.i1,r);return Bs(i,he(R,v))}else Gs(i,X(Ur));else c=c+1;return k}}})(T(()=>s((r?wr:Z)(t(y,b))))))))));return l(f,m=>Y(s(ve(i)),{onFailure:y=>l(Ua(m,Wo,r),b=>{let C=js(b,{parallel:!0});return C._tag==="Some"&&mh(C.value)?D(Fe(_s(y),C.value.i0)):D(_s(y))}),onSuccess:y=>l(y,()=>mt(u,b=>b.inheritAll()))}))})}),ex=(e,t,r,o)=>T(()=>{let n=J(e),s=new Array(n.length);return W(ox(n,t,(c,p)=>_(r(c,p),u=>s[p]=u),o),h(s))}),ox=(e,t,r,o)=>T(()=>{let n=0,s=e[Symbol.iterator](),i=[],c=l(g(()=>s.next()),u=>u.done?k:l((o?wr:Z)(Q(r(u.value,n++))),f=>{switch(f._tag){case"Blocked":return i.push(f),c;case"Failure":return f;case"Success":return c}})),p=[];for(let u=0;u<t;u++)p.push(c);return l(Z(pi(p,F,o)),u=>{if(i.length===0)return u;let f=i.map(y=>y.i0).reduce(_n),m=ox(i,t,y=>y.i1,o);return u._tag==="Failure"?he(f,Y(m,{onFailure:y=>K(Fe(u.cause,y)),onSuccess:()=>u})):he(f,m)})}),Tt=e=>ue((t,r)=>h(jA(e,t,r.runtimeFlags))),Kn=e=>h0(e,Wn),WA=a(2,(e,t)=>Tt(Kp(e,r=>{let o=co(r);switch(o._tag){case"Left":return t(o.left);case"Right":return D(o.right)}}))),jA=(e,t,r,o=null)=>{let n=tx(e,t,r,o);return n.resume(e),n},tx=(e,t,r,o=null)=>{let n=up(),s=t.unsafeGetFiberRefs(),i=Du(s,n),c=new qa(n,i,r),p=Zs(i,ho),u=c._supervisor;return u.onStart(p,e,d(t),c),c.unsafeAddObserver(m=>u.onEnd(m,c)),(o!==null?o:$(()=>t.scope())(t.getFiberRef(ta))).add(r,c),c},h0=(e,t)=>ue((r,o)=>h(jA(e,r,o.runtimeFlags,t))),nx=a(e=>Nt(e[0]),(e,t,r,o)=>Ca(o,()=>J(e).reduce((n,s,i)=>mo(n,s,(c,p)=>r(c,p,i)),h(t)),()=>l(ba(t),n=>l(Jt(e,(s,i)=>l(s,c=>N_(n,p=>r(p,c,i))),o),()=>Gu(n))))),sx=a(e=>Nt(e[0]),(e,t,r)=>_(o=>PS(o,F))(Jt(e,(o,n)=>Dr(t(o,n)),r))),zA=a(e=>Nt(e[0]),(e,t,r)=>l(sx(e,t,{concurrency:r?.concurrency,batching:r?.batching}),([o,n])=>o.length===0?r?.discard?k:h(n):L(o))),KA=e=>{let t=Tr(e);if(!Ke(t))return Lo(()=>Cs("Received an empty collection of effects"));let r=Be(t),o=Ge(t),n=s=>V(s[0])(eR(s[1]));return l(s=>l(i=>be(c=>l(p=>l(u=>Uo(()=>it(k,(f,m)=>qs(Wo(m))(f))(u))(c(l(n)(Fn(s)))))(At(u=>it(k,(f,m)=>W(Q(Tt(l(d0(u,m,s,i))(Od(m)))))(f))(u))(_(u=>Te(p)(u))(_(Ot)(He(u=>Tt(jt(u)))(o))))))(Tt(jt(r)))))(ba(o.length)))(rt())},d0=(e,t,r,o)=>n=>kn(n,{onFailure:s=>ft(P_(o,i=>[i===0?Q(wn(r,s)):k,i-1])),onSuccess:s=>l(i=>i?it(k,(c,p)=>p===t?c:qs(Wo(p))(c))(Tr(e)):k)(Bs(r,[s,t]))}),BA=a(e=>Nt(e[0]),(e,t,r,o)=>Ca(o,()=>J(e).reduce((n,s,i)=>mo(n,s,(c,p)=>r(c,p,i)),t),()=>T(()=>_(n=>{switch(n._tag){case"None":throw new Error("BUG: Effect.reduceEffect - please report an issue at https://github.com/Effect-TS/io/issues");case"Some":return n.value}})(nx([t,...e],x(),(n,s,i)=>{switch(n._tag){case"None":return d(s);case"Some":return d(r(n.value,s,i))}},o))))),GA=e=>l(hl,t=>l(Bn(zC),r=>W(Gn(e,r))(t.addFinalizer(o=>r.close(o))))),$o=e=>l(lx,e),ix=e=>l(Bn(),t=>g0(t)(e)),$A=e=>$o(t=>l(r=>Gn(r)(e))(lh(t,si))),VA=(e,t)=>ax([Uu(e,t)]),ax=e=>cx(pt(e)),cx=e=>dr(go,t=>Ve(e)(t)),YA=a(2,(e,t)=>zt(Bn(),r=>l(Gn(e,r),t),(r,o)=>jo(r,o))),JA=e=>ie(e,{onFailure:t=>{switch(t._tag){case"None":return h(x());case"Some":return L(t.value)}},onSuccess:t=>h(d(t))}),QA=a(e=>de(e[1]),(e,t,r)=>px(e,t,(o,n)=>[o,n],r)),px=a(e=>de(e[1]),(e,t,r,o)=>ft(Eo(Z(e),Z(t),(n,s)=>pa(n,s,{onSuccess:r,onFailure:(i,c)=>o?.concurrent?Fe(i,c):Ce(i,c)}),o)));var ZA=a(e=>Nt(e[0]),(e,t,r)=>qo(Jt(e,(o,n)=>qo(t(o,n)),r))),XA=e=>dr(ot,we(Wr,e)),ml=e=>dr(ot,we(Js,e)),eM=e=>$o(t=>l(lh(t,si),r=>_(o=>[Bt(n=>jo(r,nu(n))),o])(Gn(r)(e)))),tM=a(e=>de(e[1]),(e,t,r)=>Eo(e,t,(o,n)=>[o,n],r)),rM=a(e=>de(e[1]),(e,t,r)=>Eo(e,t,(o,n)=>o,r)),oM=a(e=>de(e[1]),(e,t,r)=>Eo(e,t,(o,n)=>n,r)),Eo=a(e=>de(e[1]),(e,t,r,o)=>_(ui([e,t],{concurrency:o?.concurrent?2:1,batching:o?.batching}),([n,s])=>r(n,s))),ux=e=>e===Ap?k:Fr(l(t=>{let r=As(t,e),o=En(r,t);return Q(W(ja(()=>Ls(o)))(Ls(e)))})(Bp)),x0=(e,t)=>r=>T(()=>{switch(r.state._tag){case"Exited":return k;case"Running":{let o=r.state.finalizers,n=r.state.update,s=Array.from(o.keys()).sort((i,c)=>c-i).map(i=>o.get(i));return r.state={_tag:"Exited",nextKey:r.state.nextKey,exit:t,update:n},KC(e)?l(i=>$(()=>Ur)(Me(ca)(js(i))))(He(i=>Z(n(i)(t)))(s)):BC(e)?l(i=>$(()=>Ur)(Me(ca)(js(i,{parallel:!0}))))(Ua(s,i=>Z(n(i)(t)),!1)):l(i=>$(()=>Ur)(Me(ca)(js(i,{parallel:!0}))))(ex(s,e.parallelism,i=>Z(n(i)(t)),!1))}}}),lx=St(tu),hl=lx,Bn=(e=si)=>_($S,t=>({[tu]:tu,[uh]:uh,pipe(){return E(this,arguments)},fork:r=>Fr(l(o=>V(o)(At(n=>Ws(o,n))(fh(t,n=>jo(o,n)))))(Bn(r))),close:r=>Q(x0(e,r)(t)),addFinalizer:r=>Q(fh(r)(t))})),Gn=a(2,(e,t)=>Mn(e,is(_f(lx,t)))),g0=a(2,(e,t)=>lr(r=>t.close(r))(Gn(t)(e))),y0=e=>Us(e,{differ:OA,fork:ai}),Qt=a(2,(e,t)=>Q(Wa(l(Ye(e),r=>V(Cn(e,t),r)),r=>Cn(e,r)))),dr=a(2,(e,t)=>Se(e,r=>Qt(e,t(r))));var vA=jS(Lm),ci=y0(zn),nM=e=>Q(Od(dl(e))),dl=e=>({[Ra]:Aa,id:()=>J(e).reduce((t,r)=>Sm(t,r.id()),et),await:()=>Z(Ua(e,t=>ft(t.await()),!1)),children:()=>_(Ua(e,t=>t.children(),!1),wc),inheritAll:()=>mt(e,t=>t.inheritAll()),poll:()=>_(He(e,t=>t.poll()),Fc(d(X(new Array)),(t,r)=>{switch(r._tag){case"None":return x();case"Some":switch(t._tag){case"None":return x();case"Some":return d(pa(r.value,t.value,{onSuccess:(o,n)=>[o,...n],onFailure:Fe}))}}})),interruptAsFork:t=>mt(e,r=>r.interruptAsFork(t)),pipe(){return E(this,arguments)}});var fx=a(3,(e,t,r)=>mx(e,t,{onSelfWin:(o,n)=>l(o.await(),s=>{switch(s._tag){case me:return l(o.inheritAll(),()=>r.onSelfDone(s,n));case fe:return r.onSelfDone(s,n)}}),onOtherWin:(o,n)=>l(o.await(),s=>{switch(s._tag){case me:return l(o.inheritAll(),()=>r.onOtherDone(s,n));case fe:return r.onOtherDone(s,n)}})})),sM=e=>be(t=>Bt(r=>l(Kn(t(e)),o=>Uo(()=>tR(r)(o))(t(jn(o)))))),xl=a(2,(e,t)=>Bt(r=>fx(e,t,{onSelfDone:(o,n)=>kn(o,{onFailure:s=>Xs(i=>Fe(s,i))(jn(n)),onSuccess:s=>V(s)(Gt(r)(n))}),onOtherDone:(o,n)=>kn(o,{onFailure:s=>Xs(i=>Fe(i,s))(jn(n)),onSuccess:s=>V(s)(Gt(r)(n))})}))),mx=a(3,(e,t,r)=>ue((o,n)=>{let s=n.runtimeFlags,i=at(!0),c=tx(e,o,s,r.selfScope),p=tx(t,o,s,r.otherScope);return Kt(u=>{c.unsafeAddObserver(()=>IA(c,p,r.onSelfWin,i,u)),p.unsafeAddObserver(()=>IA(p,c,r.onOtherWin,i,u)),c.startFork(e),p.startFork(t)},Sm(c.id(),p.id()))})),IA=(e,t,r,o,n)=>{Yc(!0,!1)(o)&&n(r(e,t))},Br=a(2,(e,t)=>be(r=>Y(r(e),{onFailure:o=>Y(t,{onFailure:n=>D(Ce(o,n)),onSuccess:()=>D(o)}),onSuccess:o=>V(t,o)}))),b0=(e,t)=>Bt(r=>l(l(Kn(jt(e)),o=>Kt(n=>{let s=t.map(p=>p.listeners.count),i=()=>{s.every(p=>p===0)&&(c.forEach(p=>p()),n(Wo(o)))};o.unsafeAddObserver(p=>{c.forEach(u=>u()),n(p)});let c=t.map((p,u)=>{let f=m=>{s[u]=m,i()};return p.listeners.addObserver(f),()=>p.listeners.removeObserver(f)});return i(),g(()=>{c.forEach(p=>p())})})),()=>T(()=>{let o=t.flatMap(n=>n.state.completed?[]:[n]);return mt(o,n=>mA(n.request,nu(r)))})));var iM=(e,t)=>Wa(ri(e,t),(r,o)=>l(Zu,n=>g(()=>r.end(n,o)))),gl=(e,t)=>l(ri(e,t),r=>dr(yo,ko(r))),yl=e=>dr(ot,we(Qs,e)),bl=e=>dr(yo,ko(e));var aM,uM,cM=(e,t,r,o)=>ro({_tag:"Complete",key:e,exit:t,entryStats:r,timeToLiveMillis:o}),pM=(e,t)=>ro({_tag:"Pending",key:e,deferred:t}),S0=(e,t)=>ro({_tag:"Refreshing",deferred:e,complete:t}),hx=Symbol.for("@effect/cache/Cache/MapKey"),dx=class{constructor(t){this.current=t,this[aM]=hx,this.previous=void 0,this.next=void 0}[(aM=hx,A)](){return I(S(this.next))(I(S(this.previous))(S(this.current)))}[M](t){return this===t?!0:E0(t)&&O(this.current,t.current)&&O(this.previous,t.previous)&&O(this.next,t.next)}},li=e=>new dx(e),E0=e=>typeof e=="object"&&e!=null&&hx in e,xx=class{constructor(){this.head=void 0,this.tail=void 0}add(t){if(t!==this.tail)if(this.tail===void 0)this.head=t,this.tail=t;else{let r=t.previous,o=t.next;o!==void 0&&(t.next=void 0,r!==void 0?(r.next=o,o.previous=r):(this.head=o,this.head.previous=void 0)),this.tail.next=t,t.previous=this.tail,this.tail=t}}remove(){let t=this.head;if(t!==void 0){let r=t.next;r!==void 0?(t.next=void 0,this.head=r,this.head.previous=void 0):(this.head=void 0,this.tail=void 0)}return t}},_0=()=>new xx,O0=(e,t,r,o,n,s)=>({map:e,keys:t,accesses:r,updating:o,hits:n,misses:s}),C0=()=>O0(sn(),_0(),tb(),at(!1),0,0),R0="@effect/cache/Cache",A0=Symbol.for(R0),M0={_Key:e=>e,_Error:e=>e,_Value:e=>e},T0=e=>e,Sl=e=>({loadedMillis:e}),gx=class{constructor(t,r,o,n,s){this.capacity=t,this.context=r,this.fiberId=o,this.lookup=n,this.timeToLive=s,this[uM]=M0,this.cacheState=C0()}get(t){return _(this.getEither(t),Mc)}cacheStats(){return g(()=>T0({hits:this.cacheState.hits,misses:this.cacheState.misses,size:Jc(this.cacheState.map)}))}getOption(t){return T(()=>De(ye(this.cacheState.map,t),{onNone:()=>{let r=li(t);return this.trackAccess(r),this.trackMiss(),h(x())},onSome:r=>this.resolveMapValue(r)}))}getOptionComplete(t){return T(()=>De(ye(this.cacheState.map,t),{onNone:()=>{let r=li(t);return this.trackAccess(r),this.trackMiss(),h(x())},onSome:r=>this.resolveMapValue(r,!0)}))}contains(t){return g(()=>nr(this.cacheState.map,t))}entryStats(t){return g(()=>{let r=ye(this.cacheState.map,t);if(N(r))switch(r.value._tag){case"Complete":{let o=r.value.entryStats.loadedMillis;return d(Sl(o))}case"Pending":return x();case"Refreshing":{let o=r.value.complete.entryStats.loadedMillis;return d(Sl(o))}}return x()})}getEither(t){return T(()=>{let r=t,o,n,s=je(ye(this.cacheState.map,r));return s===void 0&&(n=xh(this.fiberId),o=li(r),nr(this.cacheState.map,r)?s=je(ye(this.cacheState.map,r)):ct(this.cacheState.map,r,pM(o,n))),s===void 0?(this.trackAccess(o),this.trackMiss(),_(this.lookupValueOf(t,n),P)):l(this.resolveMapValue(s),De({onNone:()=>this.getEither(t),onSome:i=>h(q(i))}))})}invalidate(t){return g(()=>{an(this.cacheState.map,t)})}invalidateWhen(t,r){return g(()=>{let o=ye(this.cacheState.map,t);N(o)&&o.value._tag==="Complete"&&o.value.exit._tag==="Success"&&r(o.value.exit.value)&&an(this.cacheState.map,t)})}invalidateAll(){return g(()=>{this.cacheState.map=sn()})}refresh(t){return Kr(r=>T(()=>{let o=t,n=xh(this.fiberId),s=je(ye(this.cacheState.map,o));if(s===void 0&&(nr(this.cacheState.map,o)?s=je(ye(this.cacheState.map,o)):ct(this.cacheState.map,o,pM(li(o),n))),s===void 0)return Q(this.lookupValueOf(t,n));switch(s._tag){case"Complete":{if(this.hasExpired(r,s.timeToLiveMillis)){let i=je(ye(this.cacheState.map,o));return O(i,s)&&an(this.cacheState.map,o),Q(this.get(t))}return Q(Qu(()=>{let i=je(ye(this.cacheState.map,o));if(O(i,s)){let c=S0(n,s);return ct(this.cacheState.map,o,c),!0}return!1})(this.lookupValueOf(t,n)))}case"Pending":return Fn(s.deferred);case"Refreshing":return Fn(s.deferred)}}))}set(t,r){return Kr(o=>g(()=>{let n=o.unsafeCurrentTimeMillis(),s=t,i=oE(r),c=cM(li(s),i,Sl(n),n+Rr(ze(this.timeToLive(i))));ct(this.cacheState.map,s,c)}))}size(){return g(()=>Jc(this.cacheState.map))}values(){return g(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[1].exit.value);return t})}entries(){return g(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push([r[0],r[1].exit.value]);return t})}keys(){return g(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[0]);return t})}resolveMapValue(t,r=!1){return Kr(o=>{switch(t._tag){case"Complete":return this.trackAccess(t.key),this.trackHit(),this.hasExpired(o,t.timeToLiveMillis)?(an(this.cacheState.map,t.key.current),h(x())):_(t.exit,d);case"Pending":return this.trackAccess(t.key),this.trackHit(),r?h(x()):_(Fn(t.deferred),d);case"Refreshing":return this.trackAccess(t.complete.key),this.trackHit(),this.hasExpired(o,t.complete.timeToLiveMillis)?r?h(x()):_(Fn(t.deferred),d):_(t.complete.exit,d)}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(t){if(rb(this.cacheState.accesses,t),Yc(this.cacheState.updating,!1,!0)){let r=!0;for(;r;){let n=ob(this.cacheState.accesses,Qf);n===Qf?r=!1:this.cacheState.keys.add(n)}let o=Jc(this.cacheState.map);for(r=o>this.capacity;r;){let n=this.cacheState.keys.remove();n!==void 0?nr(this.cacheState.map,n.current)&&(an(this.cacheState.map,n.current),o=o-1,r=o>this.capacity):r=!1}Ut(this.cacheState.updating,!1)}}hasExpired(t,r){return t.unsafeCurrentTimeMillis()>r}lookupValueOf(t,r){return Kr(o=>T(()=>{let n=t;return Uo(()=>W(eE(r),g(()=>{an(this.cacheState.map,n)})))(l(s=>{let i=o.unsafeCurrentTimeMillis(),c=Sl(i),p=cM(li(n),s,c,i+Rr(ze(this.timeToLive(s))));return ct(this.cacheState.map,n,p),W(XS(r,s),s)})(Z(Rt(this.context)(this.lookup(t)))))}))}};uM=A0;var lM=(e,t,r)=>new gx(e,Ht(),ap,t,o=>ze(r(o)));var v0="@effect/io/Schedule/Interval",yx=Symbol.for(v0),fM={[yx]:yx,startMillis:0,endMillis:0};var mM=fM;var hM=e=>$(()=>mM)(cn(e.intervals)).startMillis;var dM=hM;var P0="Done";var xM=e=>e._tag===P0;var gM=xM;var L0,yM,H0="@effect/io/Schedule",q0=Symbol.for(H0),U0="@effect/io/Schedule/Driver",W0=Symbol.for(U0);var j0={_Env:e=>e,_In:e=>e,_Out:e=>e};L0=q0;var bx=class{constructor(t,r){this.schedule=t,this.ref=r,this[yM]=j0}state(){return _(hr(this.ref),t=>t[1])}last(){return l(hr(this.ref),([t,r])=>{switch(t._tag){case"None":return ur(()=>po());case"Some":return h(t.value)}})}reset(){return zr(this.ref,[x(),this.schedule.initial])}next(t){return l(r=>l(o=>l(([n,s,i])=>gM(i)?W(L(x()))(zr(this.ref,[d(s),n])):V(s)(W(ei(as(dM(i.intervals)-o)))(zr(this.ref,[d(s),n]))))(T(()=>this.schedule.step(o,t,r))))(Pu))(_(hr(this.ref),r=>r[1]))}};yM=W0;var Sx=e=>_(t=>new bx(e,t))(Dn([x(),e.initial]));var bM=a(2,(e,t)=>Ex(e,t,(r,o)=>L(r))),Ex=a(3,(e,t,r)=>l(Sx(t),o=>ie(e,{onFailure:n=>r(n,x()),onSuccess:n=>SM(e,o,r,n)}))),SM=(e,t,r,o)=>ie(t.next(o),{onFailure:()=>An(t.last()),onSuccess:n=>ie(e,{onFailure:s=>r(s,d(n)),onSuccess:s=>SM(e,t,r,s)})}),EM=a(2,(e,t)=>Ka(e,r=>g(()=>t(r)))),Ka=a(2,(e,t)=>l(e,r=>l(t(r),o=>o?h(r):l(Mt(),()=>Ka(e,t))))),_M=a(2,(e,t)=>_x(e,r=>g(()=>t(r)))),_x=a(2,(e,t)=>Ka(e,r=>Oa(t(r)))),OM=a(2,(e,t)=>Ox(e,t,(r,o)=>L(r))),CM=a(2,(e,t)=>RM(e,t)),RM=(e,t)=>lt(e,r=>t<0?L(r):l(Mt(),()=>RM(e,t-1))),Ox=a(3,(e,t,r)=>l(Sx(t),o=>AM(e,o,r))),AM=(e,t,r)=>lt(e,o=>ie(t.next(o),{onFailure:()=>l(n=>r(o,n))(An(t.last())),onSuccess:()=>AM(e,t,r)})),MM=a(2,(e,t)=>Ba(e,r=>g(()=>t(r)))),Ba=a(2,(e,t)=>lt(e,r=>l(t(r),o=>o?L(r):l(Mt(),()=>Ba(e,t))))),TM=a(2,(e,t)=>Cx(e,r=>g(()=>t(r)))),Cx=a(2,(e,t)=>Ba(e,r=>Oa(t(r)))),El=a(2,(e,t)=>Rx(e,void 0,t)),Rx=a(3,(e,t,r)=>l(Sx(r),o=>vM(e,t,o))),vM=(e,t,r)=>ie(r.next(t),{onFailure:()=>An(r.last()),onSuccess:()=>l(e,o=>vM(e,o,r))});var kM,FM,PM,Mx=class{constructor(t){this.permits=t,this.waiters=new Array,this.taken=0,this.take=r=>Pr(o=>{if(this.free<r){let n=()=>{if(this.free>=r){let s=this.waiters.findIndex(i=>i===n);s!==-1&&this.waiters.splice(s,1),this.taken+=r,o(h(r))}};return this.waiters.push(n),q(g(()=>{let s=this.waiters.findIndex(i=>i===n);s!==-1&&this.waiters.splice(s,1)}))}return this.taken+=r,P(h(r))}),this.release=r=>ue(o=>(this.taken-=r,o.getFiberRef(xo).scheduleTask(()=>{this.waiters.forEach(n=>n())},o.getFiberRef(oa)),k)),this.withPermits=r=>o=>be(n=>l(n(this.take(r)),s=>Br(n(o),this.release(s))))}get free(){return this.permits-this.taken}},Ol=e=>new Mx(e),NM=e=>g(()=>Ol(e)),DM=e=>Cl(e,nM),LM=a(2,(e,t)=>_(vx(e,t),r=>r[0])),vx=a(2,(e,t)=>{let r=ze(t);return l(Lr(),o=>_(Rl(x()),n=>[Rt(z0(e,r,n),o),K0(n)]))}),wM=(e,t,r)=>{let o=Rr(ze(t));return _(n=>d([r+o,n]))(At(n=>qr(e,n))(rt()))},z0=(e,t,r)=>be(o=>l(n=>j(n)?Ps("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/io/issues"):o(ve(n.value[1])))(l(n=>Y0(r,s=>{switch(s._tag){case"None":return d(wM(e,t,n));case"Some":{let[i]=s.value;return i-n<=0?d(wM(e,t,n)):x()}}}))(Kr(n=>n.currentTimeMillis)))),K0=e=>zr(e,x()),HM=a(2,(e,t)=>Cl(e,r=>t(dl(r)))),Cl=a(2,(e,t)=>l(yA,r=>Br(l(r.value(),t))(wx(e,r)))),qM=a(e=>Nt(e[0]),(e,t)=>t?.discard?mt(e,Tt):_(He(e,Tt),dl)),Ix=a(2,(e,t)=>be(r=>l(t.fork(si),o=>At(n=>o.addFinalizer(()=>Bt(s=>O(s,n.id())?k:Q(Wo(n)))))(Kn(lr(n=>o.close(n))(r(e))))))),kx=e=>$o(t=>Ix(e,t)),UM=e=>jn(e),WM=e=>T(()=>l(e,jn)),Ax=Symbol.for("@effect/io/Effect/memoizeFunction.key"),_l=class{constructor(t,r){this.a=t,this.eq=r,this[kM]=Ax}[(kM=Ax,M)](t){return typeof t=="object"&&t!==null&&Ax in t?this.eq?this.eq(this.a,t.a):O(this.a,t.a):!1}[A](){return this.eq?0:S(this.a)}},jM=(e,t)=>_(r=>o=>l(([n,s])=>V(s)(qn(n)))(l(ve)(r.modifyEffect(n=>{let s=ye(new _l(o,t))(n);return j(s)?_(i=>[i,ct(new _l(o,t),i)(n)])(At(i=>Tt(qr(i)(Ln(e(o)))))(rt())):h([s.value,n])}))))(l(Rl)(g(()=>sn()))),zM=a(2,(e,t)=>(r=>ft(r))(xl(Z(t))(Z(e)))),KM=a(2,(e,t)=>kx(El(t)(e))),wx=a(2,(e,t)=>qe(ci,o=>o.zip(t))(e)),BM=a(2,(e,t)=>Ga(e,{onTimeout:x,onSuccess:d,duration:t})),GM=a(2,(e,{duration:t,onTimeout:r})=>ft(Ga(e,{onTimeout:()=>ur(r),onSuccess:h,duration:t}))),$M=a(2,(e,{duration:t,onTimeout:r})=>ft(Ga(e,{onTimeout:()=>Hr(r),onSuccess:h,duration:t}))),Ga=a(2,(e,{duration:t,onSuccess:r,onTimeout:o})=>Bt(n=>mx(e,jt(ei(t)),{onSelfWin:(s,i)=>l(s.await(),c=>c._tag==="Success"?l(s.inheritAll(),()=>V(Gt(i,n),r(c.value))):l(Gt(i,n),()=>K(c.cause))),onOtherWin:(s,i)=>l(s.await(),c=>c._tag==="Success"?l(s.inheritAll(),()=>V(Gt(i,n),o())):l(Gt(i,n),()=>K(c.cause))),otherScope:Wn}))),B0="@effect/io/Ref/Synchronized",G0=Symbol.for(B0),$0={_A:e=>e},Tx=class{constructor(t,r){this.ref=t,this.withLock=r,this[FM]=$0,this[PM]=Gh}modify(t){return this.modifyEffect(r=>h(t(r)))}modifyEffect(t){return this.withLock(l(([r,o])=>V(zr(this.ref,o),r))(l(hr(this.ref),t)))}pipe(){return E(this,arguments)}};FM=G0,PM=ju;var Rl=e=>g(()=>V0(e)),V0=e=>{let t=zu(e),r=Ol(1);return new Tx(t,r.withPermits(1))},Y0=a(2,(e,t)=>e.modifyEffect(r=>{let o=t(r);switch(o._tag){case"None":return h([r,r]);case"Some":return _(o.value,n=>[n,n])}}));var YM="Fresh",JM="FromEffect",QM="Scoped",ZM="Suspend";var XM="ZipWithPar";var eT=Gt;var Ml=e=>(t,r)=>{let o=up(),n=t,s=Dh(e.fiberRefs,{fiberId:o,fiberRef:ho,value:e.context});r?.scheduler&&(s=Dh(s,{fiberId:o,fiberRef:xo,value:r.scheduler})),r?.updateRefs&&(s=r.updateRefs(s,o));let i=new qa(o,c_(s,o),e.runtimeFlags),c=i._supervisor;return c!==zn&&(c.onStart(e.context,n,x(),i),i.unsafeAddObserver(p=>c.onEnd(p,i))),Wn.add(e.runtimeFlags,i),i.start(n),i},Fx=e=>(t,r)=>{let o=Ml(e)(t);return r&&o.unsafeAddObserver(n=>{r(n)}),(n,s)=>Fx(e)(eT(n??et)(o),s?i=>s(rE(i)):void 0)},Z0=e=>t=>{let r=sT(e)(t);if(r._tag==="Failure")throw oT(r.i0);return r.i0},X0=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new Error;Error.stackTraceLimit=t;let o=`Fiber #${e.id().id} cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work`,n="AsyncFiberException";return Object.defineProperties(r,{_tag:{value:n},message:{value:o},name:{value:n},toString:{get(){return()=>o}},[rT]:{get(){return()=>o}}}),r};var tT=Symbol.for("@effect/io/Runtime/FiberFailure"),eP=Symbol.for("@effect/io/Runtime/FiberFailure/Cause"),rT=Symbol.for("nodejs.util.inspect.custom"),oT=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new Error;Error.stackTraceLimit=t;let o=yp(e);return o.length>0&&(r.name=o[0].message.split(":")[0],r.message=o[0].message.substring(r.name.length+2),r.stack=`${r.name}: ${r.message}
${o[0].stack}`),r[tT]=tT,r[eP]=e,r.toString=()=>uo(e),r[rT]=()=>r.toString(),r};var nT=e=>{let t=e;switch(t._tag){case"Failure":case"Success":return t;case"Left":return fr(t.left);case"Right":return X(t.right);case"Some":return X(t.value);case"None":return fr(po())}},sT=e=>t=>{let r=nT(t);if(r)return r;let o=new Pp,n=Ml(e)(t,{scheduler:o});o.flush();let s=n.unsafePoll();if(s)return s;throw X0(n)},tP=e=>t=>iT(e)(t).then(r=>{switch(r._tag){case me:return r.i0;case fe:throw oT(r.i0)}}),iT=e=>t=>new Promise(r=>{let o=nT(t);o&&r(o),Ml(e)(t).unsafeAddObserver(n=>{r(n)})}),Al=class{constructor(t,r,o){this.context=t,this.runtimeFlags=r,this.fiberRefs=o}pipe(){return E(this,arguments)}},rP=e=>new Al(e.context,e.flags,e.fiberRefs),Px=()=>ue((e,t)=>h(new Al(e.getFiberRef(ho),t.runtimeFlags,e.unsafeGetFiberRefs()))),oP=Cp(pr,Op,_p),xr=rP({context:Ht(),flags:oP,fiberRefs:l_(new Map)}),aT=Fx(xr),cT=Ml(xr),pT=tP(xr),uT=iT(xr),lT=Z0(xr),fT=sT(xr),mT=e=>l(rt(),t=>l(Px(),r=>be(o=>W(Tt(o(Nr(e(n=>Fx(r)(qr(n,t))),n=>wn(t,n)))),o(ve(t))))));var hT=a(2,(e,t)=>e.modifyEffect(t));var iP="@effect/io/Layer",aP=Symbol.for(iP),cP={_RIn:e=>e,_E:e=>e,_ROut:e=>e},Tl={[aP]:cP,pipe(){return E(this,arguments)}};var pP=e=>e._tag===YM,Nx=class{constructor(t){this.ref=t}getOrElseMemoize(t,r){return ft(hT(this.ref,o=>{let n=o.get(t);if(n!==void 0){let[s,i]=n,c=lr(su({onFailure:()=>k,onSuccess:()=>Ws(r,i)}))(l(([p,u])=>V(u)(qn(p)))(s));return h([c,o])}return l(s=>l(i=>_(c=>{let p=be(f=>l(m=>l(y=>{switch(y._tag){case fe:return W(D(y.i0))(W(jo(m,y))(wn(i,y.i0)));case me:return V(y.i0[1])(W(Bs(i,y.i0))(W(Ws(r,b=>l(C=>C(b))(hr(c))))(W(ya(s,b=>b+1))(zr(c,b=>Q(Hs(Ku(s,C=>[C===1,C-1]))(jo(m,b))))))))}})(Z(f(l(xT(t,m),y=>Ln(y(this)))))))(Bn())),u=[lr(kn({onFailure:()=>k,onSuccess:()=>ya(s,f=>f+1)}))(ve(i)),f=>l(m=>m(f))(hr(c))];return[p,pP(t)?o:o.set(t,u)]})(Dn(()=>k)))(rt()))(Dn(0))}))}},uP=()=>_(Rl(new Map),e=>new Nx(e));var dT=a(2,(e,t)=>l(uP(),r=>l(xT(e,t),o=>o(r)))),xT=(e,t)=>{let r=e;switch(r._tag){case"Locally":return g(()=>o=>r.f(o.getOrElseMemoize(r.self,t)));case"ExtendScope":return g(()=>o=>$o(n=>o.getOrElseMemoize(r.layer,n)));case"Fold":return g(()=>o=>Y({onFailure:n=>o.getOrElseMemoize(r.failureK(n),t),onSuccess:n=>o.getOrElseMemoize(r.successK(n),t)})(o.getOrElseMemoize(r.layer,t)));case"Fresh":return g(()=>o=>dT(t)(r.layer));case"FromEffect":return g(()=>o=>r.effect);case"ProvideTo":return g(()=>o=>l(n=>Rt(n)(o.getOrElseMemoize(r.second,t)))(o.getOrElseMemoize(r.first,t)));case"Scoped":return g(()=>o=>Gn(r.effect,t));case"Suspend":return g(()=>o=>o.getOrElseMemoize(r.evaluate(),t));case"ZipWith":return g(()=>o=>mo(o.getOrElseMemoize(r.second,t),r.zipK)(o.getOrElseMemoize(r.first,t)));case"ZipWithPar":return g(()=>o=>Eo(o.getOrElseMemoize(r.second,t),r.zipK,{concurrent:!0})(o.getOrElseMemoize(r.first,t)))}};var lP=()=>fP(Lr());function fP(e){let t=Object.create(Tl);return t._tag=JM,t.effect=e,t}var mP=a(2,(e,t)=>xP(e,t,(r,o)=>is(o)(r)));var vt=e=>hP(V(Ht())(e)),hP=e=>{let t=Object.create(Tl);return t._tag=QM,t.effect=e,t};var dP=e=>{let t=Object.create(Tl);return t._tag=ZM,t.evaluate=e,t};var xP=a(3,(e,t,r)=>dP(()=>{let o=Object.create(Tl);return o._tag=XM,o.first=e,o.second=t,o.zipK=r,o})),Dx=a(2,(e,t)=>zt(Bn(),r=>l(dT(t,r),o=>Rt(e,o)),(r,o)=>jo(r,o))),gT=a(2,(e,t)=>Dx(e,mP(lP(),t)));var bT=e=>vt(ml(e)),ST=e=>vt(bl(e)),ET=(e,t)=>vt(gl(e,t)),_T=e=>vt(yl(e));var Lx=En;var fi=xe(lM(65536,()=>_(rt(),e=>({listeners:new Pa,handle:e})),()=>Rf(60))),$a=z(Symbol.for("@effect/io/FiberRef/currentCacheEnabled"),()=>xe(!1)),Hx=(e,t)=>l(de(t)?t:h(t),r=>Bt(o=>{let n=new Proxy(e,{});return Se($a,s=>{if(s)return Se(fi,c=>l(c.getEither(n),p=>{switch(p._tag){case"Left":return p.left.listeners.increment(),he(fS,l(Z(ve(p.left.handle)),u=>u._tag==="Failure"&&No(u.cause)?(p.left.listeners.decrement(),l(c.invalidateWhen(n,f=>f.handle===p.left.handle),()=>Hx(n,t))):Br(ve(p.left.handle),g(()=>p.left.listeners.decrement()))));case"Right":return p.right.listeners.increment(),he(Km(r,Bm({request:n,result:p.right.handle,listeners:p.right.listeners,ownerId:o,state:{completed:!1}})),be(u=>l(Z(u(ve(p.right.handle))),f=>(p.right.listeners.decrement(),f))))}}));let i=new Pa;return i.increment(),l(rt(),c=>he(Km(r,Bm({request:n,result:c,listeners:i,ownerId:o,state:{completed:!1}})),Br(ve(c),g(()=>i.decrement()))))})})),OT=(e,t)=>Se($a,r=>r?Se(fi,o=>l(o.getEither(e),n=>{switch(n._tag){case"Left":return k;case"Right":return hh(n.right.handle,t)}})):k),CT=a(2,(e,t)=>Ee(e,$a,t)),RT=a(2,(e,t)=>Ee(e,fi,t));var SP=Fs,EP=de,_P=LM,OP=vx,CP=Zh,RP=jM,AP=Xh,MP=ui,TP=HA,vP=qA,IP=rO,kP=oO,wP=fO,FP=NA,PP=LA,NP=cO,DP=uO,Va=Jt,LP=xO,HP=nx,qP=sx,UP=zO,WP=BA,jP=KO,zP=BO,KP=rx,BP=UA,GP=XO,$P=eC,VP=zA,YP=ZA,JP=Kt,QP=mT,ZP=U_,XP=Pr,eN=L,tN=ur,rN=D,oN=Hr,nN=Qm,sN=Ps,iN=Lo,aN=dO,cN=vn,pN=NO,uN=UO,lN=h,fN=ti,mN=td,mi=T,hN=g,ht=k,dN=Mt,xN=W_;var gN=lt,yN=Nr,bN=j_,SN=kS,EN=z_,_N=K_,ON=B_,CN=G_,RN=$_,AN=Vh,MN=gO,TN=yO,vN=qO,IN=YO,kN=OM,wN=CM,FN=Ox,PN=MM,NN=Ba,DN=TM,LN=Cx,HN=Sa;var qN=cC,UN=pC,WN=id,jN=fC,zN=J_,KN=wS,BN=sM,GN=Wp,$N=jp,VN=jt,YN=FS,JN=Uo,QN=Fr,ZN=be,XN=V,eD=$u,tD=q_,rD=Q,oD=qo,nD=lO,Wx=_,sD=FO,iD=zp,aD=fo,cD=Xs,pD=PO,uD=Oa,lD=Wa,fD=FA,AT=zt,mD=ja,hD=Br,dD=Kp,xD=lr,gD=GA,yD=$A,bD=hl,SD=$o,ED=ix,_D=YA,OD=eM,CD=DM,RD=PA,AD=Q_,MD=Vu,TD=Ln,vD=HM,ID=Cl,kD=Ho,wD=Bt,FD=Tt,PD=Kn,ND=qM,DD=Ix,LD=kx,HD=WA,qD=UM,UD=WM,WD=wx,jD=Gp,zD=DS,KD=e=>vt(Qt(xo,e)),BD=KS,GD=zS,$D=ph,VD=V_,YD=Kr,JD=e=>vt(dr(ot,we(Wr,e))),QD=XA,ZD=ZE,XD=Y_,eL=ei,tL=sC,rL=sd,oL=BM,nL=GM,sL=$M,iL=Ga,aL=e_,cL=kh,pL=bT,uL=XE,lL=ml,fL=Lr,MT=nO,mL=Ns,hL=Mn,dL=Rt,TT=NS,xL=a(2,(e,t)=>{let r=Lx(xr.runtimeFlags,t.runtimeFlags),o=Lx(t.runtimeFlags,xr.runtimeFlags),n=ni(xr.fiberRefs,t.fiberRefs),s=ni(t.fiberRefs,xr.fiberRefs);return AT(l(Ux(r),()=>qx(n)),()=>TT(e,t.context),()=>l(Ux(o),()=>qx(s)))}),gL=Dx,yL=WO,bL=ed,SL=gT,EL=yC,_L=gC,OL=ad,CL=cd,RL=bC,AL=e=>MT(t=>ny(t,e)),ML=mC,TL=Z_,vL=X_,IL=eO,kL=tO;var Vo=Dr,wL=Z,FL=qr,PL=DO,NL=QO,DL=JA,LL=Up;var HL=sO,qL=iO,UL=Ea,WL=aO,jL=uC,zL=lC,KL=Qu,BL=Hs,GL=hC,$L=dC,It=l,VL=ft,YL=KA,JL=xl,QL=zM,ZL=fx,XL=Yu,e2=At,t2=tC,r2=rC,o2=nd,n2=oC,s2=nC,i2=hO,a2=Jh,c2=IO,p2=bM,u2=$O,l2=Ex,f2=EM,m2=Ka,h2=_M,d2=_x,x2=El,g2=KM,y2=Rx,b2=Tn,S2=Yh,E2=bO,_2=Ee,O2=qe,C2=Qt,R2=dr,qx=qn,A2=JO,M2=Ju,T2=SO,v2=EO,I2=_a,k2=ra,w2=Y,F2=ie,P2=_O,N2=OO,D2=Qh,L2=CO,H2=RO,q2=AO,U2=MO,W2=TO,j2=H_,z2=vO,K2=BS,B2=e=>vt(Qt(ia,e)),G2=An,$2=Zm,V2=Rn,Y2=LO,J2=HO,Q2=jO,Z2=wu,X2=Px,eH=Bp,Ux=Ls,tH=HS,rH=ux,oH=ZO,nH=rd,sH=od,iH=VA,aH=ax,cH=cx,pH=GS,uH=xC,lH=Do,fH=F,mH=Ol,hH=NM,dH=cT,xH=aT,vT=pT,gH=uT,yH=lT,bH=fT,SH=QA,EH=px,_H=tM,OH=rM,CH=oM,RH=Eo,AH=he,MH=qp,TH=wr,vH=Ds,IH=Hx,kH=OT,wH=LS,FH=e=>vt(Qt(sa,e)),PH=e=>vt(Qt($a,e)),NH=e=>vt(de(e)?l(e,t=>Qt(fi,t)):Qt(fi,e)),DH=CT,LH=RT,HH=_T,qH=aC,UH=Fu,WH=t_,jH=yl,zH=qS,KH=e=>vt(Qt(aa,e)),BH=EC,GH=SC,$H=ud,VH=pd,YH=OC,JH=CC,QH=_C,ZH=ri,XH=ST,eq=ET,tq=ld,rq=iM,oq=RC,nq=gl,sq=fd,iq=bl,aq=AC,cq=MC;var dt={};hc(dt,{ConfigTypeId:()=>pq,all:()=>uq,array:()=>lq,boolean:()=>fq,chunk:()=>mq,date:()=>hq,fail:()=>dq,hashMap:()=>Nq,hashSet:()=>Iq,integer:()=>gq,isConfig:()=>bq,logLevel:()=>yq,map:()=>Sq,mapAttempt:()=>Eq,mapOrFail:()=>_q,nested:()=>Oq,number:()=>xq,option:()=>Aq,orElse:()=>Cq,orElseIf:()=>Rq,primitive:()=>Mq,repeat:()=>Tq,secret:()=>vq,string:()=>kq,succeed:()=>wq,suspend:()=>Fq,sync:()=>Pq,unwrap:()=>Dq,validate:()=>Lq,withDefault:()=>Hq,withDescription:()=>qq,zip:()=>Uq,zipWith:()=>Wq});var pq=Mu,uq=IE,lq=yE,fq=gE,mq=Tu,hq=bE,dq=SE,xq=EE,gq=_E,yq=OE,bq=Oh,Sq=So,Eq=CE,_q=Vs,Oq=Vt,Cq=AE,Rq=vu,Aq=ME,Mq=zo,Tq=Au,vq=TE,Iq=vE,kq=_h,wq=Ys,Fq=fa,Pq=wE,Nq=FE,Dq=Ch,Lq=PE,Hq=NE,qq=DE,Uq=LE,Wq=ma;var vl={};hc(vl,{Class:()=>ay,TaggedClass:()=>kI,array:()=>vI,case:()=>II,struct:()=>ro,tagged:()=>iy,taggedEnum:()=>wI,tuple:()=>TI,unsafeArray:()=>Of,unsafeStruct:()=>sy});var oe={};hc(oe,{Do:()=>TL,EffectTypeId:()=>SP,acquireRelease:()=>lD,acquireReleaseInterruptible:()=>fD,acquireUseRelease:()=>AT,addFinalizer:()=>mD,all:()=>MP,allSuccesses:()=>vP,allWith:()=>TP,allowInterrupt:()=>zN,annotateCurrentSpan:()=>GH,annotateLogs:()=>j2,annotateSpans:()=>BH,as:()=>XN,asSome:()=>eD,asSomeError:()=>tD,asUnit:()=>rD,async:()=>JP,asyncEffect:()=>QP,asyncEither:()=>XP,asyncOption:()=>ZP,awaitAllChildren:()=>CD,bind:()=>vL,bindTo:()=>IL,blocked:()=>AH,cacheRequestResult:()=>kH,cached:()=>CP,cachedFunction:()=>RP,cachedInvalidateWithTTL:()=>OP,cachedWithTTL:()=>_P,catch:()=>xN,catchAll:()=>gN,catchAllCause:()=>yN,catchAllDefect:()=>bN,catchSome:()=>SN,catchSomeCause:()=>EN,catchSomeDefect:()=>_N,catchTag:()=>ON,catchTags:()=>CN,cause:()=>RN,checkInterruptible:()=>KN,clock:()=>VD,clockWith:()=>YD,config:()=>aL,configProviderWith:()=>cL,context:()=>fL,contextWith:()=>MT,contextWithEffect:()=>mL,currentParentSpan:()=>VH,currentSpan:()=>$H,daemonChildren:()=>RD,delay:()=>XD,descriptor:()=>AD,descriptorWith:()=>MD,die:()=>nN,dieMessage:()=>sN,dieSync:()=>iN,diffFiberRefs:()=>TD,disconnect:()=>BN,dropUntil:()=>IP,dropWhile:()=>kP,either:()=>Vo,ensuring:()=>hD,ensuringChild:()=>vD,ensuringChildren:()=>ID,eventually:()=>AN,every:()=>wP,exists:()=>FP,exit:()=>wL,fail:()=>eN,failCause:()=>rN,failCauseSync:()=>oN,failSync:()=>tN,fiberId:()=>kD,fiberIdWith:()=>wD,filter:()=>PP,filterOrDie:()=>HL,filterOrDieMessage:()=>qL,filterOrElse:()=>UL,filterOrFail:()=>WL,findFirst:()=>NP,firstSuccessOf:()=>DP,flatMap:()=>It,flatMapStep:()=>vH,flatten:()=>VL,flip:()=>oD,flipWith:()=>nD,forEach:()=>Va,forever:()=>i2,fork:()=>FD,forkAll:()=>ND,forkDaemon:()=>PD,forkIn:()=>DD,forkScoped:()=>LD,forkWithErrorHandler:()=>HD,fromFiber:()=>qD,fromFiberEffect:()=>UD,fromNullable:()=>aq,gen:()=>aN,getFiberRefs:()=>S2,head:()=>LP,if:()=>LL,ignore:()=>MN,ignoreLogged:()=>TN,inheritFiberRefs:()=>E2,interrupt:()=>GN,interruptWith:()=>$N,interruptible:()=>VN,interruptibleMask:()=>YN,intoDeferred:()=>FL,isEffect:()=>EP,isFailure:()=>T2,isSuccess:()=>v2,iterate:()=>a2,labelMetrics:()=>nH,labelMetricsScoped:()=>aH,labelMetricsScopedSet:()=>cH,labelMetricsSet:()=>sH,let:()=>kL,linkSpans:()=>QH,locally:()=>_2,locallyScoped:()=>C2,locallyScopedWith:()=>R2,locallyWith:()=>O2,log:()=>P2,logAnnotations:()=>z2,logDebug:()=>D2,logError:()=>q2,logFatal:()=>U2,logInfo:()=>L2,logTrace:()=>N2,logWarning:()=>H2,loop:()=>c2,makeSemaphore:()=>hH,makeSpan:()=>ZH,map:()=>Wx,mapAccum:()=>sD,mapBoth:()=>iD,mapError:()=>aD,mapErrorCause:()=>cD,mapInputContext:()=>hL,match:()=>I2,matchCause:()=>k2,matchCauseEffect:()=>w2,matchEffect:()=>F2,merge:()=>pD,mergeAll:()=>HP,metricLabels:()=>pH,negate:()=>uD,never:()=>cN,none:()=>pN,onError:()=>dD,onExit:()=>xD,onInterrupt:()=>JN,once:()=>AP,option:()=>PL,optionFromOptional:()=>cq,orDie:()=>G2,orDieWith:()=>$2,orElse:()=>V2,orElseFail:()=>Y2,orElseSucceed:()=>J2,parallelErrors:()=>vN,parallelFinalizers:()=>gD,partition:()=>qP,patchFiberRefs:()=>qx,promise:()=>uN,provideContext:()=>dL,provideLayer:()=>gL,provideService:()=>yL,provideServiceEffect:()=>bL,provideSomeContext:()=>TT,provideSomeLayer:()=>SL,provideSomeRuntime:()=>xL,race:()=>JL,raceAll:()=>YL,raceFirst:()=>QL,raceWith:()=>ZL,random:()=>Q2,randomWith:()=>Z2,reduce:()=>UP,reduceEffect:()=>WP,reduceRight:()=>jP,reduceWhile:()=>zP,repeat:()=>p2,repeatN:()=>u2,repeatOrElse:()=>l2,repeatUntil:()=>f2,repeatUntilEffect:()=>m2,repeatWhile:()=>h2,repeatWhileEffect:()=>d2,replicate:()=>KP,replicateEffect:()=>BP,request:()=>IH,retry:()=>kN,retryN:()=>wN,retryOrElse:()=>FN,retryUntil:()=>PN,retryUntilEffect:()=>NN,retryWhile:()=>DN,retryWhileEffect:()=>LN,runCallback:()=>xH,runFork:()=>dH,runPromise:()=>vT,runPromiseExit:()=>gH,runRequestBlock:()=>MH,runSync:()=>yH,runSyncExit:()=>bH,runtime:()=>X2,runtimeFlags:()=>eH,sandbox:()=>IN,schedule:()=>x2,scheduleForked:()=>g2,scheduleFrom:()=>y2,scope:()=>bD,scopeWith:()=>SD,scoped:()=>ED,sequentialFinalizers:()=>yD,serviceConstants:()=>CL,serviceFunction:()=>EL,serviceFunctionEffect:()=>_L,serviceFunctions:()=>OL,serviceMembers:()=>RL,serviceOption:()=>AL,setClock:()=>JD,setConfigProvider:()=>pL,setFiberRefs:()=>A2,setParentSpan:()=>XH,setRequestBatching:()=>FH,setRequestCache:()=>NH,setRequestCaching:()=>PH,setScheduler:()=>KD,setSpan:()=>eq,setTracer:()=>HH,setTracerTiming:()=>KH,setUnhandledErrorLogLevel:()=>B2,sleep:()=>eL,some:()=>NL,spanAnnotations:()=>YH,spanLinks:()=>JH,step:()=>TH,succeed:()=>lN,succeedNone:()=>fN,succeedSome:()=>mN,summarized:()=>XL,supervised:()=>WD,suspend:()=>mi,sync:()=>hN,tagMetrics:()=>oH,tagMetricsScoped:()=>iH,takeUntil:()=>GP,takeWhile:()=>$P,tap:()=>e2,tapBoth:()=>t2,tapDefect:()=>r2,tapError:()=>o2,tapErrorCause:()=>s2,tapErrorTag:()=>n2,timed:()=>tL,timedWith:()=>rL,timeout:()=>oL,timeoutFail:()=>nL,timeoutFailCause:()=>sL,timeoutTo:()=>iL,tracer:()=>qH,tracerWith:()=>UH,transplant:()=>jD,try:()=>HN,tryMap:()=>qN,tryMapPromise:()=>UN,tryPromise:()=>WN,unified:()=>fH,unifiedFn:()=>lH,uninterruptible:()=>QN,uninterruptibleMask:()=>ZN,unit:()=>ht,unless:()=>jL,unlessEffect:()=>zL,unsafeMakeSemaphore:()=>mH,unsandbox:()=>jN,unsome:()=>DL,updateFiberRefs:()=>M2,updateRuntimeFlags:()=>Ux,updateService:()=>ML,useSpan:()=>tq,useSpanScoped:()=>rq,using:()=>_D,validate:()=>SH,validateAll:()=>VP,validateFirst:()=>YP,validateWith:()=>EH,when:()=>KL,whenEffect:()=>BL,whenFiberRef:()=>GL,whenRef:()=>$L,whileLoop:()=>b2,withClock:()=>ZD,withClockScoped:()=>QD,withConcurrency:()=>zD,withConfigProvider:()=>uL,withConfigProviderScoped:()=>lL,withEarlyRelease:()=>OD,withLogSpan:()=>W2,withMaxFiberOps:()=>BD,withMetric:()=>uH,withParentSpan:()=>sq,withParentSpanScoped:()=>iq,withRequestBatching:()=>wH,withRequestCache:()=>LH,withRequestCaching:()=>DH,withRuntimeFlags:()=>tH,withRuntimeFlagsScoped:()=>rH,withScheduler:()=>GD,withSchedulingPriority:()=>$D,withSpan:()=>oq,withSpanScoped:()=>nq,withTracer:()=>WH,withTracerScoped:()=>jH,withTracerTiming:()=>zH,withUnhandledErrorLogLevel:()=>K2,yieldNow:()=>dN,zip:()=>_H,zipLeft:()=>OH,zipRight:()=>CH,zipWith:()=>RH});var Ja={};hc(Ja,{SafeRefinementId:()=>e1,any:()=>s1,bigint:()=>u1,boolean:()=>a1,date:()=>l1,defined:()=>i1,discriminator:()=>kT,discriminators:()=>Kx,discriminatorsExhaustive:()=>wT,either:()=>Il,exhaustive:()=>NT,instanceOf:()=>FT,instanceOfUnsafe:()=>m1,is:()=>r1,nonEmptyString:()=>t1,not:()=>Xq,null:()=>p1,number:()=>n1,option:()=>d1,orElse:()=>PT,orElseAbsurd:()=>h1,record:()=>f1,string:()=>o1,tag:()=>Qq,tags:()=>Zq,tagsExhaustive:()=>Bx,type:()=>Kq,typeTags:()=>$q,undefined:()=>c1,value:()=>Bq,valueTags:()=>Gq,when:()=>Vq,whenAnd:()=>Jq,whenOr:()=>Yq});var Ya=class e{constructor(t){this.cases=t,this._tag="TypeMatcher",this._input=F,this._filters=F,this._remaining=F,this._result=F}add(t){return new e([...this.cases,t])}pipe(){return E(this,arguments)}},jx=class e{constructor(t,r){this.provided=t,this.value=r,this._tag="ValueMatcher",this._input=F,this._filters=F,this._result=F}add(t){return this.value._tag==="Right"?this:t._tag==="When"&&t.guard(this.provided)===!0?new e(this.provided,P(t.evaluate(this.provided))):t._tag==="Not"&&t.guard(this.provided)===!1?new e(this.provided,P(t.evaluate(this.provided))):this}pipe(){return E(this,arguments)}},$n=class{constructor(t,r){this.guard=t,this.evaluate=r,this._tag="When"}},zx=class{constructor(t,r){this.guard=t,this.evaluate=r,this._tag="Not"}},hi=e=>{if(typeof e=="function")return e;if(Array.isArray(e)){let t=e.map(hi),r=t.length;return o=>{if(!Array.isArray(o))return!1;for(let n=0;n<r;n++)if(t[n](o[n])===!1)return!1;return!0}}else if(e!==null&&typeof e=="object"){let t=Object.entries(e).map(([o,n])=>[o,hi(n)]),r=t.length;return o=>{if(typeof o!="object"||o===null)return!1;for(let n=0;n<r;n++){let[s,i]=t[n];if(!(s in o)||i(o[s])===!1)return!1}return!0}}return t=>t===e},jq=e=>{let t=e.map(hi),r=t.length;return o=>{for(let n=0;n<r;n++)if(t[n](o)===!0)return!0;return!1}},zq=e=>{let t=e.map(hi),r=t.length;return o=>{for(let n=0;n<r;n++)if(t[n](o)===!1)return!1;return!0}},Kq=()=>new Ya([]),Bq=e=>new jx(e,q(e)),Gq=e=>{let t=Bx(e)(new Ya([]));return r=>t(r)},$q=()=>e=>{let t=Bx(e)(new Ya([]));return r=>t(r)},Vq=(e,t)=>r=>r.add(new $n(hi(e),t)),Yq=(...e)=>t=>{let r=e[e.length-1],o=e.slice(0,-1);return t.add(new $n(jq(o),r))},Jq=(...e)=>t=>{let r=e[e.length-1],o=e.slice(0,-1);return t.add(new $n(zq(o),r))},kT=e=>(...t)=>{let r=t[t.length-1],o=t.slice(0,-1),n=o.length===1?s=>s[e]===o[0]:s=>o.includes(s[e]);return s=>s.add(new $n(n,r))},Kx=e=>t=>{let r=[];for(let n in t){let s=c=>c[e]===n,i=t[n];i&&r.push(new $n(s,i))}let o=r.length;return n=>{let s=n;for(let i=0;i<o;i++)s=s.add(r[i]);return s}},wT=e=>t=>{let r=Kx(e)(t);return o=>NT(r(o))},Qq=kT("_tag"),Zq=Kx("_tag"),Bx=wT("_tag"),Xq=(e,t)=>r=>r.add(new zx(hi(e),t)),e1=Symbol.for("@effect/match/SafeRefinementId"),t1=e=>typeof e=="string"&&e.length>0,r1=(...e)=>{let t=e.length;return r=>{for(let o=0;o<t;o++)if(r===e[o])return!0;return!1}},o1=Ri,n1=Jo,s1=()=>!0,i1=e=>e!=null,a1=yc,c1=Ai;var p1=Og;var u1=es,l1=bc,f1=Mi,FT=e=>t=>t instanceof e,m1=FT,PT=e=>t=>{let r=Il(t);return Rc(r)?r._tag==="Right"?r.right:e(r.left):o=>{let n=r(o);return n._tag==="Right"?n.right:e(n.left)}},h1=e=>PT(()=>{throw new Error("absurd")})(e),Il=e=>{if(e._tag==="ValueMatcher")return e.value;let t=e.cases.length;return r=>{for(let o=0;o<t;o++){let n=e.cases[o];if(n._tag==="When"&&n.guard(r)===!0)return P(n.evaluate(r));if(n._tag==="Not"&&n.guard(r)===!1)return P(n.evaluate(r))}return q(r)}},d1=e=>{let t=Il(e);return Rc(t)?Ac(t,{onLeft:()=>x(),onRight:d}):r=>Ac(t(r),{onLeft:()=>x(),onRight:o=>d(o)})},NT=e=>{let t=Il(e);if(Rc(t)){if(t._tag==="Right")return t.right;throw new Error("@effect/match: exhaustive absurd")}return r=>{let o=t(r);if(o._tag==="Right")return o.right;throw new Error("@effect/match: exhaustive absurd")}};var kl="@effect/schema/ArbitraryHookId",Gx="@effect/schema/PrettyHookId",$x=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return $x(e,t.from)}},Qa=e=>Object.keys(e).concat(Object.getOwnPropertySymbols(e)),wl=e=>{let t=!1,r;return()=>(t||(r=e(),t=!0),r)};var Vx=e=>({_tag:"ParseError",errors:e}),gr=(e,t,r)=>({_tag:"Type",expected:e,actual:t,message:Dt(r)}),LT={_tag:"Forbidden"},_o=(e,t)=>({_tag:"Index",index:e,errors:t}),Gr=(e,t)=>({_tag:"Key",key:e,errors:t}),Fl={_tag:"Missing"},Yx=e=>({_tag:"Unexpected",actual:e}),Jx=e=>({_tag:"UnionMember",errors:e}),Je=P,Zt=e=>q(Vx([e])),Ue=e=>q(Vx(e)),$r=e=>{let t=e;if(t._tag==="Left"||t._tag==="Right")return t},di=(e,t)=>{let r=e;return r._tag==="Left"?r:r._tag==="Right"?t(r.right):It(e,t)},HT=(e,t)=>{let r=e;return r._tag==="Left"?r:r._tag==="Right"?P(t(r.right)):Wx(e,t)};var Xx="@effect/schema/TypeAnnotationId",Nl="@effect/schema/MessageAnnotationId",xi="@effect/schema/IdentifierAnnotationId",nt="@effect/schema/TitleAnnotationId",Yo="@effect/schema/DescriptionAnnotationId",WT="@effect/schema/ExamplesAnnotationId",jT="@effect/schema/JSONSchemaAnnotationId",zT="@effect/schema/DocumentationAnnotationId",ec=e=>t=>Object.prototype.hasOwnProperty.call(t.annotations,e)?d(t.annotations[e]):x(),gi=(e,t,r,o={})=>({_tag:"Declaration",typeParameters:e,type:t,decode:r,annotations:o});var KT=e=>({_tag:"Literal",literal:e,annotations:{}}),Vn=e=>e._tag==="Literal";var x1=e=>e._tag==="UniqueSymbol",g1={_tag:"UndefinedKeyword",annotations:{[nt]:"undefined"}};var y1={_tag:"VoidKeyword",annotations:{[nt]:"void"}};var tc={_tag:"NeverKeyword",annotations:{[nt]:"never"}};var yi={_tag:"UnknownKeyword",annotations:{[nt]:"unknown"}},b1=e=>e._tag==="UnknownKeyword",BT={_tag:"AnyKeyword",annotations:{[nt]:"any"}},S1=e=>e._tag==="AnyKeyword",Dl={_tag:"StringKeyword",annotations:{[nt]:"string"}},Xa=e=>e._tag==="StringKeyword",GT={_tag:"NumberKeyword",annotations:{[nt]:"number"}},Pl=e=>e._tag==="NumberKeyword",E1={_tag:"BooleanKeyword",annotations:{[nt]:"boolean"}},qT=e=>e._tag==="BooleanKeyword",_1={_tag:"BigIntKeyword",annotations:{[nt]:"bigint"}},UT=e=>e._tag==="BigIntKeyword",eg={_tag:"SymbolKeyword",annotations:{[nt]:"symbol"}},Zx=e=>e._tag==="SymbolKeyword",O1={_tag:"ObjectKeyword",annotations:{[nt]:"object"}};var rc=(e,t)=>({type:e,isOptional:t}),Yn=(e,t,r,o={})=>({_tag:"Tuple",elements:e,rest:t,isReadonly:r,annotations:o});var Ne=(e,t,r,o,n={})=>({name:e,type:t,isOptional:r,isReadonly:o,annotations:n}),$T=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return $T(e.from);default:return!1}},bi=(e,t,r)=>{if($T(e))return{parameter:e,type:t,isReadonly:r};throw new Error("An index signature parameter type must be 'string', 'symbol', a template literal type or a refinement of the previous types")},Oo=(e,t,r={})=>{let o={};for(let s=0;s<e.length;s++){let i=e[s].name;if(Object.prototype.hasOwnProperty.call(o,i))throw new Error(`Duplicate property signature ${String(i)}`);o[i]=null}let n={string:!1,symbol:!1};for(let s=0;s<t.length;s++){let i=Hl(t[s].parameter);if(Xa(i)){if(n.string)throw new Error("Duplicate index signature for type `string`");n.string=!0}else if(Zx(i)){if(n.symbol)throw new Error("Duplicate index signature for type `symbol`");n.symbol=!0}}return{_tag:"TypeLiteral",propertySignatures:C1(e),indexSignatures:t,annotations:r}};var Co=(e,t={})=>{let r=T1(e);switch(r.length){case 0:return tc;case 1:return r[0];default:return{_tag:"Union",types:M1(r),annotations:t}}};var oc=(e,t={})=>({_tag:"Lazy",f:wl(e),annotations:t});var nc=(e,t,r,o={})=>({_tag:"Refinement",from:e,decode:t,isReversed:r,annotations:o}),VT=e=>e._tag==="Refinement",sc=(e,t,r,o)=>({from:e,to:t,decode:r,encode:o}),Ll=(e,t,r,o,n,s={})=>({_tag:"Transform",from:e,to:t,decode:r,encode:o,propertySignatureTransformations:n,annotations:s}),YT=(e,t,r,o,n={})=>Ll(e,t,r,o,[],n),JT=(e,t,r,o={})=>Ll(e,t,n=>{for(let s=0;s<r.length;s++){let i=r[s],c=i.from,p=Object.prototype.hasOwnProperty.call(n,c)?d(n[c]):x();delete n[c];let u=i.decode(p);N(u)&&(n[i.to]=u.value)}return Je(n)},n=>{for(let s=0;s<r.length;s++){let i=r[s],c=i.to,p=Object.prototype.hasOwnProperty.call(n,c)?d(n[c]):x();delete n[c];let u=i.encode(p);N(u)&&(n[i.from]=u.value)}return Je(n)},r,o);var QT=(e,t,r)=>({...e,annotations:{...e.annotations,[t]:r}});var ZT=e=>e.map(t=>Ne(t.name,Pe(t.type),t.isOptional,t.isReadonly,t.annotations)),XT=e=>e.map(t=>bi(t.parameter,Pe(t.type),t.isReadonly)),Pe=e=>{switch(e._tag){case"Declaration":return gi(e.typeParameters.map(Pe),Pe(e.type),e.decode,e.annotations);case"Tuple":return Yn(e.elements.map(t=>rc(Pe(t.type),t.isOptional)),Me(e.rest,ss(Pe)),e.isReadonly,e.annotations);case"TypeLiteral":return Oo(ZT(e.propertySignatures),XT(e.indexSignatures),e.annotations);case"Union":return Co(e.types.map(Pe),e.annotations);case"Lazy":return oc(()=>Pe(e.f()),e.annotations);case"Refinement":return nc(Pe(e.from),e.decode,!1,e.annotations);case"Transform":return Pe(e.to)}return e},Xt=e=>{switch(e._tag){case"Declaration":return gi(e.typeParameters.map(Xt),Xt(e.type),e.decode,e.annotations);case"Tuple":return Yn(e.elements.map(t=>rc(Xt(t.type),t.isOptional)),Me(e.rest,ss(Xt)),e.isReadonly);case"TypeLiteral":return Oo(e.propertySignatures.map(t=>Ne(t.name,Xt(t.type),t.isOptional,t.isReadonly)),e.indexSignatures.map(t=>bi(t.parameter,Xt(t.type),t.isReadonly)));case"Union":return Co(e.types.map(Xt));case"Lazy":return oc(()=>Xt(e.f()));case"Refinement":case"Transform":return Xt(e.from)}return e},ev=e=>{switch(e._tag){case"Declaration":return ev(e.type);case"NeverKeyword":return 0;case"Literal":case"UndefinedKeyword":case"VoidKeyword":case"UniqueSymbol":return 1;case"BooleanKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3;case"ObjectKeyword":return 5;case"UnknownKeyword":case"AnyKeyword":return 6;default:return 4}},C1=Zo(ne(yt,Ci(e=>ev(e.type)))),tv=Sg(yt,yt,yt),R1=Zl(tv),rv=[0,0,0],A1=e=>e.reduce(R1,rv),Za=e=>{switch(e._tag){case"Tuple":{let t=e.elements.length,r=N(e.rest)?e.rest.value.length:0;return[2,t,r]}case"TypeLiteral":{let t=e.propertySignatures.length,r=e.indexSignatures.length;return t+r===0?[-4,0,0]:[4,t,r]}case"Declaration":{let[t,r,o]=Za(e.type);return[6,r,o]}case"Lazy":return[8,0,0];case"Union":return A1(e.types.map(Za));case"Refinement":{let[t,r,o]=Za(e.from);return[t+1,r,o]}case"Transform":return Za(e.from);case"ObjectKeyword":return[-2,0,0];case"UnknownKeyword":case"AnyKeyword":return[-4,0,0];default:return rv}},M1=Zo(bg(Ci(tv,Za))),T1=e=>{let t=ne(e,kc(o=>{switch(o._tag){case"NeverKeyword":return[];case"Union":return o.types;default:return[o]}}));if(t.some(S1))return[BT];if(t.some(b1))return[yi];let r;return(r=t.findIndex(Xa))!==-1&&(t=t.filter((o,n)=>n===r||!Xa(o)&&!(Vn(o)&&typeof o.literal=="string"))),(r=t.findIndex(Pl))!==-1&&(t=t.filter((o,n)=>n===r||!Pl(o)&&!(Vn(o)&&typeof o.literal=="number"))),(r=t.findIndex(qT))!==-1&&(t=t.filter((o,n)=>n===r||!qT(o)&&!(Vn(o)&&typeof o.literal=="boolean"))),(r=t.findIndex(UT))!==-1&&(t=t.filter((o,n)=>n===r||!UT(o)&&!(Vn(o)&&typeof o.literal=="bigint"))),(r=t.findIndex(Zx))!==-1&&(t=t.filter((o,n)=>n===r||!Zx(o)&&!x1(o))),t},Hl=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return Hl(e.from)}};var Vr=(e,t=[])=>({value:e,forest:t}),ov=e=>v1(Vr("error(s) found",e.map(Ul))),v1=e=>e.value+nv(`
`,e.forest),nv=(e,t)=>{let r="",o=t.length,n;for(let s=0;s<o;s++){n=t[s];let i=s===o-1;r+=e+(i?"\u2514":"\u251C")+"\u2500 "+n.value,r+=nv(e+(o>1&&!i?"\u2502  ":"   "),n.forest)}return r},ic=e=>{if(e==null||typeof e=="number"||typeof e=="symbol"||e instanceof Date)return String(e);if(typeof e=="bigint")return String(e)+"n";try{return JSON.stringify(e)}catch{return String(e)}},I1=e=>{switch(e.type._tag){case"StringKeyword":return"${string}";case"NumberKeyword":return"${number}"}},k1=e=>e.head+e.spans.map(t=>I1(t)+t.literal).join(""),w1=ec(Nl),F1=ec(nt),P1=ec(xi),N1=ec(Yo),yr=e=>ne(P1(e),os(()=>F1(e)),os(()=>N1(e))),ql=e=>{switch(e._tag){case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"UndefinedKeyword":case"SymbolKeyword":case"ObjectKeyword":case"AnyKeyword":case"UnknownKeyword":case"VoidKeyword":case"NeverKeyword":return $(yr(e),()=>e._tag);case"Literal":return $(yr(e),()=>ic(e.literal));case"UniqueSymbol":return $(yr(e),()=>ic(e.symbol));case"Union":return e.types.map(ql).join(" or ");case"TemplateLiteral":return $(yr(e),()=>k1(e));case"Tuple":return $(yr(e),()=>"<anonymous tuple or array schema>");case"TypeLiteral":return $(yr(e),()=>"<anonymous type literal schema>");case"Enums":return $(yr(e),()=>e.enums.map((t,r)=>JSON.stringify(r)).join(" | "));case"Lazy":return $(yr(e),()=>"<anonymous lazy schema>");case"Declaration":return $(yr(e),()=>"<anonymous declaration schema>");case"Refinement":return $(yr(e),()=>"<anonymous refinement schema>");case"Transform":return $(yr(e),()=>`${ql(e.from)} -> ${ql(e.to)}`)}},Ul=e=>{switch(e._tag){case"Type":return Vr(ne(w1(e.expected),Me(t=>t(e.actual)),os(()=>e.message),$(()=>`Expected ${ql(e.expected)}, actual ${ic(e.actual)}`)));case"Forbidden":return Vr("is forbidden");case"Index":{let t=e.errors.map(Ul);return t.length===1&&t[0].forest.length!==0?Vr(`[${e.index}]${t[0].value}`,t[0].forest):Vr(`[${e.index}]`,t)}case"Unexpected":return Vr("is unexpected");case"Key":{let t=e.errors.map(Ul);return t.length===1&&t[0].forest.length!==0?Vr(`[${ic(e.key)}]${t[0].value}`,t[0].forest):Vr(`[${ic(e.key)}]`,t)}case"Missing":return Vr("is missing");case"UnionMember":return Vr("union member",e.errors.map(Ul))}};var iv=e=>{let t=st(e);return(r,o)=>t(r,{...o,isEffectAllowed:!0})};var og=e=>st(e.ast);var ng=e=>iv(e.ast);var sg=e=>iv(br(e.ast)),st=(e,t=!0)=>{switch(e._tag){case"Refinement":if(e.isReversed){let r=st(Pe(e),t),o=st(br(av(e.from)),!1);return(n,s)=>ac(di(r(n,s),i=>o(i,s)),s)}else{let r=st(e.from,t);return(o,n)=>ac(di(r(o,n),s=>e.decode(s,n)),n)}case"Transform":{let r=st(e.to,!1);if(t){let o=st(e.from);return(n,s)=>ac(di(o(n,s),i=>di(e.decode(i,s),c=>r(c,s))),s)}else return(o,n)=>ac(di(e.decode(o,n),s=>r(s,n)),n)}case"Declaration":{let r=e.decode(...e.typeParameters);return(o,n)=>ac(r(o,n),n)}case"Literal":return xt(e,r=>r===e.literal);case"UniqueSymbol":return xt(e,r=>r===e.symbol);case"UndefinedKeyword":return xt(e,Ai);case"VoidKeyword":return xt(e,Ai);case"NeverKeyword":return xt(e,Cg);case"UnknownKeyword":case"AnyKeyword":return Je;case"StringKeyword":return xt(e,Ri);case"NumberKeyword":return xt(e,Jo);case"BooleanKeyword":return xt(e,yc);case"BigIntKeyword":return xt(e,es);case"SymbolKeyword":return xt(e,Eg);case"ObjectKeyword":return xt(e,pe);case"Enums":return xt(e,r=>e.enums.some(([o,n])=>n===r));case"TemplateLiteral":{let r=H1(e);return xt(e,o=>Ri(o)&&r.test(o))}case"Tuple":{let r=e.elements.map(s=>st(s.type,t)),o=ne(e.rest,Me(ss(s=>st(s)))),n=e.elements.filter(s=>!s.isOptional).length;return N(e.rest)&&(n+=e.rest.value.length-1),(s,i)=>{if(!Array.isArray(s))return Zt(gr(L1,s));let c=i?.errors==="all",p=[],u=0,f=s.length;for(let R=f;R<=n-1;R++){let v=_o(R,[Fl]);if(c){p.push([u++,v]);continue}else return Zt(v)}if(j(e.rest))for(let R=e.elements.length;R<=f-1;R++){let v=_o(R,[Yx(s[R])]);if(c){p.push([u++,v]);continue}else return Ue(kt(We(p),v))}let m=[],y=0,b;for(;y<r.length;y++)if(f<y+1){if(e.elements[y].isOptional)continue}else{let R=r[y],v=R(s[y],i),w=$r(v);if(w){if(Ae(w)){let H=_o(y,w.left.errors);if(c){p.push([u++,H]);continue}else return Ue(kt(We(p),H))}m.push([u++,w.right])}else{let H=u++,U=y;b||(b=[]),b.push(({es:te,output:ge})=>It(Vo(v),Ie=>{if(Ae(Ie)){let ce=_o(U,Ie.left.errors);return c?(te.push([H,ce]),ht):Ue(kt(We(te),ce))}return ge.push([H,Ie.right]),ht}))}}if(N(o)){let R=_e(o.value),v=Lt(o.value);for(;y<f-v.length;y++){let w=R(s[y],i),H=$r(w);if(H)if(Ae(H)){let U=_o(y,H.left.errors);if(c){p.push([u++,U]);continue}else return Ue(kt(We(p),U))}else m.push([u++,H.right]);else{let U=u++,te=y;b||(b=[]),b.push(({es:ge,output:Ie})=>It(Vo(w),ce=>{if(Ae(ce)){let Er=_o(te,ce.left.errors);return c?(ge.push([U,Er]),ht):Ue(kt(We(ge),Er))}else return Ie.push([U,ce.right]),ht}))}}for(let w=0;w<v.length;w++)if(y+=w,!(f<y+1)){let H=v[w](s[y],i),U=$r(H);if(U){if(Ae(U)){let te=_o(y,U.left.errors);if(c){p.push([u++,te]);continue}else return Ue(kt(We(p),te))}m.push([u++,U.right])}else{let te=u++,ge=y;b||(b=[]),b.push(({es:Ie,output:ce})=>It(Vo(H),Er=>{if(Ae(Er)){let Yr=_o(ge,Er.left.errors);return c?(Ie.push([te,Yr]),ht):Ue(kt(We(Ie),Yr))}return ce.push([te,Er.right]),ht}))}}}let C=({es:R,output:v})=>vc(R)?Ue(We(R)):Je(We(v));if(b&&b.length>0){let R=b;return mi(()=>{let v={es:Array.from(p),output:Array.from(m)};return It(Va(R,w=>w(v),{concurrency:"unbounded",discard:!0}),()=>C(v))})}return C({output:m,es:p})}}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return xt(e,Rg);let r=e.propertySignatures.map(i=>st(i.type,t)),o=e.indexSignatures.map(i=>[st(i.parameter,t),st(i.type,t)]),n=st(Co(e.indexSignatures.map(i=>Hl(i.parameter)))),s={};for(let i=0;i<r.length;i++)s[e.propertySignatures[i].name]=null;return(i,c)=>{if(!Mi(i))return Zt(gr(sv,i));let p=c?.errors==="all",u=[],f=0;if(c?.onExcessProperty==="error"){for(let R of Qa(i))if(!Object.prototype.hasOwnProperty.call(s,R)){let v=n(R),w=$r(v);if(w&&Ae(w)){let H=Gr(R,[Yx(i[R])]);if(p){u.push([f++,H]);continue}else return Ue(kt(We(u),H))}}}let y={},b;for(let R=0;R<r.length;R++){let v=e.propertySignatures[R],w=r[R],H=v.name;if(Object.prototype.hasOwnProperty.call(i,H)){let U=w(i[H],c),te=$r(U);if(te){if(Ae(te)){let ge=Gr(H,te.left.errors);if(p){u.push([f++,ge]);continue}else return Ue(kt(We(u),ge))}y[H]=te.right}else{let ge=f++,Ie=H;b||(b=[]),b.push(({es:ce,output:Er})=>It(Vo(U),Yr=>{if(Ae(Yr)){let fc=Gr(Ie,Yr.left.errors);return p?(ce.push([ge,fc]),ht):Ue(kt(We(ce),fc))}return Er[Ie]=Yr.right,ht}))}}else if(!v.isOptional){let U=Gr(H,[Fl]);if(p){u.push([f++,U]);continue}else return Zt(U)}}for(let R=0;R<o.length;R++){let v=o[R][0],w=o[R][1],H=$x(i,e.indexSignatures[R].parameter);for(let U of H){if(Object.prototype.hasOwnProperty.call(s,U))continue;let te=$r(v(U,c));if(te&&Ae(te)){let ce=Gr(U,te.left.errors);if(p){u.push([f++,ce]);continue}else return Ue(kt(We(u),ce))}let ge=w(i[U],c),Ie=$r(ge);if(Ie)if(Ae(Ie)){let ce=Gr(U,Ie.left.errors);if(p){u.push([f++,ce]);continue}else return Ue(kt(We(u),ce))}else y[U]=Ie.right;else{let ce=f++,Er=U;b||(b=[]),b.push(({es:Yr,output:fc})=>It(Vo(ge),Yl=>{if(Ae(Yl)){let hg=Gr(Er,Yl.left.errors);return p?(Yr.push([ce,hg]),ht):Ue(kt(We(Yr),hg))}else return fc[U]=Yl.right,ht}))}}}let C=({es:R,output:v})=>vc(R)?Ue(We(R)):Je(v);if(b&&b.length>0){let R=b;return mi(()=>{let v={es:Array.from(u),output:Object.assign({},y)};return It(Va(R,w=>w(v),{concurrency:"unbounded",discard:!0}),()=>C(v))})}return C({es:u,output:y})}}case"Union":{let r=D1(e.types),o=Qa(r.keys),n=o.length,s=new Map;for(let i=0;i<e.types.length;i++)s.set(e.types[i],st(e.types[i],!0));return(i,c)=>{let p=[],u=0,f=[];if(n>0)if(Mi(i))for(let b=0;b<n;b++){let C=o[b],R=r.keys[C].buckets;if(Object.prototype.hasOwnProperty.call(i,C)){let v=String(i[C]);Object.prototype.hasOwnProperty.call(R,v)?f=f.concat(R[v]):p.push([u++,Gr(C,[gr(r.keys[C].ast,i[C])])])}else p.push([u++,Gr(C,[Fl])])}else p.push([u++,gr(sv,i)]);r.otherwise.length>0&&(f=f.concat(r.otherwise));let m;for(let b=0;b<f.length;b++){let C=s.get(f[b])(i,c),R=!m||m.length===0?$r(C):void 0;if(R){if(Or(R))return Je(R.right);p.push([u++,Jx(R.left.errors)])}else{let v=u++;m||(m=[]),m.push(w=>mi(()=>"finalResult"in w?ht:It(Vo(C),H=>(Or(H)?w.finalResult=Je(H.right):w.es.push([v,Jx(H.left.errors)]),ht))))}}let y=b=>vc(b)?Ue(We(b)):Zt(gr(tc,i));if(m&&m.length>0){let b=m;return mi(()=>{let C={es:Array.from(p)};return It(Va(b,R=>R(C),{concurrency:1,discard:!0}),()=>"finalResult"in C?C.finalResult:y(C.es))})}return y(p)}}case"Lazy":{let r=wl(()=>st(e.f(),t));return(o,n)=>r()(o,n)}}},xt=(e,t)=>r=>t(r)?Je(r):Zt(gr(e,r)),rg=e=>{switch(e._tag){case"Declaration":return rg(e.type);case"TypeLiteral":{let t=[];for(let r=0;r<e.propertySignatures.length;r++){let o=e.propertySignatures[r],n=Xt(o.type);Vn(n)&&!o.isOptional&&t.push([o.name,n])}return t}case"Refinement":case"Transform":return rg(e.from)}return[]},D1=e=>{let t={},r=[];for(let o=0;o<e.length;o++){let n=e[o],s=rg(n);if(s.length>0)for(let i=0;i<s.length;i++){let[c,p]=s[i],u=String(p.literal);t[c]=t[c]||{buckets:{},ast:tc};let f=t[c].buckets;if(Object.prototype.hasOwnProperty.call(f,u)){if(i<s.length-1)continue;f[u].push(n),t[c].ast=Co([t[c].ast,p])}else{f[u]=[n],t[c].ast=Co([t[c].ast,p]);break}}else r.push(n)}return{keys:t,otherwise:r}},av=e=>VT(e)?av(e.from):e,ac=(e,t)=>{let r=$r(e);return r||(t?.isEffectAllowed===!0?e:Zt(LT))},L1=Yn([],d([yi]),!0,{[Yo]:"a generic array"}),sv=Oo([],[bi(Dl,yi,!0),bi(eg,yi,!0)],{[Yo]:"a generic object"}),kt=(e,t)=>(e.push(t),e),H1=e=>{let t=`^${e.head}`;for(let r of e.spans)Xa(r.type)?t+=".*":Pl(r.type)&&(t+="-?\\d+(\\.\\d+)?"),t+=r.literal;return t+="$",new RegExp(t)};function We(e){return e.sort(([t],[r])=>t>r?1:t<r?-1:0).map(([t,r])=>r)}var br=e=>{switch(e._tag){case"Declaration":return gi(e.typeParameters.map(br),e.type,e.decode,e.annotations);case"Tuple":return Yn(e.elements.map(t=>rc(br(t.type),t.isOptional)),Me(e.rest,ss(br)),e.isReadonly);case"TypeLiteral":return Oo(e.propertySignatures.map(t=>Ne(t.name,br(t.type),t.isOptional,t.isReadonly,t.annotations)),e.indexSignatures.map(t=>bi(t.parameter,br(t.type),t.isReadonly)));case"Union":return Co(e.types.map(br));case"Lazy":return oc(()=>br(e.f()));case"Refinement":return nc(e.from,e.decode,!e.isReversed,e.annotations);case"Transform":return Ll(br(e.to),br(e.from),e.encode,e.decode,e.propertySignatureTransformations.map(t=>sc(t.to,t.from,t.encode,t.decode)))}return e};var K1=Symbol.for("@effect/schema/Schema");var ig=class{constructor(t){Ft(this,"ast");Ft(this,"_id",K1);Ft(this,"From");Ft(this,"To");this.ast=t}pipe(){return E(this,arguments)}},wt=e=>new ig(e);var B1=e=>wt(KT(e)),Wl=(...e)=>zl(...e.map(t=>B1(t)));var cv=(e,t,r,o)=>wt(gi(e.map(n=>n.ast),t.ast,(...n)=>r(...n.map(wt)),o)),zl=(...e)=>wt(Co(e.map(t=>t.ast)));var ag=e=>wt(Yn([],d([e.ast]),!0));var jl=class e{constructor(t,r,o){Ft(this,"_from");Ft(this,"_annotations");Ft(this,"_optional");Ft(this,"From");Ft(this,"FromIsOptional");Ft(this,"To");Ft(this,"ToIsOptional");this._from=t,this._annotations=r,this._optional=o}optional(){if(this._optional)throw new Error("duplicate optional configuration");return new e(this._from,this._annotations,{to:"optional"})}withDefault(t){if(this._optional&&this._optional.to!=="optional")throw new Error("duplicate optional configuration");return new e(this._from,this._annotations,{to:"default",value:t})}toOption(){if(this._optional&&this._optional.to!=="optional")throw new Error("duplicate optional configuration");return new e(this._from,this._annotations,{to:"Option"})}},G1=(e,t)=>new jl(e.ast,t),Qn=(e,t)=>G1(e,t).optional(),Jn=e=>{let t=Qa(e),r=[],o=[],n=[],s=[];for(let i=0;i<t.length;i++){let c=t[i],p=e[c];if(p instanceof jl){let u=p._optional;if(u)switch(u.to){case"optional":{r.push(Ne(c,p._from,!0,!0,p._annotations)),o.push(Ne(c,p._from,!0,!0)),n.push(Ne(c,Pe(p._from),!0,!0,p._annotations));break}case"default":{o.push(Ne(c,p._from,!0,!0)),n.push(Ne(c,Pe(p._from),!1,!0,p._annotations)),s.push(sc(c,c,os(()=>d(u.value())),F));break}case"Option":{o.push(Ne(c,p._from,!0,!0)),n.push(Ne(c,oU(wt(Pe(p._from))).ast,!1,!0,p._annotations)),s.push(sc(c,c,d,Wg));break}}else r.push(Ne(c,p._from,!1,!0,p._annotations)),o.push(Ne(c,p._from,!1,!0)),n.push(Ne(c,Pe(p._from),!1,!0,p._annotations))}else r.push(Ne(c,p.ast,!1,!0)),o.push(Ne(c,p.ast,!1,!0)),n.push(Ne(c,Pe(p.ast),!1,!0))}return s.length>0?wt(JT(Oo(o,[]),Oo(n,[]),s)):wt(Oo(r,[]))};var $1=e=>{let t={};if(e?.typeId!==void 0){let r=e?.typeId;typeof r=="object"?(t[Xx]=r.id,t[r.id]=r.params):t[Xx]=r}return e?.message!==void 0&&(t[Nl]=e?.message),e?.identifier!==void 0&&(t[xi]=e?.identifier),e?.title!==void 0&&(t[nt]=e?.title),e?.description!==void 0&&(t[Yo]=e?.description),e?.examples!==void 0&&(t[WT]=e?.examples),e?.documentation!==void 0&&(t[zT]=e?.documentation),e?.jsonSchema!==void 0&&(t[jT]=e?.jsonSchema),e?.arbitrary!==void 0&&(t[kl]=e?.arbitrary),t};function pv(e,t){return r=>{let o=s=>e(s)?Je(s):Zt(gr(n,s)),n=nc(r.ast,o,!1,$1(t));return wt(n)}}var V1=a(4,(e,t,r,o)=>wt(YT(e.ast,t.ast,r,o)));var cc=e=>t=>wt(QT(t.ast,Yo,e));var Zn=wt(Dl),cg=wt(GT);var Y1=()=>e=>e.date(),J1=()=>e=>`new Date(${JSON.stringify(e)})`,uv=cv([],Jn({}),()=>e=>bc(e)?Je(e):Zt(gr(uv.ast,e)),{[xi]:"Date",[Gx]:J1,[kl]:Y1}),Q1="@effect/schema/ValidDateTypeId",Z1=e=>t=>t.pipe(pv(r=>!isNaN(r.getTime()),{typeId:Q1,description:"a valid Date",...e})),X1=uv.pipe(Z1()),pg=e=>V1(e,X1,r=>Je(new Date(r)),r=>Je(r.toISOString()));var eU=e=>t=>t.oneof(t.constant(x()),e(t).map(d)),tU=e=>De({onNone:()=>"none()",onSome:t=>`some(${e(t)})`}),rU=e=>zl(Jn({_tag:Wl("None")}),Jn({_tag:Wl("Some"),value:e})),oU=e=>{let t=cv([e],rU(e),r=>{let o=og(r);return(n,s)=>qg(n)?j(n)?Je(x()):HT(o(n.value,s),d):Zt(gr(t.ast,n))},{[xi]:"Option",[Gx]:tU,[kl]:eU});return t};var nU="@effect/schema/MaxLengthTypeId",pc=(e,t)=>r=>r.pipe(pv(o=>o.length<=e,{typeId:nU,description:`a string at most ${e} character(s) long`,jsonSchema:{maxLength:e},...t}));var fv=_i(require("fs/promises")),mv=_i(require("@actions/glob"));var er=class extends vl.TaggedClass("GenericError"){};var iU=dt.string("INPUT_FILE").pipe(dt.map(e=>({_tag:"File",path:e})),dt.orElse(()=>dt.string("JSON").pipe(dt.map(e=>({_tag:"Json",stringified:e})))),dt.orElse(()=>ne(dt.all({key:dt.string("KEY"),value:dt.number("VALUE")}),dt.map(({key:e,value:t})=>({_tag:"KeyVal",key:e,value:t})))),dt.nested("INPUT")),hv=ne(oe.config(iU),oe.mapError(e=>new er({error:e,message:"Failed to read input"}))),dv=e=>oe.try({try:()=>JSON.parse(e),catch:t=>new er({message:"Failed to parse JSON",error:t})}),xv=Wl("lower-is-better","higher-is-better"),aU=Jn({key:ne(Zn,pc(120)),sortDate:ne(Zn,pg,Qn),value:cg,units:ne(Zn,pc(32),Qn),trend:ne(xv,Qn)}),r$=Jn({metrics:ne(aU,ag)}),lv=Jn({key:ne(Zn,pc(120),cc("a key to identify the metric across runs")),value:ne(cg,cc("the value of the metric")),sortDate:ne(Zn,pg,cc("the date to apply sorting by. defaults to the commit time"),Qn),units:ne(Zn,pc(32),cc("the units of the metric. example: ms, MiB"),Qn),trend:ne(xv,Qn)}),gv=zl(ne(lv,ag),lv),o$=sg(gv),yv=e=>ng(gv)(e).pipe(oe.map(t=>[t].flat()),oe.mapError(t=>new er({error:t,message:`Failed to parse given JSON:
${ov(t.errors)}`}))),cU=e=>oe.tryPromise({try:()=>fv.default.readFile(e,"utf-8"),catch:t=>new er({message:"Failed to read file",error:t})}).pipe(oe.flatMap(dv),oe.flatMap(yv)),pU=e=>oe.gen(function*(t){let r=yield*t(oe.tryPromise({try:()=>mv.create(e),catch:s=>new er({message:"Failed to parse glob syntax",error:s})})),o=yield*t(oe.tryPromise({try:()=>r.glob(),catch:s=>new er({message:"Failed to iterate through glob",error:s})}));return(yield*t(oe.all(o.map(cU),{concurrency:5}))).flat()}),bv=ne(Ja.type(),Ja.tagsExhaustive({File:({path:e})=>pU(e),Json:({stringified:e})=>dv(e).pipe(oe.flatMap(yv)),KeyVal:({key:e,value:t})=>oe.succeed([{key:e,value:t}])}));var Vl=require("@actions/core"),Hv=require("@actions/http-client");var Sv=e=>e;function Ev(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,o)}return r}function _v(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ev(Object(r),!0).forEach(function(o){uU(e,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ev(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))})}return e}function uU(e,t,r){return t=lU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function lU(e){var t=fU(e,"string");return typeof t=="symbol"?t:String(t)}function fU(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var o=r.call(e,t||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Ov=Cv({});function Cv(e){return t.withOptions=r=>Cv(_v(_v({},e),r)),t;function t(r,...o){let n=typeof r=="string"?[r]:r.raw,{escapeSpecialCharacters:s=Array.isArray(r)}=e,i="";for(let u=0;u<n.length;u++){let f=n[u];s&&(f=f.replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`").replace(/\\\$/g,"$").replace(/\\{/g,"{")),i+=f,u<o.length&&(i+=o[u])}let c=i.split(`
`),p=null;for(let u of c){let f=u.match(/^(\s+)\S+/);if(f){let m=f[1].length;p?p=Math.min(p,m):p=m}}if(p!==null){let u=p;i=c.map(f=>f[0]===" "||f[0]==="	"?f.slice(u):f).join(`
`)}return i.trim().replace(/\\n/g,`
`)}}var Rv=(e=0)=>t=>`\x1B[${t+e}m`,Av=(e=0)=>t=>`\x1B[${38+e};5;${t}m`,Mv=(e=0)=>(t,r,o)=>`\x1B[${38+e};2;${t};${r};${o}m`,ae={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}},a$=Object.keys(ae.modifier),mU=Object.keys(ae.color),hU=Object.keys(ae.bgColor),c$=[...mU,...hU];function dU(){let e=new Map;for(let[t,r]of Object.entries(ae)){for(let[o,n]of Object.entries(r))ae[o]={open:`\x1B[${n[0]}m`,close:`\x1B[${n[1]}m`},r[o]=ae[o],e.set(n[0],n[1]);Object.defineProperty(ae,t,{value:r,enumerable:!1})}return Object.defineProperty(ae,"codes",{value:e,enumerable:!1}),ae.color.close="\x1B[39m",ae.bgColor.close="\x1B[49m",ae.color.ansi=Rv(),ae.color.ansi256=Av(),ae.color.ansi16m=Mv(),ae.bgColor.ansi=Rv(10),ae.bgColor.ansi256=Av(10),ae.bgColor.ansi16m=Mv(10),Object.defineProperties(ae,{rgbToAnsi256:{value(t,r,o){return t===r&&r===o?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(o/255*5)},enumerable:!1},hexToRgb:{value(t){let r=/[a-f\d]{6}|[a-f\d]{3}/i.exec(t.toString(16));if(!r)return[0,0,0];let[o]=r;o.length===3&&(o=[...o].map(s=>s+s).join(""));let n=Number.parseInt(o,16);return[n>>16&255,n>>8&255,n&255]},enumerable:!1},hexToAnsi256:{value:t=>ae.rgbToAnsi256(...ae.hexToRgb(t)),enumerable:!1},ansi256ToAnsi:{value(t){if(t<8)return 30+t;if(t<16)return 90+(t-8);let r,o,n;if(t>=232)r=((t-232)*10+8)/255,o=r,n=r;else{t-=16;let c=t%36;r=Math.floor(t/36)/5,o=Math.floor(c/6)/5,n=c%6/5}let s=Math.max(r,o,n)*2;if(s===0)return 30;let i=30+(Math.round(n)<<2|Math.round(o)<<1|Math.round(r));return s===2&&(i+=60),i},enumerable:!1},rgbToAnsi:{value:(t,r,o)=>ae.ansi256ToAnsi(ae.rgbToAnsi256(t,r,o)),enumerable:!1},hexToAnsi:{value:t=>ae.ansi256ToAnsi(ae.hexToAnsi256(t)),enumerable:!1}}),ae}var xU=dU(),Sr=xU;var Bl=_i(require("process"),1),vv=_i(require("os"),1),ug=_i(require("tty"),1);function tr(e,t=globalThis.Deno?globalThis.Deno.args:Bl.default.argv){let r=e.startsWith("-")?"":e.length===1?"-":"--",o=t.indexOf(r+e),n=t.indexOf("--");return o!==-1&&(n===-1||o<n)}var{env:le}=Bl.default,Kl;tr("no-color")||tr("no-colors")||tr("color=false")||tr("color=never")?Kl=0:(tr("color")||tr("colors")||tr("color=true")||tr("color=always"))&&(Kl=1);function gU(){if("FORCE_COLOR"in le)return le.FORCE_COLOR==="true"?1:le.FORCE_COLOR==="false"?0:le.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(le.FORCE_COLOR,10),3)}function yU(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function bU(e,{streamIsTTY:t,sniffFlags:r=!0}={}){let o=gU();o!==void 0&&(Kl=o);let n=r?Kl:o;if(n===0)return 0;if(r){if(tr("color=16m")||tr("color=full")||tr("color=truecolor"))return 3;if(tr("color=256"))return 2}if("TF_BUILD"in le&&"AGENT_NAME"in le)return 1;if(e&&!t&&n===void 0)return 0;let s=n||0;if(le.TERM==="dumb")return s;if(Bl.default.platform==="win32"){let i=vv.default.release().split(".");return Number(i[0])>=10&&Number(i[2])>=10586?Number(i[2])>=14931?3:2:1}if("CI"in le)return"GITHUB_ACTIONS"in le||"GITEA_ACTIONS"in le?3:["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some(i=>i in le)||le.CI_NAME==="codeship"?1:s;if("TEAMCITY_VERSION"in le)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(le.TEAMCITY_VERSION)?1:0;if(le.COLORTERM==="truecolor"||le.TERM==="xterm-kitty")return 3;if("TERM_PROGRAM"in le){let i=Number.parseInt((le.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(le.TERM_PROGRAM){case"iTerm.app":return i>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(le.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(le.TERM)||"COLORTERM"in le?1:s}function Tv(e,t={}){let r=bU(e,{streamIsTTY:e&&e.isTTY,...t});return yU(r)}var SU={stdout:Tv({isTTY:ug.default.isatty(1)}),stderr:Tv({isTTY:ug.default.isatty(2)})},Iv=SU;function kv(e,t,r){let o=e.indexOf(t);if(o===-1)return e;let n=t.length,s=0,i="";do i+=e.slice(s,o)+t+r,s=o+n,o=e.indexOf(t,s);while(o!==-1);return i+=e.slice(s),i}function wv(e,t,r,o){let n=0,s="";do{let i=e[o-1]==="\r";s+=e.slice(n,i?o-1:o)+t+(i?`\r
`:`
`)+r,n=o+1,o=e.indexOf(`
`,n)}while(o!==-1);return s+=e.slice(n),s}var{stdout:Fv,stderr:Pv}=Iv,lg=Symbol("GENERATOR"),Si=Symbol("STYLER"),uc=Symbol("IS_EMPTY"),Nv=["ansi","ansi","ansi256","ansi16m"],Ei=Object.create(null),EU=(e,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");let r=Fv?Fv.level:0;e.level=t.level===void 0?r:t.level},Gl=class{constructor(t){return Dv(t)}},Dv=e=>{let t=(...r)=>r.join(" ");return EU(t,e),Object.setPrototypeOf(t,lc.prototype),t};function lc(e){return Dv(e)}Object.setPrototypeOf(lc.prototype,Function.prototype);for(let[e,t]of Object.entries(Sr))Ei[e]={get(){let r=$l(this,mg(t.open,t.close,this[Si]),this[uc]);return Object.defineProperty(this,e,{value:r}),r}};Ei.visible={get(){let e=$l(this,this[Si],!0);return Object.defineProperty(this,"visible",{value:e}),e}};var fg=(e,t,r,...o)=>e==="rgb"?t==="ansi16m"?Sr[r].ansi16m(...o):t==="ansi256"?Sr[r].ansi256(Sr.rgbToAnsi256(...o)):Sr[r].ansi(Sr.rgbToAnsi(...o)):e==="hex"?fg("rgb",t,r,...Sr.hexToRgb(...o)):Sr[r][e](...o),_U=["rgb","hex","ansi256"];for(let e of _U){Ei[e]={get(){let{level:r}=this;return function(...o){let n=mg(fg(e,Nv[r],"color",...o),Sr.color.close,this[Si]);return $l(this,n,this[uc])}}};let t="bg"+e[0].toUpperCase()+e.slice(1);Ei[t]={get(){let{level:r}=this;return function(...o){let n=mg(fg(e,Nv[r],"bgColor",...o),Sr.bgColor.close,this[Si]);return $l(this,n,this[uc])}}}}var OU=Object.defineProperties(()=>{},{...Ei,level:{enumerable:!0,get(){return this[lg].level},set(e){this[lg].level=e}}}),mg=(e,t,r)=>{let o,n;return r===void 0?(o=e,n=t):(o=r.openAll+e,n=t+r.closeAll),{open:e,close:t,openAll:o,closeAll:n,parent:r}},$l=(e,t,r)=>{let o=(...n)=>CU(o,n.length===1?""+n[0]:n.join(" "));return Object.setPrototypeOf(o,OU),o[lg]=e,o[Si]=t,o[uc]=r,o},CU=(e,t)=>{if(e.level<=0||!t)return e[uc]?"":t;let r=e[Si];if(r===void 0)return t;let{openAll:o,closeAll:n}=r;if(t.includes("\x1B"))for(;r!==void 0;)t=kv(t,r.close,r.open),r=r.parent;let s=t.indexOf(`
`);return s!==-1&&(t=wv(t,n,o,s)),o+t+n};Object.defineProperties(lc.prototype,Ei);var d$=lc(),x$=lc({level:Pv?Pv.level:0});var Lv=new Gl({level:2}),RU=Ov`
  Failed to read GitHub Actions ID token.

  This means you probably forgot to add permissions for \`id-token\` in your workflow/job definition.
  The \`id-token\` permissions allows GitHub to sign your requests to the Benchy API. This does not
  give GitHub access to your Benchy account: it's merely a way to prove that the request is coming
  from your GitHub workflow.

  An example of a workflow with the \`id-token\` permission:

  \`\`\`yaml
   jobs:
     test:
       runs-on: ubuntu-latest
  ${Lv.green("+    permissions:")}
  ${Lv.green("+      id-token: write")}
       steps:
         # ...
  \`\`\`

  For more information about the id-token permisison, see the [GitHub documentation](https://docs.github.com/en/actions/deployment/security-hardening-your-deployments/about-security-hardening-with-openid-connect#overview-of-openid-connect).
`,AU=oe.tryPromise({try:()=>(0,Vl.getIDToken)(),catch:e=>new er({message:RU,error:e})}),MU=oe.gen(function*(e){let t=yield*e(AU);return new Hv.HttpClient("bnz-action",[],{headers:{Authorization:`Bearer ${t}`}})}),TU=oe.gen(function*(e){let t=yield*e(hv),r=yield*e(bv(t)),o=yield*e(MU),n=yield*e(oe.tryPromise({try:()=>o.postJson("https://bnz-web.vercel.app/api/metrics",{metrics:r}),catch:s=>new er({message:"Failed to send metrics",error:s})}));console.log("received",n)});TU.pipe(oe.catchTag("GenericError",e=>((0,Vl.error)(e.message+`
`+String(e.error)),process.exitCode=1,oe.unit)),Sv,oe.runPromise);
