"use strict";var nI=Object.create;var yc=Object.defineProperty;var sI=Object.getOwnPropertyDescriptor;var iI=Object.getOwnPropertyNames;var aI=Object.getPrototypeOf,cI=Object.prototype.hasOwnProperty;var pI=(e,t,r)=>t in e?yc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var Ai=(e,t)=>{for(var r in t)yc(e,r,{get:t[r],enumerable:!0})},uI=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of iI(t))!cI.call(e,n)&&n!==r&&yc(e,n,{get:()=>t[n],enumerable:!(o=sI(t,n))||o.enumerable});return e};var Ti=(e,t,r)=>(r=e!=null?nI(aI(e)):{},uI(t||!e||!e.__esModule?yc(r,"default",{value:e,enumerable:!0}):r,e));var Nt=(e,t,r)=>(pI(e,typeof t!="symbol"?t+"":t,r),r);var Eg=e=>typeof e=="function",a=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):r=>t(r,...arguments)};switch(e){case 0:return t;case 1:return function(r){return arguments.length>=1?t(r):function(){return t(r)}};case 2:return function(r,o){return arguments.length>=2?t(r,o):function(n){return t(n,r)}};case 3:return function(r,o,n){return arguments.length>=3?t(r,o,n):function(s){return t(s,r,o)}};case 4:return function(r,o,n,s){return arguments.length>=4?t(r,o,n,s):function(i){return t(i,r,o,n)}};case 5:return function(r,o,n,s,i){return arguments.length>=5?t(r,o,n,s,i):function(c){return t(c,r,o,n,s)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(o){return t(o,...r)}}}};var F=e=>e;var Mi=e=>()=>e,Or=Mi(!0),Dt=Mi(!1);var bc=Mi(void 0),ts=bc;function ne(e,t,r,o,n,s,i,c,p){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return o(r(t(e)));case 5:return n(o(r(t(e))));case 6:return s(n(o(r(t(e)))));case 7:return i(s(n(o(r(t(e))))));case 8:return c(i(s(n(o(r(t(e)))))));case 9:return p(c(i(s(n(o(r(t(e))))))));default:{let u=arguments[0];for(let f=1;f<arguments.length;f++)u=arguments[f](u);return u}}}var Sc=e=>(t,r)=>t===r||e(t,r);var _g=a(2,(e,t)=>Sc((r,o)=>e(t(r),t(o))));var Og=e=>Sc((t,r)=>{if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(!e(t[o],r[o]))return!1;return!0});var Ec=e=>(t,r)=>t===r?0:e(t,r);var Cg=Ec((e,t)=>e<t?-1:1);var Rg=e=>Ec((t,r)=>e(r,t));var vi=a(2,(e,t)=>Ec((r,o)=>e(t(r),t(o))));var lI=e=>Ec((t,r)=>{let o=Math.min(t.length,r.length),n=0;for(let s of e){if(n>=o)break;let i=s(t[n],r[n]);if(i!==0)return i;n++}return 0});var Ag=(...e)=>lI(e);var tf=e=>a(2,(t,r)=>e(t,r)===1);var rf=e=>a(2,(t,r)=>t===r||e(t,r)>-1?t:r);var Ii=e=>typeof e=="string",Zo=e=>typeof e=="number",_c=e=>typeof e=="boolean",rs=e=>typeof e=="bigint",Tg=e=>typeof e=="symbol",Mg=Eg,ki=e=>e===void 0;var vg=e=>e===null;var Ig=e=>!1;var pe=e=>typeof e=="object"&&e!=null||Mg(e);var Xo=e=>e==null,kg=e=>e!=null;var Oc=e=>e instanceof Date,Lt=e=>pe(e)&&Symbol.iterator in e,wi=e=>pe(e)&&!Array.isArray(e);var wg=e=>!e;var mI=335903614,hI=4150755663,dI=1481765933,xI=1284865837,gI=9007199254740992,yI=134217728,os=class{constructor(t,r,o,n){return Xo(r)&&Xo(t)?(r=Math.random()*4294967295>>>0,t=0):Xo(r)&&(r=t,t=0),Xo(n)&&Xo(o)?(n=this._state?this._state[3]:hI,o=this._state?this._state[2]:mI):Xo(n)&&(n=o,o=0),this._state=new Int32Array([0,0,o>>>0,((n||0)|1)>>>0]),this._next(),Fg(this._state,this._state[0],this._state[1],t>>>0,r>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){if(!t)return this._next();if(t=t>>>0,!(t&t-1))return this._next()&t-1;let r=0,o=(-t>>>0)%t>>>0;for(r=this._next();r<o;r=this._next());return r%t}number(){let t=(this._next()&67108863)*1,r=(this._next()&134217727)*1;return(t*yI+r)/gI}_next(){let t=this._state[0]>>>0,r=this._state[1]>>>0;bI(this._state,t,r,dI,xI),Fg(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let o=t>>>18,n=(r>>>18|t<<14)>>>0;o=(o^t)>>>0,n=(n^r)>>>0;let s=(n>>>27|o<<5)>>>0,i=t>>>27,c=(-i>>>0&31)>>>0;return(s>>>i|s<<c)>>>0}};function bI(e,t,r,o,n){let s=(r>>>16)*(n&65535)>>>0,i=(r&65535)*(n>>>16)>>>0,c=(r&65535)*(n&65535)>>>0,p=(r>>>16)*(n>>>16)+((i>>>16)+(s>>>16))>>>0;i=i<<16>>>0,c=c+i>>>0,c>>>0<i>>>0&&(p=p+1>>>0),s=s<<16>>>0,c=c+s>>>0,c>>>0<s>>>0&&(p=p+1>>>0),p=p+Math.imul(r,o)>>>0,p=p+Math.imul(t,n)>>>0,e[0]=p,e[1]=c}function Fg(e,t,r,o,n){let s=t+o>>>0,i=r+n>>>0;i>>>0<r>>>0&&(s=s+1|0),e[0]=s,e[1]=i}var sf=Symbol.for("@effect/data/Global/globalStoreId");sf in globalThis||(globalThis[sf]=new Map);var nf=globalThis[sf],K=(e,t)=>(nf.has(e)||nf.set(e,t()),nf.get(e));var af=K(Symbol.for("@effect/data/Hash/randomHashCache"),()=>new WeakMap),_I=K(Symbol.for("@effect/data/Hash/pcgr"),()=>new os),A=Symbol.for("@effect/data/Hash"),S=e=>{switch(typeof e){case"number":return Rc(e);case"bigint":return we(e.toString(10));case"boolean":return we(String(e));case"symbol":return we(String(e));case"string":return we(e);case"undefined":return we("undefined");case"function":case"object":return e===null?we("null"):OI(e)?e[A]():To(e);default:throw new Error("Bug in Equal.hash")}},To=e=>(af.has(e)||af.set(e,Rc(_I.integer(Number.MAX_SAFE_INTEGER))),af.get(e)),I=e=>t=>t*53^e,Cc=e=>e&3221225471|e>>>1&1073741824,OI=e=>typeof e=="object"&&e!==null&&A in e,Rc=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return Cc(e)},we=e=>{let t=5381,r=e.length;for(;r;)t=t*33^e.charCodeAt(--r);return Cc(t)},CI=(e,t)=>{let r=12289;for(let o=0;o<t.length;o++)r^=I(S(e[t[o]]))(we(t[o]));return Cc(r)},Pi=e=>CI(e,Object.keys(e)),eo=e=>{let t=6151;for(let r=0;r<e.length;r++)t=I(S(e[r]))(t);return Cc(t)};var T=Symbol.for("@effect/data/Equal");function O(){return arguments.length===1?e=>Pg(e,arguments[0]):Pg(arguments[0],arguments[1])}function Pg(e,t){if(e===t)return!0;let r=typeof e;return r!==typeof t?!1:(r==="object"||r==="function")&&e!==null&&t!==null&&ns(e)&&ns(t)?S(e)===S(t)&&e[T](t):!1}var ns=e=>typeof e=="object"&&e!==null&&T in e,Ac=()=>(e,t)=>S(e)===S(t)&&O(e,t);var Mo=Symbol.for("@effect/io/Effect"),vo={_R:e=>e,_E:e=>e,_A:e=>e};var E=(e,t)=>{switch(t.length){case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let o=0,n=t.length;o<n;o++)r=t[o](r);return r}}};var Ng,Dg,Tc=Symbol.for("@effect/data/Option"),cf=class{[(Ng=Mo,T)](t){return Lg(t)&&lf(t)&&O(t.i0,this.i0)}[A](){return S(this.i0)}toString(){return`Some(${String(this.i0)})`}toJSON(){return{_tag:this._tag,value:this.i0}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}get[Tc](){return{_A:t=>t}}get value(){return this.i0}constructor(t){this.i0=t,this._tag="Some",this._id=Tc,this.i1=void 0,this.i2=void 0,this[Ng]=vo}pipe(){return E(this,arguments)}},pf=class{constructor(){this._tag="None",this._id=Tc,this.i0=void 0,this.i1=void 0,this.i2=void 0,this[Dg]=vo}[(Dg=Mo,T)](t){return Lg(t)&&uf(t)}[A](){return S(this._tag)}toString(){return"None()"}toJSON(){return{_tag:this._tag}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}get[Tc](){return{_A:t=>t}}pipe(){return E(this,arguments)}},Lg=e=>typeof e=="object"&&e!=null&&"_tag"in e&&(e._tag==="None"||e._tag==="Some")&&ns(e),uf=e=>e._tag==="None",lf=e=>e._tag==="Some",Hg=new pf,qg=e=>new cf(e);var Ug,Wg,Mc=Symbol.for("@effect/data/Either"),ff=class{[(Ug=Mo,T)](t){return jg(t)&&df(t)&&O(t.i0,this.i0)}[A](){return S(this.i0)}get right(){return this.i0}constructor(t){this.i0=t,this._tag="Right",this._id=Mc,this.i1=void 0,this.i2=void 0,this[Ug]=vo}get[Mc](){return{_E:t=>t,_A:t=>t}}toString(){return`right(${String(this.i0)})`}toJSON(){return{_tag:this._tag,right:this.i0}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},mf=class{[(Wg=Mo,T)](t){return jg(t)&&hf(t)&&O(t.i0,this.i0)}[A](){return S(this.i0)}get[Mc](){return{_E:t=>t,_A:t=>t}}get left(){return this.i0}constructor(t){this.i0=t,this._tag="Left",this._id=Mc,this.i1=void 0,this.i2=void 0,this[Wg]=vo}toString(){return`left(${String(this.i0)})`}toJSON(){return{_tag:this._tag,left:this.i0}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},jg=e=>typeof e=="object"&&e!=null&&"_tag"in e&&(e._tag==="Left"||e._tag==="Right")&&ns(e),hf=e=>e._tag==="Left",df=e=>e._tag==="Right",zg=e=>new mf(e),Kg=e=>new ff(e);var MI=Symbol.for("@effect/data/Either"),P=Kg,U=zg;var vc=e=>pe(e)&&"_id"in e&&e._id===MI,Ae=hf,Cr=df;var Ic=a(2,(e,{onLeft:t,onRight:r})=>Ae(e)?t(e.left):r(e.right)),kc=Ic({onLeft:F,onRight:F});var St=Cg;var wI=Symbol.for("@effect/data/Option"),x=()=>Hg,d=qg,Bg=e=>pe(e)&&"_id"in e&&e._id===wI,z=uf,N=lf,De=a(2,(e,{onNone:t,onSome:r})=>z(e)?t():r(e.value));var V=a(2,(e,t)=>z(e)?t():e.value),ss=a(2,(e,t)=>z(e)?t():e);var Ht=e=>e==null?x():d(e);var je=V(bc);var FI=a(2,(e,t)=>{if(N(e))return e.value;throw t()}),Gg=FI(()=>new Error("getOrThrow called on a None")),Te=a(2,(e,t)=>z(e)?x():d(t(e.value)));var is=a(2,(e,t)=>z(e)?x():t(e.value));var $g=is(F);var PI=e=>a(2,(t,r)=>z(t)?!1:e(t.value,r)),NI=Ac(),Vg=PI(NI);var xf=e=>e.length>0;var gf=(e,t)=>{let r=Math.max(1,Math.floor(e)),o=[t(0)];for(let n=1;n<r;n++)o.push(t(n));return o};var Q=e=>Array.isArray(e)?e:Array.from(e);var rr=a(2,(e,t)=>[t,...e]);var Yg=a(2,(e,t)=>[...e,t]);var LI=e=>e.length===0,yf=LI,Fc=xf,Rr=xf;var Jg=(e,t)=>e<0||e>=t.length;var HI=a(2,(e,t)=>{let r=Math.floor(t);return Jg(r,e)?x():d(e[r])}),bf=a(2,(e,t)=>{let r=Math.floor(t);if(Jg(r,e))throw new Error(`Index ${r} out of bounds`);return e[r]});var Pc=HI(0),_e=bf(0),Qg=e=>Rr(e)?d(qI(e)):x(),qI=e=>e[e.length-1];var qt=e=>e.slice(1);var Sf=e=>Array.from(e).reverse();var en=a(2,(e,t)=>{let r=Array.from(e);return r.sort(t),r});var Ef=a(2,(e,t)=>Zg(e,t,(r,o)=>[r,o])),Zg=a(3,(e,t,r)=>{let o=Q(e),n=Q(t);return Rr(o)&&Rr(n)?UI(n,r)(o):[]});var UI=a(3,(e,t,r)=>{let o=[r(_e(e),_e(t))],n=Math.min(e.length,t.length);for(let s=1;s<n;s++)o[s]=r(e[s],t[s]);return o});var WI=a(2,(e,t)=>{let r=[_e(e)],o=qt(e);for(let n of o)r.every(s=>!t(n,s))&&r.push(n);return r});var tn=()=>[],Et=e=>[e],to=a(2,(e,t)=>e.map(t)),as=to,Nc=a(2,(e,t)=>{if(yf(e))return[];let r=[];for(let o=0;o<e.length;o++)r.push(...t(e[o],o));return r});var Dc=Nc(F);var Ni=a(2,(e,t)=>{let r=Q(e),o=[];for(let n=0;n<r.length;n++){let s=t(r[n],n);N(s)&&o.push(s.value)}return o});var Xg=Ni(F);var at=a(3,(e,t,r)=>Q(e).reduce((o,n,s)=>r(o,n,s),t)),Lc=a(3,(e,t,r)=>Q(e).reduceRight((o,n,s)=>r(o,n,s),t));var _f=(e,t)=>{let r=[],o=e,n;for(;N(n=t(o));){let[s,i]=n.value;r.push(s),o=i}return r};var ey=Og;var jI=a(2,(e,t)=>{let r=Q(e);return Rr(r)?WI(t)(r):[]}),ty=jI(Ac());var ro=a(2,(e,t)=>Q(e).join(t));var ry,Of=Symbol.for("@effect/data/Context/Tag"),Hc=class{[(ry=Mo,T)](t){return this===t}[A](){return To(this)}get[Of](){return{_S:t=>t,_I:t=>t}}constructor(t){this._tag="Tag",this.i0=void 0,this.i1=void 0,this.i2=void 0,this[ry]=vo;let r=Error.stackTraceLimit;if(Error.stackTraceLimit=3,this.creationError=new Error,Error.stackTraceLimit=r,typeof t<"u")return this.i0=t,K(t,()=>this)}get stack(){return this.creationError.stack}toString(){return JSON.stringify(this)}toJSON(){return{_tag:"Tag",identifier:this.i0,stack:this.stack}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}of(t){return t}context(t){return Af(this,t)}},Cf=Symbol.for("@effect/data/Context"),or=class{[T](t){if(Rf(t)&&this.unsafeMap.size===t.unsafeMap.size){for(let r of this.unsafeMap.keys())if(!t.unsafeMap.has(r)||!O(this.unsafeMap.get(r),t.unsafeMap.get(r)))return!1;return!0}return!1}[A](){return Rc(this.unsafeMap.size)}constructor(t){this.unsafeMap=t,this._id=Cf,this._S=r=>r}pipe(){return E(this,arguments)}},zI=e=>{let t=new Error(`Service not found${e.i0?`: ${String(e.i0)}`:""}`);if(e.stack){let r=e.stack.split(`
`);if(r.length>2){let o=r[3].match(/at (.*)/);o&&(t.message=t.message+` (defined at ${o[1]})`)}}if(t.stack){let r=t.stack.split(`
`);r.splice(1,3),t.stack=r.join(`
`)}return t},Rf=e=>typeof e=="object"&&e!==null&&"_id"in e&&e._id===Cf,oy=e=>typeof e=="object"&&e!==null&&Of in e,ny=()=>new or(new Map),Af=(e,t)=>new or(new Map([[e,t]])),sy=a(3,(e,t,r)=>{let o=new Map(e.unsafeMap);return o.set(t,r),new or(o)}),Tf=a(2,(e,t)=>{if(!e.unsafeMap.has(t))throw zI(t);return e.unsafeMap.get(t)}),iy=Tf,ay=a(2,(e,t)=>e.unsafeMap.has(t)?d(e.unsafeMap.get(t)):x()),cy=a(2,(e,t)=>{let r=new Map(e.unsafeMap);for(let[o,n]of t.unsafeMap)r.set(o,n);return new or(r)}),py=(...e)=>t=>{let r=new Set(e),o=new Map;for(let[n,s]of t.unsafeMap.entries())r.has(n)&&o.set(n,s);return new or(o)},uy=(...e)=>t=>{let r=new Map(t.unsafeMap);for(let o of e)r.delete(o);return new or(r)};var ct=e=>new Hc(e);var BI=Rf,ly=oy,_t=ny,qc=Af,Me=sy,Ar=iy,cs=Tf,Mf=ay,rn=cy,GI=py,$I=uy;var VI=(()=>{let e={[A](){return eo(this)},[T](t){return Array.isArray(t)&&this.length===t.length?this.every((r,o)=>O(r,t[o])):!1}};return Object.setPrototypeOf(e,Array.prototype)})(),YI=(()=>{let e={[A](){return Pi(this)},[T](t){let r=Object.keys(this),o=Object.keys(t);if(r.length!==o.length)return!1;for(let n of r)if(!(n in t&&O(this[n],t[n])))return!1;return!0}};return Object.setPrototypeOf(e,Object.prototype)})(),oo=e=>fy(Object.assign({},e)),fy=e=>Object.setPrototypeOf(e,YI),JI=(...e)=>vf(e),QI=e=>vf(e.slice(0)),vf=e=>Object.setPrototypeOf(e,VI),ZI=()=>e=>oo(e===void 0?{}:e);var my=e=>t=>oo(t===void 0?{_tag:e}:{...t,_tag:e}),XI=e=>{class t extends hy{constructor(){super(...arguments),this._tag=e}}return t},hy=(()=>{class e{constructor(r){r&&Object.assign(this,r)}[A](){return Pi(this)}[T](r){let o=Object.keys(this),n=Object.keys(r);if(o.length!==n.length)return!1;for(let s of o)if(!(s in r&&O(this[s],r[s])))return!1;return!0}}return e})(),ek=()=>my;var yy=Symbol.for("@effect/data/Duration"),rk=BigInt(1e3),dy=BigInt(1e9),xy=/^(-?\d+(?:\.\d+)?)\s+(nanos|micros|millis|seconds|minutes|hours|days|weeks)$/,ze=e=>{if(by(e))return e;if(Zo(e))return ps(e);if(rs(e))return Uc(e);{xy.lastIndex=0;let t=xy.exec(e);if(t){let[r,o,n]=t,s=Number(o);switch(n){case"nanos":return Uc(BigInt(o));case"micros":return nk(BigInt(o));case"millis":return ps(s);case"seconds":return kf(s);case"minutes":return sk(s);case"hours":return ik(s);case"days":return ak(s);case"weeks":return ck(s)}}}throw new Error("Invalid duration input")},gy={_tag:"Millis",millis:0},ok={_tag:"Infinity"},nr=class{constructor(t){this._id=yy,Zo(t)?isNaN(t)||t<0?this.value=gy:Number.isFinite(t)?Number.isInteger(t)?this.value={_tag:"Millis",millis:t}:this.value={_tag:"Nanos",nanos:BigInt(Math.round(t*1e6))}:this.value=ok:t<BigInt(0)?this.value=gy:this.value={_tag:"Nanos",nanos:t}}[A](){return Pi(this.value)}[T](t){return by(t)&&lk(this,t)}toString(){switch(this.value._tag){case"Millis":return`Duration("${this.value.millis} millis")`;case"Nanos":return`Duration("${this.value.nanos} nanos")`;case"Infinity":return"Duration(Infinity)"}}toJSON(){return this.value._tag==="Nanos"?{_tag:"Duration",value:{_tag:"Nanos",hrtime:pk(this)}}:{_tag:"Duration",value:this.value}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},by=e=>pe(e)&&"_id"in e&&e._id===yy,If=new nr(0);var Uc=e=>new nr(e),nk=e=>new nr(e*rk),ps=e=>new nr(e),kf=e=>new nr(e*1e3),sk=e=>new nr(e*6e4),ik=e=>new nr(e*36e5),ak=e=>new nr(e*864e5),ck=e=>new nr(e*6048e5),Tr=e=>{let t=ze(e);switch(t.value._tag){case"Infinity":return 1/0;case"Nanos":return Number(t.value.nanos)/1e6;case"Millis":return t.value.millis}};var pk=e=>{let t=ze(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/dy),Number(t.value.nanos%dy)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}};var Sy=a(3,(e,t,r)=>{let o=ze(e),n=ze(t);if(o.value._tag==="Infinity"||n.value._tag==="Infinity")return r.onMillis(Tr(o),Tr(n));if(o.value._tag==="Nanos"||n.value._tag==="Nanos"){let s=o.value._tag==="Nanos"?o.value.nanos:BigInt(Math.round(o.value.millis*1e6)),i=n.value._tag==="Nanos"?n.value.nanos:BigInt(Math.round(n.value.millis*1e6));return r.onNanos(s,i)}return r.onMillis(o.value.millis,n.value.millis)});var uk=(e,t)=>Sy(e,t,{onMillis:(r,o)=>r===o,onNanos:(r,o)=>r===o});var wf=a(2,(e,t)=>Sy(e,t,{onMillis:(r,o)=>r>=o,onNanos:(r,o)=>r>=o})),lk=a(2,(e,t)=>uk(ze(e),ze(t)));var Ff=Math.pow(2,5),Ey=Ff-1,_y=Ff/2,Oy=Ff/4;function fk(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Io(e,t){return t>>>e&Ey}function ko(e){return 1<<e}function Wc(e,t){return fk(e&t-1)}function nn(e,t,r,o){let n=o;if(!e){let s=o.length;n=new Array(s);for(let i=0;i<s;++i)n[i]=o[i]}return n[t]=r,n}function Pf(e,t,r){let o=r.length-1,n=0,s=0,i=r;if(e)n=s=t;else for(i=new Array(o);n<t;)i[s++]=r[n++];for(++n;n<=o;)i[s++]=r[n++];return e&&(i.length=o),i}function Cy(e,t,r,o){let n=o.length;if(e){let p=n;for(;p>=t;)o[p--]=o[p];return o[t]=r,o}let s=0,i=0,c=new Array(n+1);for(;s<t;)c[i++]=o[s++];for(c[t]=r;s<n;)c[++i]=o[s++];return c}var jc=class{constructor(t,r){this.value=t,this.previous=r}};var Mr=class e{constructor(){this._tag="EmptyNode"}modify(t,r,o,n,s,i){let c=o(x());return z(c)?new e:(++i.value,new us(t,n,s,c))}};function Ut(e){return e instanceof Mr}function mk(e){return Ut(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function zc(e,t){return Ut(e)?!1:t===e.edit}var us=class e{constructor(t,r,o,n){this.edit=t,this.hash=r,this.key=o,this.value=n,this._tag="LeafNode"}modify(t,r,o,n,s,i){if(O(s,this.key)){let p=o(this.value);return p===this.value?this:z(p)?(--i.value,new Mr):zc(this,t)?(this.value=p,this):new e(t,n,s,p)}let c=o(x());return z(c)?this:(++i.value,Ry(t,r,this.hash,this,n,new e(t,n,s,c)))}},Nf=class e{constructor(t,r,o){this.edit=t,this.hash=r,this.children=o,this._tag="CollisionNode"}modify(t,r,o,n,s,i){if(n===this.hash){let p=zc(this,t),u=this.updateCollisionList(p,t,this.hash,this.children,o,s,i);return u===this.children?this:u.length>1?new e(t,this.hash,u):u[0]}let c=o(x());return z(c)?this:(++i.value,Ry(t,r,this.hash,this,n,new us(t,n,s,c)))}updateCollisionList(t,r,o,n,s,i,c){let p=n.length;for(let f=0;f<p;++f){let m=n[f];if("key"in m&&O(i,m.key)){let y=m.value,b=s(y);return b===y?n:z(b)?(--c.value,Pf(t,f,n)):nn(t,f,new us(r,o,i,b),n)}}let u=s(x());return z(u)?n:(++c.value,nn(t,p,new us(r,o,i,u),n))}},Di=class e{constructor(t,r,o){this.edit=t,this.mask=r,this.children=o,this._tag="IndexedNode"}modify(t,r,o,n,s,i){let c=this.mask,p=this.children,u=Io(r,n),f=ko(u),m=Wc(c,f),y=c&f,b=zc(this,t);if(!y){let q=new Mr().modify(t,r+5,o,n,s,i);return q?p.length>=_y?dk(t,u,q,c,p):new e(t,c|f,Cy(b,m,q,p)):this}let C=p[m],R=C.modify(t,r+5,o,n,s,i);if(C===R)return this;let v=c,w;if(Ut(R)){if(v&=~f,!v)return new Mr;if(p.length<=2&&mk(p[m^1]))return p[m^1];w=Pf(b,m,p)}else w=nn(b,m,R,p);return b?(this.mask=v,this.children=w,this):new e(t,v,w)}},Df=class e{constructor(t,r,o){this.edit=t,this.size=r,this.children=o,this._tag="ArrayNode"}modify(t,r,o,n,s,i){let c=this.size,p=this.children,u=Io(r,n),f=p[u],m=(f||new Mr).modify(t,r+5,o,n,s,i);if(f===m)return this;let y=zc(this,t),b;if(Ut(f)&&!Ut(m))++c,b=nn(y,u,m,p);else if(!Ut(f)&&Ut(m)){if(--c,c<=Oy)return hk(t,c,u,p);b=nn(y,u,new Mr,p)}else b=nn(y,u,m,p);return y?(this.size=c,this.children=b,this):new e(t,c,b)}};function hk(e,t,r,o){let n=new Array(t-1),s=0,i=0;for(let c=0,p=o.length;c<p;++c)if(c!==r){let u=o[c];u&&!Ut(u)&&(n[s++]=u,i|=1<<c)}return new Di(e,i,n)}function dk(e,t,r,o,n){let s=[],i=o,c=0;for(let p=0;i;++p)i&1&&(s[p]=n[c++]),i>>>=1;return s[t]=r,new Df(e,c+1,s)}function xk(e,t,r,o,n,s){if(r===n)return new Nf(e,r,[s,o]);let i=Io(t,r),c=Io(t,n);if(i===c)return p=>new Di(e,ko(i)|ko(c),[p]);{let p=i<c?[o,s]:[s,o];return new Di(e,ko(i)|ko(c),p)}}function Ry(e,t,r,o,n,s){let i,c=t;for(;;){let p=xk(e,c,r,o,n,s);if(typeof p=="function")i=new jc(p,i),c=c+5;else{let u=p;for(;i!=null;)u=i.value(u),i=i.previous;return u}}}var Lf=Symbol.for("@effect/data/HashMap"),Li=class{constructor(t,r,o,n){this._editable=t,this._edit=r,this._root=o,this._size=n,this._id=Lf}[Symbol.iterator](){return new Kc(this,(t,r)=>[t,r])}[A](){let t=S("HashMap");for(let r of this)t^=I(S(r[0]))(S(r[1]));return t}[T](t){if(vy(t)){if(t._size!==this._size)return!1;for(let r of this){let o=Gc(r[0],S(r[0]))(t);if(z(o))return!1;if(!O(r[1],o.value))return!1}return!0}return!1}toString(){return`HashMap(${Array.from(this).map(([t,r])=>`[${String(t)}, ${String(r)}]`).join(", ")})`}toJSON(){return{_tag:"HashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},Kc=class e{constructor(t,r){this.map=t,this.f=r,this.v=Ay(this.map._root,this.f,void 0)}next(){if(z(this.v))return{done:!0,value:void 0};let t=this.v.value;return this.v=Bc(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new e(this.map,this.f)}},Bc=e=>e?Ty(e[0],e[1],e[2],e[3],e[4]):x(),Ay=(e,t,r=void 0)=>{switch(e._tag){case"LeafNode":return N(e.value)?d({value:t(e.key,e.value.value),cont:r}):Bc(r);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let o=e.children;return Ty(o.length,o,0,t,r)}default:return Bc(r)}},Ty=(e,t,r,o,n)=>{for(;r<e;){let s=t[r++];if(s&&!Ut(s))return Ay(s,o,[e,t,r,o,n])}return Bc(n)},fs=()=>new Li(!1,0,new Mr,0),My=(...e)=>Hf(e),Hf=e=>{let t=Vc(fs());for(let r of e)sn(r[0],r[1])(t);return wy(t)},vy=e=>pe(e)&&"_id"in e&&e._id===Lf,Iy=e=>e&&Ut(e._root),ky=a(2,(e,t)=>Gc(e,t,S(t))),Gc=a(3,(e,t,r)=>{let o=e._root,n=0;for(;;)switch(o._tag){case"LeafNode":return O(t,o.key)?o.value:x();case"CollisionNode":{if(r===o.hash){let s=o.children;for(let i=0,c=s.length;i<c;++i){let p=s[i];if("key"in p&&O(t,p.key))return p.value}}return x()}case"IndexedNode":{let s=Io(n,r),i=ko(s);if(o.mask&i){o=o.children[Wc(o.mask,i)],n+=5;break}return x()}case"ArrayNode":{if(o=o.children[Io(n,r)],o){n+=5;break}return x()}default:return x()}});var qf=a(2,(e,t)=>N(Gc(e,t,S(t))));var sn=a(3,(e,t,r)=>Uf(e,t,()=>d(r))),yk=a(3,(e,t,r)=>e._editable?(e._root=t,e._size=r,e):t===e._root?e:new Li(e._editable,e._edit,t,r)),$c=e=>new Kc(e,t=>t);var ms=e=>e._size,Vc=e=>new Li(!0,e._edit+1,e._root,e._size),wy=e=>(e._editable=!1,e);var Uf=a(3,(e,t,r)=>Fy(e,t,S(t),r)),Fy=a(4,(e,t,r,o)=>{let n={value:e._size},s=e._root.modify(e._editable?e._edit:NaN,0,o,r,t,n);return yk(s,n.value)(e)});var Hi=a(2,(e,t)=>Uf(e,t,x));var Py=a(2,(e,t)=>hs(e,fs(),(r,o,n)=>sn(r,n,t(o,n))));var Yc=a(2,(e,t)=>hs(e,void 0,(r,o,n)=>t(o,n))),hs=a(3,(e,t,r)=>{let o=e._root;if(o._tag==="LeafNode")return N(o.value)?r(t,o.value.value,o.key):t;if(o._tag==="EmptyNode")return t;let n=[o.children],s;for(;s=n.pop();)for(let i=0,c=s.length;i<c;){let p=s[i++];p&&!Ut(p)&&(p._tag==="LeafNode"?N(p.value)&&(t=r(t,p.value.value,p.key)):n.push(p.children))}return t});var Wf=Symbol.for("@effect/data/HashSet"),ds=class{constructor(t){this._keyMap=t,this._id=Wf}[Symbol.iterator](){return $c(this._keyMap)}[A](){return I(S(this._keyMap))(S("HashSet"))}[T](t){return Dy(t)?ms(this._keyMap)===ms(t._keyMap)&&O(this._keyMap,t._keyMap):!1}toString(){return`HashSet(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"HashSet",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},Dy=e=>pe(e)&&"_id"in e&&e._id===Wf,qi=()=>new ds(fs()),Ly=e=>{let t=Jc(qi());for(let r of e)xs(t,r);return Qc(t)},Hy=(...e)=>{let t=Jc(qi());for(let r of e)xs(t,r);return Qc(t)},qy=a(2,(e,t)=>qf(e._keyMap,t));var Uy=e=>ms(e._keyMap),Jc=e=>new ds(Vc(e._keyMap)),Qc=e=>(e._keyMap._editable=!1,e),jf=a(2,(e,t)=>{let r=Jc(e);return t(r),Qc(r)}),xs=a(2,(e,t)=>e._keyMap._editable?(sn(t,!0)(e._keyMap),e):new ds(sn(t,!0)(e._keyMap))),zf=a(2,(e,t)=>e._keyMap._editable?(Hi(t)(e._keyMap),e):new ds(Hi(t)(e._keyMap))),Wy=a(2,(e,t)=>jf(e,r=>{for(let o of t)zf(r,o)}));var jy=a(2,(e,t)=>jf(qi(),r=>{zy(e,o=>xs(r,o));for(let o of t)xs(r,o)}));var zy=a(2,(e,t)=>Yc(e._keyMap,(r,o)=>t(o))),Ky=a(3,(e,t,r)=>hs(e._keyMap,t,(o,n,s)=>r(o,s)));var no=fs,By=My,Zc=Hf,Gy=Iy,Ui=ky;var vr=sn,Kf=$c;var Xc=ms;var $y=Hi;var Vy=Py;var Yy=Yc,Bf=hs;var Sk=Symbol.for("@effect/data/MutableRef"),Gf=class{constructor(t){this.current=t,this._T=r=>r,this._id=Sk}toString(){return`MutableRef(${String(this.current)})`}toJSON(){return{_tag:"MutableRef",current:this.current}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},pt=e=>new Gf(e),ep=a(3,(e,t,r)=>O(t,e.current)?(e.current=r,!0):!1);var Ct=e=>e.current;var Jy=e=>_k(e,t=>t+1),Wt=a(2,(e,t)=>(e.current=t,e)),Ek=a(2,(e,t)=>(e.current=t,e.current)),$f=a(2,(e,t)=>Wt(e,t(Ct(e)))),_k=a(2,(e,t)=>Ek(e,t(Ct(e))));var Ok=Symbol.for("@effect/data/MutableHashMap"),Vf=class{constructor(){this._id=Ok,this.backingMap=pt(no())}[Symbol.iterator](){return this.backingMap.current[Symbol.iterator]()}toString(){return`MutableHashMap(${Array.from(this).map(([t,r])=>`[${String(t)}, ${String(r)}]`).join(", ")})`}toJSON(){return{_tag:"MutableHashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},pn=()=>new Vf;var ye=a(2,(e,t)=>Ui(e.backingMap.current,t)),sr=a(2,(e,t)=>N(ye(e,t)));var un=a(2,(e,t)=>($f(e.backingMap,$y(t)),e)),ut=a(3,(e,t,r)=>($f(e.backingMap,vr(t,r)),e)),tp=e=>Xc(Ct(e.backingMap));var Qy=Symbol.for("@effect/data/Chunk");function Ck(e,t,r,o,n){for(let s=t;s<Math.min(e.length,t+n);s++)r[o+s-t]=e[s];return r}var Zy=[],Rk=e=>Sc((t,r)=>Ze(t).every((o,n)=>e(o,wo(r,n)))),Ak=Rk(O),oe=class{constructor(t){switch(this.backing=t,this._id=Qy,t._tag){case"IEmpty":{this.length=0,this.depth=0,this.left=this,this.right=this;break}case"IConcat":{this.length=t.left.length+t.right.length,this.depth=1+Math.max(t.left.depth,t.right.depth),this.left=t.left,this.right=t.right;break}case"IArray":{this.length=t.array.length,this.depth=0,this.left=ir,this.right=ir;break}case"ISingleton":{this.length=1,this.depth=0,this.left=ir,this.right=ir;break}case"ISlice":{this.length=t.length,this.depth=t.chunk.depth+1,this.left=ir,this.right=ir;break}}}toString(){return`Chunk(${Ze(this).map(String).join(", ")})`}toJSON(){return{_tag:"Chunk",values:Ze(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}[T](t){return Xy(t)&&Ak(this,t)}[A](){return eo(Ze(this))}[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return Zy[Symbol.iterator]();default:return Ze(this)[Symbol.iterator]()}}pipe(){return E(this,arguments)}},Xy=e=>pe(e)&&"_id"in e&&e._id===Qy,ir=new oe({_tag:"IEmpty"}),Xe=()=>ir;var Oe=e=>new oe({_tag:"ISingleton",a:e}),Ir=e=>Xy(e)?e:new oe({_tag:"IArray",array:Q(e)}),Jf=(e,t,r)=>{switch(e.backing._tag){case"IArray":{Ck(e.backing.array,0,t,r,e.length);break}case"IConcat":{Jf(e.left,t,r),Jf(e.right,t,r+e.left.length);break}case"ISingleton":{t[r]=e.backing.a;break}case"ISlice":{let o=0,n=r;for(;o<e.length;)t[n]=wo(e,o),o+=1,n+=1;break}}},Ze=e=>{switch(e.backing._tag){case"IEmpty":return Zy;case"IArray":return e.backing.array;default:{let t=new Array(e.length);return Jf(e,t,0),e.backing={_tag:"IArray",array:t},e.left=ir,e.right=ir,e.depth=0,t}}},so=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return new oe({_tag:"IArray",array:Sf(e.backing.array)});case"IConcat":return new oe({_tag:"IConcat",left:so(e.backing.right),right:so(e.backing.left)});case"ISlice":return Rt(Sf(Ze(e)))}},Tk=a(2,(e,t)=>t<0||t>=e.length?x():d(wo(e,t))),Rt=e=>new oe({_tag:"IArray",array:e});var wo=a(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?wo(e.left,t):wo(e.right,t-e.left.length);case"ISlice":return wo(e.backing.chunk,t+e.backing.offset)}}),rp=a(2,(e,t)=>eb(e,Oe(t))),ve=a(2,(e,t)=>eb(Oe(t),e)),Qf=a(2,(e,t)=>{if(t<=0)return ir;if(t>=e.length)return e;switch(e.backing._tag){case"ISlice":return new oe({_tag:"ISlice",chunk:e.backing.chunk,length:t,offset:e.backing.offset});case"IConcat":return t>e.left.length?new oe({_tag:"IConcat",left:e.left,right:Qf(e.right,t-e.left.length)}):Qf(e.left,t);default:return new oe({_tag:"ISlice",chunk:e,offset:0,length:t})}}),gs=a(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return ir;switch(e.backing._tag){case"ISlice":return new oe({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?gs(e.right,t-e.left.length):new oe({_tag:"IConcat",left:gs(e.left,t),right:e.right});default:return new oe({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}});var ar=a(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;let r=t.depth-e.depth;if(Math.abs(r)<=1)return new oe({_tag:"IConcat",left:e,right:t});if(r<-1)if(e.left.depth>=e.right.depth){let o=ar(e.right,t);return new oe({_tag:"IConcat",left:e.left,right:o})}else{let o=ar(e.right.right,t);if(o.depth===e.depth-3){let n=new oe({_tag:"IConcat",left:e.right.left,right:o});return new oe({_tag:"IConcat",left:e.left,right:n})}else{let n=new oe({_tag:"IConcat",left:e.left,right:e.right.left});return new oe({_tag:"IConcat",left:n,right:o})}}else if(t.right.depth>=t.left.depth){let o=ar(e,t.left);return new oe({_tag:"IConcat",left:o,right:t.right})}else{let o=ar(e,t.left.left);if(o.depth===t.depth-3){let n=new oe({_tag:"IConcat",left:o,right:t.left.right});return new oe({_tag:"IConcat",left:n,right:t.right})}else{let n=new oe({_tag:"IConcat",left:t.left.right,right:t.right});return new oe({_tag:"IConcat",left:o,right:n})}}}),eb=a(2,(e,t)=>ar(e,t));var ys=e=>e.length===0,Ke=e=>e.length>0,ln=Tk(0),fn=e=>wo(e,0),Be=fn;var tb=e=>wo(e,e.length-1),Zf=a(2,(e,t)=>e.backing._tag==="ISingleton"?Oe(t(e.backing.a,0)):Rt(to((r,o)=>t(r,o))(Ze(e))));var op=a(2,(e,t)=>Rt(en(Ze(e),t)));var Mk=a(2,(e,t)=>[Qf(e,t),gs(e,t)]);var rb=a(2,(e,t)=>{let r=0;for(let o of Ze(e)){if(t(o))break;r++}return Mk(e,r)});var Ge=e=>gs(e,1);var ob=e=>Rt(ty(Ze(e)));var vk=Symbol.for("@effect/data/MutableList"),Xf=class{constructor(){this._id=vk,this.head=void 0,this.tail=void 0,this._length=0}[Symbol.iterator](){let t=!1,r=this.head;return{next(){if(t)return this.return();if(r==null)return t=!0,this.return();let o=r.value;return r=r.next,{done:t,value:o}},return(o){return t||(t=!0),{done:!0,value:o}}}}toString(){return`MutableList(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableList",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},em=class{constructor(t){this.value=t,this.removed=!1,this.prev=void 0,this.next=void 0}},nb=()=>new Xf;var sb=e=>tm(e)===0,tm=e=>e._length;var ib=a(2,(e,t)=>{let r=new em(t);return e.head===void 0&&(e.head=r),e.tail===void 0||(e.tail.next=r,r.prev=e.tail),e.tail=r,e._length+=1,e}),ab=e=>{let t=e.head;if(t!==void 0)return Ik(e,t),t.value};var Ik=(e,t)=>{t.removed||(t.removed=!0,t.prev!==void 0&&t.next!==void 0?(t.prev.next=t.next,t.next.prev=t.prev):t.prev!==void 0?(e.tail=t.prev,t.prev.next=void 0):t.next!==void 0?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))};var wk=Symbol.for("@effect/data/MutableQueue"),om=Symbol.for("@effect/data/mutable/MutableQueue/Empty"),rm=class{constructor(t=void 0){this.capacity=t,this._tag="Bounded",this._id=wk,this.queue=nb()}[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()}toString(){return`MutableQueue(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableQueue",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}};var cb=()=>new rm;var pb=a(2,(e,t)=>{let r=tm(e.queue);return e.capacity!==void 0&&r===e.capacity?!1:(ib(t)(e.queue),!0)});var ub=a(2,(e,t)=>sb(e.queue)?t:ab(e.queue));var bs=Symbol.for("@effect/data/Differ/ContextPatch");function kr(e){return e}var nm=class{constructor(){this._tag="Empty",this._Input=kr,this._Output=kr,this._id=bs}[A](){return we("ContextPatch(Empty)")}[T](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}},sm=class{constructor(t,r){this.first=t,this.second=r,this._tag="AndThen",this._id=bs,this._Input=kr,this._Output=kr}[A](){return we("ContextPatch(AndThen)")}[T](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.first,t.first)&&O(this.second,t.second)}},im=class{constructor(t,r){this.tag=t,this.service=r,this._tag="AddService",this._id=bs,this._Input=kr,this._Output=kr}[A](){return we("ContextPatch(AddService)")}[T](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.tag,t.tag)&&O(this.service,t.service)}},am=class{constructor(t){this.tag=t,this._tag="RemoveService",this._id=bs,this._Input=kr,this._Output=kr}[A](){return we("ContextPatch(RemoveService)")}[T](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.tag,t.tag)}},cm=class{constructor(t,r){this.tag=t,this.update=r,this._tag="UpdateService",this._id=bs,this._Input=kr,this._Output=kr}[A](){return we("ContextPatch(AndThen)")}[T](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.tag,t.tag)&&O(this.update,t.update)}},pm=()=>new nm,lb=(e,t)=>{let r=new Map(e.unsafeMap),o=pm();for(let[n,s]of t.unsafeMap.entries())if(r.has(n)){let i=r.get(n);r.delete(n),O(i,s)||(o=Wi(new cm(n,()=>s))(o))}else r.delete(n),o=Wi(new im(n,s))(o);for(let[n]of r.entries())o=Wi(new am(n))(o);return o},Wi=a(2,(e,t)=>new sm(e,t)),fb=a(2,(e,t)=>{let r=!1,o=Oe(e),n=new Map(t.unsafeMap);for(;Ke(o);){let i=Be(o),c=Ge(o);switch(i._tag){case"Empty":{o=c;break}case"AddService":{n.set(i.tag,i.service),o=c;break}case"AndThen":{o=ve(ve(c,i.second),i.first);break}case"RemoveService":{n.delete(i.tag),o=c;break}case"UpdateService":{n.set(i.tag,i.update(n.get(i.tag))),r=!0,o=c;break}}}if(!r)return new or(n);let s=new Map;for(let[i]of t.unsafeMap)n.has(i)&&(s.set(i,n.get(i)),n.delete(i));for(let[i,c]of n)s.set(i,c);return new or(s)});var np=pm,mb=lb,hb=Wi,db=fb;var $e=qi,lt=Ly,io=Hy,gb=qy;var ao=Uy;var wr=xs,um=zf,lm=Wy;var Ve=jy;var mn=Ky;var ji=Symbol.for("@effect/data/Differ/HashSetPatch");function ip(e){return e}var fm=class{constructor(){this._tag="Empty",this._Value=ip,this._id=ji}[A](){return we("HashSetPatch(Empty)")}[T](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}},mm=class{constructor(t,r){this.first=t,this.second=r,this._tag="AndThen",this._Value=ip,this._id=ji}[A](){return we("HashSetPatch(AndThen)")}[T](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.first,t.first)&&O(this.second,t.second)}},hm=class{constructor(t){this.value=t,this._tag="Add",this._Value=ip,this._id=ji}[A](){return we("HashSetPatch(Add)")}[T](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.value,t.value)}},dm=class{constructor(t){this.value=t,this._tag="Remove",this._Value=ip,this._id=ji}[A](){return we("HashSetPatch(Remove)")}[T](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.value,t.value)}},xm=()=>new fm,yb=(e,t)=>{let[r,o]=mn([e,xm()],([n,s],i)=>gb(i)(n)?[um(i)(n),s]:[n,sp(new hm(i))(s)])(t);return mn(o,(n,s)=>sp(new dm(s))(n))(r)},sp=a(2,(e,t)=>new mm(e,t)),bb=a(2,(e,t)=>{let r=t,o=Oe(e);for(;Ke(o);){let n=Be(o),s=Ge(o);switch(n._tag){case"Empty":{o=s;break}case"AndThen":{o=ve(n.first)(ve(n.second)(s));break}case"Add":{r=wr(n.value)(r),o=s;break}case"Remove":r=um(n.value)(r),o=s}}return r});var ap=xm,Sb=yb,Eb=sp,_b=bb;var Cb=Symbol.for("@effect/data/Differ"),gm=class{constructor(t){this._id=Cb,this._P=F,this._V=F,this.empty=t.empty,this.diff=t.diff,this.combine=t.combine,this.patch=t.patch}},zi=e=>new gm(e),Rb=()=>zi({empty:np(),combine:(e,t)=>hb(t)(e),diff:(e,t)=>mb(e,t),patch:(e,t)=>db(t)(e)});var Ab=()=>zi({empty:ap(),combine:(e,t)=>Eb(t)(e),diff:(e,t)=>Sb(e,t),patch:(e,t)=>_b(t)(e)});var Tb=()=>Mb((e,t)=>t),Mb=e=>zi({empty:F,combine:(t,r)=>t===F?r:r===F?t:o=>r(t(o)),diff:(t,r)=>O(t,r)?F:Mi(r),patch:(t,r)=>e(r,t(r))});var vb=a(3,(e,t,r)=>e.diff(t,r)),Ib=a(3,(e,t,r)=>e.combine(t,r)),kb=a(3,(e,t,r)=>e.patch(t,r)),cp=zi,wb=Rb;var Fb=Ab;var Pb=Tb;var Sm=Symbol.for("@effect/data/List"),Ki=e=>Array.from(e),Hk=e=>_g(ey(e),Ki),qk=Hk(O),Ss=class{constructor(t,r){this.head=t,this.tail=r,this._tag="Cons",this._id=Sm}toString(){return`List.Cons(${Ki(this).map(String).join(", ")})`}toJSON(){return{_tag:"List.Cons",values:Ki(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}[T](t){return Nb(t)&&this._tag===t._tag&&qk(this,t)}[A](){return eo(Ki(this))}[Symbol.iterator](){let t=!1,r=this;return{next(){if(t)return this.return();if(r._tag==="Nil")return t=!0,this.return();let o=r.head;return r=r.tail,{done:t,value:o}},return(o){return t||(t=!0),{done:!0,value:o}}}}pipe(){return E(this,arguments)}},bm=class{constructor(){this._tag="Nil",this._id=Sm}toString(){return"List.Nil"}toJSON(){return{_tag:"List.Nil"}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}[A](){return eo(Ki(this))}[T](t){return Nb(t)&&this._tag===t._tag}[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}}pipe(){return E(this,arguments)}},Nb=e=>pe(e)&&"_id"in e&&e._id===Sm,ft=e=>e._tag==="Nil",Bi=e=>e._tag==="Cons";var Db=new bm,Uk=()=>Db,co=(e,t)=>new Ss(e,t),cr=Uk,Gi=e=>new Ss(e,Db);var Lb=a(2,(e,t)=>Wk(t,e));var Fo=a(2,(e,t)=>co(t,e)),Wk=a(2,(e,t)=>{if(ft(e))return t;if(ft(t))return e;{let r=new Ss(t.head,e),o=r,n=t.tail;for(;!ft(n);){let s=new Ss(n.head,e);o.tail=s,o=s,n=n.tail}return r}});var Hb=a(2,(e,t)=>{let r=e;for(;!ft(r);){if(t(r.head))return d(r.head);r=r.tail}return x()});var pp=e=>ft(e)?x():d(e.head);var qb=a(3,(e,t,r)=>{let o=t,n=e;for(;!ft(n);)o=r(o,n.head),n=n.tail;return o});var Ub=e=>{let t=cr(),r=e;for(;!ft(r);)t=Fo(t,r.head),r=r.tail;return t};var Wb,jb,zb,lp="@effect/io/Fiber/Id",Po=Symbol.for(lp),$i="None",Em="Runtime",_m="Composite",Om=class{constructor(){this[Wb]=Po,this._tag=$i}[(Wb=Po,A)](){return I(S(this._tag))(S(lp))}[T](t){return mp(t)&&t._tag===$i}},Cm=class{constructor(t,r){this.id=t,this.startTimeMillis=r,this[jb]=Po,this._tag=Em}[(jb=Po,A)](){return I(S(this.startTimeMillis))(I(S(this.id))(I(S(this._tag))(S(lp))))}[T](t){return mp(t)&&t._tag===Em&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}},Rm=class{constructor(t,r){this.left=t,this.right=r,this[zb]=Po,this._tag=_m}[(zb=Po,A)](){return I(S(this.right))(I(S(this.left))(I(S(this._tag))(S(lp))))}[T](t){return mp(t)&&t._tag===_m&&O(this.left,t.left)&&O(this.right,t.right)}},fp=new Om;var mp=e=>typeof e=="object"&&e!=null&&Po in e;var Bb=a(2,(e,t)=>e._tag===$i?t:t._tag===$i?e:new Rm(e,t));var up=e=>{switch(e._tag){case $i:return $e();case Em:return io(e.id);case _m:return Ve(up(e.right))(up(e.left))}},Kb=K(Symbol.for("@effect/io/Fiber/Id/_fiberCounter"),()=>pt(0));var hp=e=>Array.from(up(e)).map(r=>`#${r}`).join(",");var Gb=()=>{let e=Ct(Kb);return Wt(e+1)(Kb),new Cm(e,new Date().getTime())};var et=fp;var Am=Bb;var Vb=hp;var dp=Gb;var hn="Die",No="Empty",dn="Fail",Os="Interrupt",xn="Annotated",gn="Parallel",yn="Sequential";var eS="@effect/io/Cause",km=Symbol.for(eS),zk={_E:e=>e},Sn={[km]:zk,[A](){return I(S(Bk(this)))(S(eS))},[T](e){return bp(e)&&Kk(this,e)},pipe(){return E(this,arguments)},toJSON(){return{_tag:"Cause",errors:Op(this)}},toString(){return lo(this)},[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}},tt=(()=>{let e=Object.create(Sn);return e._tag=No,e})(),En=e=>{let t=Object.create(Sn);return t._tag=dn,t.error=e,t},Le=e=>{let t=Object.create(Sn);return t._tag=hn,t.defect=e,t},pr=e=>{let t=Object.create(Sn);return t._tag=Os,t.fiberId=e,t},Do=(e,t)=>{let r=Object.create(Sn);return r._tag=xn,r.cause=e,r.annotation=t,r},Fe=(e,t)=>{let r=Object.create(Sn);return r._tag=gn,r.left=e,r.right=t,r},Ce=(e,t)=>{let r=Object.create(Sn);return r._tag=yn,r.left=e,r.right=t,r},bp=e=>typeof e=="object"&&e!=null&&km in e,wm=e=>e._tag===No;var Sp=e=>e._tag===hn;var Fm=e=>e._tag===No?!0:bn(e,!0,(t,r)=>{switch(r._tag){case No:return d(t);case hn:case dn:case Os:return d(!1);default:return x()}});var Lo=e=>_p(void 0,$k)(e),Vi=e=>so(bn(e,Xe(),(t,r)=>r._tag===dn?d(ve(r.error)(t)):x())),Ep=e=>so(bn(e,Xe(),(t,r)=>r._tag===hn?d(ve(r.defect)(t)):x())),Yi=e=>bn(e,$e(),(t,r)=>r._tag===Os?d(wr(r.fiberId)(t)):x()),tS=e=>Ji(e,t=>t._tag===dn?d(t.error):x()),po=e=>{let t=tS(e);switch(t._tag){case"None":return P(e);case"Some":return U(t.value)}};var Pm=e=>Rs(e,{onEmpty:x(),onFail:()=>x(),onDie:t=>d(Le(t)),onInterrupt:()=>x(),onAnnotated:(t,r)=>Te(o=>Do(o,r))(t),onSequential:(t,r)=>N(t)&&N(r)?d(Ce(t.value,r.value)):N(t)&&z(r)?d(t.value):z(t)&&N(r)?d(r.value):x(),onParallel:(t,r)=>N(t)&&N(r)?d(Fe(t.value,r.value)):N(t)&&z(r)?d(t.value):z(t)&&N(r)?d(r.value):x()}),rS=e=>Rs(e,{onEmpty:x(),onFail:t=>d(Le(t)),onDie:t=>d(Le(t)),onInterrupt:()=>x(),onAnnotated:(t,r)=>Te(o=>Do(o,r))(t),onSequential:(t,r)=>N(t)&&N(r)?d(Ce(t.value,r.value)):N(t)&&z(r)?d(t.value):z(t)&&N(r)?d(r.value):x(),onParallel:(t,r)=>N(t)&&N(r)?d(Fe(t.value,r.value)):N(t)&&z(r)?d(t.value):z(t)&&N(r)?d(r.value):x()});var Cs=e=>Rs(e,{onEmpty:tt,onFail:()=>tt,onDie:t=>Le(t),onInterrupt:t=>pr(t),onAnnotated:(t,r)=>wm(t)?t:Do(t,r),onSequential:Ce,onParallel:Fe}),oS=e=>Rs(e,{onEmpty:tt,onFail:t=>Le(t),onDie:t=>Le(t),onInterrupt:t=>pr(t),onAnnotated:(t,r)=>wm(t)?t:Do(t,r),onSequential:(t,r)=>Ce(t,r),onParallel:(t,r)=>Fe(t,r)});var nS=a(2,(e,t)=>Rs(e,{onEmpty:tt,onFail:r=>t(r),onDie:r=>Le(r),onInterrupt:r=>pr(r),onAnnotated:(r,o)=>Do(r,o),onSequential:(r,o)=>Ce(r,o),onParallel:(r,o)=>Fe(r,o)})),Nm=e=>nS(e,F);var Kk=(e,t)=>{let r=Oe(e),o=Oe(t);for(;Ke(r)&&Ke(o);){let[n,s]=bn([$e(),Xe()],([p,u],f)=>{let[m,y]=Tm(f);return d([Ve(m)(p),ar(y)(u)])})(Be(r)),[i,c]=bn([$e(),Xe()],([p,u],f)=>{let[m,y]=Tm(f);return d([Ve(m)(p),ar(y)(u)])})(Be(o));if(!O(n,i))return!1;r=s,o=c}return!0},Bk=e=>Gk(Oe(e),Xe()),Gk=(e,t)=>{for(;;){let[r,o]=at([$e(),Xe()],([s,i],c)=>{let[p,u]=Tm(c);return[Ve(p)(s),ar(u)(i)]})(e),n=ao(r)>0?ve(r)(t):t;if(ys(o))return so(n);e=o,t=n}throw new Error("BUG: Cause.flattenCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")};var Ji=a(2,(e,t)=>{let r=[e];for(;r.length>0;){let o=r.pop(),n=t(o);switch(n._tag){case"None":{switch(o._tag){case yn:case gn:{r.push(o.right),r.push(o.left);break}case xn:{r.push(o.cause);break}}break}case"Some":return n}}return x()});var Tm=e=>{let t=e,r=[],o=$e(),n=Xe();for(;t!==void 0;)switch(t._tag){case No:{if(r.length===0)return[o,n];t=r.pop();break}case dn:{if(r.length===0)return[wr(t.error)(o),n];o=wr(t.error)(o),t=r.pop();break}case hn:{if(r.length===0)return[wr(t.defect)(o),n];o=wr(t.defect)(o),t=r.pop();break}case Os:{if(r.length===0)return[wr(t.fiberId)(o),n];o=wr(t.fiberId)(o),t=r.pop();break}case xn:{t=t.cause;break}case yn:{switch(t.left._tag){case No:{t=t.right;break}case yn:{t=Ce(t.left.left,Ce(t.left.right,t.right));break}case gn:{t=Fe(Ce(t.left.left,t.right),Ce(t.left.right,t.right));break}case xn:{t=Ce(t.left.cause,t.right);break}default:{n=ve(t.right)(n),t=t.left;break}}break}case gn:{r.push(t.right),t=t.left;break}}throw new Error("BUG: Cause.evaluateCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")};var $k={emptyCase:Or,failCase:Dt,dieCase:Dt,interruptCase:Or,annotatedCase:(e,t)=>t,sequentialCase:(e,t,r)=>t&&r,parallelCase:(e,t,r)=>t&&r};var Yb="SequentialCase",Jb="ParallelCase",Qb="AnnotatedCase",Rs=a(2,(e,{onAnnotated:t,onDie:r,onEmpty:o,onFail:n,onInterrupt:s,onParallel:i,onSequential:c})=>_p(e,void 0,{emptyCase:()=>o,failCase:(p,u)=>n(u),dieCase:(p,u)=>r(u),interruptCase:(p,u)=>s(u),annotatedCase:(p,u,f)=>t(u,f),sequentialCase:(p,u,f)=>c(u,f),parallelCase:(p,u,f)=>i(u,f)})),bn=a(3,(e,t,r)=>{let o=t,n=e,s=[];for(;n!==void 0;){let i=r(o,n);switch(o=N(i)?i.value:o,n._tag){case yn:{s.push(n.right),n=n.left;break}case gn:{s.push(n.right),n=n.left;break}case xn:{n=n.cause;break}default:{n=void 0;break}}n===void 0&&s.length>0&&(n=s.pop())}return o}),_p=a(3,(e,t,r)=>{let o=[e],n=[];for(;o.length>0;){let i=o.pop();switch(i._tag){case No:{n.push(P(r.emptyCase(t)));break}case dn:{n.push(P(r.failCase(t,i.error)));break}case hn:{n.push(P(r.dieCase(t,i.defect)));break}case Os:{n.push(P(r.interruptCase(t,i.fiberId)));break}case xn:{o.push(i.cause),n.push(U({_tag:Qb,annotation:i.annotation}));break}case yn:{o.push(i.right),o.push(i.left),n.push(U({_tag:Yb}));break}case gn:{o.push(i.right),o.push(i.left),n.push(U({_tag:Jb}));break}}}let s=[];for(;n.length>0;){let i=n.pop();switch(i._tag){case"Left":{switch(i.left._tag){case Yb:{let c=s.pop(),p=s.pop(),u=r.sequentialCase(t,c,p);s.push(u);break}case Jb:{let c=s.pop(),p=s.pop(),u=r.parallelCase(t,c,p);s.push(u);break}case Qb:{let c=s.pop(),p=r.annotatedCase(t,c,i.left.annotation);s.push(p);break}}break}case"Right":{s.push(i.right);break}}}if(s.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/io/issues");return s.pop()}),Qi=(e,t)=>{let r={value:t,enumerable:!0},o={...e,toString(){return`${this._tag}: ${this.message}`}};return n=>Object.create(o,{_tag:r,message:{value:n,enumerable:!0}})},Mm=Symbol.for("@effect/io/Cause/errors/RuntimeException"),Dm=Qi({[Mm]:Mm},"RuntimeException");var xp=Symbol.for("@effect/io/Cause/errors/InterruptedException"),Vk=Qi({[xp]:xp},"InterruptedException"),Lm=e=>typeof e=="object"&&e!=null&&xp in e,vm=Symbol.for("@effect/io/Cause/errors/IllegalArgument"),As=Qi({[vm]:vm},"IllegalArgumentException");var gp=Symbol.for("@effect/io/Cause/errors/NoSuchElement"),uo=Qi({[gp]:gp},"NoSuchElementException"),Hm=e=>typeof e=="object"&&e!=null&&gp in e,Im=Symbol.for("@effect/io/Cause/errors/InvalidHubCapacityException"),fz=Qi({[Im]:Im},"InvalidHubCapacityException");var yp=Symbol.for("@effect/io/Cause/SpanAnnotation"),Yk=e=>typeof e=="object"&&e!==null&&yp in e,sS=e=>({_tag:"SpanAnnotation",[yp]:yp,span:e});var Zb=e=>{if(typeof e=="object"&&e!=null&&"toString"in e&&typeof e.toString=="function"&&e.toString!==Object.prototype.toString)return e.toString();if(typeof e=="string")return`Error: ${e}`;if(typeof e=="object"&&e!==null&&"message"in e&&typeof e.message=="string"){let t=JSON.parse(JSON.stringify(e)),r=new Set(Object.keys(t));if(r.delete("name"),r.delete("message"),r.delete("_tag"),r.size===0)return`${"name"in e&&typeof e.name=="string"?e.name:"Error"}${"_tag"in e&&typeof e._tag=="string"?`(${e._tag})`:""}: ${e.message}`}return`Error: ${JSON.stringify(e)}`},Xb=e=>e instanceof Error?[Zb(e),e.stack?.split(`
`).filter(t=>!t.startsWith("Error")).join(`
`)]:[Zb(e),void 0];var Jk=e=>{let t=e.split(`
`),r=[];for(let o=0;o<t.length;o++){if(t[o].includes("EffectPrimitive")||t[o].includes("Generator.next")||t[o].includes("FiberRuntime"))return r.join(`
`);r.push(t[o])}return r.join(`
`)},lo=e=>{if(Lo(e))return"All fibers interrupted without errors.";let t=Op(e).map(r=>{let o=r.message;if(r.stack&&(o+=`\r
${Jk(r.stack)}`),r.span){let n=r.span,s=0;for(;n&&n._tag==="Span"&&s<10;)o+=`\r
    at ${n.name}`,n=je(n.parent),s++}return o}).join(`\r
\r
`);return t.includes(`\r
`)?`\r
${t}\r
`:t},Op=e=>_p(e,void 0,{emptyCase:()=>[],dieCase:(t,r)=>{let o=Xb(r);return[{message:o[0],stack:o[1],span:void 0}]},failCase:(t,r)=>{let o=Xb(r);return[{message:o[0],stack:o[1],span:void 0}]},interruptCase:()=>[],parallelCase:(t,r,o)=>[...r,...o],sequentialCase:(t,r,o)=>[...r,...o],annotatedCase:(t,r,o)=>Yk(o)?r.map(n=>({...n,span:n.span??o.span})):r});var iS=lo;var Zi=255,aS=8,Cp=e=>e&Zi,Rp=e=>e>>aS&Zi,On=(e,t)=>(e&Zi)+((t&e&Zi)<<aS),Ap=On(0,0),cS=e=>On(e,e),pS=e=>On(e,0);var uS=a(2,(e,t)=>On(Cp(e)&~t,Rp(e)));var qm=a(2,(e,t)=>e|t);var lS=e=>~e>>>0&Zi;var mS=0,ur=1,Um=2,Tp=4,Xi=16,Mp=32;var Wm=e=>ea(e,Mp);var jm=a(2,(e,t)=>e|t);var Fr=e=>Ts(e)&&!hS(e),Ts=e=>ea(e,ur);var ea=a(2,(e,t)=>(e&t)!==0),vp=(...e)=>e.reduce((t,r)=>t|r,0),zm=vp(mS);var ta=e=>ea(e,Tp);var hS=e=>ea(e,Xi);var Cn=a(2,(e,t)=>On(e^t,t)),Ms=a(2,(e,t)=>e&(lS(Cp(t))|Rp(t))|Cp(t)&Rp(t));var Km=cp({empty:Ap,diff:(e,t)=>Cn(e,t),combine:(e,t)=>qm(t)(e),patch:(e,t)=>Ms(t,e)});var kp=Ap;var Bm=cS,Gm=pS;var $m=uS;var xS,gS,yS,bS={_tag:"Empty"},Rn=(e,t)=>({_tag:"Par",left:e,right:t}),wp=(e,t)=>({_tag:"Seq",left:e,right:t}),Jm=(e,t)=>({_tag:"Single",dataSource:e,blockedRequest:t});var SS=e=>{let t=Gi(e),r=cr();for(;;){let[o,n]=qb(t,[ES(),cr()],([s,i],c)=>{let[p,u]=tw(c);return[_S(s,p),Lb(i,u)]});if(r=rw(r,o),ft(n))return Ub(r);t=n}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/query/issues")},tw=e=>{let t=e,r=ES(),o=cr(),n=cr();for(;;)switch(t._tag){case"Empty":{if(ft(o))return[r,n];t=o.head,o=o.tail;break}case"Par":{o=co(t.right,o),t=t.left;break}case"Seq":{let s=t.left,i=t.right;switch(s._tag){case"Empty":{t=i;break}case"Par":{let c=s.left,p=s.right;t=Rn(wp(c,i),wp(p,i));break}case"Seq":{let c=s.left,p=s.right;t=wp(c,wp(p,i));break}case"Single":{t=s,n=co(i,n);break}}break}case"Single":{if(r=_S(r,aw(t.dataSource,t.blockedRequest)),ft(o))return[r,n];t=o.head,o=o.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/query/issues")},rw=(e,t)=>{if(ft(e))return Gi(Vm(t));if(cw(t))return e;let r=hw(e.head),o=pw(t);return r.length===1&&o.length===1&&O(r[0],o[0])?co(mw(e.head,Vm(t)),e.tail):co(Vm(t),e)},ow=Symbol.for("@effect/io/RequestBlock.Entry"),Ym=class{constructor(t,r,o,n,s){this.request=t,this.result=r,this.listeners=o,this.ownerId=n,this.state=s,this[xS]=nw}};xS=ow;var nw={_R:e=>e};var Qm=e=>new Ym(e.request,e.result,e.listeners,e.ownerId,e.state),sw=Symbol.for("@effect/io/RequestBlockParallel"),iw={_R:e=>e},ra=class{constructor(t){this.map=t,this[gS]=iw}};gS=sw;var ES=()=>new ra(no()),aw=(e,t)=>new ra(By([e,Array.of(t)])),_S=(e,t)=>new ra(Bf(e.map,t.map,(r,o,n)=>vr(r,n,De(Ui(r,n),{onNone:()=>o,onSome:s=>[...s,...o]})))),cw=e=>Gy(e.map),pw=e=>Array.from(Kf(e.map)),Vm=e=>fw(Vy(e.map,t=>Array.of(t)));var uw=Symbol.for("@effect/io/RequestBlockSequential"),lw={_R:e=>e},Fp=class{constructor(t){this.map=t,this[yS]=lw}};yS=uw;var fw=e=>new Fp(e),mw=(e,t)=>new Fp(Bf(t.map,e.map,(r,o,n)=>vr(r,n,De(Ui(r,n),{onNone:()=>[],onSome:s=>[...s,...o]}))));var hw=e=>Array.from(Kf(e.map)),OS=e=>Array.from(e.map);var An="Pending",oa="Done";var dw="@effect/io/Deferred",AS=Symbol.for(dw),TS={_E:e=>e,_A:e=>e},Pp=e=>({_tag:An,joiners:e}),Zm=e=>({_tag:oa,effect:e});var vs="Async",MS="Commit",fe="Failure",Is="OnFailure",ks="OnSuccess",ws="OnSuccessAndFailure",me="Success",Np="Sync",vS="Tag",fo="UpdateRuntimeFlags",Fs="While",Dp="WithRuntime",Ps="Yield",na="RevertFlags";var Hp=class{constructor(){this.buckets=[]}scheduleTask(t,r){let o,n;for(n=0;n<this.buckets.length&&this.buckets[n][0]<=r;n++)o=this.buckets[n];if(o)o[1].push(t);else{let s=[];for(let i=0;i<n;i++)s.push(this.buckets[i]);s.push([r,[t]]);for(let i=n;i<this.buckets.length;i++)s.push(this.buckets[i]);this.buckets=s}}},Xm=class{constructor(t){this.maxNextTickBeforeTimer=t,this.running=!1,this.tasks=new Hp}starveInternal(t){let r=this.tasks.buckets;this.tasks.buckets=[];for(let[o,n]of r)for(let s=0;s<n.length;s++)n[s]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}scheduleTask(t,r){this.tasks.scheduleTask(t,r),this.running||(this.running=!0,this.starve())}},eh=K(Symbol.for("@effect/io/Scheduler/defaultScheduler"),()=>new Xm(2048)),qp=class{constructor(){this.tasks=new Hp,this.deferred=!1}scheduleTask(t,r){this.deferred?eh.scheduleTask(t,r):this.tasks.scheduleTask(t,r)}flush(){for(;this.tasks.buckets.length>0;){let t=this.tasks.buckets;this.tasks.buckets=[];for(let[r,o]of t)for(let n=0;n<o.length;n++)o[n]()}this.deferred=!0}};var kS,wS,FS,PS,gw="@effect/io/Effect/Error",th=Symbol.for(gw),DS=e=>typeof e=="object"&&e!=null&&th in e,LS=e=>({[th]:th,_tag:"EffectError",cause:e}),he=(e,t)=>{let r=new Re("Blocked");return r.i0=e,r.i1=t,r},Kp=e=>{let t=new Re("RunBlocked");return t.i0=e,t},Ns=Symbol.for("@effect/io/Effect"),Wp=class{constructor(t,r){this.patch=t,this.op=r,this._tag=na}},Re=class{constructor(t){this._tag=t,this.i0=void 0,this.i1=void 0,this.i2=void 0,this.trace=void 0,this[kS]=rh}[(kS=Ns,T)](t){return this===t}[A](){return To(this)}pipe(){return E(this,arguments)}},jp=class{constructor(t){this._tag=t,this.i0=void 0,this.i1=void 0,this.i2=void 0,this.trace=void 0,this[wS]=rh}[(wS=Ns,T)](t){return this===t}[A](){return To(this)}get cause(){return this.i0}pipe(){return E(this,arguments)}toJSON(){return{_tag:this._tag,cause:this.cause.toJSON()}}toString(){return iS(this.cause)}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}},zp=class{constructor(t){this._tag=t,this.i0=void 0,this.i1=void 0,this.i2=void 0,this.trace=void 0,this[FS]=rh}[(FS=Ns,T)](t){return this===t}[A](){return To(this)}get value(){return this.i0}pipe(){return E(this,arguments)}toJSON(){return{_tag:this._tag,value:this.value}}toString(){return`Success: ${String(this.value)}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}},rh={_R:e=>e,_E:e=>e,_A:e=>e},de=e=>typeof e=="object"&&e!=null&&Ns in e,ue=e=>{let t=new Re(Dp);return t.i0=e,t},Kt=a(3,(e,t,r)=>be(o=>l(e,n=>l(X(M(()=>o(t(n)))),s=>M(()=>r(n,s)).pipe(J({onFailure:i=>{switch(s._tag){case fe:return D(Fe(s.i0,i));case me:return D(i)}},onSuccess:()=>s})))))),Y=a(2,(e,t)=>l(e,()=>h(t))),Z=e=>Y(e,void 0),Bt=(e,t=et)=>M(()=>{let r,o,n=new Re(vs);if(e.length!==1){let s=new AbortController;o=s,n.i0=i=>{r=e(i,s.signal)}}else n.i0=s=>{r=e(s)};return n.i1=t,jo(n,()=>(o&&o.abort(),r??k))}),Dr=(e,t=et)=>Bt(r=>{let o=e(r);if(Cr(o))r(o.right);else return o.left},t),Lr=a(2,(e,t)=>{let r=new Re(Is);return r.i0=e,r.i1=t,r}),mt=a(2,(e,t)=>ie(e,{onFailure:t,onSuccess:h})),Ho=e=>(...t)=>e(...t),HS=a(2,(e,t)=>J(e,{onFailure:Ho(r=>{let o=po(r);switch(o._tag){case"Left":return V(()=>D(r))(t(o.left));case"Right":return D(o.right)}}),onSuccess:h})),qS=e=>ue((t,r)=>e(Ts(r.runtimeFlags))),oh=e=>D(Le(e)),Ds=e=>Ur(()=>Le(Dm(e))),qo=e=>Ur(()=>Le(e())),Hr=e=>ie(e,{onFailure:t=>h(U(t)),onSuccess:t=>h(P(t))}),qr=()=>M(()=>Ye(xo)),Ls=e=>l(qr(),e),X=e=>ia(e,{onFailure:B,onSuccess:ee}),L=e=>D(En(e)),lr=e=>Ur(()=>En(e())),D=e=>{let t=new jp(fe);return t.i0=e,t},Ur=e=>l(g(e),D),Uo=ue(e=>h(e.id())),Gt=e=>ue(t=>e(t.id())),l=a(2,(e,t)=>{let r=new Re(ks);return r.i0=e,r.i1=t,r}),Pr=e=>{let t=new Re("OnStep");return t.i0=e,t.i1=ee,t},Hs=(e,t)=>{let r=new Re("OnStep");return r.i0=e,r.i1=t,r},ht=e=>l(e,F),Wo=e=>ie(e,{onFailure:h,onSuccess:L}),ia=a(2,(e,{onFailure:t,onSuccess:r})=>J(e,{onFailure:o=>h(t(o)),onSuccess:o=>h(r(o))})),J=a(2,(e,{onFailure:t,onSuccess:r})=>{let o=new Re(ws);return o.i0=e,o.i1=t,o.i2=r,o}),ie=a(2,(e,{onFailure:t,onSuccess:r})=>J(e,{onFailure:o=>{let n=Vi(o);return Ep(o).length>0?D(oS(o)):n.length>0?t(fn(n)):D(o)},onSuccess:r})),He=a(2,(e,t)=>M(()=>{let r=Q(e),o=new Array(r.length),n=0;return Y(kn({while:()=>n<r.length,body:()=>t(r[n],n),step:s=>{o[n++]=s}}),o)})),dt=a(2,(e,t)=>M(()=>{let r=Q(e),o=0;return kn({while:()=>o<r.length,body:()=>t(r[o],o),step:()=>{o++}})})),Bp=a(e=>typeof e[0]=="boolean"||de(e[0]),(e,{onFalse:t,onTrue:r})=>typeof e=="boolean"?e?r:t:l(e,Ho(o=>o?r:t))),Gp=l(Uo,e=>$p(e)),$p=e=>D(pr(e)),zt=e=>{let t=new Re(fo);t.i0=Bm(ur);let r=o=>o._tag==="Blocked"?he(o.i0,zt(o.i1)):o;return t.i1=()=>Hs(e,r),t},US=e=>{let t=new Re(fo);t.i0=Bm(ur);let r=o=>o._tag==="Blocked"?he(o.i0,zt(o.i1)):o;return t.i1=o=>Ts(o)?Pr(e(zt)):Pr(e(Nr)),l(t,r)},Wr=a(2,(e,t)=>be(r=>l(X(r(e)),o=>Eh(t,o)))),_=a(2,(e,t)=>l(e,r=>g(()=>t(r)))),Vp=a(2,(e,{onFailure:t,onSuccess:r})=>ie(e,{onFailure:o=>lr(()=>t(o)),onSuccess:o=>g(()=>r(o))})),mo=a(2,(e,t)=>J(e,{onFailure:r=>{let o=po(r);switch(o._tag){case"Left":return lr(()=>t(o.left));case"Right":return D(o.right)}},onSuccess:h})),Yp=a(2,(e,t)=>fr(e,Ho(r=>au(r)?k:t(r.i0)))),fr=a(2,(e,t)=>be(r=>J(r(e),{onFailure:o=>{let n=B(o);return J(t(n),{onFailure:s=>B(Ce(o,s)),onSuccess:()=>n})},onSuccess:o=>{let n=ee(o);return j(t(n),n)}}))),jo=a(2,(e,t)=>fr(e,uu({onFailure:r=>Lo(r)?Z(t(Yi(r))):k,onSuccess:()=>k}))),Mn=a(2,(e,t)=>yw(e,t,h)),vn=e=>nh(e,F),nh=a(2,(e,t)=>ie(e,{onFailure:r=>oh(t(r)),onSuccess:h})),WS=(e,t)=>Q(e).reduceRight(([r,o],n)=>{let s=t(n);switch(s._tag){case"Left":return[[s.left,...r],o];case"Right":return[r,[s.right,...o]]}},[new Array,new Array]),Tt=a(2,(e,t)=>Ee(xo,t)(e)),jS=a(2,(e,t)=>qe(xo,r=>rn(r,t))(e)),In=a(2,(e,t)=>Ls(r=>Tt(e,t(r)))),Jp=ue((e,t)=>h(t.runtimeFlags)),h=e=>{let t=new zp(me);return t.i0=e,t},M=e=>l(g(e),F),g=e=>{let t=new Re(Np);return t.i0=e,t},Mt=a(2,(e,t)=>l(e,r=>Y(t(r),r))),Qp=e=>ue(t=>{let r=t.getFiberRef(sa),o=V(()=>t.scope())(r);return e(Ee(sa,d(o)))}),yw=a(3,(e,t,r)=>J(e,{onFailure:o=>Ep(o).length>0?D(Gg(rS(o))):t(),onSuccess:r})),Nr=e=>{let t=new Re(fo);t.i0=Gm(ur),t.i1=()=>Hs(e,r);let r=o=>o._tag==="Blocked"?he(o.i0,Nr(o.i1)):o;return t},be=e=>{let t=new Re(fo);t.i0=Gm(ur);let r=o=>o._tag==="Blocked"?he(o.i0,Nr(o.i1)):o;return t.i1=o=>Ts(o)?Pr(e(zt)):Pr(e(Nr)),l(t,r)},k=h(void 0),qs=e=>{let t=new Re(fo);return t.i0=e,t.i1=void 0,t},Us=a(2,(e,t)=>l(t,r=>r?_(d)(e):h(x()))),kn=e=>{let t=new Re(Fs);return t.i0=e.while,t.i1=e.body,t.i2=e.step,t},zS=a(2,(e,t)=>Ee(e,ou,t)),KS=a(2,(e,t)=>Ee(e,pa,t)),BS=a(2,(e,t)=>{let r=new Re(fo);return r.i0=t,r.i1=()=>e,r}),GS=a(2,(e,t)=>Ee(e,la,t)),vt=e=>{let t=new Re(Ps);return typeof e?.priority<"u"?dh(e.priority)(t):t},Zp=a(2,(e,t)=>l(e,r=>_(t,o=>[r,o])));var Ws=a(2,(e,t)=>l(e,r=>Y(t,r))),j=a(2,(e,t)=>l(e,()=>t)),ho=a(3,(e,t,r)=>l(e,o=>_(t,n=>r(o,n)))),wn=Dr(()=>{let e=setInterval(()=>{},2147483647);return U(g(()=>clearInterval(e)))}),zo=e=>l(Uo,t=>$t(t)(e)),$t=a(2,(e,t)=>l(e.interruptAsFork(t),()=>e.await())),sh={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return E(this,arguments)}},ih={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return E(this,arguments)}},ah={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return E(this,arguments)}},ch={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return E(this,arguments)}},Xp={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return E(this,arguments)}},eu={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return E(this,arguments)}},ph={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return E(this,arguments)}},uh={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return E(this,arguments)}},lh=[sh,ph,eu,Xp,ch,ah,ih,uh],bw="@effect/io/FiberRef",Sw=Symbol.for(bw),Ew={_A:e=>e},Ye=e=>$S(e,t=>[t,t]);var Se=a(2,(e,t)=>l(Ye(e),t)),Tn=a(2,(e,t)=>$S(e,()=>[void 0,t]));var $S=a(2,(e,t)=>ue(r=>{let[o,n]=t(r.getFiberRef(e));return r.setFiberRef(e,n),h(o)}));var _w="@effect/io/RequestResolver",VS=Symbol.for(_w),Ow={_R:e=>e,_A:e=>e},NS=class e{constructor(t,r){this.runAll=t,this.target=r,this[PS]=Ow,this.runAll=t}[(PS=VS,A)](){return this.target?S(this.target):To(this)}[T](t){return this.target?Cw(t)&&O(this.target,t.target):this===t}identified(...t){return new e(this.runAll,Ir(t))}pipe(){return E(this,arguments)}},Cw=e=>typeof e=="object"&&e!=null&&VS in e;var Ee=a(3,(e,t,r)=>l(Kt(Ws(Ye(t),Tn(t,r)),()=>Pr(e),o=>Tn(t,o)),o=>o._tag==="Blocked"?he(o.i0,Ee(o.i1,t,r)):o)),qe=a(3,(e,t,r)=>Se(t,o=>Ee(e,t,r(o)))),xe=(e,t)=>js(e,{differ:Pb(),fork:t?.fork??F,join:t?.join}),fh=e=>js(e,{differ:Fb(),fork:ap()}),tu=e=>js(e,{differ:wb(),fork:np()}),js=(e,t)=>({[Sw]:Ew,initial:e,diff:(r,o)=>vb(r,o)(t.differ),combine:(r,o)=>Ib(r,o)(t.differ),patch:r=>o=>kb(r,o)(t.differ),fork:t.fork,join:t.join??((r,o)=>o),pipe(){return E(this,arguments)}}),YS=e=>js(e,{differ:Km,fork:kp}),xo=tu(_t()),aa=xe(0),mh=xe(2048),ca=K(Symbol.for("@effect/io/FiberRef/currentLogAnnotation"),()=>xe(no())),hh=xe(Xp),ru=K(Symbol.for("@effect/io/FiberRef/currentLogSpan"),()=>xe(cr())),go=K(Symbol.for("@effect/io/FiberRef/currentScheduler"),()=>xe(eh)),JS=a(2,(e,t)=>Ee(e,go,t)),dh=a(2,(e,t)=>Ee(e,aa,t)),QS=a(2,(e,t)=>Ee(e,mh,t)),ou=K(Symbol.for("@effect/io/FiberRef/currentConcurrency"),()=>xe("unbounded")),pa=K(Symbol.for("@effect/io/FiberRef/currentRequestBatching"),()=>xe(!0)),ua=K(Symbol.for("@effect/io/FiberRef/currentUnhandledErrorLogLevel"),()=>xe(d(eu))),ZS=a(2,(e,t)=>Ee(e,ua,t)),yo=fh($e()),XS=Ye(yo),sa=K(Symbol.for("@effect/io/FiberRef/currentForkScopeOverride"),()=>xe(x(),{fork:()=>x(),join:(e,t)=>e})),Fn=K(Symbol.for("@effect/io/FiberRef/currentInterruptedCause"),()=>xe(tt,{fork:()=>tt,join:(e,t)=>e})),bo=K(Symbol.for("@effect/io/FiberRef/currentTracerSpan"),()=>xe(cr())),la=K(Symbol.for("@effect/io/FiberRef/currentTracerTiming"),()=>xe(!0)),nu=K(Symbol.for("@effect/io/FiberRef/currentTracerSpanAnnotations"),()=>xe(no())),su=K(Symbol.for("@effect/io/FiberRef/currentTracerSpanLinks"),()=>xe(Xe())),iu=Symbol.for("@effect/io/Scope"),xh=Symbol.for("@effect/io/CloseableScope");var zs=(e,t)=>e.addFinalizer(t),Ko=(e,t)=>e.close(t),gh=(e,t)=>e.fork(t),yh=a(2,(e,t)=>_(Aw(e,t),De({onNone:()=>()=>k,onSome:r=>o=>Rw(r,o)(e)}))),Rw=a(3,(e,t,r)=>M(()=>{switch(e.state._tag){case"Exited":return k;case"Running":{let o=e.state.finalizers.get(t);return e.state.finalizers.delete(t),o!=null?e.state.update(o)(r):k}}})),Aw=a(2,(e,t)=>M(()=>{switch(e.state._tag){case"Exited":return e.state.nextKey+=1,Y(t(e.state.exit),x());case"Running":{let r=e.state.nextKey;return e.state.finalizers.set(r,t),e.state.nextKey+=1,h(d(r))}}}));var eE=g(()=>({state:{_tag:"Running",nextKey:0,finalizers:new Map,update:F}}));var bh=e=>e._tag==="Failure",au=e=>e._tag==="Success";var tE=a(2,(e,t)=>{switch(e._tag){case fe:return B(e.i0);case me:return ee(t)}}),fa=e=>tE(e,void 0);var Ks=(e,t)=>Tw(e,t?.parallel?Fe:Ce),cu=e=>B(Le(e));var mr=e=>B(En(e)),B=e=>{let t=new jp(fe);return t.i0=e,t},rE=a(2,(e,t)=>{switch(e._tag){case fe:return B(e.i0);case me:return t(e.i0)}});var oE=e=>rE(F)(e);var pu=e=>B(pr(e)),Up=a(2,(e,t)=>{switch(e._tag){case fe:return B(e.i0);case me:return ee(t(e.i0))}});var uu=a(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case fe:return t(e.i0);case me:return r(e.i0)}}),Pn=a(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case fe:return t(e.i0);case me:return r(e.i0)}}),ee=e=>{let t=new zp(me);return t.i0=e,t};var jr=ee(void 0);var ma=a(3,(e,t,{onFailure:r,onSuccess:o})=>{switch(e._tag){case fe:switch(t._tag){case me:return B(e.i0);case fe:return B(r(e.i0,t.i0))}case me:switch(t._tag){case me:return ee(o(e.i0,t.i0));case fe:return B(t.i0)}}}),Tw=(e,t)=>{let r=Ir(e);return Ke(r)?d(Up(o=>Array.from(o))(Up(so)(at(Up(Oe)(Be(r)),(o,n)=>ma(n,{onSuccess:(s,i)=>ve(i)(s),onFailure:t})(o))(Ge(r))))):x()},Bs=e=>({[AS]:TS,state:pt(Pp([])),blockingOn:e,pipe(){return E(this,arguments)}}),rt=()=>l(Uo,e=>nE(e)),nE=e=>g(()=>Bs(e)),Ie=e=>Dr(t=>{let r=Ct(e.state);switch(r._tag){case oa:return P(r.effect);case An:return Wt(Pp([t,...r.joiners]))(e.state),U(Mw(e,t))}},e.blockingOn),Sh=a(2,(e,t)=>Wr(t,e)),Gs=a(2,(e,t)=>g(()=>{let r=Ct(e.state);switch(r._tag){case oa:return!1;case An:{Wt(Zm(t))(e.state);for(let o=0;o<r.joiners.length;o++)r.joiners[o](t);return!0}}})),Eh=a(2,(e,t)=>Gs(e,t)),ha=a(2,(e,t)=>Gs(e,L(t)));var Nn=a(2,(e,t)=>Gs(e,D(t)));var sE=e=>l(Uo,t=>Gs(e,$p(t)));var $s=a(2,(e,t)=>Gs(e,h(t)));var Vs=(e,t)=>{let r=Ct(e.state);if(r._tag===An){Wt(Zm(t))(e.state);for(let o=r.joiners.length-1;o>=0;o--)r.joiners[o](t)}},Mw=(e,t)=>g(()=>{let r=Ct(e.state);r._tag===An&&Wt(Pp(r.joiners.filter(o=>o!==t)))(e.state)});var Dn=Ie;var iE=Eh;var aE=sE;var _h=Bs;var pE=oE;var uE=ee;var hE,vw="@effect/io/Clock",Ch=Symbol.for(vw),zr=ct(Ch),Iw=2**31-1,fE={unsafeSchedule(e,t){let r=Tr(t);if(r>Iw)return Dt;let o=!1,n=setTimeout(()=>{o=!0,e()},r);return()=>(clearTimeout(n),!o)}},mE=function(){let e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;let t="timeOrigin"in performance&&typeof performance.timeOrigin=="number"?BigInt(Math.round(performance.timeOrigin*1e6)):BigInt(Date.now())*e;return()=>t+BigInt(Math.round(performance.now()*1e6))}(),kw=function(){let e=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!e)return mE;let t=mE()-e.bigint();return()=>t+e.bigint()}(),Oh=class{constructor(){this[hE]=Ch,this.currentTimeMillis=g(()=>this.unsafeCurrentTimeMillis()),this.currentTimeNanos=g(()=>this.unsafeCurrentTimeNanos())}unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return kw()}scheduler(){return h(fE)}sleep(t){return Dr(r=>{let o=fE.unsafeSchedule(()=>r(k),t);return U(Z(g(o)))})}};hE=Ch;var dE=()=>new Oh;var lu="And",fu="Or",mu="InvalidData",hu="MissingData",du="SourceUnavailable",xu="Unsupported";var Fw="@effect/io/Config/Error",Rh=Symbol.for(Fw),Ys={[Rh]:Rh},gu=(e,t)=>{let r=Object.create(Ys);return r._tag=lu,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),r},yu=(e,t)=>{let r=Object.create(Ys);return r._tag=fu,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),r},Kr=(e,t,r={pathDelim:"."})=>{let o=Object.create(Ys);return o._tag=mu,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Invalid data at ${ro(r.pathDelim)(this.path)}: "${this.message}")`}}),o},hr=(e,t,r={pathDelim:"."})=>{let o=Object.create(Ys);return o._tag=hu,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Missing data at ${ro(r.pathDelim)(this.path)}: "${this.message}")`}}),o},gE=(e,t,r,o={pathDelim:"."})=>{let n=Object.create(Ys);return n._tag=du,n.path=e,n.message=t,n.cause=r,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Source unavailable at ${ro(o.pathDelim)(this.path)}: "${this.message}")`}}),n},bu=(e,t,r={pathDelim:"."})=>{let o=Object.create(Ys);return o._tag=xu,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${ro(r.pathDelim)(this.path)}: "${this.message}")`}}),o};var So=a(2,(e,t)=>{switch(e._tag){case lu:return gu(So(t)(e.left),So(t)(e.right));case fu:return yu(So(t)(e.left),So(t)(e.right));case mu:return Kr([...t,...e.path],e.message);case hu:return hr([...t,...e.path],e.message);case du:return gE([...t,...e.path],e.message,e.cause);case xu:return bu([...t,...e.path],e.message)}}),Pw={andCase:(e,t,r)=>t&&r,orCase:(e,t,r)=>t&&r,invalidDataCase:Dt,missingDataCase:Or,sourceUnavailableCase:Dt,unsupportedCase:Dt},yE=a(3,(e,t,r)=>{let o=[e],n=[];for(;o.length>0;){let i=o.pop();switch(i._tag){case lu:{o.push(i.right),o.push(i.left),n.push(U({_tag:"AndCase"}));break}case fu:{o.push(i.right),o.push(i.left),n.push(U({_tag:"OrCase"}));break}case mu:{n.push(P(r.invalidDataCase(t,i.path,i.message)));break}case hu:{n.push(P(r.missingDataCase(t,i.path,i.message)));break}case du:{n.push(P(r.sourceUnavailableCase(t,i.path,i.message,i.cause)));break}case xu:{n.push(P(r.unsupportedCase(t,i.path,i.message)));break}}}let s=[];for(;n.length>0;){let i=n.pop();switch(i._tag){case"Left":{switch(i.left._tag){case"AndCase":{let c=s.pop(),p=s.pop(),u=r.andCase(t,c,p);s.push(u);break}case"OrCase":{let c=s.pop(),p=s.pop(),u=r.orCase(t,c,p);s.push(u);break}}break}case"Right":{s.push(i.right);break}}}if(s.length===0)throw new Error("BUG: ConfigError.reduceWithContext - please report an issue at https://github.com/Effect-TS/io/issues");return s.pop()}),bE=e=>yE(e,void 0,Pw);var Ah=bE;var SE="@effect/io/Config/Secret",Th=Symbol.for(SE),Dw={[Th]:Th,[A](){return I(eo(this.raw))(S(SE))},[T](e){return Lw(e)&&this.raw.length===e.raw.length&&this.raw.every((t,r)=>O(t,e.raw[r]))}},Lw=e=>typeof e=="object"&&e!=null&&Th in e,Hw=e=>{let t=Object.create(Dw);return Object.defineProperty(t,"toString",{enumerable:!1,value(){return"ConfigSecret(<redacted>)"}}),Object.defineProperty(t,"raw",{enumerable:!1,value:e}),t};var EE=e=>Hw(e.split("").map(t=>t.charCodeAt(0)));var Eu="Constant",_u="Fail",da="Fallback",Ou="Described",Cu="Lazy",Ru="MapOrFail",Au="Nested",Tu="Primitive",Mu="Sequence",vu="HashMap",Iu="ZipWith";var Uw="@effect/io/Config",wu=Symbol.for(Uw),Ww={_A:e=>e},Vt={[wu]:Ww,pipe(){return E(this,arguments)}},CE=e=>{let t=Bo("a boolean property",r=>{switch(r){case"true":case"yes":case"on":case"1":return P(!0);case"false":case"no":case"off":case"0":return P(!1);default:{let o=Kr([],`Expected a boolean value, but received ${r}`);return U(o)}}});return e===void 0?t:Yt(e)(t)},RE=(e,t)=>Eo(Ze)(Fu(e,t)),Fu=(e,t)=>Eo(t===void 0?ku(e):Yt(t)(ku(e)),Rt),AE=e=>{let t=Bo("a date property",r=>{let o=Date.parse(r);return Number.isNaN(o)?U(Kr([],`Expected a date value but received ${r}`)):P(new Date(o))});return e===void 0?t:Yt(e)(t)},TE=e=>{let t=Object.create(Vt);return t._tag=_u,t.message=e,t.parse=()=>U(bu([],e)),t},ME=e=>{let t=Bo("a number property",r=>{let o=Number.parseFloat(r);return Number.isNaN(o)?U(Kr([],`Expected an number value but received ${r}`)):P(o)});return e===void 0?t:Yt(e)(t)},vE=e=>{let t=Bo("an integer property",r=>{let o=Number.parseInt(r,10);return Number.isNaN(o)?U(Kr([],`Expected an integer value but received ${r}`)):P(o)});return e===void 0?t:Yt(e)(t)},IE=e=>{let t=Js(Mh(),r=>{let o=r.toUpperCase(),n=lh.find(s=>s.label===o);return n===void 0?U(Kr([],`Expected a log level, but found: ${r}`)):P(n)});return e===void 0?t:Yt(t,e)},Eo=a(2,(e,t)=>Js(e,r=>P(t(r)))),kE=a(2,(e,t)=>Js(e,r=>{try{return P(t(r))}catch(o){return U(Kr([],o instanceof Error?o.message:`${o}`))}})),Js=a(2,(e,t)=>{let r=Object.create(Vt);return r._tag=Ru,r.original=e,r.mapOrFail=t,r}),wE=e=>t=>hr([],`Expected ${t.description} with name ${e}`),Yt=a(2,(e,t)=>{let r=Object.create(Vt);return r._tag=Au,r.name=t,r.config=e,r}),FE=a(2,(e,t)=>{let r=Object.create(Vt);return r._tag=da,r.first=e,r.second=xa(t),r.condition=Or,r}),Pu=a(2,(e,t)=>{let r=Object.create(Vt);return r._tag=da,r.first=e,r.second=xa(t.orElse),r.condition=t.if,r}),PE=e=>Pu({orElse:()=>Qs(x()),if:Ah})(Eo(d)(e)),Bo=(e,t)=>{let r=Object.create(Vt);return r._tag=Tu,r.description=e,r.parse=t,r},ku=e=>{let t=Object.create(Vt);return t._tag=Mu,t.config=e,t},NE=e=>{let t=Bo("a secret property",r=>P(EE(r)));return e===void 0?t:Yt(e)(t)},DE=(e,t)=>{let r=Eo(Fu(e),lt);return t===void 0?r:Yt(t)(r)},Mh=e=>{let t=Bo("a text property",P);return e===void 0?t:Yt(e)(t)},LE=e=>Array.isArray(e)?OE(e):Symbol.iterator in e?OE([...e]):HE(e),HE=e=>{let t=Object.entries(e),r=Eo(n=>({[t[0][0]]:n}))(t[0][1]);if(t.length===1)return r;let o=t.slice(1);for(let[n,s]of o)r=ga(s,(i,c)=>({...i,[n]:c}))(r);return r},Qs=e=>{let t=Object.create(Vt);return t._tag=Eu,t.value=e,t.parse=()=>P(e),t},xa=e=>{let t=Object.create(Vt);return t._tag=Cu,t.config=e,t},qE=e=>xa(()=>Qs(e())),UE=(e,t)=>{let r=Object.create(Vt);return r._tag=vu,r.valueConfig=e,t===void 0?r:Yt(t)(r)},vh=e=>typeof e=="object"&&e!=null&&wu in e,OE=e=>{if(e.length===0)return Qs([]);if(e.length===1)return Eo(e[0],r=>[r]);let t=Eo(e[0],r=>[r]);for(let r=1;r<e.length;r++){let o=e[r];t=ga(o,(n,s)=>[...n,s])(t)}return t},Ih=e=>vh(e)?e:HE(Object.fromEntries(Object.entries(e).map(([t,r])=>[t,Ih(r)]))),WE=a(2,(e,{message:t,validation:r})=>Js(e,o=>r(o)?P(o):U(Kr([],t)))),jE=a(2,(e,t)=>Pu(e,{orElse:()=>Qs(t),if:Ah})),zE=a(2,(e,t)=>{let r=Object.create(Vt);return r._tag=Ou,r.config=e,r.description=t,r}),KE=a(2,(e,t)=>ga(e,t,(r,o)=>[r,o])),ga=a(3,(e,t,r)=>{let o=Object.create(Vt);return o._tag=Iu,o.left=e,o.right=t,o.zip=r,o});var GE={_tag:"Empty"};var Nu=a(2,(e,t)=>{let r=Gi(t),o=e;for(;Bi(r);){let n=r.head;switch(n._tag){case"Empty":{r=r.tail;break}case"AndThen":{r=co(n.first,co(n.second,r.tail));break}case"MapName":{o=to(o,n.f),r=r.tail;break}case"Nested":{o=rr(o,n.name),r=r.tail;break}case"Unnested":{if(Vg(n.name)(Pc(o)))o=qt(o),r=r.tail;else return U(hr(o,`Expected ${n.name} to be in path in ConfigProvider#unnested`));break}}}return P(o)});var Du=(e,t)=>[...e,...t],zw="@effect/io/Config/Provider",kh=Symbol.for(zw),Zs=ct(kh),Kw="@effect/io/Config/Provider/Flat",$E=Symbol.for(Kw),Bw=e=>({[kh]:kh,pipe(){return E(this,arguments)},...e}),Gw=e=>({[$E]:$E,patch:e.patch,load:(t,r,o=!0)=>e.load(t,r,o),enumerateChildren:e.enumerateChildren}),$w=e=>Bw({load:t=>l(Jt(e,tn(),t,!1),r=>De(Pc(r),{onNone:()=>L(hr(tn(),`Expected a single value having structure: ${t}`)),onSome:h})),flattened:e}),VE=(e={})=>{let{pathDelim:t,seqDelim:r}=Object.assign({},{pathDelim:"_",seqDelim:","},e),o=p=>ro(t)(p),n=p=>p.split(t),s=()=>typeof process<"u"&&"env"in process&&typeof process.env=="object"?process.env:{};return $w(Gw({load:(p,u,f=!0)=>{let m=o(p),y=s(),b=m in y?d(y[m]):x();return l(C=>Qw(C,p,u,r,f))(mo(()=>hr(p,`Expected ${m} to exist in the process context`))(b))},enumerateChildren:p=>g(()=>{let u=s(),f=Object.keys(u),y=Array.from(f).map(b=>n(b.toUpperCase())).filter(b=>{for(let C=0;C<p.length;C++){let R=bf(C)(p),v=b[C];if(v===void 0||R!==v)return!1}return!0}).flatMap(b=>b.slice(p.length,p.length+1));return lt(y)}),patch:GE}))};var Vw=(e,t,r,o)=>{let n=_f(r.length,p=>p>=o.length?x():d([e(p),p+1])),s=_f(o.length,p=>p>=r.length?x():d([t(p),p+1])),i=Du(r,n),c=Du(o,s);return[i,c]},Jt=(e,t,r,o)=>{let n=r;switch(n._tag){case Eu:return h(Et(n.value));case Ou:return M(()=>Jt(e,t,n.config,o));case _u:return L(hr(t,n.message));case da:return mt(s=>n.condition(s)?mt(i=>L(yu(s,i)))(Jt(e,t,n.second,o)):L(s))(M(()=>Jt(e,t,n.first,o)));case Cu:return M(()=>Jt(e,t,n.config(),o));case Ru:return M(()=>l(He(s=>mo(So(t))(n.mapOrFail(s))))(Jt(e,t,n.original,o)));case Au:return M(()=>Jt(e,Du(t,Et(n.name)),n.config,o));case Tu:return l(s=>l(i=>{if(i.length===0){let c=V(()=>"<n/a>")(Qg(s));return L(wE(c))}return h(i)})(e.load(s,n,o)))(Nu(t,e.patch));case Mu:return l(s=>l(i=>i.length===0?M(()=>_(Jt(e,s,n.config,!0),Et)):_(c=>{let p=Dc(c);return p.length===0?Et(tn()):Et(p)})(He(i,c=>Jt(e,Yg(t,`[${c}]`),n.config,!0))))(l(eF)(e.enumerateChildren(s))))(Nu(t,e.patch));case vu:return M(()=>l(s=>l(i=>_(c=>{if(c.length===0)return Et(no());let p=c.map(u=>Array.from(u));return to(u=>Zc(Ef(Q(i),u)))(Zw(p))})(He(c=>Jt(e,Du(s,Et(c)),n.valueConfig,o))(i)))(e.enumerateChildren(s)))(Nu(t,e.patch)));case Iu:return M(()=>l(s=>l(i=>{if(Ae(s)&&Ae(i))return L(gu(s.left,i.left));if(Ae(s)&&Cr(i))return L(s.left);if(Cr(s)&&Ae(i))return L(i.left);if(Cr(s)&&Cr(i)){let c=ro(".")(t),p=Yw(t,c),[u,f]=Vw(p,p,to(P)(s.right),to(P)(i.right));return He(([m,y])=>_(([b,C])=>n.zip(b,C))(Zp(m,y)))(Ef(f)(u))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/io/issues")})(Hr(Jt(e,t,n.right,o))))(Hr(Jt(e,t,n.left,o))))}},Yw=(e,t)=>r=>U(hr(e,`The element at index ${r} in a sequence at path "${t}" was missing`));var Jw=(e,t)=>e.split(new RegExp(`\\s*${Xw(t)}\\s*`)),Qw=(e,t,r,o,n)=>n?mo(So(t))(He(s=>r.parse(s.trim()))(Jw(e,o))):mo(So(t))(_(Et)(r.parse(e))),Zw=e=>Object.keys(e[0]).map(t=>e.map(r=>r[t])),Xw=e=>e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&"),eF=e=>_(kc)(Hr(Vp({onFailure:()=>tn(),onSuccess:en(St)})(He(e,rF))));var tF=/^(\[(\d+)\])$/,rF=e=>{let t=e.match(tF);if(t!==null){let r=t[2];return is(oF)(r!==void 0&&r.length>0?d(r):x())}return x()};var oF=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?x():d(t)};var wh=Symbol("@effect/io/Console"),YE=ct(wh),JE={[wh]:wh,assert(e,...t){return g(()=>{console.assert(e,...t)})},clear:g(()=>{console.clear()}),count(e){return g(()=>{console.count(e)})},countReset(e){return g(()=>{console.countReset(e)})},debug(...e){return g(()=>{console.debug(...e)})},dir(e,t){return g(()=>{console.dir(e,t)})},dirxml(...e){return g(()=>{console.dirxml(...e)})},error(...e){return g(()=>{console.error(...e)})},group(e){return e?.collapsed?g(()=>console.groupCollapsed(e?.label)):g(()=>console.group(e?.label))},groupEnd:g(()=>{console.groupEnd()}),info(...e){return g(()=>{console.info(...e)})},log(...e){return g(()=>{console.log(...e)})},table(e,t){return g(()=>{console.table(e,t)})},time(e){return g(()=>console.time(e))},timeEnd(e){return g(()=>console.timeEnd(e))},timeLog(e,...t){return g(()=>{console.timeLog(e,...t)})},trace(...e){return g(()=>{console.trace(...e)})},warn(...e){return g(()=>{console.warn(...e)})},withGroup(e,t){return Kt(t?.collapsed?g(()=>console.groupCollapsed(t?.label)):g(()=>console.group(t?.label)),()=>e,()=>g(()=>console.groupEnd()))},withTime(e,t){return Kt(g(()=>console.time(t)),()=>e,()=>g(()=>console.timeEnd(t)))}};var QE,iF="@effect/io/Random",Ph=Symbol.for(iF),Nh=ct(Ph),Fh=class{constructor(t){this.seed=t,this[QE]=Ph,this.PRNG=new os(t)}next(){return g(()=>this.PRNG.number())}nextBoolean(){return _(this.next(),t=>t>.5)}nextInt(){return g(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,r){return _(this.next(),o=>(r-t)*o+t)}nextIntBetween(t,r){return g(()=>this.PRNG.integer(r-t)+t)}shuffle(t){return aF(t,r=>this.nextIntBetween(0,r+1))}};QE=Ph;var aF=(e,t)=>M(()=>l(r=>{let o=[];for(let n=r.length;n>=2;n=n-1)o.push(n);return Y(Ir(r))(dt(n=>_(s=>cF(r,n-1,s))(t(n)))(o))})(g(()=>Array.from(e)))),cF=(e,t,r)=>{let o=e[t];return e[t]=e[r],e[r]=o,e},ZE=e=>new Fh(e);var XE=Symbol.for("@effect/io/Tracer"),uF=e=>({[XE]:XE,...e}),Xs=ct(Symbol.for("@effect/io/Tracer")),lF=K("@effect/io/Tracer/SpanId.ids",()=>pt(0)),Dh=class{constructor(t,r,o,n,s){this.name=t,this.parent=r,this.context=o,this.links=n,this.startTime=s,this._tag="Span",this.traceId="native",this.events=[],this.end=(i,c)=>{this.status={_tag:"Ended",endTime:i,exit:c,startTime:this.status.startTime}},this.attribute=(i,c)=>{this.attributes.set(i,c)},this.event=(i,c,p)=>{this.events.push([i,c,p??{}])},this.status={_tag:"Started",startTime:s},this.attributes=new Map,this.spanId=`span${Jy(lF)}`}},e_=uF({span:(e,t,r,o,n)=>new Dh(e,t,r,o,n)});var fF=Me(Xs,e_)(Me(Zs,VE())(Me(Nh,ZE(Math.random()*4294967296>>>0))(Me(YE,JE)(Me(zr,dE())(_t()))))),ot=tu(fF),r_=e=>{let t=ze(e);return ya(r=>r.sleep(t))},ya=e=>Se(ot,t=>e(Ar(t,zr))),o_=ya(e=>e.currentTimeMillis),n_=ya(e=>e.currentTimeNanos),s_=a(2,(e,t)=>qe(ot,Me(zr,t))(e)),i_=a(2,(e,t)=>qe(ot,Me(Zs,t))(e)),Lh=e=>Se(ot,t=>e(Ar(t,Zs))),a_=e=>Lh(t=>t.load(e));var Lu=e=>Se(ot,t=>e(Ar(t,Nh)));var Hu=e=>Se(ot,t=>e(Ar(t,Xs))),c_=a(2,(e,t)=>qe(ot,Me(Xs,t))(e));var Hh=r_,qu=o_,qh=n_,p_=ya;var l_;function f_(e){return new Ln(e)}var Uh=Symbol.for("@effect/io/FiberRefs"),Ln=class{constructor(t){this.locals=t,this[l_]=Uh}pipe(){return E(this,arguments)}};l_=Uh;var mF=(e,t,r,o=!1)=>{let n=e,s=t,i=r,c=o,p;for(;p===void 0;)if(Rr(s)&&Rr(i)){let u=_e(s)[0],f=qt(s),m=_e(i)[0],y=_e(i)[1],b=qt(i);u.startTimeMillis<m.startTimeMillis?(i=b,c=!0):u.startTimeMillis>m.startTimeMillis?s=f:u.id<m.id?(i=b,c=!0):u.id>m.id?s=f:p=[y,c]}else p=[n.initial,!0];return p},Uu=a(3,(e,t,r)=>{let o=new Map(e.locals);for(let[n,s]of r.locals){let i=_e(s)[1];if(!O(_e(s)[0],t)){if(!o.has(n)){if(O(i,n.initial))continue;o.set(n,[[t,n.join(n.initial,i)]]);continue}let c=o.get(n),[p,u]=mF(n,c,s);if(u){let f=n.diff(p,i),m=_e(c)[1],y=n.join(m,n.patch(f)(m));if(!O(m,y)){let b,C=_e(c)[0];O(C,t)?b=rr([C,y])(qt(c)):b=rr([t,y])(c),o.set(n,b)}}}}return new Ln(new Map(o))}),Wu=a(2,(e,t)=>{let r=new Map;for(let[o,n]of e.locals.entries()){let s=_e(n)[1],i=o.patch(o.fork)(s);O(s,i)?r.set(o,n):r.set(o,rr([t,i])(n))}return new Ln(r)}),m_=e=>lt(e.locals.keys()),h_=e=>dt(m_(e),t=>Tn(t,ei(e,t))),Sa=a(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new Ln(r)}),Ea=a(2,(e,t)=>e.locals.has(t)?d(_e(e.locals.get(t))[1]):x()),ei=a(2,(e,t)=>V(()=>t.initial)(Ea(e,t))),Hn=a(2,(e,{fiberId:t,fiberRef:r,value:o})=>{let n=e.locals.has(r)?e.locals.get(r):tn(),s;if(yf(n))s=Et([t,o]);else{let[c,p]=_e(n);if(O(c,t)){if(O(p,o))return e;s=rr([t,o])(qt(n))}else s=rr([t,o])(n)}let i=new Map(e.locals);return new Ln(i.set(r,s))});var d_=Wu;var x_=Uu,g_=h_,jh=Hn,y_=f_;var S_="Empty",E_="Add",__="Remove",O_="Update",C_="AndThen",R_={_tag:S_},zu=(e,t)=>{let r=new Map(e.locals),o=R_;for(let[n,s]of t.locals.entries()){let i=_e(s)[1],c=r.get(n);if(c!==void 0){let p=_e(c)[1];O(p,i)||(o=ju({_tag:O_,fiberRef:n,patch:n.diff(p,i)})(o))}else o=ju({_tag:E_,fiberRef:n,value:i})(o);r.delete(n)}for(let[n]of r.entries())o=ju({_tag:__,fiberRef:n})(o);return o},ju=a(2,(e,t)=>({_tag:C_,first:e,second:t})),Ku=a(3,(e,t,r)=>{let o=r,n=Et(e);for(;Rr(n);){let s=_e(n),i=qt(n);switch(s._tag){case S_:{n=i;break}case E_:{o=Hn(o,{fiberId:t,fiberRef:s.fiberRef,value:s.value}),n=i;break}case __:{o=Sa(o,s.fiberRef),n=i;break}case O_:{let c=ei(o,s.fiberRef);o=Hn(o,{fiberId:t,fiberRef:s.fiberRef,value:s.fiberRef.patch(s.patch)(c)}),n=i;break}case C_:{n=rr(s.first)(rr(s.second)(i));break}}}return o});var T_,M_="@effect/io/Metric/Label",zh=Symbol.for(M_),Kh=class{constructor(t,r){this.key=t,this.value=r,this[T_]=zh}[(T_=zh,A)](){return I(S(this.value))(I(S(this.key))(S(M_)))}[T](t){return hF(t)&&this.key===t.key&&this.value===t.value}pipe(){return E(this,arguments)}},Bu=(e,t)=>new Kh(e,t),hF=e=>typeof e=="object"&&e!=null&&zh in e;var Gu=class e{constructor(t){this.self=t,this.called=!1}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new e(this.self)}};var xF=sh,Bh=ih,Gh=ah,$h=ch,Vh=Xp,Yh=eu,Jh=ph,gF=uh;var yF=vi(e=>e.ordinal)(St);var I_=tf(yF);var k_=e=>{switch(e){case"All":return xF;case"Debug":return Yh;case"Error":return Gh;case"Fatal":return Bh;case"Info":return Vh;case"Trace":return Jh;case"None":return gF;case"Warning":return $h}};var F_=(e,t)=>({label:e,startTime:t}),P_=e=>t=>`${t.label.replace(/[\s="]/g,"_")}=${e-t.startTime}ms`;var N_=F_,D_=P_;var H_,$u=Symbol.for("@effect/io/Ref"),Zh={_A:e=>e},Qh=class{constructor(t){this.ref=t,this[H_]=Zh}modify(t){return g(()=>{let r=Ct(this.ref),[o,n]=t(r);return r!==n&&Wt(n)(this.ref),o})}pipe(){return E(this,arguments)}};H_=$u;var Vu=e=>new Qh(pt(e)),qn=e=>g(()=>Vu(e)),dr=e=>e.modify(t=>[t,t]),Br=a(2,(e,t)=>e.modify(()=>[void 0,t])),q_=a(2,(e,t)=>e.modify(r=>[r,t]));var Yu=a(2,(e,t)=>e.modify(t));var _a=a(2,(e,t)=>e.modify(r=>[void 0,t(r)]));var Oa=qn,Qu=dr,U_=q_;var W_=Yu;var j_=_a;var K_=Hu;var B_=a(e=>de(e[0]),function(){let e=arguments;return qe(e[0],ca,typeof e[1]=="string"?vr(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[o,n])=>vr(r,o,n),t))}),Zu=e=>_(e,d),G_=e=>mo(e,d),$_=(e,t=et)=>Dr(r=>{let o=e(r);switch(o._tag){case"None":return U(k);case"Some":return P(o.value)}},t),Ca=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),g(()=>{try{return t()}catch(o){throw LS(En(r?r(o):o))}})},V_=a(3,(e,t,r)=>mt(e,o=>typeof o=="object"&&o!=null&&t in o&&o[t]===r.failure?r.onFailure(o):L(o))),Y_=a(2,(e,t)=>Lr(e,Ho(r=>{let o=Ji(r,n=>Sp(n)?d(n):x());switch(o._tag){case"None":return D(r);case"Some":return t(o.value.defect)}}))),J_=a(2,(e,t)=>J(e,{onFailure:r=>{let o=t(r);switch(o._tag){case"None":return D(r);case"Some":return o.value}},onSuccess:h})),Q_=a(2,(e,t)=>Lr(e,Ho(r=>{let o=Ji(r,n=>Sp(n)?d(n):x());switch(o._tag){case"None":return D(r);case"Some":{let n=t(o.value.defect);return n._tag==="Some"?n.value:D(r)}}}))),Z_=a(3,(e,t,r)=>mt(e,o=>pe(o)&&"_tag"in o&&o._tag===t?r(o):L(o))),X_=a(2,(e,t)=>mt(e,r=>{let o=Object.keys(t);return pe(r)&&"_tag"in r&&o.includes(r._tag)?t[r._tag](r):L(r)})),eO=e=>ia(e,{onFailure:F,onSuccess:()=>tt}),Gr=p_,tO=Gr(h),rO=a(2,(e,t)=>j(Hh(t),e)),Xu=e=>ue((t,r)=>e({id:t.id(),status:r,interruptors:Yi(t.getFiberRef(Fn))})),oO=Xu(e=>ao(e.interruptors)>0?Gp:k),nO=Xu(h),Un=e=>el(e,td,zu),sO=h({}),iO=a(3,(e,t,r)=>l(e,o=>_(r(o),n=>({...o,[t]:n})))),aO=a(2,(e,t)=>_(e,r=>({[t]:r}))),cO=a(3,(e,t,r)=>_(e,o=>({...o,[t]:r(o)}))),pO=a(2,(e,t)=>M(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!1),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>u?(o.push(c),h(!0)):t(c,p))}return _(s,()=>o)})),uO=a(2,(e,t)=>M(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!0),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>_(u?t(c,p):h(!1),f=>(f||o.push(c),f)))}return _(s,()=>o)})),lO=e=>_(qr(),e),ed=e=>Mn(e,()=>l(vt(),()=>ed(e)));var fO=a(3,(e,t,r)=>Ra(e,t,()=>qo(r))),mO=a(3,(e,t,r)=>Ra(e,t,()=>Ds(r))),Ra=a(3,(e,t,r)=>l(e,o=>t(o)?h(o):r(o))),hO=a(3,(e,t,r)=>Ra(e,t,o=>lr(()=>r(o)))),dO=a(2,(e,t)=>M(()=>{let r=e[Symbol.iterator](),o=r.next();return o.done?h(x()):xO(r,0,t,o.value)})),xO=(e,t,r,o)=>l(r(o,t),n=>{if(n)return h(d(o));let s=e.next();return s.done?h(x()):xO(e,t+1,r,s.value)}),gO=e=>M(()=>{let t=Ir(e);return Ke(t)?at(Be(t),(r,o)=>Mn(r,()=>o))(Ge(t)):qo(()=>As("Received an empty collection of effects"))}),yO=a(2,(e,t)=>Wo(t(Wo(e)))),Aa=a(2,(e,{onFailure:t,onSuccess:r})=>ie(e,{onFailure:o=>h(t(o)),onSuccess:o=>h(r(o))})),bO=a(2,(e,t)=>M(()=>SO(e[Symbol.iterator](),0,t))),SO=(e,t,r)=>{let o=e.next();return o.done?h(!0):l(r(o.value,t),n=>n?SO(e,t+1,r):h(n))},EO=e=>{let t=l(l(e,()=>vt()),()=>t);return t},Xh=class{constructor(t){this.value=t}[Symbol.iterator](){return new Gu(this)}},EF=function(){let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return new Xh(e)},_O=e=>M(()=>{let t=e(EF),r=t.next(),o=n=>n.done?h(n.value):l(s=>o(t.next(s)))(n.value.value);return o(r)}),td=ue(e=>h(e.unsafeGetFiberRefs())),OO=e=>ie(e,{onFailure:t=>L(d(t)),onSuccess:t=>{let o=t[Symbol.iterator]().next();return o.done?L(x()):h(o.value)}}),CO=e=>Aa(e,{onFailure:ts,onSuccess:ts}),RO=e=>J(e,{onFailure:t=>od(t,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>k}),AO=e=>tl((t,r)=>x_(r,t,e)),TO=e=>Aa(e,{onFailure:Or,onSuccess:Dt}),MO=e=>Aa(e,{onFailure:Dt,onSuccess:Or}),rd=(e,t)=>M(()=>t.while(e)?l(t.body(e),r=>rd(r,t)):h(e)),Wn=e=>(t,r)=>{let o=Ht(e),n,s;return bp(t)?(s=t,n=r??""):(n=t,s=r??tt),ue(i=>(i.log(n,s,o),k))},vO=Wn(),IO=Wn(Jh),od=Wn(Yh),kO=Wn(Vh),wO=Wn($h),FO=Wn(Gh),PO=Wn(Bh),NO=a(2,(e,t)=>l(qu,r=>qe(e,ru,Fo(N_(t,r))))),DO=Ye(ca),LO=(e,t)=>t.discard?qO(e,t.while,t.step,t.body):_(HO(e,t.while,t.step,t.body),r=>Array.from(r)),HO=(e,t,r,o)=>M(()=>t(e)?l(o(e),n=>_(HO(r(e),t,r,o),Fo(n))):g(()=>cr())),qO=(e,t,r,o)=>M(()=>t(e)?l(o(e),()=>qO(r(e),t,r,o)):k),UO=a(3,(e,t,r)=>M(()=>{let o=e[Symbol.iterator](),n=[],s=h(t),i,c=0;for(;!(i=o.next()).done;){let p=c++;s=l(s,u=>_(r(u,i.value,p),([f,m])=>(n.push(m),f)))}return _(s,p=>[p,n])})),ti=a(2,(e,t)=>J(e,{onFailure:r=>Ur(()=>t(r)),onSuccess:h})),nd=e=>l(t=>_(r=>j(r,l(([o,n])=>Y(jn(o),n))(Ie(t))))(sd(Wr(t)(Un(e)))))(rt()),WO=e=>ie(e,{onFailure:t=>h(t),onSuccess:h}),Ta=e=>_(e,t=>!t),jO=e=>ie(e,{onFailure:t=>L(d(t)),onSuccess:t=>{switch(t._tag){case"None":return k;case"Some":return L(x())}}}),sd=e=>_(Oa(!0),t=>Z(Us(e,U_(t,!1)))),zO=e=>ie(e,{onFailure:()=>h(x()),onSuccess:t=>h(d(t))}),KO=a(2,(e,t)=>Mn(e,()=>lr(t))),BO=a(2,(e,t)=>Mn(e,()=>g(t))),GO=e=>J(e,{onFailure:t=>{let r=Array.from(Vi(t));return r.length===0?D(t):L(r)},onSuccess:h}),jn=e=>tl((t,r)=>Ku(t,r)(e)),$O=e=>e.length>=1?Bt((t,r)=>{e(r).then(o=>t(ee(o))).catch(o=>t(cu(o)))}):Bt(t=>{e().then(r=>t(ee(r))).catch(r=>t(cu(r)))}),VO=a(3,(e,t,r)=>id(e,t,h(r))),id=a(3,(e,t,r)=>Ls(o=>l(r,n=>Tt(e,Me(t,n)(o))))),YO=Lu(h),JO=a(3,(e,t,r)=>Q(e).reduce((o,n,s)=>l(o,i=>r(i,n,s)),h(t))),QO=a(3,(e,t,r)=>Q(e).reduceRight((o,n,s)=>l(o,i=>r(n,i,s)),h(t))),ZO=a(3,(e,t,r)=>l(g(()=>e[Symbol.iterator]()),o=>XO(o,0,t,r.while,r.body))),XO=(e,t,r,o,n)=>{let s=e.next();return!s.done&&o(r)?l(n(r,s.value,t),i=>XO(e,t+1,i,o,n)):h(r)},eC=a(2,(e,t)=>M(()=>tC(e,t))),tC=(e,t)=>l(e,r=>t<=0?h(r):j(vt(),tC(e,t-1))),rC=e=>J(e,{onFailure:L,onSuccess:h}),oC=e=>M(()=>g_(e)),ri=Hh,nC=e=>ie(e,{onFailure:t=>L(d(t)),onSuccess:t=>{switch(t._tag){case"None":return L(x());case"Some":return h(t.value)}}}),oi=h(x()),ad=e=>h(d(e)),el=a(3,(e,t,r)=>l(t,o=>l(e,n=>_(t,s=>[r(o,s),n])))),sC=a(3,(e,t,r)=>cd(e,[Bu(t,r)])),cd=a(2,(e,t)=>pd(e,lt(t))),pd=a(2,(e,t)=>qe(yo,r=>Ve(t)(r))(e)),iC=a(2,(e,t)=>M(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!1),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>u?h(!0):(o.push(c),t(c,p)))}return _(s,()=>o)})),aC=a(2,(e,t)=>M(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!0),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>_(f=>(f&&o.push(c),f))(u?t(c,p):h(!1)))}return _(s,()=>o)})),cC=a(2,(e,{onFailure:t,onSuccess:r})=>J(e,{onFailure:o=>{let n=po(o);switch(n._tag){case"Left":return j(t(n.left),D(o));case"Right":return D(o)}},onSuccess:o=>Y(r(o),o)})),pC=a(2,(e,t)=>Lr(e,r=>De(Pm(r),{onNone:()=>D(r),onSome:o=>j(t(o),D(r))}))),ud=a(2,(e,t)=>J(e,{onFailure:r=>{let o=po(r);switch(o._tag){case"Left":return j(t(o.left),D(r));case"Right":return D(r)}},onSuccess:h})),uC=a(3,(e,t,r)=>ud(e,o=>pe(o)&&"_tag"in o&&o._tag===t?r(o):k)),lC=a(2,(e,t)=>J(e,{onFailure:r=>j(t(r),D(r)),onSuccess:h})),fC=e=>ld(e,qh),ld=a(2,(e,t)=>el(e,t,(r,o)=>Uc(o-r))),mC=K_,hC=mC(h),fd=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),t.length>=1?M(()=>{let o=new AbortController;return l(Ca(()=>t(o.signal)),n=>Bt(s=>(n.then(i=>s(ee(i))).catch(i=>s(mr(r?r(i):i))),g(()=>o.abort()))))}):l(Ca(e),o=>Bt(n=>{o.then(s=>n(ee(s))).catch(s=>n(mr(r?r(s):s)))}))},dC=a(2,(e,t)=>l(e,r=>Ca({try:()=>t.try(r),catch:t.catch}))),xC=a(2,(e,t)=>l(e,r=>fd({try:t.try.length>=1?o=>t.try(r,o):()=>t.try(r),catch:t.catch}))),gC=a(2,(e,t)=>M(()=>t()?oi:Zu(e))),yC=a(2,(e,t)=>l(t,r=>r?oi:Zu(e))),bC=e=>ti(e,Nm),tl=e=>ue(t=>(t.setFiberRefs(e(t.id(),t.unsafeGetFiberRefs())),k)),SC=a(3,(e,t,r)=>In(e,o=>Me(o,t,r(cs(o,t))))),rl=a(2,(e,t)=>M(()=>t()?_(e,d):h(x()))),EC=a(3,(e,t,r)=>l(Ye(t),o=>r(o)?_(e,n=>[o,d(n)]):h([o,x()]))),_C=a(3,(e,t,r)=>l(Qu(t),o=>r(o)?_(e,n=>[o,d(n)]):h([o,x()]))),OC=a(2,(e,t)=>t(e)),CC=(e,t)=>(...r)=>l(e,o=>t(o)(...r)),RC=(e,t)=>(...r)=>_(e,o=>t(o)(...r)),md=e=>new Proxy({},{get(t,r,o){return(...n)=>l(e,s=>s[r](...n))}}),hd=e=>new Proxy({},{get(t,r,o){return l(e,n=>n[r])}}),AC=e=>({functions:md(e),constants:hd(e)}),TC=function(){let e=arguments;return l(xd,t=>t._tag==="Some"?g(()=>{if(typeof e[0]=="string")t.value.attribute(e[0],e[1]);else for(let r in e[0])t.value.attribute(r,e[0][r])}):k)},MC=a(e=>de(e[0]),function(){let e=arguments;return qe(e[0],nu,typeof e[1]=="string"?vr(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[o,n])=>vr(r,o,n),t))}),dd=_(Ye(bo),pp),xd=_(Ye(bo),Hb(e=>e._tag==="Span")),_F=BigInt(0),ol=Se(la,e=>e?qh:h(_F)),vC=a(e=>de(e[0]),(e,t,r)=>qe(e,su,rp({_tag:"SpanLink",span:t,attributes:r??{}}))),ni=(e,t)=>mC(r=>l(t?.parent?ad(t.parent):t?.root?oi:dd,o=>l(Ye(nu),n=>l(Ye(su),s=>l(ol,i=>g(()=>{let c=t?.links?[...Ze(s),...t.links]:Ze(s),p=r.span(e,o,t?.context??_t(),c,i);return Yy(n,(u,f)=>p.attribute(f,u)),Object.entries(t?.attributes??{}).forEach(([u,f])=>p.attribute(u,f)),p})))))),IC=Ye(nu),kC=Ye(su),gd=(e,...t)=>{let r=t.length===1?void 0:t[0],o=t[t.length-1];return Kt(ni(e,r),o,(n,s)=>l(ol,i=>g(()=>n.end(i,s))))},yd=a(2,(e,t)=>qe(e,bo,Fo(t))),wC=a(e=>typeof e[0]!="string",(e,t,r)=>gd(t,r??{},o=>yd(e,o))),FC=e=>M(()=>{let t=e();return t==null?L(uo()):h(t)}),PC=e=>mt(_(e,d),t=>Hm(t)?oi:L(t));var NC,DC,LC,nl="@effect/io/Fiber/Status",Go=Symbol.for(nl),bd="Done",HC="Running",qC="Suspended",Sd=class{constructor(){this[NC]=Go,this._tag=bd}[(NC=Go,A)](){return I(S(this._tag))(S(nl))}[T](t){return sl(t)&&t._tag===bd}},Ed=class{constructor(t){this.runtimeFlags=t,this[DC]=Go,this._tag=HC}[(DC=Go,A)](){return I(S(this.runtimeFlags))(I(S(this._tag))(S(nl)))}[T](t){return sl(t)&&t._tag===HC&&this.runtimeFlags===t.runtimeFlags}},_d=class{constructor(t,r){this.runtimeFlags=t,this.blockingOn=r,this[LC]=Go,this._tag=qC}[(LC=Go,A)](){return I(S(this.blockingOn))(I(S(this.runtimeFlags))(I(S(this._tag))(S(nl))))}[T](t){return sl(t)&&t._tag===qC&&this.runtimeFlags===t.runtimeFlags&&O(this.blockingOn,t.blockingOn)}},UC=new Sd,WC=e=>new Ed(e),jC=(e,t)=>new _d(e,t),sl=e=>typeof e=="object"&&e!=null&&Go in e,zC=e=>e._tag===bd;var KC=UC,Od=WC,BC=jC;var GC=zC;var ii=zu;var Cd=Ku;var il=K(Symbol.for("@effect/io/FiberRef/currentRequestMap"),()=>xe(new Map));var Rd=(e,t,r,o)=>{switch(e?.concurrency){case void 0:return t();case"unbounded":return r();case"inherit":return Se(ou,n=>n==="unbounded"?r():n>1?o(n):t());default:return e.concurrency>1?o(e.concurrency):t()}},Ma=(e,t,r)=>{switch(e?.concurrency){case void 0:return t();case"unbounded":return r();case"inherit":return Se(ou,o=>o==="unbounded"||o>1?r():t());default:return e.concurrency>1?r():t()}};var VC="Sequential",YC="Parallel";var ai={_tag:VC},JC={_tag:YC};var QC=e=>e._tag===VC,ZC=e=>e._tag===YC;var al="InterruptSignal",cl="Stateful",pl="Resume",ul="YieldNow",Ad=e=>({_tag:al,cause:e}),ci=e=>({_tag:cl,onFiber:e}),zn=e=>({_tag:pl,effect:e}),eR=()=>({_tag:ul});var rR,oR,TF="@effect/io/Fiber/Scope",ll=Symbol.for(TF),Td=class{constructor(){this[rR]=ll,this.fiberId=et,this.roots=new Set}add(t,r){this.roots.add(r),r.unsafeAddObserver(()=>{this.roots.delete(r)})}};rR=ll;var Md=class{constructor(t,r){this.fiberId=t,this.parent=r,this[oR]=ll}add(t,r){this.parent.tell(ci(o=>{o.addChild(r),r.unsafeAddObserver(()=>{o.removeChild(r)})}))}};oR=ll;var nR=e=>new Md(e.id(),e),Kn=K(Symbol.for("@effect/io/FiberScope/Global"),()=>new Td);var MF="@effect/io/Fiber",va=Symbol.for(MF),Ia={_E:e=>e,_A:e=>e},vF={[va]:Ia,pipe(){return E(this,arguments)}},IF="@effect/io/Fiber",iR=Symbol.for(IF);var vd=e=>e.await();var aR=e=>e.inheritAll();var cR=a(2,(e,t)=>e.interruptAsFork(t)),Bn=e=>Ws(ht(e.await()),e.inheritAll());var mB={...vF,id:()=>et,await:()=>wn,children:()=>h([]),inheritAll:()=>wn,poll:()=>h(x()),interruptAsFork:()=>wn};var $o="@effect/io/Fiber/Current";var kF="@effect/io/Logger",uR=Symbol.for(kF),lR={_Message:e=>e,_Output:e=>e},fl=e=>({[uR]:lR,log:e,pipe(){return E(this,arguments)}});var xB={[uR]:lR,log:ts,pipe(){return E(this,arguments)}};var fR=fl(({annotations:e,cause:t,date:r,fiberId:o,logLevel:n,message:s,spans:i})=>{let c=r.getTime(),u=[`timestamp=${r.toISOString()}`,`level=${n.label}`,`fiber=${hp(o)}`].join(" "),f=wF(s);if(f.length>0&&(u=u+" message=",u=Id(f,u)),t!=null&&t!=tt&&(u=u+" cause=",u=Id(lo(t),u)),Bi(i)){u=u+" ";let m=!0;for(let y of i)m?m=!1:u=u+" ",u=u+D_(c)(y)}if(Xc(e)>0){u=u+" ";let m=!0;for(let[y,b]of e)m?m=!1:u=u+" ",u=u+NF(y),u=u+"=",u=Id(String(b),u)}return u}),wF=e=>{try{return typeof e=="object"?JSON.stringify(e):String(e)}catch{return String(e)}},FF=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,PF=/^[^\s"=]+$/,Id=(e,t)=>t+(e.match(PF)?e:FF(e));var NF=e=>e.replace(/[\s="]/g,"_");var mR,hR="@effect/io/Metric/Boundaries",kd=Symbol.for(hR),wd=class{constructor(t){this.values=t,this[mR]=kd}[(mR=kd,A)](){return I(S(this.values))(S(hR))}[T](t){return LF(t)&&O(this.values,t.values)}pipe(){return E(this,arguments)}},LF=e=>typeof e=="object"&&e!=null&&kd in e,HF=e=>{let t=ob(ar(Oe(Number.POSITIVE_INFINITY))(e));return new wd(t)};var dR=e=>HF(Rt(gf(e.count-1,t=>e.start*Math.pow(e.factor,t))));var xR,gR,yR,bR,SR,ER,_R,OR,CR,RR,UF="@effect/io/Metric/KeyType",ka=Symbol.for(UF),vR="effect/io/Metric/KeyType/Counter",Fd=Symbol.for(vR),IR="effect/io/Metric/KeyType/Frequency",Pd=Symbol.for(IR),kR="effect/io/Metric/KeyType/Gauge",Nd=Symbol.for(kR),wR="effect/io/Metric/KeyType/Histogram",Dd=Symbol.for(wR),FR="effect/io/Metric/KeyType/Summary",Ld=Symbol.for(FR),wa={_In:e=>e,_Out:e=>e},Hd=class{constructor(){this[xR]=wa,this[gR]=Fd}[(xR=ka,gR=Fd,A)](){return S(vR)}[T](t){return Ud(t)}pipe(){return E(this,arguments)}},AR=class{constructor(){this[yR]=wa,this[bR]=Pd}[(yR=ka,bR=Pd,A)](){return S(IR)}[T](t){return Wd(t)}pipe(){return E(this,arguments)}},TR=class{constructor(){this[SR]=wa,this[ER]=Nd}[(SR=ka,ER=Nd,A)](){return S(kR)}[T](t){return jd(t)}pipe(){return E(this,arguments)}},qd=class{constructor(t){this.boundaries=t,this[_R]=wa,this[OR]=Dd}[(_R=ka,OR=Dd,A)](){return I(S(this.boundaries))(S(wR))}[T](t){return zd(t)&&O(this.boundaries,t.boundaries)}pipe(){return E(this,arguments)}},MR=class{constructor(t,r,o,n){this.maxAge=t,this.maxSize=r,this.error=o,this.quantiles=n,this[CR]=wa,this[RR]=Ld}[(CR=ka,RR=Ld,A)](){return I(S(this.quantiles))(I(S(this.error))(I(S(this.maxSize))(I(S(this.maxAge))(S(FR)))))}[T](t){return Kd(t)&&O(this.maxAge,t.maxAge)&&this.maxSize===t.maxSize&&this.error===t.error&&O(this.quantiles,t.quantiles)}pipe(){return E(this,arguments)}},PR=new Hd;var NR=e=>new qd(e);var Ud=e=>typeof e=="object"&&e!=null&&Fd in e,Wd=e=>typeof e=="object"&&e!=null&&Pd in e,jd=e=>typeof e=="object"&&e!=null&&Nd in e,zd=e=>typeof e=="object"&&e!=null&&Dd in e,Kd=e=>typeof e=="object"&&e!=null&&Ld in e;var LR,WF="@effect/io/Metric/Key",HR=Symbol.for(WF),jF={_Type:e=>e},Fa=class{constructor(t,r,o,n=$e()){this.name=t,this.keyType=r,this.description=o,this.tags=n,this[LR]=jF}[(LR=HR,A)](){return I(S(this.tags))(I(S(this.description))(I(S(this.keyType))(S(this.name))))}[T](t){return zF(t)&&this.name===t.name&&O(this.keyType,t.keyType)&&O(this.description,t.description)&&O(this.tags,t.tags)}pipe(){return E(this,arguments)}},zF=e=>typeof e=="object"&&e!=null&&HR in e,qR=(e,t)=>new Fa(e,PR,Ht(t));var UR=(e,t,r)=>new Fa(e,NR(t),Ht(r));var WR=a(2,(e,t)=>ao(t)===0?e:new Fa(e.name,e.keyType,e.description,Ve(t)(e.tags)));var jR,zR,KR,BR,GR,$R,VR,YR,JR,QR,BF="@effect/io/Metric/State",Pa=Symbol.for(BF),ZR="effect/io/Metric/State/Counter",Bd=Symbol.for(ZR),XR="effect/io/Metric/State/Frequency",Gd=Symbol.for(XR),eA="effect/io/Metric/State/Gauge",$d=Symbol.for(eA),tA="effect/io/Metric/State/Histogram",Vd=Symbol.for(tA),rA="effect/io/Metric/State/Summary",Yd=Symbol.for(rA),Na={_A:e=>e},Jd=class{constructor(t){this.count=t,this[jR]=Na,this[zR]=Bd}[(jR=Pa,zR=Bd,A)](){return I(S(this.count))(S(ZR))}[T](t){return GF(t)&&this.count===t.count}pipe(){return E(this,arguments)}},Qd=class{constructor(t){this.occurrences=t,this[KR]=Na,this[BR]=Gd}[(KR=Pa,BR=Gd,A)](){return I(S(this.occurrences))(S(XR))}[T](t){return $F(t)&&O(this.occurrences,t.occurrences)}pipe(){return E(this,arguments)}},Zd=class{constructor(t){this.value=t,this[GR]=Na,this[$R]=$d}[(GR=Pa,$R=$d,A)](){return I(S(this.value))(S(eA))}[T](t){return VF(t)&&this.value===t.value}pipe(){return E(this,arguments)}},Xd=class{constructor(t,r,o,n,s){this.buckets=t,this.count=r,this.min=o,this.max=n,this.sum=s,this[VR]=Na,this[YR]=Vd}[(VR=Pa,YR=Vd,A)](){return I(S(this.sum))(I(S(this.max))(I(S(this.min))(I(S(this.count))(I(S(this.buckets))(S(tA))))))}[T](t){return YF(t)&&O(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return E(this,arguments)}},ex=class{constructor(t,r,o,n,s,i){this.error=t,this.quantiles=r,this.count=o,this.min=n,this.max=s,this.sum=i,this[JR]=Na,this[QR]=Yd}[(JR=Pa,QR=Yd,A)](){return I(S(this.sum))(I(S(this.max))(I(S(this.min))(I(S(this.count))(I(S(this.quantiles))(I(S(this.error))(S(rA)))))))}[T](t){return JF(t)&&this.error===t.error&&O(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return E(this,arguments)}},oA=e=>new Jd(e),nA=e=>new Qd(e),sA=e=>new Zd(e),iA=e=>new Xd(e.buckets,e.count,e.min,e.max,e.sum),aA=e=>new ex(e.error,e.quantiles,e.count,e.min,e.max,e.sum);var GF=e=>typeof e=="object"&&e!=null&&Bd in e,$F=e=>typeof e=="object"&&e!=null&&Gd in e,VF=e=>typeof e=="object"&&e!=null&&$d in e,YF=e=>typeof e=="object"&&e!=null&&Vd in e,JF=e=>typeof e=="object"&&e!=null&&Yd in e;var ZF="@effect/io/Metric/Hook",XF=Symbol.for(ZF),e0={_In:e=>e,_Out:e=>e},Da=e=>({[XF]:e0,pipe(){return E(this,arguments)},...e});var pA=e=>{let t=0;return Da({get:()=>oA(t),update:r=>{t=t+r}})},uA=e=>{let t=0,r=new Map,o=s=>{t=t+1;let i=r.get(s)??0;r.set(s,i+1)},n=()=>Zc(r.entries());return Da({get:()=>nA(n()),update:o})},lA=(e,t)=>{let r=t;return Da({get:()=>sA(r),update:o=>{r=o}})},fA=e=>{let t=e.keyType.boundaries.values,r=t.length,o=new Uint32Array(r+1),n=new Float32Array(r),s=0,i=0,c=Number.MAX_VALUE,p=Number.MIN_VALUE;Zf((m,y)=>{n[y]=m})(op(St)(t));let u=m=>{let y=0,b=r;for(;y!==b;){let C=Math.floor(y+(b-y)/2),R=n[C];m<=R?b=C:y=C,b===y+1&&(m<=n[y]?b=y:y=b)}o[y]=o[y]+1,s=s+1,i=i+m,m<c&&(c=m),m>p&&(p=m)},f=()=>{let m=Array(r),y=0;for(let b=0;b<r;b++){let C=n[b],R=o[b];y=y+R,m[b]=[C,y]}return Rt(m)};return Da({get:()=>iA({buckets:f(),count:s,min:c,max:p,sum:i}),update:u})},mA=e=>{let{error:t,maxAge:r,maxSize:o,quantiles:n}=e.keyType,s=op(St)(n),i=Array(o),c=0,p=0,u=0,f=Number.MAX_VALUE,m=Number.MIN_VALUE,y=C=>{let R=[],v=0;for(;v!==o-1;){let w=i[v];if(w!=null){let[q,W]=w,re=ps(C-q);wf(re,If)&&re<=r&&R.push(W)}v=v+1}return t0(t,s,op(St)(Rt(R)))},b=(C,R)=>{if(o>0){c=c+1;let v=c%o;i[v]=[R,C]}p=p+1,u=u+C,C<f&&(f=C),C>m&&(m=C)};return Da({get:()=>aA({error:t,quantiles:y(Date.now()),count:p,min:f,max:m,sum:u}),update:([C,R])=>b(C,R)})},t0=(e,t,r)=>{let o=r.length;if(ys(t))return Xe();let n=fn(t),s=gs(1)(t),i=at(Oe(cA(e,o,x(),0,n,r)),(c,p)=>{let u=fn(c);return rp(cA(e,o,u.value,u.consumed,p,u.rest))(c)})(s);return Zf(c=>[c.quantile,c.value])(i)},cA=(e,t,r,o,n,s)=>{let i=e,c=t,p=r,u=o,f=n,m=s,y=e,b=t,C=r,R=o,v=n,w=s;for(;;){if(ys(m))return{quantile:f,value:x(),consumed:u,rest:Xe()};if(f===1)return{quantile:f,value:d(tb(m)),consumed:u+m.length,rest:Xe()};let q=rb(ce=>ce>fn(m))(m),W=f*c,re=i/2*W,ge=u+q[0].length,ke=Math.abs(ge-W);if(ge<W-re){y=i,b=c,C=ln(m),R=ge,v=f,w=q[1],i=y,c=b,p=C,u=R,f=v,m=w;continue}if(ge>W+re)return{quantile:f,value:p,consumed:u,rest:m};switch(p._tag){case"None":{y=i,b=c,C=ln(m),R=ge,v=f,w=q[1],i=y,c=b,p=C,u=R,f=v,m=w;continue}case"Some":{let ce=Math.abs(W-p.value);if(ke<ce){y=i,b=c,C=ln(m),R=ge,v=f,w=q[1],i=y,c=b,p=C,u=R,f=v,m=w;continue}return{quantile:f,value:d(p.value),consumed:u,rest:m}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/io/issues")};var o0="@effect/io/Metric/Pair",n0=Symbol.for(o0),s0={_Type:e=>e};var hA=(e,t)=>({[n0]:s0,metricKey:e,metricState:t,pipe(){return E(this,arguments)}});var dA,a0="@effect/io/Metric/Registry",xA=Symbol.for(a0),tx=class{constructor(){this[dA]=xA,this.map=pn()}snapshot(){let t=[];for(let[r,o]of this.map)t.push(hA(r,o.get()));return lt(t)}get(t){let r=je(ye(t)(this.map));if(r==null){if(Ud(t.keyType))return this.getCounter(t);if(jd(t.keyType))return this.getGauge(t);if(Wd(t.keyType))return this.getFrequency(t);if(zd(t.keyType))return this.getHistogram(t);if(Kd(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/io/issues")}else return r}getCounter(t){let r=je(ye(t)(this.map));if(r==null){let o=pA(t);sr(t)(this.map)||ut(t,o)(this.map),r=o}return r}getFrequency(t){let r=je(ye(t)(this.map));if(r==null){let o=uA(t);sr(t)(this.map)||ut(t,o)(this.map),r=o}return r}getGauge(t){let r=je(ye(t)(this.map));if(r==null){let o=lA(t,0);sr(t)(this.map)||ut(t,o)(this.map),r=o}return r}getHistogram(t){let r=je(ye(t)(this.map));if(r==null){let o=fA(t);sr(t)(this.map)||ut(t,o)(this.map),r=o}return r}getSummary(t){let r=je(ye(t)(this.map));if(r==null){let o=mA(t);sr(t)(this.map)||ut(t,o)(this.map),r=o}return r}};dA=xA;var gA=()=>new tx;var p0="@effect/io/Metric",u0=Symbol.for(p0),l0={_Type:e=>e,_In:e=>e,_Out:e=>e},f0=K(Symbol.for("@effect/io/Metric/globalMetricRegistry"),()=>gA()),m0=function(e,t,r){return Object.assign(n=>Mt(n,s=>g(()=>t(s,$e()))),{[u0]:l0,keyType:e,unsafeUpdate:t,unsafeValue:r,pipe(){return E(this,arguments)}})};var La=(e,t)=>yA(qR(e,t));var yA=e=>{let t=r=>{let o=WR(r)(e);return f0.get(o)};return m0(e.keyType,(r,o)=>t(o).update(r),r=>t(r).get())};var bA=(e,t,r)=>yA(UR(e,t,r));var SA=a(2,(e,t)=>Se(il,r=>g(()=>{if(r.has(e)){let o=r.get(e);o.state.completed||(o.state.completed=!0,Vs(o.result,t))}})));var Ha=class{constructor(){this.count=0,this.observers=new Set}addObserver(t){this.observers.add(t)}removeObserver(t){this.observers.delete(t)}increment(){this.count++,this.observers.forEach(t=>t(this.count))}decrement(){this.count--,this.observers.forEach(t=>t(this.count))}};var EA,_A,OA,CA,d0,x0="@effect/io/Supervisor",Ua=Symbol.for(x0),ml={_T:e=>e},qa=class e{constructor(t,r){this.underlying=t,this.value0=r,this[EA]=ml}value(){return this.value0()}onStart(t,r,o,n){this.underlying.onStart(t,r,o,n)}onEnd(t,r){this.underlying.onEnd(t,r)}onEffect(t,r){this.underlying.onEffect(t,r)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new e(this,()=>_(t)(this.value()))}zip(t){return new Vo(this,t)}onRun(t,r){return this.underlying.onRun(t,r)}};EA=Ua;var Vo=class e{constructor(t,r){this.left=t,this.right=r,this[_A]=ml}value(){return Zp(this.left.value(),this.right.value())}onStart(t,r,o,n){this.left.onStart(t,r,o,n),this.right.onStart(t,r,o,n)}onEnd(t,r){this.left.onEnd(t,r),this.right.onEnd(t,r)}onEffect(t,r){this.left.onEffect(t,r),this.right.onEffect(t,r)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new qa(this,()=>_(t)(this.value()))}zip(t){return new e(this,t)}onRun(t,r){return this.right.onRun(()=>this.left.onRun(t,r),r)}};_A=Ua;var rx=class{constructor(){this[OA]=ml,this.fibers=new Set}value(){return g(()=>Array.from(this.fibers))}onStart(t,r,o,n){this.fibers.add(n)}onEnd(t,r){this.fibers.delete(r)}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new qa(this,()=>_(t)(this.value()))}zip(t){return new Vo(this,t)}onRun(t,r){return t()}};OA=Ua;var ox=class{constructor(t){this.effect=t,this[CA]=ml}value(){return this.effect}onStart(t,r,o,n){}onEnd(t,r){}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new qa(this,()=>_(t)(this.value()))}zip(t){return new Vo(this,t)}onRun(t,r){return t()}};CA=Ua;d0=Ua;var g0=()=>new rx,RA=g(g0),y0=e=>new ox(e),Gn=y0(k);var AA="Empty",TA="AddSupervisor",MA="RemoveSupervisor",vA="AndThen",pi={_tag:AA},dl=(e,t)=>({_tag:vA,first:e,second:t}),b0=(e,t)=>S0(t,Oe(e)),S0=(e,t)=>{let r=e,o=t;for(;Ke(o);){let n=Be(o);switch(n._tag){case AA:{o=Ge(o);break}case TA:{r=r.zip(n.supervisor),o=Ge(o);break}case MA:{r=nx(r,n.supervisor),o=Ge(o);break}case vA:{o=ve(n.first)(ve(n.second)(Ge(o)));break}}}return r},nx=(e,t)=>O(e,t)?Gn:e instanceof Vo?nx(e.left,t).zip(nx(e.right,t)):e,xl=e=>O(e,Gn)?$e():e instanceof Vo?Ve(xl(e.right))(xl(e.left)):io(e),E0=(e,t)=>{if(O(e,t))return pi;let r=xl(e),o=xl(t),n=mn(pi,(i,c)=>dl(i,{_tag:TA,supervisor:c}))(lm(r)(o)),s=mn(pi,(i,c)=>dl(i,{_tag:MA,supervisor:c}))(lm(o)(r));return dl(n,s)},IA=cp({empty:pi,patch:b0,combine:dl,diff:E0});var kA,wA,O0=La("effect_fiber_started"),FA=La("effect_fiber_active"),C0=La("effect_fiber_successes"),R0=La("effect_fiber_failures"),A0=bA("effect_fiber_lifetimes",dR({start:1,factor:2,count:100})),Wa="Continue",T0="Done",PA="Yield",M0={_E:e=>e,_A:e=>e},ja=e=>{throw new Error(`BUG: FiberRuntime - ${JSON.stringify(e)} - please report an issue at https://github.com/Effect-TS/io/issues`)},gl={[ks]:(e,t,r)=>t.i1(r),OnStep:(e,t,r)=>t.i1(ee(r)),[ws]:(e,t,r)=>t.i2(r),[na]:(e,t,r)=>(e.patchRuntimeFlags(e._runtimeFlags,t.patch),Fr(e._runtimeFlags)&&e.isInterrupted()?B(e.getInterruptedCause()):ee(r)),[Fs]:(e,t,r)=>(t.i2(r),t.i0()?(e.pushStack(t),t.i1()):k)},v0={[al]:(e,t,r,o)=>(e.processNewInterruptSignal(o.cause),Fr(t)?B(o.cause):r),[pl]:(e,t,r,o)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[cl]:(e,t,r,o)=>(o.onFiber(e,Od(t)),r),[ul]:(e,t,r,o)=>l(vt(),()=>r)},I0=e=>dt(SS(e),t=>li(OS(t),([r,o])=>{let n=new Map;for(let s of o)for(let i of s)n.set(i.request,i);return Ee(W0(r.runAll(o),o.flat()),il,n)},!1)),za=class{pipe(){return E(this,arguments)}constructor(t,r,o){if(this[kA]=Ia,this[wA]=M0,this._queue=new Array,this._children=null,this._observers=new Array,this._running=!1,this._stack=[],this._asyncInterruptor=null,this._asyncBlockingOn=null,this._exitValue=null,this._steps=[!1],this.run=()=>{this.drainQueueOnCurrentThread()},this._runtimeFlags=o,this._fiberId=t,this._fiberRefs=r,this._supervisor=this.getFiberRef(ui),ta(o)){let n=this.getFiberRef(yo);O0.unsafeUpdate(1,n),FA.unsafeUpdate(1,n)}}id(){return this._fiberId}resume(t){this.tell(zn(t))}status(){return this.ask((t,r)=>r)}runtimeFlags(){return this.ask((t,r)=>GC(r)?t._runtimeFlags:r.runtimeFlags)}scope(){return nR(this)}children(){return this.ask(t=>Array.from(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(Fn)}fiberRefs(){return this.ask(t=>t.unsafeGetFiberRefs())}ask(t){return M(()=>{let r=Bs(this._fiberId);return this.tell(ci((o,n)=>{Vs(r,g(()=>t(o,n)))})),Ie(r)})}tell(t){this._queue.push(t),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}await(){return Bt(t=>{let r=o=>t(h(o));return this.tell(ci((o,n)=>{o._exitValue!==null?r(this._exitValue):o.unsafeAddObserver(r)})),g(()=>this.tell(ci((o,n)=>{o.unsafeRemoveObserver(r)})))},this.id())}inheritAll(){return ue((t,r)=>{let o=t.id(),n=t.unsafeGetFiberRefs(),s=r.runtimeFlags,i=this.unsafeGetFiberRefs(),c=Uu(n,o,i);t.setFiberRefs(c);let p=t.getFiberRef(DA),u=$m(Xi)($m(ur)(Cn(s,p)));return qs(u)})}poll(){return g(()=>Ht(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(t){return g(()=>this.tell(Ad(pr(t))))}unsafeAddObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}unsafeRemoveObserver(t){this._observers=this._observers.filter(r=>r!==t)}unsafeGetFiberRefs(){return this.setFiberRef(DA,this._runtimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=Sa(this._fiberRefs,t)}getFiberRef(t){return this._fiberRefs.locals.has(t)?this._fiberRefs.locals.get(t)[0][1]:t.initial}setFiberRef(t,r){this._fiberRefs=Hn(this._fiberRefs,{fiberId:this._fiberId,fiberRef:t,value:r}),t===ui&&(this._supervisor=r)}setFiberRefs(t){this._fiberRefs=t,this._supervisor=this.getFiberRef(ui)}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let r=Wa,o=globalThis[$o];globalThis[$o]=this;try{for(;r===Wa;)r=this._queue.length===0?T0:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[$o]=o}this._queue.length>0&&!this._running?(this._running=!0,r===PA?(this.drainQueueLaterOnExecutor(),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(){this.getFiberRef(go).scheduleTask(this.run,this.getFiberRef(aa))}drainQueueWhileRunning(t,r){let o=r;for(;this._queue.length>0;){let n=this._queue.splice(0,1)[0];o=v0[n._tag](this,t,o,n)}return o}isInterrupted(){return!Fm(this.getFiberRef(Fn))}addInterruptedCause(t){let r=this.getFiberRef(Fn);this.setFiberRef(Fn,Ce(r,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(let r of this._children)r.tell(Ad(pr(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let t=this._children.values();this._children=null;let r=!1;return kn({while:()=>!r,body:()=>{let n=t.next();return n.done?g(()=>{r=!0}):Z(n.value.await())},step:()=>{}})}return null}reportExitValue(t){if(ta(this._runtimeFlags)){let r=this.getFiberRef(yo);switch(FA.unsafeUpdate(-1,r),t._tag){case me:{C0.unsafeUpdate(1,r);break}case fe:{R0.unsafeUpdate(1,r);break}}}if(t._tag==="Failure"){let r=this.getFiberRef(ua);!Lo(t.cause)&&r._tag==="Some"&&this.log("Fiber terminated with a non handled error",t.cause,r)}}setExitValue(t){if(this._exitValue=t,ta(this._runtimeFlags)){let r=this.getFiberRef(yo),o=this.id().startTimeMillis,n=new Date().getTime();A0.unsafeUpdate((n-o)/1e3,r)}this.reportExitValue(t);for(let r=this._observers.length-1;r>=0;r--)this._observers[r](t)}getLoggers(){return this.getFiberRef(qA)}log(t,r,o){let n=N(o)?o.value:this.getFiberRef(hh),s=this.getFiberRef(HA);if(I_(s,n))return;let i=this.getFiberRef(ru),c=this.getFiberRef(ca),p=this.getLoggers(),u=this.unsafeGetFiberRefs();if(ao(p)>0){let f=Ar(this.getFiberRef(ot),zr),m=new Date(f.unsafeCurrentTimeMillis());for(let y of p)y.log({fiberId:this.id(),logLevel:n,message:t,cause:r,context:u,spans:i,annotations:c,date:m})}}evaluateMessageWhileSuspended(t){switch(t._tag){case ul:return PA;case al:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(B(t.cause)),this._asyncInterruptor=null),Wa;case pl:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),Wa;case cl:return t.onFiber(this,this._exitValue!==null?KC:BC(this._runtimeFlags,this._asyncBlockingOn)),Wa;default:return ja(t)}}evaluateEffect(t){this._supervisor.onResume(this);try{let r=Fr(this._runtimeFlags)&&this.isInterrupted()?B(this.getInterruptedCause()):t;for(;r!==null;)try{let o=r,n=this.runLoop(o);this._runtimeFlags=jm(Xi)(this._runtimeFlags);let s=this.interruptAllChildren();s!==null?r=l(s,()=>n):(this._queue.length===0?this.setExitValue(n):this.tell(zn(n)),r=null)}catch(o){if(de(o))o._tag===Ps?Wm(this._runtimeFlags)?(this.tell(eR()),this.tell(zn(jr)),r=null):r=jr:o._tag===vs&&(r=null);else throw o}}finally{this._supervisor.onSuspend(this)}}start(t){if(this._running)this.tell(zn(t));else{this._running=!0;let r=globalThis[$o];globalThis[$o]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[$o]=r,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(t){this.tell(zn(t))}patchRuntimeFlags(t,r){let o=Ms(t,r);return globalThis[$o]=this,this._runtimeFlags=o,o}initiateAsync(t,r){let o=!1,n=s=>{o||(o=!0,this.tell(zn(s)))};Fr(t)&&(this._asyncInterruptor=n);try{r(n)}catch(s){n(D(Le(s)))}}pushStack(t){this._stack.push(t),t._tag==="OnStep"&&this._steps.push(!0),t._tag==="RevertFlags"&&this._steps.push(!1)}popStack(){let t=this._stack.pop();if(t)return(t._tag==="OnStep"||t._tag==="RevertFlags")&&this._steps.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._tag!==Is)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._tag!==ks&&t._tag!==Fs)return t;t=this.popStack()}}[(kA=va,wA=iR,vS)](t){return _(Ye(xo),r=>{try{return cs(r,t)}catch(o){throw console.log(o),o}})}Left(t){return mr(t.i0)}None(t){return mr(uo())}Right(t){return ee(t.i0)}Some(t){return ee(t.i0)}[Np](t){let r=t.i0(),o=this.getNextSuccessCont();if(o!==void 0)return o._tag in gl||ja(o),gl[o._tag](this,o,r);throw ee(r)}[me](t){let r=t,o=this.getNextSuccessCont();if(o!==void 0)return o._tag in gl||ja(o),gl[o._tag](this,o,r.i0);throw r}[fe](t){let r=this.getFiberRef(bo),o=ft(r)||r.head._tag==="ExternalSpan"?t.i0:Do(t.i0,sS(r.head)),n=this.getNextFailCont();if(n!==void 0)switch(n._tag){case Is:case ws:return Fr(this._runtimeFlags)&&this.isInterrupted()?B(Cs(o)):n.i1(o);case"OnStep":return Fr(this._runtimeFlags)&&this.isInterrupted()?B(Cs(o)):n.i1(B(o));case na:return this.patchRuntimeFlags(this._runtimeFlags,n.patch),Fr(this._runtimeFlags)&&this.isInterrupted()?B(Ce(o,this.getInterruptedCause())):B(o);default:ja(n)}else throw B(o)}[Dp](t){return t.i0(this,Od(this._runtimeFlags))}Blocked(t){if(this._steps[this._steps.length-1]){let r=this.popStack();if(r)switch(r._tag){case"OnStep":return r.i1(t);case"OnSuccess":return he(t.i0,l(t.i1,r.i1));case"OnSuccessAndFailure":return he(t.i0,J(t.i1,{onFailure:r.i1,onSuccess:r.i2}));case"OnFailure":return he(t.i0,Lr(t.i1,r.i1));case"While":return he(t.i0,l(t.i1,o=>(r.i2(o),r.i0()?kn({while:r.i0,body:r.i1,step:r.i2}):k)));case"RevertFlags":{this.pushStack(r);break}}}return be(r=>l(It(Kp(t.i0)),()=>r(t.i1)))}RunBlocked(t){return I0(t.i0)}[fo](t){let r=t.i0,o=this._runtimeFlags,n=Ms(o,r);if(Fr(n)&&this.isInterrupted())return B(this.getInterruptedCause());if(this.patchRuntimeFlags(this._runtimeFlags,r),t.i1){let s=Cn(n,o);return this.pushStack(new Wp(s,t)),t.i1(o)}else return jr}[ks](t){return this.pushStack(t),t.i0}OnStep(t){return this.pushStack(t),t.i0}[Is](t){return this.pushStack(t),t.i0}[ws](t){return this.pushStack(t),t.i0}[vs](t){throw this._asyncBlockingOn=t.i1,this.initiateAsync(this._runtimeFlags,t.i0),t}[Ps](t){throw t}[Fs](t){let r=t.i0,o=t.i1;return r()?(this.pushStack(t),o()):jr}[MS](t){return t.commit()}runLoop(t){let r=t,o=0;for(;;){if(this._runtimeFlags&Um&&this._supervisor.onEffect(this,r),this._queue.length>0&&(r=this.drainQueueWhileRunning(this._runtimeFlags,r)),o+=1,o>=this.getFiberRef(mh)){o=0;let n=r;r=l(vt(),()=>n)}try{r._tag in this||(typeof r=="function"&&console.log(r()),ja(r)),r=this._supervisor.onRun(()=>this[r._tag](r),this)}catch(n){if(de(n)){if(n._tag===Ps||n._tag===vs)throw n;if(n._tag===me||n._tag===fe)return n}else DS(n)?r=B(n.cause):Lm(n)?r=B(Ce(Le(n),pr(et))):r=B(Le(n))}}}},HA=xe(k_("Info")),k0=fl(e=>{let t=fR.log(e);globalThis.console.log(t)});var w0=fl(({annotations:e,cause:t,context:r,fiberId:o,logLevel:n,message:s})=>{let i=is(Ea(r,bo),pp),c=Te(Ea(r,ot),u=>Ar(u,zr));if(i._tag==="None"||i.value._tag==="ExternalSpan"||c._tag==="None")return;let p=Object.fromEntries(e);p["effect.fiberId"]=Vb(o),p["effect.logLevel"]=n.label,t!==null&&t!==tt&&(p["effect.cause"]=lo(t)),i.value.event(String(s),c.value.unsafeCurrentTimeNanos(),p)}),qA=fh(io(k0,w0)),Ba=a(e=>de(e[0]),(e,t)=>Nr(Mt(e,r=>Ga(o=>t(r,o))))),UA=a(e=>de(e[0]),(e,t)=>$r(e,Ga(r=>t(r)))),Ga=e=>ue(t=>{let r=t.unsafeGetFiberRefs();return l(bl,o=>zs(o,n=>ue(s=>{let i=s.unsafeGetFiberRefs(),c=ii(i,r),p=ii(r,i);return s.setFiberRefs(Cd(c,s.id(),r)),$r(e(n),g(()=>{s.setFiberRefs(Cd(p,s.id(),s.unsafeGetFiberRefs()))}))})))}),WA=e=>Ee(sa,d(Kn))(e),NA=Symbol("@effect/io/Effect/existsPar/found"),jA=a(e=>Lt(e[0]),(e,t,r)=>Ma(r,()=>M(()=>zA(e[Symbol.iterator](),0,t)),()=>ie(Qt(e,(o,n)=>Bp(t(o,n),{onTrue:L(NA),onFalse:k}),r),{onFailure:o=>o===NA?h(!0):L(o),onSuccess:()=>h(!1)}))),zA=(e,t,r)=>{let o=e.next();return o.done?h(!1):l(r(o.value,t),n=>n?h(n):zA(e,t+1,r))},KA=a(e=>Lt(e[0]),(e,t,r)=>{let o=r?.negate?(n,s)=>_(t(n,s),wg):t;return Ma(r,()=>M(()=>Q(e).reduceRight((n,s,i)=>ho(n,M(()=>o(s,i)),(c,p)=>p?[s,...c]:c),g(()=>new Array))),()=>_(Qt(e,(n,s)=>_(o(n,s),i=>i?d(n):x()),r),Xg))}),F0=e=>{if(Array.isArray(e)||Lt(e))return[e,x()];let t=Object.keys(e),r=t.length;return[t.map(o=>e[o]),d(o=>{let n={};for(let s=0;s<r;s++)n[t[s]]=o[s];return n})]},P0=(e,t,r)=>{let o=[];for(let n of e)o.push(Hr(n));return l(Qt(o,F,{concurrency:r?.concurrency,batching:r?.batching}),n=>{let s=x(),i=n.length,c=new Array(i),p=new Array(i),u=!1;for(let f=0;f<i;f++){let m=n[f];m._tag==="Left"?(c[f]=d(m.left),u=!0):(p[f]=m.right,c[f]=s)}return u?t._tag==="Some"?L(t.value(c)):L(c):r?.discard?k:t._tag==="Some"?h(t.value(p)):h(p)})},N0=(e,t,r)=>{let o=[];for(let n of e)o.push(Hr(n));return r?.discard?Qt(o,F,{concurrency:r?.concurrency,batching:r?.batching,discard:!0}):_(Qt(o,F,{concurrency:r?.concurrency,batching:r?.batching}),n=>t._tag==="Some"?t.value(n):n)},fi=(e,t)=>{let[r,o]=F0(e);return t?.mode==="validate"?P0(r,o,t):t?.mode==="either"?N0(r,o,t):o._tag==="Some"?_(Qt(r,F,t),o.value):Qt(r,F,t)},BA=e=>t=>fi(t,e),GA=(e,t)=>_(fi(Q(e).map(X),t),Ni(r=>au(r)?d(r.i0):x())),cx=a(2,(e,t)=>Array.from({length:t},()=>e)),$A=a(e=>de(e[0]),(e,t,r)=>fi(cx(t)(e),r)),Qt=a(e=>Lt(e[0]),(e,t,r)=>ue(o=>{let n=r?.batching===!0||r?.batching==="inherit"&&o.getFiberRef(pa);return r?.discard?Rd(r,()=>n?sx(e,t):dt(e,t),()=>li(e,t,n),s=>px(e,s,t,n)):Rd(r,()=>n?ix(e,1,t,!0):He(e,t),()=>Ka(e,t,n),s=>ix(e,s,t,n))})),Ka=(e,t,r)=>M(()=>{let o=Q(e),n=new Array(o.length);return j(li(o,(i,c)=>l(t(i,c),p=>g(()=>n[c]=p)),r),h(n))}),sx=(e,t)=>M(()=>{let r=Q(e),o=r.length;if(o===0)return k;if(o===1)return Z(t(r[0],0));let n=r.map(t),s=new Array,i=c=>c===n.length?M(()=>{if(s.length>0){let p=s.map(u=>u.i0).reduce(Rn);return he(p,sx(s.map(u=>u.i1),F))}return k}):Hs(n[c],p=>p._tag==="Blocked"?(s.push(p),i(c+1)):p._tag==="Failure"?M(()=>{if(s.length>0){let u=s.map(f=>f.i0).reduce(Rn);return he(u,l(sx(s.map(f=>f.i1),F),()=>p))}return k}):i(c+1));return i(0)}),li=(e,t,r)=>M(()=>{let o=Q(e),n=o.length;return n===0?k:n===1?Z(t(o[0],0)):be(s=>{let i=Bs(et),c=0,p=[],u=[],f=Qp(m=>He(o,(y,b)=>_(C=>(C.unsafeAddObserver(()=>{u.push(C)}),C))($n(m(l(C=>{switch(C._tag){case"Failure":{if(p.length>0){let R=p.map(w=>w.i0).reduce(Rn),v=li(p,w=>w.i1,r);return he(R,J(v,{onFailure:w=>j(ha(i,void 0),D(Fe(w,C.cause))),onSuccess:()=>j(ha(i,void 0),D(C.cause))}))}return j(ha(i,void 0),D(C.cause))}default:{if(C._tag==="Blocked"&&p.push(C),c+1===n)if(p.length>0){let R=p.map(w=>w.i0).reduce(Rn),v=li(p,w=>w.i1,r);return $s(i,he(R,v))}else Vs(i,ee(jr));else c=c+1;return k}}})(M(()=>s((r?Pr:X)(t(y,b))))))))));return l(f,m=>J(s(Ie(i)),{onFailure:y=>l(Ka(m,zo,r),b=>{let C=Ks(b,{parallel:!0});return C._tag==="Some"&&bh(C.value)?D(Fe(Cs(y),C.value.i0)):D(Cs(y))}),onSuccess:y=>l(y,()=>dt(u,b=>b.inheritAll()))}))})}),ix=(e,t,r,o)=>M(()=>{let n=Q(e),s=new Array(n.length);return j(px(n,t,(c,p)=>_(r(c,p),u=>s[p]=u),o),h(s))}),px=(e,t,r,o)=>M(()=>{let n=0,s=e[Symbol.iterator](),i=[],c=l(g(()=>s.next()),u=>u.done?k:l((o?Pr:X)(Z(r(u.value,n++))),f=>{switch(f._tag){case"Blocked":return i.push(f),c;case"Failure":return f;case"Success":return c}})),p=[];for(let u=0;u<t;u++)p.push(c);return l(X(li(p,F,o)),u=>{if(i.length===0)return u;let f=i.map(y=>y.i0).reduce(Rn),m=px(i,t,y=>y.i1,o);return u._tag==="Failure"?he(f,J(m,{onFailure:y=>B(Fe(u.cause,y)),onSuccess:()=>u})):he(f,m)})}),It=e=>ue((t,r)=>h(YA(e,t,r.runtimeFlags))),$n=e=>D0(e,Kn),VA=a(2,(e,t)=>It(Yp(e,r=>{let o=po(r);switch(o._tag){case"Left":return t(o.left);case"Right":return D(o.right)}}))),YA=(e,t,r,o=null)=>{let n=ax(e,t,r,o);return n.resume(e),n},ax=(e,t,r,o=null)=>{let n=dp(),s=t.unsafeGetFiberRefs(),i=Wu(s,n),c=new za(n,i,r),p=ei(i,xo),u=c._supervisor;return u.onStart(p,e,d(t),c),c.unsafeAddObserver(m=>u.onEnd(m,c)),(o!==null?o:V(()=>t.scope())(t.getFiberRef(sa))).add(r,c),c},D0=(e,t)=>ue((r,o)=>h(YA(e,r,o.runtimeFlags,t))),ux=a(e=>Lt(e[0]),(e,t,r,o)=>Ma(o,()=>Q(e).reduce((n,s,i)=>ho(n,s,(c,p)=>r(c,p,i)),h(t)),()=>l(Oa(t),n=>l(Qt(e,(s,i)=>l(s,c=>j_(n,p=>r(p,c,i))),o),()=>Qu(n))))),lx=a(e=>Lt(e[0]),(e,t,r)=>_(o=>WS(o,F))(Qt(e,(o,n)=>Hr(t(o,n)),r))),JA=a(e=>Lt(e[0]),(e,t,r)=>l(lx(e,t,{concurrency:r?.concurrency,batching:r?.batching}),([o,n])=>o.length===0?r?.discard?k:h(n):L(o))),QA=e=>{let t=Ir(e);if(!Ke(t))return qo(()=>As("Received an empty collection of effects"));let r=Be(t),o=Ge(t),n=s=>Y(s[0])(aR(s[1]));return l(s=>l(i=>be(c=>l(p=>l(u=>jo(()=>at(k,(f,m)=>Ws(zo(m))(f))(u))(c(l(n)(Dn(s)))))(Mt(u=>at(k,(f,m)=>j(Z(It(l(L0(u,m,s,i))(vd(m)))))(f))(u))(_(u=>ve(p)(u))(_(Rt)(He(u=>It(zt(u)))(o))))))(It(zt(r)))))(Oa(o.length)))(rt())},L0=(e,t,r,o)=>n=>Pn(n,{onFailure:s=>ht(W_(o,i=>[i===0?Z(Nn(r,s)):k,i-1])),onSuccess:s=>l(i=>i?at(k,(c,p)=>p===t?c:Ws(zo(p))(c))(Ir(e)):k)($s(r,[s,t]))}),ZA=a(e=>Lt(e[0]),(e,t,r,o)=>Ma(o,()=>Q(e).reduce((n,s,i)=>ho(n,s,(c,p)=>r(c,p,i)),t),()=>M(()=>_(n=>{switch(n._tag){case"None":throw new Error("BUG: Effect.reduceEffect - please report an issue at https://github.com/Effect-TS/io/issues");case"Some":return n.value}})(ux([t,...e],x(),(n,s,i)=>{switch(n._tag){case"None":return d(s);case"Some":return d(r(n.value,s,i))}},o))))),XA=e=>l(bl,t=>l(Vn(JC),r=>j(Yn(e,r))(t.addFinalizer(o=>r.close(o))))),Yo=e=>l(gx,e),fx=e=>l(Vn(),t=>q0(t)(e)),eT=e=>Yo(t=>l(r=>Yn(r)(e))(gh(t,ai))),tT=(e,t)=>mx([Bu(e,t)]),mx=e=>hx(lt(e)),hx=e=>xr(yo,t=>Ve(e)(t)),rT=a(2,(e,t)=>Kt(Vn(),r=>l(Yn(e,r),t),(r,o)=>Ko(r,o))),oT=e=>ie(e,{onFailure:t=>{switch(t._tag){case"None":return h(x());case"Some":return L(t.value)}},onSuccess:t=>h(d(t))}),nT=a(e=>de(e[1]),(e,t,r)=>dx(e,t,(o,n)=>[o,n],r)),dx=a(e=>de(e[1]),(e,t,r,o)=>ht(_o(X(e),X(t),(n,s)=>ma(n,s,{onSuccess:r,onFailure:(i,c)=>o?.concurrent?Fe(i,c):Ce(i,c)}),o)));var sT=a(e=>Lt(e[0]),(e,t,r)=>Wo(Qt(e,(o,n)=>Wo(t(o,n)),r))),iT=e=>xr(ot,Me(zr,e)),yl=e=>xr(ot,Me(Zs,e)),aT=e=>Yo(t=>l(gh(t,ai),r=>_(o=>[Gt(n=>Ko(r,pu(n))),o])(Yn(r)(e)))),cT=a(e=>de(e[1]),(e,t,r)=>_o(e,t,(o,n)=>[o,n],r)),pT=a(e=>de(e[1]),(e,t,r)=>_o(e,t,(o,n)=>o,r)),uT=a(e=>de(e[1]),(e,t,r)=>_o(e,t,(o,n)=>n,r)),_o=a(e=>de(e[1]),(e,t,r,o)=>_(fi([e,t],{concurrency:o?.concurrent?2:1,batching:o?.batching}),([n,s])=>r(n,s))),xx=e=>e===kp?k:Nr(l(t=>{let r=Ms(t,e),o=Cn(r,t);return Z(j(Ga(()=>qs(o)))(qs(e)))})(Jp)),H0=(e,t)=>r=>M(()=>{switch(r.state._tag){case"Exited":return k;case"Running":{let o=r.state.finalizers,n=r.state.update,s=Array.from(o.keys()).sort((i,c)=>c-i).map(i=>o.get(i));return r.state={_tag:"Exited",nextKey:r.state.nextKey,exit:t,update:n},QC(e)?l(i=>V(()=>jr)(Te(fa)(Ks(i))))(He(i=>X(n(i)(t)))(s)):ZC(e)?l(i=>V(()=>jr)(Te(fa)(Ks(i,{parallel:!0}))))(Ka(s,i=>X(n(i)(t)),!1)):l(i=>V(()=>jr)(Te(fa)(Ks(i,{parallel:!0}))))(ix(s,e.parallelism,i=>X(n(i)(t)),!1))}}}),gx=ct(iu),bl=gx,Vn=(e=ai)=>_(eE,t=>({[iu]:iu,[xh]:xh,pipe(){return E(this,arguments)},fork:r=>Nr(l(o=>Y(o)(Mt(n=>zs(o,n))(yh(t,n=>Ko(o,n)))))(Vn(r))),close:r=>Z(H0(e,r)(t)),addFinalizer:r=>Z(yh(r)(t))})),Yn=a(2,(e,t)=>In(e,rn(qc(gx,t)))),q0=a(2,(e,t)=>fr(r=>t.close(r))(Yn(t)(e))),U0=e=>js(e,{differ:IA,fork:pi}),Zt=a(2,(e,t)=>Z(Ba(l(Ye(e),r=>Y(Tn(e,t),r)),r=>Tn(e,r)))),xr=a(2,(e,t)=>Se(e,r=>Zt(e,t(r))));var DA=YS(zm),ui=U0(Gn),lT=e=>Z(vd(Sl(e))),Sl=e=>({[va]:Ia,id:()=>Q(e).reduce((t,r)=>Am(t,r.id()),et),await:()=>X(Ka(e,t=>ht(t.await()),!1)),children:()=>_(Ka(e,t=>t.children(),!1),Dc),inheritAll:()=>dt(e,t=>t.inheritAll()),poll:()=>_(He(e,t=>t.poll()),Lc(d(ee(new Array)),(t,r)=>{switch(r._tag){case"None":return x();case"Some":switch(t._tag){case"None":return x();case"Some":return d(ma(r.value,t.value,{onSuccess:(o,n)=>[o,...n],onFailure:Fe}))}}})),interruptAsFork:t=>dt(e,r=>r.interruptAsFork(t)),pipe(){return E(this,arguments)}});var yx=a(3,(e,t,r)=>bx(e,t,{onSelfWin:(o,n)=>l(o.await(),s=>{switch(s._tag){case me:return l(o.inheritAll(),()=>r.onSelfDone(s,n));case fe:return r.onSelfDone(s,n)}}),onOtherWin:(o,n)=>l(o.await(),s=>{switch(s._tag){case me:return l(o.inheritAll(),()=>r.onOtherDone(s,n));case fe:return r.onOtherDone(s,n)}})})),fT=e=>be(t=>Gt(r=>l($n(t(e)),o=>jo(()=>cR(r)(o))(t(Bn(o)))))),El=a(2,(e,t)=>Gt(r=>yx(e,t,{onSelfDone:(o,n)=>Pn(o,{onFailure:s=>ti(i=>Fe(s,i))(Bn(n)),onSuccess:s=>Y(s)($t(r)(n))}),onOtherDone:(o,n)=>Pn(o,{onFailure:s=>ti(i=>Fe(i,s))(Bn(n)),onSuccess:s=>Y(s)($t(r)(n))})}))),bx=a(3,(e,t,r)=>ue((o,n)=>{let s=n.runtimeFlags,i=pt(!0),c=ax(e,o,s,r.selfScope),p=ax(t,o,s,r.otherScope);return Bt(u=>{c.unsafeAddObserver(()=>LA(c,p,r.onSelfWin,i,u)),p.unsafeAddObserver(()=>LA(p,c,r.onOtherWin,i,u)),c.startFork(e),p.startFork(t)},Am(c.id(),p.id()))})),LA=(e,t,r,o,n)=>{ep(!0,!1)(o)&&n(r(e,t))},$r=a(2,(e,t)=>be(r=>J(r(e),{onFailure:o=>J(t,{onFailure:n=>D(Ce(o,n)),onSuccess:()=>D(o)}),onSuccess:o=>Y(t,o)}))),W0=(e,t)=>Gt(r=>l(l($n(zt(e)),o=>Bt(n=>{let s=t.map(p=>p.listeners.count),i=()=>{s.every(p=>p===0)&&(c.forEach(p=>p()),n(zo(o)))};o.unsafeAddObserver(p=>{c.forEach(u=>u()),n(p)});let c=t.map((p,u)=>{let f=m=>{s[u]=m,i()};return p.listeners.addObserver(f),()=>p.listeners.removeObserver(f)});return i(),g(()=>{c.forEach(p=>p())})})),()=>M(()=>{let o=t.flatMap(n=>n.state.completed?[]:[n]);return dt(o,n=>SA(n.request,pu(r)))})));var mT=(e,t)=>Ba(ni(e,t),(r,o)=>l(ol,n=>g(()=>r.end(n,o)))),_l=(e,t)=>l(ni(e,t),r=>xr(bo,Fo(r))),Ol=e=>xr(ot,Me(Xs,e)),Cl=e=>xr(bo,Fo(e));var hT,gT,dT=(e,t,r,o)=>oo({_tag:"Complete",key:e,exit:t,entryStats:r,timeToLiveMillis:o}),xT=(e,t)=>oo({_tag:"Pending",key:e,deferred:t}),j0=(e,t)=>oo({_tag:"Refreshing",deferred:e,complete:t}),Sx=Symbol.for("@effect/cache/Cache/MapKey"),Ex=class{constructor(t){this.current=t,this[hT]=Sx,this.previous=void 0,this.next=void 0}[(hT=Sx,A)](){return I(S(this.next))(I(S(this.previous))(S(this.current)))}[T](t){return this===t?!0:z0(t)&&O(this.current,t.current)&&O(this.previous,t.previous)&&O(this.next,t.next)}},mi=e=>new Ex(e),z0=e=>typeof e=="object"&&e!=null&&Sx in e,_x=class{constructor(){this.head=void 0,this.tail=void 0}add(t){if(t!==this.tail)if(this.tail===void 0)this.head=t,this.tail=t;else{let r=t.previous,o=t.next;o!==void 0&&(t.next=void 0,r!==void 0?(r.next=o,o.previous=r):(this.head=o,this.head.previous=void 0)),this.tail.next=t,t.previous=this.tail,this.tail=t}}remove(){let t=this.head;if(t!==void 0){let r=t.next;r!==void 0?(t.next=void 0,this.head=r,this.head.previous=void 0):(this.head=void 0,this.tail=void 0)}return t}},K0=()=>new _x,B0=(e,t,r,o,n,s)=>({map:e,keys:t,accesses:r,updating:o,hits:n,misses:s}),G0=()=>B0(pn(),K0(),cb(),pt(!1),0,0),$0="@effect/cache/Cache",V0=Symbol.for($0),Y0={_Key:e=>e,_Error:e=>e,_Value:e=>e},J0=e=>e,Rl=e=>({loadedMillis:e}),Ox=class{constructor(t,r,o,n,s){this.capacity=t,this.context=r,this.fiberId=o,this.lookup=n,this.timeToLive=s,this[gT]=Y0,this.cacheState=G0()}get(t){return _(this.getEither(t),kc)}cacheStats(){return g(()=>J0({hits:this.cacheState.hits,misses:this.cacheState.misses,size:tp(this.cacheState.map)}))}getOption(t){return M(()=>De(ye(this.cacheState.map,t),{onNone:()=>{let r=mi(t);return this.trackAccess(r),this.trackMiss(),h(x())},onSome:r=>this.resolveMapValue(r)}))}getOptionComplete(t){return M(()=>De(ye(this.cacheState.map,t),{onNone:()=>{let r=mi(t);return this.trackAccess(r),this.trackMiss(),h(x())},onSome:r=>this.resolveMapValue(r,!0)}))}contains(t){return g(()=>sr(this.cacheState.map,t))}entryStats(t){return g(()=>{let r=ye(this.cacheState.map,t);if(N(r))switch(r.value._tag){case"Complete":{let o=r.value.entryStats.loadedMillis;return d(Rl(o))}case"Pending":return x();case"Refreshing":{let o=r.value.complete.entryStats.loadedMillis;return d(Rl(o))}}return x()})}getEither(t){return M(()=>{let r=t,o,n,s=je(ye(this.cacheState.map,r));return s===void 0&&(n=_h(this.fiberId),o=mi(r),sr(this.cacheState.map,r)?s=je(ye(this.cacheState.map,r)):ut(this.cacheState.map,r,xT(o,n))),s===void 0?(this.trackAccess(o),this.trackMiss(),_(this.lookupValueOf(t,n),P)):l(this.resolveMapValue(s),De({onNone:()=>this.getEither(t),onSome:i=>h(U(i))}))})}invalidate(t){return g(()=>{un(this.cacheState.map,t)})}invalidateWhen(t,r){return g(()=>{let o=ye(this.cacheState.map,t);N(o)&&o.value._tag==="Complete"&&o.value.exit._tag==="Success"&&r(o.value.exit.value)&&un(this.cacheState.map,t)})}invalidateAll(){return g(()=>{this.cacheState.map=pn()})}refresh(t){return Gr(r=>M(()=>{let o=t,n=_h(this.fiberId),s=je(ye(this.cacheState.map,o));if(s===void 0&&(sr(this.cacheState.map,o)?s=je(ye(this.cacheState.map,o)):ut(this.cacheState.map,o,xT(mi(o),n))),s===void 0)return Z(this.lookupValueOf(t,n));switch(s._tag){case"Complete":{if(this.hasExpired(r,s.timeToLiveMillis)){let i=je(ye(this.cacheState.map,o));return O(i,s)&&un(this.cacheState.map,o),Z(this.get(t))}return Z(rl(()=>{let i=je(ye(this.cacheState.map,o));if(O(i,s)){let c=j0(n,s);return ut(this.cacheState.map,o,c),!0}return!1})(this.lookupValueOf(t,n)))}case"Pending":return Dn(s.deferred);case"Refreshing":return Dn(s.deferred)}}))}set(t,r){return Gr(o=>g(()=>{let n=o.unsafeCurrentTimeMillis(),s=t,i=uE(r),c=dT(mi(s),i,Rl(n),n+Tr(ze(this.timeToLive(i))));ut(this.cacheState.map,s,c)}))}size(){return g(()=>tp(this.cacheState.map))}values(){return g(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[1].exit.value);return t})}entries(){return g(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push([r[0],r[1].exit.value]);return t})}keys(){return g(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[0]);return t})}resolveMapValue(t,r=!1){return Gr(o=>{switch(t._tag){case"Complete":return this.trackAccess(t.key),this.trackHit(),this.hasExpired(o,t.timeToLiveMillis)?(un(this.cacheState.map,t.key.current),h(x())):_(t.exit,d);case"Pending":return this.trackAccess(t.key),this.trackHit(),r?h(x()):_(Dn(t.deferred),d);case"Refreshing":return this.trackAccess(t.complete.key),this.trackHit(),this.hasExpired(o,t.complete.timeToLiveMillis)?r?h(x()):_(Dn(t.deferred),d):_(t.complete.exit,d)}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(t){if(pb(this.cacheState.accesses,t),ep(this.cacheState.updating,!1,!0)){let r=!0;for(;r;){let n=ub(this.cacheState.accesses,om);n===om?r=!1:this.cacheState.keys.add(n)}let o=tp(this.cacheState.map);for(r=o>this.capacity;r;){let n=this.cacheState.keys.remove();n!==void 0?sr(this.cacheState.map,n.current)&&(un(this.cacheState.map,n.current),o=o-1,r=o>this.capacity):r=!1}Wt(this.cacheState.updating,!1)}}hasExpired(t,r){return t.unsafeCurrentTimeMillis()>r}lookupValueOf(t,r){return Gr(o=>M(()=>{let n=t;return jo(()=>j(aE(r),g(()=>{un(this.cacheState.map,n)})))(l(s=>{let i=o.unsafeCurrentTimeMillis(),c=Rl(i),p=dT(mi(n),s,c,i+Tr(ze(this.timeToLive(s))));return ut(this.cacheState.map,n,p),j(iE(r,s),s)})(X(Tt(this.context)(this.lookup(t)))))}))}};gT=V0;var yT=(e,t,r)=>new Ox(e,_t(),fp,t,o=>ze(r(o)));var Q0="@effect/io/Schedule/Interval",Cx=Symbol.for(Q0),bT={[Cx]:Cx,startMillis:0,endMillis:0};var ST=bT;var ET=e=>V(()=>ST)(ln(e.intervals)).startMillis;var _T=ET;var rP="Done";var OT=e=>e._tag===rP;var CT=OT;var sP,RT,iP="@effect/io/Schedule",aP=Symbol.for(iP),cP="@effect/io/Schedule/Driver",pP=Symbol.for(cP);var uP={_Env:e=>e,_In:e=>e,_Out:e=>e};sP=aP;var Rx=class{constructor(t,r){this.schedule=t,this.ref=r,this[RT]=uP}state(){return _(dr(this.ref),t=>t[1])}last(){return l(dr(this.ref),([t,r])=>{switch(t._tag){case"None":return lr(()=>uo());case"Some":return h(t.value)}})}reset(){return Br(this.ref,[x(),this.schedule.initial])}next(t){return l(r=>l(o=>l(([n,s,i])=>CT(i)?j(L(x()))(Br(this.ref,[d(s),n])):Y(s)(j(ri(ps(_T(i.intervals)-o)))(Br(this.ref,[d(s),n]))))(M(()=>this.schedule.step(o,t,r))))(qu))(_(dr(this.ref),r=>r[1]))}};RT=pP;var Ax=e=>_(t=>new Rx(e,t))(qn([x(),e.initial]));var AT=a(2,(e,t)=>Tx(e,t,(r,o)=>L(r))),Tx=a(3,(e,t,r)=>l(Ax(t),o=>ie(e,{onFailure:n=>r(n,x()),onSuccess:n=>TT(e,o,r,n)}))),TT=(e,t,r,o)=>ie(t.next(o),{onFailure:()=>vn(t.last()),onSuccess:n=>ie(e,{onFailure:s=>r(s,d(n)),onSuccess:s=>TT(e,t,r,s)})}),MT=a(2,(e,t)=>Va(e,r=>g(()=>t(r)))),Va=a(2,(e,t)=>l(e,r=>l(t(r),o=>o?h(r):l(vt(),()=>Va(e,t))))),vT=a(2,(e,t)=>Mx(e,r=>g(()=>t(r)))),Mx=a(2,(e,t)=>Va(e,r=>Ta(t(r)))),IT=a(2,(e,t)=>vx(e,t,(r,o)=>L(r))),kT=a(2,(e,t)=>wT(e,t)),wT=(e,t)=>mt(e,r=>t<0?L(r):l(vt(),()=>wT(e,t-1))),vx=a(3,(e,t,r)=>l(Ax(t),o=>FT(e,o,r))),FT=(e,t,r)=>mt(e,o=>ie(t.next(o),{onFailure:()=>l(n=>r(o,n))(vn(t.last())),onSuccess:()=>FT(e,t,r)})),PT=a(2,(e,t)=>Ya(e,r=>g(()=>t(r)))),Ya=a(2,(e,t)=>mt(e,r=>l(t(r),o=>o?L(r):l(vt(),()=>Ya(e,t))))),NT=a(2,(e,t)=>Ix(e,r=>g(()=>t(r)))),Ix=a(2,(e,t)=>Ya(e,r=>Ta(t(r)))),Al=a(2,(e,t)=>kx(e,void 0,t)),kx=a(3,(e,t,r)=>l(Ax(r),o=>DT(e,t,o))),DT=(e,t,r)=>ie(r.next(t),{onFailure:()=>vn(r.last()),onSuccess:()=>l(e,o=>DT(e,o,r))});var HT,UT,WT,Fx=class{constructor(t){this.permits=t,this.waiters=new Array,this.taken=0,this.take=r=>Dr(o=>{if(this.free<r){let n=()=>{if(this.free>=r){let s=this.waiters.findIndex(i=>i===n);s!==-1&&this.waiters.splice(s,1),this.taken+=r,o(h(r))}};return this.waiters.push(n),U(g(()=>{let s=this.waiters.findIndex(i=>i===n);s!==-1&&this.waiters.splice(s,1)}))}return this.taken+=r,P(h(r))}),this.release=r=>ue(o=>(this.taken-=r,o.getFiberRef(go).scheduleTask(()=>{this.waiters.forEach(n=>n())},o.getFiberRef(aa)),k)),this.withPermits=r=>o=>be(n=>l(n(this.take(r)),s=>$r(n(o),this.release(s))))}get free(){return this.permits-this.taken}},Ml=e=>new Fx(e),jT=e=>g(()=>Ml(e)),zT=e=>vl(e,lT),KT=a(2,(e,t)=>_(Nx(e,t),r=>r[0])),Nx=a(2,(e,t)=>{let r=ze(t);return l(qr(),o=>_(Il(x()),n=>[Tt(lP(e,r,n),o),fP(n)]))}),qT=(e,t,r)=>{let o=Tr(ze(t));return _(n=>d([r+o,n]))(Mt(n=>Wr(e,n))(rt()))},lP=(e,t,r)=>be(o=>l(n=>z(n)?Ds("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/io/issues"):o(Ie(n.value[1])))(l(n=>gP(r,s=>{switch(s._tag){case"None":return d(qT(e,t,n));case"Some":{let[i]=s.value;return i-n<=0?d(qT(e,t,n)):x()}}}))(Gr(n=>n.currentTimeMillis)))),fP=e=>Br(e,x()),BT=a(2,(e,t)=>vl(e,r=>t(Sl(r)))),vl=a(2,(e,t)=>l(RA,r=>$r(l(r.value(),t))(Hx(e,r)))),GT=a(e=>Lt(e[0]),(e,t)=>t?.discard?dt(e,It):_(He(e,It),Sl)),Dx=a(2,(e,t)=>be(r=>l(t.fork(ai),o=>Mt(n=>o.addFinalizer(()=>Gt(s=>O(s,n.id())?k:Z(zo(n)))))($n(fr(n=>o.close(n))(r(e))))))),Lx=e=>Yo(t=>Dx(e,t)),$T=e=>Bn(e),VT=e=>M(()=>l(e,Bn)),wx=Symbol.for("@effect/io/Effect/memoizeFunction.key"),Tl=class{constructor(t,r){this.a=t,this.eq=r,this[HT]=wx}[(HT=wx,T)](t){return typeof t=="object"&&t!==null&&wx in t?this.eq?this.eq(this.a,t.a):O(this.a,t.a):!1}[A](){return this.eq?0:S(this.a)}},YT=(e,t)=>_(r=>o=>l(([n,s])=>Y(s)(jn(n)))(l(Ie)(r.modifyEffect(n=>{let s=ye(new Tl(o,t))(n);return z(s)?_(i=>[i,ut(new Tl(o,t),i)(n)])(Mt(i=>It(Wr(i)(Un(e(o)))))(rt())):h([s.value,n])}))))(l(Il)(g(()=>pn()))),JT=a(2,(e,t)=>(r=>ht(r))(El(X(t))(X(e)))),QT=a(2,(e,t)=>Lx(Al(t)(e))),Hx=a(2,(e,t)=>qe(ui,o=>o.zip(t))(e)),ZT=a(2,(e,t)=>Ja(e,{onTimeout:x,onSuccess:d,duration:t})),XT=a(2,(e,{duration:t,onTimeout:r})=>ht(Ja(e,{onTimeout:()=>lr(r),onSuccess:h,duration:t}))),eM=a(2,(e,{duration:t,onTimeout:r})=>ht(Ja(e,{onTimeout:()=>Ur(r),onSuccess:h,duration:t}))),Ja=a(2,(e,{duration:t,onSuccess:r,onTimeout:o})=>Gt(n=>bx(e,zt(ri(t)),{onSelfWin:(s,i)=>l(s.await(),c=>c._tag==="Success"?l(s.inheritAll(),()=>Y($t(i,n),r(c.value))):l($t(i,n),()=>B(c.cause))),onOtherWin:(s,i)=>l(s.await(),c=>c._tag==="Success"?l(s.inheritAll(),()=>Y($t(i,n),o())):l($t(i,n),()=>B(c.cause))),otherScope:Kn}))),mP="@effect/io/Ref/Synchronized",hP=Symbol.for(mP),dP={_A:e=>e},Px=class{constructor(t,r){this.ref=t,this.withLock=r,this[UT]=dP,this[WT]=Zh}modify(t){return this.modifyEffect(r=>h(t(r)))}modifyEffect(t){return this.withLock(l(([r,o])=>Y(Br(this.ref,o),r))(l(dr(this.ref),t)))}pipe(){return E(this,arguments)}};UT=hP,WT=$u;var Il=e=>g(()=>xP(e)),xP=e=>{let t=Vu(e),r=Ml(1);return new Px(t,r.withPermits(1))},gP=a(2,(e,t)=>e.modifyEffect(r=>{let o=t(r);switch(o._tag){case"None":return h([r,r]);case"Some":return _(o.value,n=>[n,n])}}));var rM="Fresh",oM="FromEffect",nM="Scoped",sM="Suspend";var iM="ZipWithPar";var aM=$t;var wl=e=>(t,r)=>{let o=dp(),n=t,s=jh(e.fiberRefs,{fiberId:o,fiberRef:xo,value:e.context});r?.scheduler&&(s=jh(s,{fiberId:o,fiberRef:go,value:r.scheduler})),r?.updateRefs&&(s=r.updateRefs(s,o));let i=new za(o,d_(s,o),e.runtimeFlags),c=i._supervisor;return c!==Gn&&(c.onStart(e.context,n,x(),i),i.unsafeAddObserver(p=>c.onEnd(p,i))),Kn.add(e.runtimeFlags,i),i.start(n),i},qx=e=>(t,r)=>{let o=wl(e)(t);return r&&o.unsafeAddObserver(n=>{r(n)}),(n,s)=>qx(e)(aM(n??et)(o),s?i=>s(pE(i)):void 0)},SP=e=>t=>{let r=fM(e)(t);if(r._tag==="Failure")throw uM(r.i0);return r.i0},EP=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new Error;Error.stackTraceLimit=t;let o=`Fiber #${e.id().id} cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work`,n="AsyncFiberException";return Object.defineProperties(r,{_tag:{value:n},message:{value:o},name:{value:n},toString:{get(){return()=>o}},[pM]:{get(){return()=>o}}}),r};var cM=Symbol.for("@effect/io/Runtime/FiberFailure"),_P=Symbol.for("@effect/io/Runtime/FiberFailure/Cause"),pM=Symbol.for("nodejs.util.inspect.custom"),uM=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new Error;Error.stackTraceLimit=t;let o=Op(e);return o.length>0&&(r.name=o[0].message.split(":")[0],r.message=o[0].message.substring(r.name.length+2),r.stack=`${r.name}: ${r.message}
${o[0].stack}`),r[cM]=cM,r[_P]=e,r.toString=()=>lo(e),r[pM]=()=>r.toString(),r};var lM=e=>{let t=e;switch(t._tag){case"Failure":case"Success":return t;case"Left":return mr(t.left);case"Right":return ee(t.right);case"Some":return ee(t.value);case"None":return mr(uo())}},fM=e=>t=>{let r=lM(t);if(r)return r;let o=new qp,n=wl(e)(t,{scheduler:o});o.flush();let s=n.unsafePoll();if(s)return s;throw EP(n)},OP=e=>t=>mM(e)(t).then(r=>{switch(r._tag){case me:return r.i0;case fe:throw uM(r.i0)}}),mM=e=>t=>new Promise(r=>{let o=lM(t);o&&r(o),wl(e)(t).unsafeAddObserver(n=>{r(n)})}),kl=class{constructor(t,r,o){this.context=t,this.runtimeFlags=r,this.fiberRefs=o}pipe(){return E(this,arguments)}},CP=e=>new kl(e.context,e.flags,e.fiberRefs),Ux=()=>ue((e,t)=>h(new kl(e.getFiberRef(xo),t.runtimeFlags,e.unsafeGetFiberRefs()))),RP=vp(ur,Mp,Tp),gr=CP({context:_t(),flags:RP,fiberRefs:y_(new Map)}),hM=qx(gr),dM=wl(gr),xM=OP(gr),gM=mM(gr),yM=SP(gr),bM=fM(gr),SM=e=>l(rt(),t=>l(Ux(),r=>be(o=>j(It(o(Lr(e(n=>qx(r)(Wr(n,t))),n=>Nn(t,n)))),o(Ie(t))))));var EM=a(2,(e,t)=>e.modifyEffect(t));var MP="@effect/io/Layer",vP=Symbol.for(MP),IP={_RIn:e=>e,_E:e=>e,_ROut:e=>e},Fl={[vP]:IP,pipe(){return E(this,arguments)}};var kP=e=>e._tag===rM,Wx=class{constructor(t){this.ref=t}getOrElseMemoize(t,r){return ht(EM(this.ref,o=>{let n=o.get(t);if(n!==void 0){let[s,i]=n,c=fr(uu({onFailure:()=>k,onSuccess:()=>zs(r,i)}))(l(([p,u])=>Y(u)(jn(p)))(s));return h([c,o])}return l(s=>l(i=>_(c=>{let p=be(f=>l(m=>l(y=>{switch(y._tag){case fe:return j(D(y.i0))(j(Ko(m,y))(Nn(i,y.i0)));case me:return Y(y.i0[1])(j($s(i,y.i0))(j(zs(r,b=>l(C=>C(b))(dr(c))))(j(_a(s,b=>b+1))(Br(c,b=>Z(Us(Yu(s,C=>[C===1,C-1]))(Ko(m,b))))))))}})(X(f(l(OM(t,m),y=>Un(y(this)))))))(Vn())),u=[fr(Pn({onFailure:()=>k,onSuccess:()=>_a(s,f=>f+1)}))(Ie(i)),f=>l(m=>m(f))(dr(c))];return[p,kP(t)?o:o.set(t,u)]})(qn(()=>k)))(rt()))(qn(0))}))}},wP=()=>_(Il(new Map),e=>new Wx(e));var _M=a(2,(e,t)=>l(wP(),r=>l(OM(e,t),o=>o(r)))),OM=(e,t)=>{let r=e;switch(r._tag){case"Locally":return g(()=>o=>r.f(o.getOrElseMemoize(r.self,t)));case"ExtendScope":return g(()=>o=>Yo(n=>o.getOrElseMemoize(r.layer,n)));case"Fold":return g(()=>o=>J({onFailure:n=>o.getOrElseMemoize(r.failureK(n),t),onSuccess:n=>o.getOrElseMemoize(r.successK(n),t)})(o.getOrElseMemoize(r.layer,t)));case"Fresh":return g(()=>o=>_M(t)(r.layer));case"FromEffect":return g(()=>o=>r.effect);case"ProvideTo":return g(()=>o=>l(n=>Tt(n)(o.getOrElseMemoize(r.second,t)))(o.getOrElseMemoize(r.first,t)));case"Scoped":return g(()=>o=>Yn(r.effect,t));case"Suspend":return g(()=>o=>o.getOrElseMemoize(r.evaluate(),t));case"ZipWith":return g(()=>o=>ho(o.getOrElseMemoize(r.second,t),r.zipK)(o.getOrElseMemoize(r.first,t)));case"ZipWithPar":return g(()=>o=>_o(o.getOrElseMemoize(r.second,t),r.zipK,{concurrent:!0})(o.getOrElseMemoize(r.first,t)))}};var FP=()=>PP(qr());function PP(e){let t=Object.create(Fl);return t._tag=oM,t.effect=e,t}var NP=a(2,(e,t)=>HP(e,t,(r,o)=>rn(o)(r)));var kt=e=>DP(Y(_t())(e)),DP=e=>{let t=Object.create(Fl);return t._tag=nM,t.effect=e,t};var LP=e=>{let t=Object.create(Fl);return t._tag=sM,t.evaluate=e,t};var HP=a(3,(e,t,r)=>LP(()=>{let o=Object.create(Fl);return o._tag=iM,o.first=e,o.second=t,o.zipK=r,o})),jx=a(2,(e,t)=>Kt(Vn(),r=>l(_M(t,r),o=>Tt(e,o)),(r,o)=>Ko(r,o))),CM=a(2,(e,t)=>jx(e,NP(FP(),t)));var AM=e=>kt(yl(e)),TM=e=>kt(Cl(e)),MM=(e,t)=>kt(_l(e,t)),vM=e=>kt(Ol(e));var zx=Cn;var hi=xe(yT(65536,()=>_(rt(),e=>({listeners:new Ha,handle:e})),()=>kf(60))),Qa=K(Symbol.for("@effect/io/FiberRef/currentCacheEnabled"),()=>xe(!1)),Kx=(e,t)=>l(de(t)?t:h(t),r=>Gt(o=>{let n=new Proxy(e,{});return Se(Qa,s=>{if(s)return Se(hi,c=>l(c.getEither(n),p=>{switch(p._tag){case"Left":return p.left.listeners.increment(),he(bS,l(X(Ie(p.left.handle)),u=>u._tag==="Failure"&&Lo(u.cause)?(p.left.listeners.decrement(),l(c.invalidateWhen(n,f=>f.handle===p.left.handle),()=>Kx(n,t))):$r(Ie(p.left.handle),g(()=>p.left.listeners.decrement()))));case"Right":return p.right.listeners.increment(),he(Jm(r,Qm({request:n,result:p.right.handle,listeners:p.right.listeners,ownerId:o,state:{completed:!1}})),be(u=>l(X(u(Ie(p.right.handle))),f=>(p.right.listeners.decrement(),f))))}}));let i=new Ha;return i.increment(),l(rt(),c=>he(Jm(r,Qm({request:n,result:c,listeners:i,ownerId:o,state:{completed:!1}})),$r(Ie(c),g(()=>i.decrement()))))})})),IM=(e,t)=>Se(Qa,r=>r?Se(hi,o=>l(o.getEither(e),n=>{switch(n._tag){case"Left":return k;case"Right":return Sh(n.right.handle,t)}})):k),kM=a(2,(e,t)=>Ee(e,Qa,t)),wM=a(2,(e,t)=>Ee(e,hi,t));var jP=Ns,zP=de,KP=KT,BP=Nx,GP=nd,$P=YT,VP=sd,YP=fi,JP=BA,QP=GA,ZP=pO,XP=uO,eN=bO,tN=jA,rN=KA,oN=dO,nN=gO,Za=Qt,sN=OO,iN=ux,aN=lx,cN=JO,pN=ZA,uN=QO,lN=ZO,fN=cx,mN=$A,hN=iC,dN=aC,xN=JA,gN=sT,yN=Bt,bN=SM,SN=$_,EN=Dr,_N=L,ON=lr,CN=D,RN=Ur,AN=oh,TN=Ds,MN=qo,vN=_O,IN=wn,kN=jO,wN=$O,FN=h,PN=oi,NN=ad,di=M,DN=g,xt=k,LN=vt,HN=V_;var qN=mt,UN=Lr,WN=Y_,jN=HS,zN=J_,KN=Q_,BN=Z_,GN=X_,$N=eO,VN=ed,YN=CO,JN=RO,QN=GO,ZN=rC,XN=IT,eD=kT,tD=vx,rD=PT,oD=Ya,nD=NT,sD=Ix,iD=Ca;var aD=dC,cD=xC,pD=fd,uD=bC,lD=oO,fD=qS,mD=fT,hD=Gp,dD=$p,xD=zt,gD=US,yD=jo,bD=Nr,SD=be,ED=Y,_D=Zu,OD=G_,CD=Z,RD=Wo,AD=yO,$x=_,TD=UO,MD=Vp,vD=mo,ID=ti,kD=WO,wD=Ta,FD=Ba,PD=UA,FM=Kt,ND=Ga,DD=$r,LD=Yp,HD=fr,qD=XA,UD=eT,WD=bl,jD=Yo,zD=fx,KD=rT,BD=aT,GD=zT,$D=WA,VD=nO,YD=Xu,JD=Un,QD=BT,ZD=vl,XD=Uo,eL=Gt,tL=It,rL=$n,oL=GT,nL=Dx,sL=Lx,iL=VA,aL=$T,cL=VT,pL=Hx,uL=Qp,lL=zS,fL=e=>kt(Zt(go,e)),mL=QS,hL=JS,dL=dh,xL=tO,gL=Gr,yL=e=>kt(xr(ot,Me(zr,e))),bL=iT,SL=s_,EL=rO,_L=ri,OL=fC,CL=ld,RL=ZT,AL=XT,TL=eM,ML=Ja,vL=a_,IL=Lh,kL=AM,wL=i_,FL=yl,PL=qr,PM=lO,NL=Ls,DL=In,LL=Tt,NM=jS,HL=a(2,(e,t)=>{let r=zx(gr.runtimeFlags,t.runtimeFlags),o=zx(t.runtimeFlags,gr.runtimeFlags),n=ii(gr.fiberRefs,t.fiberRefs),s=ii(t.fiberRefs,gr.fiberRefs);return FM(l(Gx(r),()=>Bx(n)),()=>NM(e,t.context),()=>l(Gx(o),()=>Bx(s)))}),qL=jx,UL=VO,WL=id,jL=CM,zL=RC,KL=CC,BL=md,GL=hd,$L=AC,VL=e=>PM(t=>Mf(t,e)),YL=SC,JL=sO,QL=iO,ZL=aO,XL=cO;var Jo=Hr,e2=X,t2=Wr,r2=zO,o2=nC,n2=oT,s2=Bp;var i2=fO,a2=mO,c2=Ra,p2=hO,u2=gC,l2=yC,f2=rl,m2=Us,h2=EC,d2=_C,wt=l,x2=ht,g2=QA,y2=El,b2=JT,S2=yx,E2=el,_2=Mt,O2=cC,C2=pC,R2=ud,A2=uC,T2=lC,M2=EO,v2=rd,I2=LO,k2=AT,w2=eC,F2=Tx,P2=MT,N2=Va,D2=vT,L2=Mx,H2=Al,q2=QT,U2=kx,W2=kn,j2=td,z2=AO,K2=Ee,B2=qe,G2=Zt,$2=xr,Bx=jn,V2=oC,Y2=tl,J2=TO,Q2=MO,Z2=Aa,X2=ia,eH=J,tH=ie,rH=vO,oH=IO,nH=od,sH=kO,iH=wO,aH=FO,cH=PO,pH=NO,uH=B_,lH=DO,fH=ZS,mH=e=>kt(Zt(ua,e)),hH=vn,dH=nh,xH=Mn,gH=KO,yH=BO,bH=YO,SH=Lu,EH=Ux,_H=Jp,Gx=qs,OH=BS,CH=xx,RH=sC,AH=cd,TH=pd,MH=tT,vH=mx,IH=hx,kH=XS,wH=OC,FH=Ho,PH=F,NH=Ml,DH=jT,LH=dM,HH=hM,DM=xM,qH=gM,UH=yM,WH=bM,jH=nT,zH=dx,KH=cT,BH=pT,GH=uT,$H=_o,VH=he,YH=Kp,JH=Pr,QH=Hs,ZH=Kx,XH=IM,eq=KS,tq=e=>kt(Zt(pa,e)),rq=e=>kt(Zt(Qa,e)),oq=e=>kt(de(e)?l(e,t=>Zt(hi,t)):Zt(hi,e)),nq=kM,sq=wM,iq=vM,aq=hC,cq=Hu,pq=c_,uq=Ol,lq=GS,fq=e=>kt(Zt(la,e)),mq=MC,hq=TC,dq=xd,xq=dd,gq=IC,yq=kC,bq=vC,Sq=ni,Eq=TM,_q=MM,Oq=gd,Cq=mT,Rq=wC,Aq=_l,Tq=yd,Mq=Cl,vq=FC,Iq=PC;var gt={};Ai(gt,{ConfigTypeId:()=>kq,all:()=>wq,array:()=>Fq,boolean:()=>Pq,chunk:()=>Nq,date:()=>Dq,fail:()=>Lq,hashMap:()=>o1,hashSet:()=>Zq,integer:()=>qq,isConfig:()=>Wq,logLevel:()=>Uq,map:()=>jq,mapAttempt:()=>zq,mapOrFail:()=>Kq,nested:()=>Bq,number:()=>Hq,option:()=>Vq,orElse:()=>Gq,orElseIf:()=>$q,primitive:()=>Yq,repeat:()=>Jq,secret:()=>Qq,string:()=>Xq,succeed:()=>e1,suspend:()=>t1,sync:()=>r1,unwrap:()=>n1,validate:()=>s1,withDefault:()=>i1,withDescription:()=>a1,zip:()=>c1,zipWith:()=>p1});var kq=wu,wq=LE,Fq=RE,Pq=CE,Nq=Fu,Dq=AE,Lq=TE,Hq=ME,qq=vE,Uq=IE,Wq=vh,jq=Eo,zq=kE,Kq=Js,Bq=Yt,Gq=FE,$q=Pu,Vq=PE,Yq=Bo,Jq=ku,Qq=NE,Zq=DE,Xq=Mh,e1=Qs,t1=xa,r1=qE,o1=UE,n1=Ih,s1=WE,i1=jE,a1=zE,c1=KE,p1=ga;var Pl={};Ai(Pl,{Tag:()=>ct,add:()=>Me,empty:()=>_t,get:()=>Ar,getOption:()=>Mf,isContext:()=>BI,isTag:()=>ly,make:()=>qc,merge:()=>rn,omit:()=>$I,pick:()=>GI,unsafeGet:()=>cs});var xi={};Ai(xi,{Class:()=>hy,TaggedClass:()=>XI,array:()=>QI,case:()=>ZI,struct:()=>oo,tagged:()=>my,taggedEnum:()=>ek,tuple:()=>JI,unsafeArray:()=>vf,unsafeStruct:()=>fy});var H={};Ai(H,{Do:()=>JL,EffectTypeId:()=>jP,acquireRelease:()=>FD,acquireReleaseInterruptible:()=>PD,acquireUseRelease:()=>FM,addFinalizer:()=>ND,all:()=>YP,allSuccesses:()=>QP,allWith:()=>JP,allowInterrupt:()=>lD,annotateCurrentSpan:()=>hq,annotateLogs:()=>uH,annotateSpans:()=>mq,as:()=>ED,asSome:()=>_D,asSomeError:()=>OD,asUnit:()=>CD,async:()=>yN,asyncEffect:()=>bN,asyncEither:()=>EN,asyncOption:()=>SN,awaitAllChildren:()=>GD,bind:()=>QL,bindTo:()=>ZL,blocked:()=>VH,cacheRequestResult:()=>XH,cached:()=>GP,cachedFunction:()=>$P,cachedInvalidateWithTTL:()=>BP,cachedWithTTL:()=>KP,catch:()=>HN,catchAll:()=>qN,catchAllCause:()=>UN,catchAllDefect:()=>WN,catchSome:()=>jN,catchSomeCause:()=>zN,catchSomeDefect:()=>KN,catchTag:()=>BN,catchTags:()=>GN,cause:()=>$N,checkInterruptible:()=>fD,clock:()=>xL,clockWith:()=>gL,config:()=>vL,configProviderWith:()=>IL,context:()=>PL,contextWith:()=>PM,contextWithEffect:()=>NL,currentParentSpan:()=>xq,currentSpan:()=>dq,daemonChildren:()=>$D,delay:()=>EL,descriptor:()=>VD,descriptorWith:()=>YD,die:()=>AN,dieMessage:()=>TN,dieSync:()=>MN,diffFiberRefs:()=>JD,disconnect:()=>mD,dropUntil:()=>ZP,dropWhile:()=>XP,either:()=>Jo,ensuring:()=>DD,ensuringChild:()=>QD,ensuringChildren:()=>ZD,eventually:()=>VN,every:()=>eN,exists:()=>tN,exit:()=>e2,fail:()=>_N,failCause:()=>CN,failCauseSync:()=>RN,failSync:()=>ON,fiberId:()=>XD,fiberIdWith:()=>eL,filter:()=>rN,filterOrDie:()=>i2,filterOrDieMessage:()=>a2,filterOrElse:()=>c2,filterOrFail:()=>p2,findFirst:()=>oN,firstSuccessOf:()=>nN,flatMap:()=>wt,flatMapStep:()=>QH,flatten:()=>x2,flip:()=>RD,flipWith:()=>AD,forEach:()=>Za,forever:()=>M2,fork:()=>tL,forkAll:()=>oL,forkDaemon:()=>rL,forkIn:()=>nL,forkScoped:()=>sL,forkWithErrorHandler:()=>iL,fromFiber:()=>aL,fromFiberEffect:()=>cL,fromNullable:()=>vq,gen:()=>vN,getFiberRefs:()=>j2,head:()=>sN,if:()=>s2,ignore:()=>YN,ignoreLogged:()=>JN,inheritFiberRefs:()=>z2,interrupt:()=>hD,interruptWith:()=>dD,interruptible:()=>xD,interruptibleMask:()=>gD,intoDeferred:()=>t2,isEffect:()=>zP,isFailure:()=>J2,isSuccess:()=>Q2,iterate:()=>v2,labelMetrics:()=>AH,labelMetricsScoped:()=>vH,labelMetricsScopedSet:()=>IH,labelMetricsSet:()=>TH,let:()=>XL,linkSpans:()=>bq,locally:()=>K2,locallyScoped:()=>G2,locallyScopedWith:()=>$2,locallyWith:()=>B2,log:()=>rH,logAnnotations:()=>lH,logDebug:()=>nH,logError:()=>aH,logFatal:()=>cH,logInfo:()=>sH,logTrace:()=>oH,logWarning:()=>iH,loop:()=>I2,makeSemaphore:()=>DH,makeSpan:()=>Sq,map:()=>$x,mapAccum:()=>TD,mapBoth:()=>MD,mapError:()=>vD,mapErrorCause:()=>ID,mapInputContext:()=>DL,match:()=>Z2,matchCause:()=>X2,matchCauseEffect:()=>eH,matchEffect:()=>tH,merge:()=>kD,mergeAll:()=>iN,metricLabels:()=>kH,negate:()=>wD,never:()=>IN,none:()=>kN,onError:()=>LD,onExit:()=>HD,onInterrupt:()=>yD,once:()=>VP,option:()=>r2,optionFromOptional:()=>Iq,orDie:()=>hH,orDieWith:()=>dH,orElse:()=>xH,orElseFail:()=>gH,orElseSucceed:()=>yH,parallelErrors:()=>QN,parallelFinalizers:()=>qD,partition:()=>aN,patchFiberRefs:()=>Bx,promise:()=>wN,provideContext:()=>LL,provideLayer:()=>qL,provideService:()=>UL,provideServiceEffect:()=>WL,provideSomeContext:()=>NM,provideSomeLayer:()=>jL,provideSomeRuntime:()=>HL,race:()=>y2,raceAll:()=>g2,raceFirst:()=>b2,raceWith:()=>S2,random:()=>bH,randomWith:()=>SH,reduce:()=>cN,reduceEffect:()=>pN,reduceRight:()=>uN,reduceWhile:()=>lN,repeat:()=>k2,repeatN:()=>w2,repeatOrElse:()=>F2,repeatUntil:()=>P2,repeatUntilEffect:()=>N2,repeatWhile:()=>D2,repeatWhileEffect:()=>L2,replicate:()=>fN,replicateEffect:()=>mN,request:()=>ZH,retry:()=>XN,retryN:()=>eD,retryOrElse:()=>tD,retryUntil:()=>rD,retryUntilEffect:()=>oD,retryWhile:()=>nD,retryWhileEffect:()=>sD,runCallback:()=>HH,runFork:()=>LH,runPromise:()=>DM,runPromiseExit:()=>qH,runRequestBlock:()=>YH,runSync:()=>UH,runSyncExit:()=>WH,runtime:()=>EH,runtimeFlags:()=>_H,sandbox:()=>ZN,schedule:()=>H2,scheduleForked:()=>q2,scheduleFrom:()=>U2,scope:()=>WD,scopeWith:()=>jD,scoped:()=>zD,sequentialFinalizers:()=>UD,serviceConstants:()=>GL,serviceFunction:()=>zL,serviceFunctionEffect:()=>KL,serviceFunctions:()=>BL,serviceMembers:()=>$L,serviceOption:()=>VL,setClock:()=>yL,setConfigProvider:()=>kL,setFiberRefs:()=>V2,setParentSpan:()=>Eq,setRequestBatching:()=>tq,setRequestCache:()=>oq,setRequestCaching:()=>rq,setScheduler:()=>fL,setSpan:()=>_q,setTracer:()=>iq,setTracerTiming:()=>fq,setUnhandledErrorLogLevel:()=>mH,sleep:()=>_L,some:()=>o2,spanAnnotations:()=>gq,spanLinks:()=>yq,step:()=>JH,succeed:()=>FN,succeedNone:()=>PN,succeedSome:()=>NN,summarized:()=>E2,supervised:()=>pL,suspend:()=>di,sync:()=>DN,tagMetrics:()=>RH,tagMetricsScoped:()=>MH,takeUntil:()=>hN,takeWhile:()=>dN,tap:()=>_2,tapBoth:()=>O2,tapDefect:()=>C2,tapError:()=>R2,tapErrorCause:()=>T2,tapErrorTag:()=>A2,timed:()=>OL,timedWith:()=>CL,timeout:()=>RL,timeoutFail:()=>AL,timeoutFailCause:()=>TL,timeoutTo:()=>ML,tracer:()=>aq,tracerWith:()=>cq,transplant:()=>uL,try:()=>iD,tryMap:()=>aD,tryMapPromise:()=>cD,tryPromise:()=>pD,unified:()=>PH,unifiedFn:()=>FH,uninterruptible:()=>bD,uninterruptibleMask:()=>SD,unit:()=>xt,unless:()=>u2,unlessEffect:()=>l2,unsafeMakeSemaphore:()=>NH,unsandbox:()=>uD,unsome:()=>n2,updateFiberRefs:()=>Y2,updateRuntimeFlags:()=>Gx,updateService:()=>YL,useSpan:()=>Oq,useSpanScoped:()=>Cq,using:()=>KD,validate:()=>jH,validateAll:()=>xN,validateFirst:()=>gN,validateWith:()=>zH,when:()=>f2,whenEffect:()=>m2,whenFiberRef:()=>h2,whenRef:()=>d2,whileLoop:()=>W2,withClock:()=>SL,withClockScoped:()=>bL,withConcurrency:()=>lL,withConfigProvider:()=>wL,withConfigProviderScoped:()=>FL,withEarlyRelease:()=>BD,withLogSpan:()=>pH,withMaxFiberOps:()=>mL,withMetric:()=>wH,withParentSpan:()=>Tq,withParentSpanScoped:()=>Mq,withRequestBatching:()=>eq,withRequestCache:()=>sq,withRequestCaching:()=>nq,withRuntimeFlags:()=>OH,withRuntimeFlagsScoped:()=>CH,withScheduler:()=>hL,withSchedulingPriority:()=>dL,withSpan:()=>Rq,withSpanScoped:()=>Aq,withTracer:()=>pq,withTracerScoped:()=>uq,withTracerTiming:()=>lq,withUnhandledErrorLogLevel:()=>fH,yieldNow:()=>LN,zip:()=>KH,zipLeft:()=>BH,zipRight:()=>GH,zipWith:()=>$H});var ec={};Ai(ec,{SafeRefinementId:()=>_1,any:()=>T1,bigint:()=>w1,boolean:()=>v1,date:()=>F1,defined:()=>M1,discriminator:()=>HM,discriminators:()=>Jx,discriminatorsExhaustive:()=>qM,either:()=>Nl,exhaustive:()=>jM,instanceOf:()=>UM,instanceOfUnsafe:()=>N1,is:()=>C1,nonEmptyString:()=>O1,not:()=>E1,null:()=>k1,number:()=>A1,option:()=>L1,orElse:()=>WM,orElseAbsurd:()=>D1,record:()=>P1,string:()=>R1,tag:()=>b1,tags:()=>S1,tagsExhaustive:()=>Qx,type:()=>f1,typeTags:()=>d1,undefined:()=>I1,value:()=>m1,valueTags:()=>h1,when:()=>x1,whenAnd:()=>y1,whenOr:()=>g1});var Xa=class e{constructor(t){this.cases=t,this._tag="TypeMatcher",this._input=F,this._filters=F,this._remaining=F,this._result=F}add(t){return new e([...this.cases,t])}pipe(){return E(this,arguments)}},Vx=class e{constructor(t,r){this.provided=t,this.value=r,this._tag="ValueMatcher",this._input=F,this._filters=F,this._result=F}add(t){return this.value._tag==="Right"?this:t._tag==="When"&&t.guard(this.provided)===!0?new e(this.provided,P(t.evaluate(this.provided))):t._tag==="Not"&&t.guard(this.provided)===!1?new e(this.provided,P(t.evaluate(this.provided))):this}pipe(){return E(this,arguments)}},Jn=class{constructor(t,r){this.guard=t,this.evaluate=r,this._tag="When"}},Yx=class{constructor(t,r){this.guard=t,this.evaluate=r,this._tag="Not"}},gi=e=>{if(typeof e=="function")return e;if(Array.isArray(e)){let t=e.map(gi),r=t.length;return o=>{if(!Array.isArray(o))return!1;for(let n=0;n<r;n++)if(t[n](o[n])===!1)return!1;return!0}}else if(e!==null&&typeof e=="object"){let t=Object.entries(e).map(([o,n])=>[o,gi(n)]),r=t.length;return o=>{if(typeof o!="object"||o===null)return!1;for(let n=0;n<r;n++){let[s,i]=t[n];if(!(s in o)||i(o[s])===!1)return!1}return!0}}return t=>t===e},u1=e=>{let t=e.map(gi),r=t.length;return o=>{for(let n=0;n<r;n++)if(t[n](o)===!0)return!0;return!1}},l1=e=>{let t=e.map(gi),r=t.length;return o=>{for(let n=0;n<r;n++)if(t[n](o)===!1)return!1;return!0}},f1=()=>new Xa([]),m1=e=>new Vx(e,U(e)),h1=e=>{let t=Qx(e)(new Xa([]));return r=>t(r)},d1=()=>e=>{let t=Qx(e)(new Xa([]));return r=>t(r)},x1=(e,t)=>r=>r.add(new Jn(gi(e),t)),g1=(...e)=>t=>{let r=e[e.length-1],o=e.slice(0,-1);return t.add(new Jn(u1(o),r))},y1=(...e)=>t=>{let r=e[e.length-1],o=e.slice(0,-1);return t.add(new Jn(l1(o),r))},HM=e=>(...t)=>{let r=t[t.length-1],o=t.slice(0,-1),n=o.length===1?s=>s[e]===o[0]:s=>o.includes(s[e]);return s=>s.add(new Jn(n,r))},Jx=e=>t=>{let r=[];for(let n in t){let s=c=>c[e]===n,i=t[n];i&&r.push(new Jn(s,i))}let o=r.length;return n=>{let s=n;for(let i=0;i<o;i++)s=s.add(r[i]);return s}},qM=e=>t=>{let r=Jx(e)(t);return o=>jM(r(o))},b1=HM("_tag"),S1=Jx("_tag"),Qx=qM("_tag"),E1=(e,t)=>r=>r.add(new Yx(gi(e),t)),_1=Symbol.for("@effect/match/SafeRefinementId"),O1=e=>typeof e=="string"&&e.length>0,C1=(...e)=>{let t=e.length;return r=>{for(let o=0;o<t;o++)if(r===e[o])return!0;return!1}},R1=Ii,A1=Zo,T1=()=>!0,M1=e=>e!=null,v1=_c,I1=ki;var k1=vg;var w1=rs,F1=Oc,P1=wi,UM=e=>t=>t instanceof e,N1=UM,WM=e=>t=>{let r=Nl(t);return vc(r)?r._tag==="Right"?r.right:e(r.left):o=>{let n=r(o);return n._tag==="Right"?n.right:e(n.left)}},D1=e=>WM(()=>{throw new Error("absurd")})(e),Nl=e=>{if(e._tag==="ValueMatcher")return e.value;let t=e.cases.length;return r=>{for(let o=0;o<t;o++){let n=e.cases[o];if(n._tag==="When"&&n.guard(r)===!0)return P(n.evaluate(r));if(n._tag==="Not"&&n.guard(r)===!1)return P(n.evaluate(r))}return U(r)}},L1=e=>{let t=Nl(e);return vc(t)?Ic(t,{onLeft:()=>x(),onRight:d}):r=>Ic(t(r),{onLeft:()=>x(),onRight:o=>d(o)})},jM=e=>{let t=Nl(e);if(vc(t)){if(t._tag==="Right")return t.right;throw new Error("@effect/match: exhaustive absurd")}return r=>{let o=t(r);if(o._tag==="Right")return o.right;throw new Error("@effect/match: exhaustive absurd")}};var Dl="@effect/schema/ArbitraryHookId",Zx="@effect/schema/PrettyHookId",Xx=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return Xx(e,t.from)}},tc=e=>Object.keys(e).concat(Object.getOwnPropertySymbols(e)),Ll=e=>{let t=!1,r;return()=>(t||(r=e(),t=!0),r)};var eg=e=>({_tag:"ParseError",errors:e}),yr=(e,t,r)=>({_tag:"Type",expected:e,actual:t,message:Ht(r)}),KM={_tag:"Forbidden"},Oo=(e,t)=>({_tag:"Index",index:e,errors:t}),Vr=(e,t)=>({_tag:"Key",key:e,errors:t}),Hl={_tag:"Missing"},tg=e=>({_tag:"Unexpected",actual:e}),rg=e=>({_tag:"UnionMember",errors:e}),Je=P,Xt=e=>U(eg([e])),Ue=e=>U(eg(e)),Yr=e=>{let t=e;if(t._tag==="Left"||t._tag==="Right")return t},yi=(e,t)=>{let r=e;return r._tag==="Left"?r:r._tag==="Right"?t(r.right):wt(e,t)},BM=(e,t)=>{let r=e;return r._tag==="Left"?r:r._tag==="Right"?P(t(r.right)):$x(e,t)};var sg="@effect/schema/TypeAnnotationId",Ul="@effect/schema/MessageAnnotationId",bi="@effect/schema/IdentifierAnnotationId",nt="@effect/schema/TitleAnnotationId",Qo="@effect/schema/DescriptionAnnotationId",VM="@effect/schema/ExamplesAnnotationId",YM="@effect/schema/JSONSchemaAnnotationId",JM="@effect/schema/DocumentationAnnotationId",nc=e=>t=>Object.prototype.hasOwnProperty.call(t.annotations,e)?d(t.annotations[e]):x(),Si=(e,t,r,o={})=>({_tag:"Declaration",typeParameters:e,type:t,decode:r,annotations:o});var QM=e=>({_tag:"Literal",literal:e,annotations:{}}),Qn=e=>e._tag==="Literal";var H1=e=>e._tag==="UniqueSymbol",q1={_tag:"UndefinedKeyword",annotations:{[nt]:"undefined"}};var U1={_tag:"VoidKeyword",annotations:{[nt]:"void"}};var sc={_tag:"NeverKeyword",annotations:{[nt]:"never"}};var Ei={_tag:"UnknownKeyword",annotations:{[nt]:"unknown"}},W1=e=>e._tag==="UnknownKeyword",ZM={_tag:"AnyKeyword",annotations:{[nt]:"any"}},j1=e=>e._tag==="AnyKeyword",Wl={_tag:"StringKeyword",annotations:{[nt]:"string"}},oc=e=>e._tag==="StringKeyword",XM={_tag:"NumberKeyword",annotations:{[nt]:"number"}},ql=e=>e._tag==="NumberKeyword",z1={_tag:"BooleanKeyword",annotations:{[nt]:"boolean"}},GM=e=>e._tag==="BooleanKeyword",K1={_tag:"BigIntKeyword",annotations:{[nt]:"bigint"}},$M=e=>e._tag==="BigIntKeyword",ig={_tag:"SymbolKeyword",annotations:{[nt]:"symbol"}},ng=e=>e._tag==="SymbolKeyword",B1={_tag:"ObjectKeyword",annotations:{[nt]:"object"}};var ic=(e,t)=>({type:e,isOptional:t}),Zn=(e,t,r,o={})=>({_tag:"Tuple",elements:e,rest:t,isReadonly:r,annotations:o});var Ne=(e,t,r,o,n={})=>({name:e,type:t,isOptional:r,isReadonly:o,annotations:n}),ev=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return ev(e.from);default:return!1}},_i=(e,t,r)=>{if(ev(e))return{parameter:e,type:t,isReadonly:r};throw new Error("An index signature parameter type must be 'string', 'symbol', a template literal type or a refinement of the previous types")},Co=(e,t,r={})=>{let o={};for(let s=0;s<e.length;s++){let i=e[s].name;if(Object.prototype.hasOwnProperty.call(o,i))throw new Error(`Duplicate property signature ${String(i)}`);o[i]=null}let n={string:!1,symbol:!1};for(let s=0;s<t.length;s++){let i=zl(t[s].parameter);if(oc(i)){if(n.string)throw new Error("Duplicate index signature for type `string`");n.string=!0}else if(ng(i)){if(n.symbol)throw new Error("Duplicate index signature for type `symbol`");n.symbol=!0}}return{_tag:"TypeLiteral",propertySignatures:G1(e),indexSignatures:t,annotations:r}};var Ro=(e,t={})=>{let r=J1(e);switch(r.length){case 0:return sc;case 1:return r[0];default:return{_tag:"Union",types:Y1(r),annotations:t}}};var ac=(e,t={})=>({_tag:"Lazy",f:Ll(e),annotations:t});var cc=(e,t,r,o={})=>({_tag:"Refinement",from:e,decode:t,isReversed:r,annotations:o}),tv=e=>e._tag==="Refinement",pc=(e,t,r,o)=>({from:e,to:t,decode:r,encode:o}),jl=(e,t,r,o,n,s={})=>({_tag:"Transform",from:e,to:t,decode:r,encode:o,propertySignatureTransformations:n,annotations:s}),rv=(e,t,r,o,n={})=>jl(e,t,r,o,[],n),ov=(e,t,r,o={})=>jl(e,t,n=>{for(let s=0;s<r.length;s++){let i=r[s],c=i.from,p=Object.prototype.hasOwnProperty.call(n,c)?d(n[c]):x();delete n[c];let u=i.decode(p);N(u)&&(n[i.to]=u.value)}return Je(n)},n=>{for(let s=0;s<r.length;s++){let i=r[s],c=i.to,p=Object.prototype.hasOwnProperty.call(n,c)?d(n[c]):x();delete n[c];let u=i.encode(p);N(u)&&(n[i.from]=u.value)}return Je(n)},r,o);var nv=(e,t,r)=>({...e,annotations:{...e.annotations,[t]:r}});var sv=e=>e.map(t=>Ne(t.name,Pe(t.type),t.isOptional,t.isReadonly,t.annotations)),iv=e=>e.map(t=>_i(t.parameter,Pe(t.type),t.isReadonly)),Pe=e=>{switch(e._tag){case"Declaration":return Si(e.typeParameters.map(Pe),Pe(e.type),e.decode,e.annotations);case"Tuple":return Zn(e.elements.map(t=>ic(Pe(t.type),t.isOptional)),Te(e.rest,as(Pe)),e.isReadonly,e.annotations);case"TypeLiteral":return Co(sv(e.propertySignatures),iv(e.indexSignatures),e.annotations);case"Union":return Ro(e.types.map(Pe),e.annotations);case"Lazy":return ac(()=>Pe(e.f()),e.annotations);case"Refinement":return cc(Pe(e.from),e.decode,!1,e.annotations);case"Transform":return Pe(e.to)}return e},er=e=>{switch(e._tag){case"Declaration":return Si(e.typeParameters.map(er),er(e.type),e.decode,e.annotations);case"Tuple":return Zn(e.elements.map(t=>ic(er(t.type),t.isOptional)),Te(e.rest,as(er)),e.isReadonly);case"TypeLiteral":return Co(e.propertySignatures.map(t=>Ne(t.name,er(t.type),t.isOptional,t.isReadonly)),e.indexSignatures.map(t=>_i(t.parameter,er(t.type),t.isReadonly)));case"Union":return Ro(e.types.map(er));case"Lazy":return ac(()=>er(e.f()));case"Refinement":case"Transform":return er(e.from)}return e},av=e=>{switch(e._tag){case"Declaration":return av(e.type);case"NeverKeyword":return 0;case"Literal":case"UndefinedKeyword":case"VoidKeyword":case"UniqueSymbol":return 1;case"BooleanKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3;case"ObjectKeyword":return 5;case"UnknownKeyword":case"AnyKeyword":return 6;default:return 4}},G1=en(ne(St,vi(e=>av(e.type)))),cv=Ag(St,St,St),$1=rf(cv),pv=[0,0,0],V1=e=>e.reduce($1,pv),rc=e=>{switch(e._tag){case"Tuple":{let t=e.elements.length,r=N(e.rest)?e.rest.value.length:0;return[2,t,r]}case"TypeLiteral":{let t=e.propertySignatures.length,r=e.indexSignatures.length;return t+r===0?[-4,0,0]:[4,t,r]}case"Declaration":{let[t,r,o]=rc(e.type);return[6,r,o]}case"Lazy":return[8,0,0];case"Union":return V1(e.types.map(rc));case"Refinement":{let[t,r,o]=rc(e.from);return[t+1,r,o]}case"Transform":return rc(e.from);case"ObjectKeyword":return[-2,0,0];case"UnknownKeyword":case"AnyKeyword":return[-4,0,0];default:return pv}},Y1=en(Rg(vi(cv,rc))),J1=e=>{let t=ne(e,Nc(o=>{switch(o._tag){case"NeverKeyword":return[];case"Union":return o.types;default:return[o]}}));if(t.some(j1))return[ZM];if(t.some(W1))return[Ei];let r;return(r=t.findIndex(oc))!==-1&&(t=t.filter((o,n)=>n===r||!oc(o)&&!(Qn(o)&&typeof o.literal=="string"))),(r=t.findIndex(ql))!==-1&&(t=t.filter((o,n)=>n===r||!ql(o)&&!(Qn(o)&&typeof o.literal=="number"))),(r=t.findIndex(GM))!==-1&&(t=t.filter((o,n)=>n===r||!GM(o)&&!(Qn(o)&&typeof o.literal=="boolean"))),(r=t.findIndex($M))!==-1&&(t=t.filter((o,n)=>n===r||!$M(o)&&!(Qn(o)&&typeof o.literal=="bigint"))),(r=t.findIndex(ng))!==-1&&(t=t.filter((o,n)=>n===r||!ng(o)&&!H1(o))),t},zl=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return zl(e.from)}};var Jr=(e,t=[])=>({value:e,forest:t}),uv=e=>Q1(Jr("error(s) found",e.map(Bl))),Q1=e=>e.value+lv(`
`,e.forest),lv=(e,t)=>{let r="",o=t.length,n;for(let s=0;s<o;s++){n=t[s];let i=s===o-1;r+=e+(i?"\u2514":"\u251C")+"\u2500 "+n.value,r+=lv(e+(o>1&&!i?"\u2502  ":"   "),n.forest)}return r},uc=e=>{if(e==null||typeof e=="number"||typeof e=="symbol"||e instanceof Date)return String(e);if(typeof e=="bigint")return String(e)+"n";try{return JSON.stringify(e)}catch{return String(e)}},Z1=e=>{switch(e.type._tag){case"StringKeyword":return"${string}";case"NumberKeyword":return"${number}"}},X1=e=>e.head+e.spans.map(t=>Z1(t)+t.literal).join(""),eU=nc(Ul),tU=nc(nt),rU=nc(bi),oU=nc(Qo),br=e=>ne(rU(e),ss(()=>tU(e)),ss(()=>oU(e))),Kl=e=>{switch(e._tag){case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"UndefinedKeyword":case"SymbolKeyword":case"ObjectKeyword":case"AnyKeyword":case"UnknownKeyword":case"VoidKeyword":case"NeverKeyword":return V(br(e),()=>e._tag);case"Literal":return V(br(e),()=>uc(e.literal));case"UniqueSymbol":return V(br(e),()=>uc(e.symbol));case"Union":return e.types.map(Kl).join(" or ");case"TemplateLiteral":return V(br(e),()=>X1(e));case"Tuple":return V(br(e),()=>"<anonymous tuple or array schema>");case"TypeLiteral":return V(br(e),()=>"<anonymous type literal schema>");case"Enums":return V(br(e),()=>e.enums.map((t,r)=>JSON.stringify(r)).join(" | "));case"Lazy":return V(br(e),()=>"<anonymous lazy schema>");case"Declaration":return V(br(e),()=>"<anonymous declaration schema>");case"Refinement":return V(br(e),()=>"<anonymous refinement schema>");case"Transform":return V(br(e),()=>`${Kl(e.from)} -> ${Kl(e.to)}`)}},Bl=e=>{switch(e._tag){case"Type":return Jr(ne(eU(e.expected),Te(t=>t(e.actual)),ss(()=>e.message),V(()=>`Expected ${Kl(e.expected)}, actual ${uc(e.actual)}`)));case"Forbidden":return Jr("is forbidden");case"Index":{let t=e.errors.map(Bl);return t.length===1&&t[0].forest.length!==0?Jr(`[${e.index}]${t[0].value}`,t[0].forest):Jr(`[${e.index}]`,t)}case"Unexpected":return Jr("is unexpected");case"Key":{let t=e.errors.map(Bl);return t.length===1&&t[0].forest.length!==0?Jr(`[${uc(e.key)}]${t[0].value}`,t[0].forest):Jr(`[${uc(e.key)}]`,t)}case"Missing":return Jr("is missing");case"UnionMember":return Jr("union member",e.errors.map(Bl))}};var mv=e=>{let t=st(e);return(r,o)=>t(r,{...o,isEffectAllowed:!0})};var pg=e=>st(e.ast);var fc=e=>mv(e.ast);var ug=e=>mv(Sr(e.ast)),st=(e,t=!0)=>{switch(e._tag){case"Refinement":if(e.isReversed){let r=st(Pe(e),t),o=st(Sr(hv(e.from)),!1);return(n,s)=>lc(yi(r(n,s),i=>o(i,s)),s)}else{let r=st(e.from,t);return(o,n)=>lc(yi(r(o,n),s=>e.decode(s,n)),n)}case"Transform":{let r=st(e.to,!1);if(t){let o=st(e.from);return(n,s)=>lc(yi(o(n,s),i=>yi(e.decode(i,s),c=>r(c,s))),s)}else return(o,n)=>lc(yi(e.decode(o,n),s=>r(s,n)),n)}case"Declaration":{let r=e.decode(...e.typeParameters);return(o,n)=>lc(r(o,n),n)}case"Literal":return yt(e,r=>r===e.literal);case"UniqueSymbol":return yt(e,r=>r===e.symbol);case"UndefinedKeyword":return yt(e,ki);case"VoidKeyword":return yt(e,ki);case"NeverKeyword":return yt(e,Ig);case"UnknownKeyword":case"AnyKeyword":return Je;case"StringKeyword":return yt(e,Ii);case"NumberKeyword":return yt(e,Zo);case"BooleanKeyword":return yt(e,_c);case"BigIntKeyword":return yt(e,rs);case"SymbolKeyword":return yt(e,Tg);case"ObjectKeyword":return yt(e,pe);case"Enums":return yt(e,r=>e.enums.some(([o,n])=>n===r));case"TemplateLiteral":{let r=iU(e);return yt(e,o=>Ii(o)&&r.test(o))}case"Tuple":{let r=e.elements.map(s=>st(s.type,t)),o=ne(e.rest,Te(as(s=>st(s)))),n=e.elements.filter(s=>!s.isOptional).length;return N(e.rest)&&(n+=e.rest.value.length-1),(s,i)=>{if(!Array.isArray(s))return Xt(yr(sU,s));let c=i?.errors==="all",p=[],u=0,f=s.length;for(let R=f;R<=n-1;R++){let v=Oo(R,[Hl]);if(c){p.push([u++,v]);continue}else return Xt(v)}if(z(e.rest))for(let R=e.elements.length;R<=f-1;R++){let v=Oo(R,[tg(s[R])]);if(c){p.push([u++,v]);continue}else return Ue(Ft(We(p),v))}let m=[],y=0,b;for(;y<r.length;y++)if(f<y+1){if(e.elements[y].isOptional)continue}else{let R=r[y],v=R(s[y],i),w=Yr(v);if(w){if(Ae(w)){let q=Oo(y,w.left.errors);if(c){p.push([u++,q]);continue}else return Ue(Ft(We(p),q))}m.push([u++,w.right])}else{let q=u++,W=y;b||(b=[]),b.push(({es:re,output:ge})=>wt(Jo(v),ke=>{if(Ae(ke)){let ce=Oo(W,ke.left.errors);return c?(re.push([q,ce]),xt):Ue(Ft(We(re),ce))}return ge.push([q,ke.right]),xt}))}}if(N(o)){let R=_e(o.value),v=qt(o.value);for(;y<f-v.length;y++){let w=R(s[y],i),q=Yr(w);if(q)if(Ae(q)){let W=Oo(y,q.left.errors);if(c){p.push([u++,W]);continue}else return Ue(Ft(We(p),W))}else m.push([u++,q.right]);else{let W=u++,re=y;b||(b=[]),b.push(({es:ge,output:ke})=>wt(Jo(w),ce=>{if(Ae(ce)){let _r=Oo(re,ce.left.errors);return c?(ge.push([W,_r]),xt):Ue(Ft(We(ge),_r))}else return ke.push([W,ce.right]),xt}))}}for(let w=0;w<v.length;w++)if(y+=w,!(f<y+1)){let q=v[w](s[y],i),W=Yr(q);if(W){if(Ae(W)){let re=Oo(y,W.left.errors);if(c){p.push([u++,re]);continue}else return Ue(Ft(We(p),re))}m.push([u++,W.right])}else{let re=u++,ge=y;b||(b=[]),b.push(({es:ke,output:ce})=>wt(Jo(q),_r=>{if(Ae(_r)){let Zr=Oo(ge,_r.left.errors);return c?(ke.push([re,Zr]),xt):Ue(Ft(We(ke),Zr))}return ce.push([re,_r.right]),xt}))}}}let C=({es:R,output:v})=>Fc(R)?Ue(We(R)):Je(We(v));if(b&&b.length>0){let R=b;return di(()=>{let v={es:Array.from(p),output:Array.from(m)};return wt(Za(R,w=>w(v),{concurrency:"unbounded",discard:!0}),()=>C(v))})}return C({output:m,es:p})}}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return yt(e,kg);let r=e.propertySignatures.map(i=>st(i.type,t)),o=e.indexSignatures.map(i=>[st(i.parameter,t),st(i.type,t)]),n=st(Ro(e.indexSignatures.map(i=>zl(i.parameter)))),s={};for(let i=0;i<r.length;i++)s[e.propertySignatures[i].name]=null;return(i,c)=>{if(!wi(i))return Xt(yr(fv,i));let p=c?.errors==="all",u=[],f=0;if(c?.onExcessProperty==="error"){for(let R of tc(i))if(!Object.prototype.hasOwnProperty.call(s,R)){let v=n(R),w=Yr(v);if(w&&Ae(w)){let q=Vr(R,[tg(i[R])]);if(p){u.push([f++,q]);continue}else return Ue(Ft(We(u),q))}}}let y={},b;for(let R=0;R<r.length;R++){let v=e.propertySignatures[R],w=r[R],q=v.name;if(Object.prototype.hasOwnProperty.call(i,q)){let W=w(i[q],c),re=Yr(W);if(re){if(Ae(re)){let ge=Vr(q,re.left.errors);if(p){u.push([f++,ge]);continue}else return Ue(Ft(We(u),ge))}y[q]=re.right}else{let ge=f++,ke=q;b||(b=[]),b.push(({es:ce,output:_r})=>wt(Jo(W),Zr=>{if(Ae(Zr)){let gc=Vr(ke,Zr.left.errors);return p?(ce.push([ge,gc]),xt):Ue(Ft(We(ce),gc))}return _r[ke]=Zr.right,xt}))}}else if(!v.isOptional){let W=Vr(q,[Hl]);if(p){u.push([f++,W]);continue}else return Xt(W)}}for(let R=0;R<o.length;R++){let v=o[R][0],w=o[R][1],q=Xx(i,e.indexSignatures[R].parameter);for(let W of q){if(Object.prototype.hasOwnProperty.call(s,W))continue;let re=Yr(v(W,c));if(re&&Ae(re)){let ce=Vr(W,re.left.errors);if(p){u.push([f++,ce]);continue}else return Ue(Ft(We(u),ce))}let ge=w(i[W],c),ke=Yr(ge);if(ke)if(Ae(ke)){let ce=Vr(W,ke.left.errors);if(p){u.push([f++,ce]);continue}else return Ue(Ft(We(u),ce))}else y[W]=ke.right;else{let ce=f++,_r=W;b||(b=[]),b.push(({es:Zr,output:gc})=>wt(Jo(ge),Xl=>{if(Ae(Xl)){let Sg=Vr(_r,Xl.left.errors);return p?(Zr.push([ce,Sg]),xt):Ue(Ft(We(Zr),Sg))}else return gc[W]=Xl.right,xt}))}}}let C=({es:R,output:v})=>Fc(R)?Ue(We(R)):Je(v);if(b&&b.length>0){let R=b;return di(()=>{let v={es:Array.from(u),output:Object.assign({},y)};return wt(Za(R,w=>w(v),{concurrency:"unbounded",discard:!0}),()=>C(v))})}return C({es:u,output:y})}}case"Union":{let r=nU(e.types),o=tc(r.keys),n=o.length,s=new Map;for(let i=0;i<e.types.length;i++)s.set(e.types[i],st(e.types[i],!0));return(i,c)=>{let p=[],u=0,f=[];if(n>0)if(wi(i))for(let b=0;b<n;b++){let C=o[b],R=r.keys[C].buckets;if(Object.prototype.hasOwnProperty.call(i,C)){let v=String(i[C]);Object.prototype.hasOwnProperty.call(R,v)?f=f.concat(R[v]):p.push([u++,Vr(C,[yr(r.keys[C].ast,i[C])])])}else p.push([u++,Vr(C,[Hl])])}else p.push([u++,yr(fv,i)]);r.otherwise.length>0&&(f=f.concat(r.otherwise));let m;for(let b=0;b<f.length;b++){let C=s.get(f[b])(i,c),R=!m||m.length===0?Yr(C):void 0;if(R){if(Cr(R))return Je(R.right);p.push([u++,rg(R.left.errors)])}else{let v=u++;m||(m=[]),m.push(w=>di(()=>"finalResult"in w?xt:wt(Jo(C),q=>(Cr(q)?w.finalResult=Je(q.right):w.es.push([v,rg(q.left.errors)]),xt))))}}let y=b=>Fc(b)?Ue(We(b)):Xt(yr(sc,i));if(m&&m.length>0){let b=m;return di(()=>{let C={es:Array.from(p)};return wt(Za(b,R=>R(C),{concurrency:1,discard:!0}),()=>"finalResult"in C?C.finalResult:y(C.es))})}return y(p)}}case"Lazy":{let r=Ll(()=>st(e.f(),t));return(o,n)=>r()(o,n)}}},yt=(e,t)=>r=>t(r)?Je(r):Xt(yr(e,r)),cg=e=>{switch(e._tag){case"Declaration":return cg(e.type);case"TypeLiteral":{let t=[];for(let r=0;r<e.propertySignatures.length;r++){let o=e.propertySignatures[r],n=er(o.type);Qn(n)&&!o.isOptional&&t.push([o.name,n])}return t}case"Refinement":case"Transform":return cg(e.from)}return[]},nU=e=>{let t={},r=[];for(let o=0;o<e.length;o++){let n=e[o],s=cg(n);if(s.length>0)for(let i=0;i<s.length;i++){let[c,p]=s[i],u=String(p.literal);t[c]=t[c]||{buckets:{},ast:sc};let f=t[c].buckets;if(Object.prototype.hasOwnProperty.call(f,u)){if(i<s.length-1)continue;f[u].push(n),t[c].ast=Ro([t[c].ast,p])}else{f[u]=[n],t[c].ast=Ro([t[c].ast,p]);break}}else r.push(n)}return{keys:t,otherwise:r}},hv=e=>tv(e)?hv(e.from):e,lc=(e,t)=>{let r=Yr(e);return r||(t?.isEffectAllowed===!0?e:Xt(KM))},sU=Zn([],d([Ei]),!0,{[Qo]:"a generic array"}),fv=Co([],[_i(Wl,Ei,!0),_i(ig,Ei,!0)],{[Qo]:"a generic object"}),Ft=(e,t)=>(e.push(t),e),iU=e=>{let t=`^${e.head}`;for(let r of e.spans)oc(r.type)?t+=".*":ql(r.type)&&(t+="-?\\d+(\\.\\d+)?"),t+=r.literal;return t+="$",new RegExp(t)};function We(e){return e.sort(([t],[r])=>t>r?1:t<r?-1:0).map(([t,r])=>r)}var Sr=e=>{switch(e._tag){case"Declaration":return Si(e.typeParameters.map(Sr),e.type,e.decode,e.annotations);case"Tuple":return Zn(e.elements.map(t=>ic(Sr(t.type),t.isOptional)),Te(e.rest,as(Sr)),e.isReadonly);case"TypeLiteral":return Co(e.propertySignatures.map(t=>Ne(t.name,Sr(t.type),t.isOptional,t.isReadonly,t.annotations)),e.indexSignatures.map(t=>_i(t.parameter,Sr(t.type),t.isReadonly)));case"Union":return Ro(e.types.map(Sr));case"Lazy":return ac(()=>Sr(e.f()));case"Refinement":return cc(e.from,e.decode,!e.isReversed,e.annotations);case"Transform":return jl(Sr(e.to),Sr(e.from),e.encode,e.decode,e.propertySignatureTransformations.map(t=>pc(t.to,t.from,t.encode,t.decode)))}return e};var fU=Symbol.for("@effect/schema/Schema");var lg=class{constructor(t){Nt(this,"ast");Nt(this,"_id",fU);Nt(this,"From");Nt(this,"To");this.ast=t}pipe(){return E(this,arguments)}},Pt=e=>new lg(e);var mU=e=>Pt(QM(e)),Xn=(...e)=>Oi(...e.map(t=>mU(t)));var dv=(e,t,r,o)=>Pt(Si(e.map(n=>n.ast),t.ast,(...n)=>r(...n.map(Pt)),o)),Oi=(...e)=>Pt(Ro(e.map(t=>t.ast)));var fg=e=>Pt(Zn([],d([e.ast]),!0));var Gl=class e{constructor(t,r,o){Nt(this,"_from");Nt(this,"_annotations");Nt(this,"_optional");Nt(this,"From");Nt(this,"FromIsOptional");Nt(this,"To");Nt(this,"ToIsOptional");this._from=t,this._annotations=r,this._optional=o}optional(){if(this._optional)throw new Error("duplicate optional configuration");return new e(this._from,this._annotations,{to:"optional"})}withDefault(t){if(this._optional&&this._optional.to!=="optional")throw new Error("duplicate optional configuration");return new e(this._from,this._annotations,{to:"default",value:t})}toOption(){if(this._optional&&this._optional.to!=="optional")throw new Error("duplicate optional configuration");return new e(this._from,this._annotations,{to:"Option"})}},hU=(e,t)=>new Gl(e.ast,t),es=(e,t)=>hU(e,t).optional(),Qr=e=>{let t=tc(e),r=[],o=[],n=[],s=[];for(let i=0;i<t.length;i++){let c=t[i],p=e[c];if(p instanceof Gl){let u=p._optional;if(u)switch(u.to){case"optional":{r.push(Ne(c,p._from,!0,!0,p._annotations)),o.push(Ne(c,p._from,!0,!0)),n.push(Ne(c,Pe(p._from),!0,!0,p._annotations));break}case"default":{o.push(Ne(c,p._from,!0,!0)),n.push(Ne(c,Pe(p._from),!1,!0,p._annotations)),s.push(pc(c,c,ss(()=>d(u.value())),F));break}case"Option":{o.push(Ne(c,p._from,!0,!0)),n.push(Ne(c,RU(Pt(Pe(p._from))).ast,!1,!0,p._annotations)),s.push(pc(c,c,d,$g));break}}else r.push(Ne(c,p._from,!1,!0,p._annotations)),o.push(Ne(c,p._from,!1,!0)),n.push(Ne(c,Pe(p._from),!1,!0,p._annotations))}else r.push(Ne(c,p.ast,!1,!0)),o.push(Ne(c,p.ast,!1,!0)),n.push(Ne(c,Pe(p.ast),!1,!0))}return s.length>0?Pt(ov(Co(o,[]),Co(n,[]),s)):Pt(Co(r,[]))};var dU=e=>{let t={};if(e?.typeId!==void 0){let r=e?.typeId;typeof r=="object"?(t[sg]=r.id,t[r.id]=r.params):t[sg]=r}return e?.message!==void 0&&(t[Ul]=e?.message),e?.identifier!==void 0&&(t[bi]=e?.identifier),e?.title!==void 0&&(t[nt]=e?.title),e?.description!==void 0&&(t[Qo]=e?.description),e?.examples!==void 0&&(t[VM]=e?.examples),e?.documentation!==void 0&&(t[JM]=e?.documentation),e?.jsonSchema!==void 0&&(t[YM]=e?.jsonSchema),e?.arbitrary!==void 0&&(t[Dl]=e?.arbitrary),t};function xv(e,t){return r=>{let o=s=>e(s)?Je(s):Xt(yr(n,s)),n=cc(r.ast,o,!1,dU(t));return Pt(n)}}var xU=a(4,(e,t,r,o)=>Pt(rv(e.ast,t.ast,r,o)));var mc=e=>t=>Pt(nv(t.ast,Qo,e));var Ao=Pt(Wl),mg=Pt(XM);var gU=()=>e=>e.date(),yU=()=>e=>`new Date(${JSON.stringify(e)})`,gv=dv([],Qr({}),()=>e=>Oc(e)?Je(e):Xt(yr(gv.ast,e)),{[bi]:"Date",[Zx]:yU,[Dl]:gU}),bU="@effect/schema/ValidDateTypeId",SU=e=>t=>t.pipe(xv(r=>!isNaN(r.getTime()),{typeId:bU,description:"a valid Date",...e})),EU=gv.pipe(SU()),hg=e=>xU(e,EU,r=>Je(new Date(r)),r=>Je(r.toISOString()));var _U=e=>t=>t.oneof(t.constant(x()),e(t).map(d)),OU=e=>De({onNone:()=>"none()",onSome:t=>`some(${e(t)})`}),CU=e=>Oi(Qr({_tag:Xn("None")}),Qr({_tag:Xn("Some"),value:e})),RU=e=>{let t=dv([e],CU(e),r=>{let o=pg(r);return(n,s)=>Bg(n)?z(n)?Je(x()):BM(o(n.value,s),d):Xt(yr(t.ast,n))},{[bi]:"Option",[Zx]:OU,[Dl]:_U});return t};var AU="@effect/schema/MaxLengthTypeId",hc=(e,t)=>r=>r.pipe(xv(o=>o.length<=e,{typeId:AU,description:`a string at most ${e} character(s) long`,jsonSchema:{maxLength:e},...t}));var _v=Ti(require("fs/promises")),Ov=Ti(require("@actions/glob"));var $l=require("@actions/core");var it=class extends xi.TaggedClass("GenericError"){},bv=e=>H.sync(()=>((0,$l.error)(e.message),(0,$l.debug)(`cause: ${e.error}`),process.exitCode=1,H.unit));var TU=gt.string("INPUT_FILE").pipe(gt.map(e=>({_tag:"File",path:e})),gt.orElse(()=>gt.string("JSON").pipe(gt.map(e=>({_tag:"Json",stringified:e})))),gt.orElse(()=>ne(gt.all({key:gt.string("KEY"),value:gt.number("VALUE")}),gt.map(({key:e,value:t})=>({_tag:"KeyVal",key:e,value:t})))),gt.nested("INPUT")),Cv=ne(H.config(TU),H.mapError(e=>new it({error:e,message:"Failed to read input"}))),Rv=e=>H.try({try:()=>JSON.parse(e),catch:t=>new it({message:"Failed to parse JSON",error:t})}),Av=Xn("lower-is-better","higher-is-better"),MU=Qr({key:ne(Ao,hc(120)),sortDate:ne(Ao,hg,es),value:mg,units:ne(Ao,hc(32),es),trend:ne(Av,es)}),E$=Qr({metrics:ne(MU,fg)}),Ev=Qr({key:ne(Ao,hc(120),mc("a key to identify the metric across runs")),value:ne(mg,mc("the value of the metric")),sortDate:ne(Ao,hg,mc("the date to apply sorting by. defaults to the commit time"),es),units:ne(Ao,hc(32),mc("the units of the metric. example: ms, MiB"),es),trend:ne(Av,es)}),Tv=Oi(ne(Ev,fg),Ev),_$=ug(Tv),Mv=e=>fc(Tv)(e).pipe(H.map(t=>[t].flat()),H.mapError(t=>new it({error:t,message:`Failed to parse given JSON:
${uv(t.errors)}`}))),vU=e=>H.tryPromise({try:()=>_v.default.readFile(e,"utf-8"),catch:t=>new it({message:"Failed to read file",error:t})}).pipe(H.flatMap(Rv),H.flatMap(Mv)),IU=e=>H.gen(function*(t){let r=yield*t(H.tryPromise({try:()=>Ov.create(e),catch:s=>new it({message:"Failed to parse glob syntax",error:s})})),o=yield*t(H.tryPromise({try:()=>r.glob(),catch:s=>new it({message:"Failed to iterate through glob",error:s})}));return(yield*t(H.all(o.map(vU),{concurrency:5}))).flat()}),vv=ne(ec.type(),ec.tagsExhaustive({File:({path:e})=>IU(e),Json:({stringified:e})=>Rv(e).pipe(H.flatMap(Mv)),KeyVal:({key:e,value:t})=>H.succeed([{key:e,value:t}])}));var Iv=e=>e;var kv=(e=0)=>t=>`\x1B[${t+e}m`,wv=(e=0)=>t=>`\x1B[${38+e};5;${t}m`,Fv=(e=0)=>(t,r,o)=>`\x1B[${38+e};2;${t};${r};${o}m`,ae={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}},C$=Object.keys(ae.modifier),wU=Object.keys(ae.color),FU=Object.keys(ae.bgColor),R$=[...wU,...FU];function PU(){let e=new Map;for(let[t,r]of Object.entries(ae)){for(let[o,n]of Object.entries(r))ae[o]={open:`\x1B[${n[0]}m`,close:`\x1B[${n[1]}m`},r[o]=ae[o],e.set(n[0],n[1]);Object.defineProperty(ae,t,{value:r,enumerable:!1})}return Object.defineProperty(ae,"codes",{value:e,enumerable:!1}),ae.color.close="\x1B[39m",ae.bgColor.close="\x1B[49m",ae.color.ansi=kv(),ae.color.ansi256=wv(),ae.color.ansi16m=Fv(),ae.bgColor.ansi=kv(10),ae.bgColor.ansi256=wv(10),ae.bgColor.ansi16m=Fv(10),Object.defineProperties(ae,{rgbToAnsi256:{value(t,r,o){return t===r&&r===o?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(o/255*5)},enumerable:!1},hexToRgb:{value(t){let r=/[a-f\d]{6}|[a-f\d]{3}/i.exec(t.toString(16));if(!r)return[0,0,0];let[o]=r;o.length===3&&(o=[...o].map(s=>s+s).join(""));let n=Number.parseInt(o,16);return[n>>16&255,n>>8&255,n&255]},enumerable:!1},hexToAnsi256:{value:t=>ae.rgbToAnsi256(...ae.hexToRgb(t)),enumerable:!1},ansi256ToAnsi:{value(t){if(t<8)return 30+t;if(t<16)return 90+(t-8);let r,o,n;if(t>=232)r=((t-232)*10+8)/255,o=r,n=r;else{t-=16;let c=t%36;r=Math.floor(t/36)/5,o=Math.floor(c/6)/5,n=c%6/5}let s=Math.max(r,o,n)*2;if(s===0)return 30;let i=30+(Math.round(n)<<2|Math.round(o)<<1|Math.round(r));return s===2&&(i+=60),i},enumerable:!1},rgbToAnsi:{value:(t,r,o)=>ae.ansi256ToAnsi(ae.rgbToAnsi256(t,r,o)),enumerable:!1},hexToAnsi:{value:t=>ae.ansi256ToAnsi(ae.hexToAnsi256(t)),enumerable:!1}}),ae}var NU=PU(),Er=NU;var Yl=Ti(require("process"),1),Nv=Ti(require("os"),1),dg=Ti(require("tty"),1);function tr(e,t=globalThis.Deno?globalThis.Deno.args:Yl.default.argv){let r=e.startsWith("-")?"":e.length===1?"-":"--",o=t.indexOf(r+e),n=t.indexOf("--");return o!==-1&&(n===-1||o<n)}var{env:le}=Yl.default,Vl;tr("no-color")||tr("no-colors")||tr("color=false")||tr("color=never")?Vl=0:(tr("color")||tr("colors")||tr("color=true")||tr("color=always"))&&(Vl=1);function DU(){if("FORCE_COLOR"in le)return le.FORCE_COLOR==="true"?1:le.FORCE_COLOR==="false"?0:le.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(le.FORCE_COLOR,10),3)}function LU(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function HU(e,{streamIsTTY:t,sniffFlags:r=!0}={}){let o=DU();o!==void 0&&(Vl=o);let n=r?Vl:o;if(n===0)return 0;if(r){if(tr("color=16m")||tr("color=full")||tr("color=truecolor"))return 3;if(tr("color=256"))return 2}if("TF_BUILD"in le&&"AGENT_NAME"in le)return 1;if(e&&!t&&n===void 0)return 0;let s=n||0;if(le.TERM==="dumb")return s;if(Yl.default.platform==="win32"){let i=Nv.default.release().split(".");return Number(i[0])>=10&&Number(i[2])>=10586?Number(i[2])>=14931?3:2:1}if("CI"in le)return"GITHUB_ACTIONS"in le||"GITEA_ACTIONS"in le?3:["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some(i=>i in le)||le.CI_NAME==="codeship"?1:s;if("TEAMCITY_VERSION"in le)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(le.TEAMCITY_VERSION)?1:0;if(le.COLORTERM==="truecolor"||le.TERM==="xterm-kitty")return 3;if("TERM_PROGRAM"in le){let i=Number.parseInt((le.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(le.TERM_PROGRAM){case"iTerm.app":return i>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(le.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(le.TERM)||"COLORTERM"in le?1:s}function Pv(e,t={}){let r=HU(e,{streamIsTTY:e&&e.isTTY,...t});return LU(r)}var qU={stdout:Pv({isTTY:dg.default.isatty(1)}),stderr:Pv({isTTY:dg.default.isatty(2)})},Dv=qU;function Lv(e,t,r){let o=e.indexOf(t);if(o===-1)return e;let n=t.length,s=0,i="";do i+=e.slice(s,o)+t+r,s=o+n,o=e.indexOf(t,s);while(o!==-1);return i+=e.slice(s),i}function Hv(e,t,r,o){let n=0,s="";do{let i=e[o-1]==="\r";s+=e.slice(n,i?o-1:o)+t+(i?`\r
`:`
`)+r,n=o+1,o=e.indexOf(`
`,n)}while(o!==-1);return s+=e.slice(n),s}var{stdout:qv,stderr:Uv}=Dv,xg=Symbol("GENERATOR"),Ci=Symbol("STYLER"),dc=Symbol("IS_EMPTY"),Wv=["ansi","ansi","ansi256","ansi16m"],Ri=Object.create(null),UU=(e,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");let r=qv?qv.level:0;e.level=t.level===void 0?r:t.level},Jl=class{constructor(t){return jv(t)}},jv=e=>{let t=(...r)=>r.join(" ");return UU(t,e),Object.setPrototypeOf(t,xc.prototype),t};function xc(e){return jv(e)}Object.setPrototypeOf(xc.prototype,Function.prototype);for(let[e,t]of Object.entries(Er))Ri[e]={get(){let r=Ql(this,yg(t.open,t.close,this[Ci]),this[dc]);return Object.defineProperty(this,e,{value:r}),r}};Ri.visible={get(){let e=Ql(this,this[Ci],!0);return Object.defineProperty(this,"visible",{value:e}),e}};var gg=(e,t,r,...o)=>e==="rgb"?t==="ansi16m"?Er[r].ansi16m(...o):t==="ansi256"?Er[r].ansi256(Er.rgbToAnsi256(...o)):Er[r].ansi(Er.rgbToAnsi(...o)):e==="hex"?gg("rgb",t,r,...Er.hexToRgb(...o)):Er[r][e](...o),WU=["rgb","hex","ansi256"];for(let e of WU){Ri[e]={get(){let{level:r}=this;return function(...o){let n=yg(gg(e,Wv[r],"color",...o),Er.color.close,this[Ci]);return Ql(this,n,this[dc])}}};let t="bg"+e[0].toUpperCase()+e.slice(1);Ri[t]={get(){let{level:r}=this;return function(...o){let n=yg(gg(e,Wv[r],"bgColor",...o),Er.bgColor.close,this[Ci]);return Ql(this,n,this[dc])}}}}var jU=Object.defineProperties(()=>{},{...Ri,level:{enumerable:!0,get(){return this[xg].level},set(e){this[xg].level=e}}}),yg=(e,t,r)=>{let o,n;return r===void 0?(o=e,n=t):(o=r.openAll+e,n=t+r.closeAll),{open:e,close:t,openAll:o,closeAll:n,parent:r}},Ql=(e,t,r)=>{let o=(...n)=>zU(o,n.length===1?""+n[0]:n.join(" "));return Object.setPrototypeOf(o,jU),o[xg]=e,o[Ci]=t,o[dc]=r,o},zU=(e,t)=>{if(e.level<=0||!t)return e[dc]?"":t;let r=e[Ci];if(r===void 0)return t;let{openAll:o,closeAll:n}=r;if(t.includes("\x1B"))for(;r!==void 0;)t=Lv(t,r.close,r.open),r=r.parent;let s=t.indexOf(`
`);return s!==-1&&(t=Hv(t,n,o,s)),o+t+n};Object.defineProperties(xc.prototype,Ri);var w$=xc(),F$=xc({level:Uv?Uv.level:0});var Zl=Pl.Tag(),zv=H.sync(()=>new Jl({level:2}));function Bv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,o)}return r}function Gv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Bv(Object(r),!0).forEach(function(o){KU(e,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bv(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))})}return e}function KU(e,t,r){return t=BU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function BU(e){var t=GU(e,"string");return typeof t=="symbol"?t:String(t)}function GU(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var o=r.call(e,t||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var $v=Vv({});function Vv(e){return t.withOptions=r=>Vv(Gv(Gv({},e),r)),t;function t(r,...o){let n=typeof r=="string"?[r]:r.raw,{escapeSpecialCharacters:s=Array.isArray(r)}=e,i="";for(let u=0;u<n.length;u++){let f=n[u];s&&(f=f.replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`").replace(/\\\$/g,"$").replace(/\\{/g,"{")),i+=f,u<o.length&&(i+=o[u])}let c=i.split(`
`),p=null;for(let u of c){let f=u.match(/^(\s+)\S+/);if(f){let m=f[1].length;p?p=Math.min(p,m):p=m}}if(p!==null){let u=p;i=c.map(f=>f[0]===" "||f[0]==="	"?f.slice(u):f).join(`
`)}return i.trim().replace(/\\n/g,`
`)}}var Yv=require("@actions/core"),bg=class extends xi.TaggedClass("IdTokenError"){},Jv=e=>H.gen(function*(t){let r=yield*t(Zl),o=r.cyan("`id-token`"),n=$v`
      Failed to read GitHub Actions ID token.

      This means you probably forgot to add permissions for ${o} in your workflow/job definition.
      The ${o} permissions allows GitHub to sign your requests to the Benchy API. This does not
      give GitHub access to your Benchy account: it's merely a way to prove that the request is coming
      from your GitHub workflow.

      An example of a workflow with the ${o} permission:

      \`\`\`yaml
       jobs:
         test:
           runs-on: ubuntu-latest
      ${r.green("+    permissions:")}
      ${r.green("+      id-token: write")}
           steps:
             # ...
      \`\`\`

      For more information about the ${o} permisison, see the GitHub documentation on OpenID Connect: https://docs.github.com/en/actions/deployment/security-hardening-your-deployments/about-security-hardening-with-openid-connect#overview-of-openid-connect
   `;return yield*t(H.fail(new it({message:n,error:e.error})))}),Qv=H.tryPromise({try:()=>(0,Yv.getIDToken)(),catch:e=>new bg({error:e})});var Xv=require("@actions/http-client");var eI=require("@actions/core"),tI=require("util");var $U=Qr({error:Xn(!0),message:Ao}),VU=Qr({error:Xn(!1)}),YU=Oi($U,VU),JU=fc(YU),rI=H.gen(function*(e){let t=yield*e(Qv);return new Xv.HttpClient("bnz-action",[],{headers:{Authorization:`Bearer ${t}`}})}),oI=(e,t)=>H.tryPromise({try:()=>e.postJson("https://bnz-web.vercel.app/api/metrics",{metrics:t}),catch:r=>new it({message:"Failed to send metrics",error:r})}).pipe(H.tap(r=>H.gen(function*(o){let n=yield*o(JU(r.result),H.mapError(s=>new it({error:s,message:"Response is malformed"})));if(n.error)return yield*o(H.fail(new it({error:new Error(`HTTP ${r.statusCode}: ${n.message}`),message:n.message})))})),H.tap(r=>H.sync(()=>(0,eI.debug)(`got response: ${(0,tI.inspect)(r,{depth:10,colors:!0})}`))));var ZU=H.gen(function*(e){let t=yield*e(Cv),r=yield*e(vv(t)),o=yield*e(rI);yield*e(oI(o,r))});ZU.pipe(H.catchTag("IdTokenError",e=>Jv(e)),H.catchTag("GenericError",e=>bv(e)),Iv,H.provideServiceEffect(Zl,zv),H.runPromise);
