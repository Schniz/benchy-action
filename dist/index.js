"use strict";var iv=Object.create;var nc=Object.defineProperty;var av=Object.getOwnPropertyDescriptor;var cv=Object.getOwnPropertyNames;var pv=Object.getPrototypeOf,uv=Object.prototype.hasOwnProperty;var lv=(e,t,r)=>t in e?nc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var sc=(e,t)=>{for(var r in t)nc(e,r,{get:t[r],enumerable:!0})},fv=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of cv(t))!uv.call(e,n)&&n!==r&&nc(e,n,{get:()=>t[n],enumerable:!(o=av(t,n))||o.enumerable});return e};var Zx=(e,t,r)=>(r=e!=null?iv(pv(e)):{},fv(t||!e||!e.__esModule?nc(r,"default",{value:e,enumerable:!0}):r,e));var kt=(e,t,r)=>(lv(e,typeof t!="symbol"?t+"":t,r),r);var Xx=e=>typeof e=="function",a=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):r=>t(r,...arguments)};switch(e){case 0:return t;case 1:return function(r){return arguments.length>=1?t(r):function(){return t(r)}};case 2:return function(r,o){return arguments.length>=2?t(r,o):function(n){return t(n,r)}};case 3:return function(r,o,n){return arguments.length>=3?t(r,o,n):function(s){return t(s,r,o)}};case 4:return function(r,o,n,s){return arguments.length>=4?t(r,o,n,s):function(i){return t(i,r,o,n)}};case 5:return function(r,o,n,s,i){return arguments.length>=5?t(r,o,n,s,i):function(c){return t(c,r,o,n,s)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(o){return t(o,...r)}}}};var F=e=>e;var xi=e=>()=>e,yr=xi(!0),wt=xi(!1);var ic=xi(void 0),Jn=ic;function ne(e,t,r,o,n,s,i,c,p){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return o(r(t(e)));case 5:return n(o(r(t(e))));case 6:return s(n(o(r(t(e)))));case 7:return i(s(n(o(r(t(e))))));case 8:return c(i(s(n(o(r(t(e)))))));case 9:return p(c(i(s(n(o(r(t(e))))))));default:{let u=arguments[0];for(let f=1;f<arguments.length;f++)u=arguments[f](u);return u}}}var ac=e=>(t,r)=>t===r||e(t,r);var eg=a(2,(e,t)=>ac((r,o)=>e(t(r),t(o))));var tg=e=>ac((t,r)=>{if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(!e(t[o],r[o]))return!1;return!0});var cc=e=>(t,r)=>t===r?0:e(t,r);var rg=cc((e,t)=>e<t?-1:1);var og=e=>cc((t,r)=>e(r,t));var gi=a(2,(e,t)=>cc((r,o)=>e(t(r),t(o))));var mv=e=>cc((t,r)=>{let o=Math.min(t.length,r.length),n=0;for(let s of e){if(n>=o)break;let i=s(t[n],r[n]);if(i!==0)return i;n++}return 0});var ng=(...e)=>mv(e);var Hl=e=>a(2,(t,r)=>e(t,r)===1);var ql=e=>a(2,(t,r)=>t===r||e(t,r)>-1?t:r);var yi=e=>typeof e=="string",Go=e=>typeof e=="number",pc=e=>typeof e=="boolean",Yn=e=>typeof e=="bigint",sg=e=>typeof e=="symbol",ig=Xx,bi=e=>e===void 0;var ag=e=>e===null;var cg=e=>!1;var ce=e=>typeof e=="object"&&e!=null||ig(e);var $o=e=>e==null,pg=e=>e!=null;var uc=e=>e instanceof Date,Ft=e=>ce(e)&&Symbol.iterator in e,Si=e=>ce(e)&&!Array.isArray(e);var ug=e=>!e;var dv=335903614,xv=4150755663,gv=1481765933,yv=1284865837,bv=9007199254740992,Sv=134217728,Qn=class{constructor(t,r,o,n){return $o(r)&&$o(t)?(r=Math.random()*4294967295>>>0,t=0):$o(r)&&(r=t,t=0),$o(n)&&$o(o)?(n=this._state?this._state[3]:xv,o=this._state?this._state[2]:dv):$o(n)&&(n=o,o=0),this._state=new Int32Array([0,0,o>>>0,((n||0)|1)>>>0]),this._next(),lg(this._state,this._state[0],this._state[1],t>>>0,r>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){if(!t)return this._next();if(t=t>>>0,!(t&t-1))return this._next()&t-1;let r=0,o=(-t>>>0)%t>>>0;for(r=this._next();r<o;r=this._next());return r%t}number(){let t=(this._next()&67108863)*1,r=(this._next()&134217727)*1;return(t*Sv+r)/bv}_next(){let t=this._state[0]>>>0,r=this._state[1]>>>0;Ev(this._state,t,r,gv,yv),lg(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let o=t>>>18,n=(r>>>18|t<<14)>>>0;o=(o^t)>>>0,n=(n^r)>>>0;let s=(n>>>27|o<<5)>>>0,i=t>>>27,c=(-i>>>0&31)>>>0;return(s>>>i|s<<c)>>>0}};function Ev(e,t,r,o,n){let s=(r>>>16)*(n&65535)>>>0,i=(r&65535)*(n>>>16)>>>0,c=(r&65535)*(n&65535)>>>0,p=(r>>>16)*(n>>>16)+((i>>>16)+(s>>>16))>>>0;i=i<<16>>>0,c=c+i>>>0,c>>>0<i>>>0&&(p=p+1>>>0),s=s<<16>>>0,c=c+s>>>0,c>>>0<s>>>0&&(p=p+1>>>0),p=p+Math.imul(r,o)>>>0,p=p+Math.imul(t,n)>>>0,e[0]=p,e[1]=c}function lg(e,t,r,o,n){let s=t+o>>>0,i=r+n>>>0;i>>>0<r>>>0&&(s=s+1|0),e[0]=s,e[1]=i}var jl=Symbol.for("@effect/data/Global/globalStoreId");jl in globalThis||(globalThis[jl]=new Map);var Wl=globalThis[jl],z=(e,t)=>(Wl.has(e)||Wl.set(e,t()),Wl.get(e));var zl=z(Symbol.for("@effect/data/Hash/randomHashCache"),()=>new WeakMap),Cv=z(Symbol.for("@effect/data/Hash/pcgr"),()=>new Qn),A=Symbol.for("@effect/data/Hash"),S=e=>{switch(typeof e){case"number":return fc(e);case"bigint":return ve(e.toString(10));case"boolean":return ve(String(e));case"symbol":return ve(String(e));case"string":return ve(e);case"undefined":return ve("undefined");case"function":case"object":return e===null?ve("null"):Rv(e)?e[A]():Eo(e);default:throw new Error("Bug in Equal.hash")}},Eo=e=>(zl.has(e)||zl.set(e,fc(Cv.integer(Number.MAX_SAFE_INTEGER))),zl.get(e)),I=e=>t=>t*53^e,lc=e=>e&3221225471|e>>>1&1073741824,Rv=e=>typeof e=="object"&&e!==null&&A in e,fc=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return lc(e)},ve=e=>{let t=5381,r=e.length;for(;r;)t=t*33^e.charCodeAt(--r);return lc(t)},Av=(e,t)=>{let r=12289;for(let o=0;o<t.length;o++)r^=I(S(e[t[o]]))(ve(t[o]));return lc(r)},_i=e=>Av(e,Object.keys(e)),$r=e=>{let t=6151;for(let r=0;r<e.length;r++)t=I(S(e[r]))(t);return lc(t)};var M=Symbol.for("@effect/data/Equal");function O(){return arguments.length===1?e=>fg(e,arguments[0]):fg(arguments[0],arguments[1])}function fg(e,t){if(e===t)return!0;let r=typeof e;return r!==typeof t?!1:(r==="object"||r==="function")&&e!==null&&t!==null&&Zn(e)&&Zn(t)?S(e)===S(t)&&e[M](t):!1}var Zn=e=>typeof e=="object"&&e!==null&&M in e,mc=()=>(e,t)=>S(e)===S(t)&&O(e,t);var _o=Symbol.for("@effect/io/Effect"),Oo={_R:e=>e,_E:e=>e,_A:e=>e};var E=(e,t)=>{switch(t.length){case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let o=0,n=t.length;o<n;o++)r=t[o](r);return r}}};var mg,hg,hc=Symbol.for("@effect/data/Option"),Kl=class{[(mg=_o,M)](t){return dg(t)&&$l(t)&&O(t.i0,this.i0)}[A](){return S(this.i0)}toString(){return`Some(${String(this.i0)})`}toJSON(){return{_tag:this._tag,value:this.i0}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}get[hc](){return{_A:t=>t}}get value(){return this.i0}constructor(t){this.i0=t,this._tag="Some",this._id=hc,this.i1=void 0,this.i2=void 0,this[mg]=Oo}pipe(){return E(this,arguments)}},Bl=class{constructor(){this._tag="None",this._id=hc,this.i0=void 0,this.i1=void 0,this.i2=void 0,this[hg]=Oo}[(hg=_o,M)](t){return dg(t)&&Gl(t)}[A](){return S(this._tag)}toString(){return"None()"}toJSON(){return{_tag:this._tag}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}get[hc](){return{_A:t=>t}}pipe(){return E(this,arguments)}},dg=e=>typeof e=="object"&&e!=null&&"_tag"in e&&(e._tag==="None"||e._tag==="Some")&&Zn(e),Gl=e=>e._tag==="None",$l=e=>e._tag==="Some",xg=new Bl,gg=e=>new Kl(e);var yg,bg,dc=Symbol.for("@effect/data/Either"),Vl=class{[(yg=_o,M)](t){return Sg(t)&&Ql(t)&&O(t.i0,this.i0)}[A](){return S(this.i0)}get right(){return this.i0}constructor(t){this.i0=t,this._tag="Right",this._id=dc,this.i1=void 0,this.i2=void 0,this[yg]=Oo}get[dc](){return{_E:t=>t,_A:t=>t}}toString(){return`right(${String(this.i0)})`}toJSON(){return{_tag:this._tag,right:this.i0}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},Jl=class{[(bg=_o,M)](t){return Sg(t)&&Yl(t)&&O(t.i0,this.i0)}[A](){return S(this.i0)}get[dc](){return{_E:t=>t,_A:t=>t}}get left(){return this.i0}constructor(t){this.i0=t,this._tag="Left",this._id=dc,this.i1=void 0,this.i2=void 0,this[bg]=Oo}toString(){return`left(${String(this.i0)})`}toJSON(){return{_tag:this._tag,left:this.i0}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},Sg=e=>typeof e=="object"&&e!=null&&"_tag"in e&&(e._tag==="Left"||e._tag==="Right")&&Zn(e),Yl=e=>e._tag==="Left",Ql=e=>e._tag==="Right",Eg=e=>new Jl(e),_g=e=>new Vl(e);var Iv=Symbol.for("@effect/data/Either"),P=_g,q=Eg;var xc=e=>ce(e)&&"_id"in e&&e._id===Iv,Ce=Yl,br=Ql;var gc=a(2,(e,{onLeft:t,onRight:r})=>Ce(e)?t(e.left):r(e.right)),yc=gc({onLeft:F,onRight:F});var xt=rg;var Pv=Symbol.for("@effect/data/Option"),x=()=>xg,d=gg,Og=e=>ce(e)&&"_id"in e&&e._id===Pv,j=Gl,N=$l,Pe=a(2,(e,{onNone:t,onSome:r})=>j(e)?t():r(e.value));var $=a(2,(e,t)=>j(e)?t():e.value),Xn=a(2,(e,t)=>j(e)?t():e);var Pt=e=>e==null?x():d(e);var Ue=$(ic);var Nv=a(2,(e,t)=>{if(N(e))return e.value;throw t()}),Cg=Nv(()=>new Error("getOrThrow called on a None")),Re=a(2,(e,t)=>j(e)?x():d(t(e.value)));var es=a(2,(e,t)=>j(e)?x():t(e.value));var Rg=es(F);var Dv=e=>a(2,(t,r)=>j(t)?!1:e(t.value,r)),Lv=mc(),Ag=Dv(Lv);var Zl=e=>e.length>0;var Xl=(e,t)=>{let r=Math.max(1,Math.floor(e)),o=[t(0)];for(let n=1;n<r;n++)o.push(t(n));return o};var Y=e=>Array.isArray(e)?e:Array.from(e);var Xt=a(2,(e,t)=>[t,...e]);var Mg=a(2,(e,t)=>[...e,t]);var qv=e=>e.length===0,ef=qv,Sc=Zl,Sr=Zl;var Tg=(e,t)=>e<0||e>=t.length;var Uv=a(2,(e,t)=>{let r=Math.floor(t);return Tg(r,e)?x():d(e[r])}),tf=a(2,(e,t)=>{let r=Math.floor(t);if(Tg(r,e))throw new Error(`Index ${r} out of bounds`);return e[r]});var Ec=Uv(0),Se=tf(0),vg=e=>Sr(e)?d(Wv(e)):x(),Wv=e=>e[e.length-1];var Nt=e=>e.slice(1);var rf=e=>Array.from(e).reverse();var Vo=a(2,(e,t)=>{let r=Array.from(e);return r.sort(t),r});var of=a(2,(e,t)=>Ig(e,t,(r,o)=>[r,o])),Ig=a(3,(e,t,r)=>{let o=Y(e),n=Y(t);return Sr(o)&&Sr(n)?jv(n,r)(o):[]});var jv=a(3,(e,t,r)=>{let o=[r(Se(e),Se(t))],n=Math.min(e.length,t.length);for(let s=1;s<n;s++)o[s]=r(e[s],t[s]);return o});var zv=a(2,(e,t)=>{let r=[Se(e)],o=Nt(e);for(let n of o)r.every(s=>!t(n,s))&&r.push(n);return r});var Jo=()=>[],gt=e=>[e],Vr=a(2,(e,t)=>e.map(t)),ts=Vr,_c=a(2,(e,t)=>{if(ef(e))return[];let r=[];for(let o=0;o<e.length;o++)r.push(...t(e[o],o));return r});var Oc=_c(F);var Oi=a(2,(e,t)=>{let r=Y(e),o=[];for(let n=0;n<r.length;n++){let s=t(r[n],n);N(s)&&o.push(s.value)}return o});var kg=Oi(F);var nt=a(3,(e,t,r)=>Y(e).reduce((o,n,s)=>r(o,n,s),t)),Cc=a(3,(e,t,r)=>Y(e).reduceRight((o,n,s)=>r(o,n,s),t));var nf=(e,t)=>{let r=[],o=e,n;for(;N(n=t(o));){let[s,i]=n.value;r.push(s),o=i}return r};var wg=tg;var Kv=a(2,(e,t)=>{let r=Y(e);return Sr(r)?zv(t)(r):[]}),Fg=Kv(mc());var Jr=a(2,(e,t)=>Y(e).join(t));var Pg,Ng=Symbol.for("@effect/data/Context/Tag"),Rc=class{[(Pg=_o,M)](t){return this===t}[A](){return Eo(this)}get[Ng](){return{_S:t=>t,_I:t=>t}}constructor(t){this._tag="Tag",this.i0=void 0,this.i1=void 0,this.i2=void 0,this[Pg]=Oo;let r=Error.stackTraceLimit;if(Error.stackTraceLimit=3,this.creationError=new Error,Error.stackTraceLimit=r,typeof t<"u")return this.i0=t,z(t,()=>this)}get stack(){return this.creationError.stack}toString(){return JSON.stringify(this)}toJSON(){return{_tag:"Tag",identifier:this.i0,stack:this.stack}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}of(t){return t}context(t){return af(this,t)}},sf=Symbol.for("@effect/data/Context"),Yr=class{[M](t){if(Dg(t)&&this.unsafeMap.size===t.unsafeMap.size){for(let r of this.unsafeMap.keys())if(!t.unsafeMap.has(r)||!O(this.unsafeMap.get(r),t.unsafeMap.get(r)))return!1;return!0}return!1}[A](){return fc(this.unsafeMap.size)}constructor(t){this.unsafeMap=t,this._id=sf,this._S=r=>r}pipe(){return E(this,arguments)}},Bv=e=>{let t=new Error(`Service not found${e.i0?`: ${String(e.i0)}`:""}`);if(e.stack){let r=e.stack.split(`
`);if(r.length>2){let o=r[3].match(/at (.*)/);o&&(t.message=t.message+` (defined at ${o[1]})`)}}if(t.stack){let r=t.stack.split(`
`);r.splice(1,3),t.stack=r.join(`
`)}return t},Dg=e=>typeof e=="object"&&e!==null&&"_id"in e&&e._id===sf;var Lg=()=>new Yr(new Map),af=(e,t)=>new Yr(new Map([[e,t]])),Hg=a(3,(e,t,r)=>{let o=new Map(e.unsafeMap);return o.set(t,r),new Yr(o)}),cf=a(2,(e,t)=>{if(!e.unsafeMap.has(t))throw Bv(t);return e.unsafeMap.get(t)}),qg=cf,Ug=a(2,(e,t)=>e.unsafeMap.has(t)?d(e.unsafeMap.get(t)):x()),Wg=a(2,(e,t)=>{let r=new Map(e.unsafeMap);for(let[o,n]of t.unsafeMap)r.set(o,n);return new Yr(r)});var yt=e=>new Rc(e);var Dt=Lg,pf=af,Ie=Hg,Qr=qg,Ci=cf,jg=Ug,rs=Wg;var $v=(()=>{let e={[A](){return $r(this)},[M](t){return Array.isArray(t)&&this.length===t.length?this.every((r,o)=>O(r,t[o])):!1}};return Object.setPrototypeOf(e,Array.prototype)})(),Vv=(()=>{let e={[A](){return _i(this)},[M](t){let r=Object.keys(this),o=Object.keys(t);if(r.length!==o.length)return!1;for(let n of r)if(!(n in t&&O(this[n],t[n])))return!1;return!0}};return Object.setPrototypeOf(e,Object.prototype)})(),Zr=e=>zg(Object.assign({},e)),zg=e=>Object.setPrototypeOf(e,Vv),Jv=(...e)=>uf(e),Yv=e=>uf(e.slice(0)),uf=e=>Object.setPrototypeOf(e,$v),Qv=()=>e=>Zr(e===void 0?{}:e);var Kg=e=>t=>Zr(t===void 0?{_tag:e}:{...t,_tag:e}),Zv=e=>{class t extends Bg{constructor(){super(...arguments),this._tag=e}}return t},Bg=(()=>{class e{constructor(r){r&&Object.assign(this,r)}[A](){return _i(this)}[M](r){let o=Object.keys(this),n=Object.keys(r);if(o.length!==n.length)return!1;for(let s of o)if(!(s in r&&O(this[s],r[s])))return!1;return!0}}return e})(),Xv=()=>Kg;var Jg=Symbol.for("@effect/data/Duration"),tI=BigInt(1e3),Gg=BigInt(1e9),$g=/^(-?\d+(?:\.\d+)?)\s+(nanos|micros|millis|seconds|minutes|hours|days|weeks)$/,We=e=>{if(Yg(e))return e;if(Go(e))return os(e);if(Yn(e))return Ac(e);{$g.lastIndex=0;let t=$g.exec(e);if(t){let[r,o,n]=t,s=Number(o);switch(n){case"nanos":return Ac(BigInt(o));case"micros":return oI(BigInt(o));case"millis":return os(s);case"seconds":return ff(s);case"minutes":return nI(s);case"hours":return sI(s);case"days":return iI(s);case"weeks":return aI(s)}}}throw new Error("Invalid duration input")},Vg={_tag:"Millis",millis:0},rI={_tag:"Infinity"},er=class{constructor(t){this._id=Jg,Go(t)?isNaN(t)||t<0?this.value=Vg:Number.isFinite(t)?Number.isInteger(t)?this.value={_tag:"Millis",millis:t}:this.value={_tag:"Nanos",nanos:BigInt(Math.round(t*1e6))}:this.value=rI:t<BigInt(0)?this.value=Vg:this.value={_tag:"Nanos",nanos:t}}[A](){return _i(this.value)}[M](t){return Yg(t)&&uI(this,t)}toString(){switch(this.value._tag){case"Millis":return`Duration("${this.value.millis} millis")`;case"Nanos":return`Duration("${this.value.nanos} nanos")`;case"Infinity":return"Duration(Infinity)"}}toJSON(){return this.value._tag==="Nanos"?{_tag:"Duration",value:{_tag:"Nanos",hrtime:cI(this)}}:{_tag:"Duration",value:this.value}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},Yg=e=>ce(e)&&"_id"in e&&e._id===Jg,lf=new er(0);var Ac=e=>new er(e),oI=e=>new er(e*tI),os=e=>new er(e),ff=e=>new er(e*1e3),nI=e=>new er(e*6e4),sI=e=>new er(e*36e5),iI=e=>new er(e*864e5),aI=e=>new er(e*6048e5),Er=e=>{let t=We(e);switch(t.value._tag){case"Infinity":return 1/0;case"Nanos":return Number(t.value.nanos)/1e6;case"Millis":return t.value.millis}};var cI=e=>{let t=We(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/Gg),Number(t.value.nanos%Gg)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}};var Qg=a(3,(e,t,r)=>{let o=We(e),n=We(t);if(o.value._tag==="Infinity"||n.value._tag==="Infinity")return r.onMillis(Er(o),Er(n));if(o.value._tag==="Nanos"||n.value._tag==="Nanos"){let s=o.value._tag==="Nanos"?o.value.nanos:BigInt(Math.round(o.value.millis*1e6)),i=n.value._tag==="Nanos"?n.value.nanos:BigInt(Math.round(n.value.millis*1e6));return r.onNanos(s,i)}return r.onMillis(o.value.millis,n.value.millis)});var pI=(e,t)=>Qg(e,t,{onMillis:(r,o)=>r===o,onNanos:(r,o)=>r===o});var mf=a(2,(e,t)=>Qg(e,t,{onMillis:(r,o)=>r>=o,onNanos:(r,o)=>r>=o})),uI=a(2,(e,t)=>pI(We(e),We(t)));var hf=Math.pow(2,5),Zg=hf-1,Xg=hf/2,ey=hf/4;function lI(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function Co(e,t){return t>>>e&Zg}function Ro(e){return 1<<e}function Mc(e,t){return lI(e&t-1)}function Qo(e,t,r,o){let n=o;if(!e){let s=o.length;n=new Array(s);for(let i=0;i<s;++i)n[i]=o[i]}return n[t]=r,n}function df(e,t,r){let o=r.length-1,n=0,s=0,i=r;if(e)n=s=t;else for(i=new Array(o);n<t;)i[s++]=r[n++];for(++n;n<=o;)i[s++]=r[n++];return e&&(i.length=o),i}function ty(e,t,r,o){let n=o.length;if(e){let p=n;for(;p>=t;)o[p--]=o[p];return o[t]=r,o}let s=0,i=0,c=new Array(n+1);for(;s<t;)c[i++]=o[s++];for(c[t]=r;s<n;)c[++i]=o[s++];return c}var Tc=class{constructor(t,r){this.value=t,this.previous=r}};var _r=class e{constructor(){this._tag="EmptyNode"}modify(t,r,o,n,s,i){let c=o(x());return j(c)?new e:(++i.value,new ns(t,n,s,c))}};function Lt(e){return e instanceof _r}function fI(e){return Lt(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function vc(e,t){return Lt(e)?!1:t===e.edit}var ns=class e{constructor(t,r,o,n){this.edit=t,this.hash=r,this.key=o,this.value=n,this._tag="LeafNode"}modify(t,r,o,n,s,i){if(O(s,this.key)){let p=o(this.value);return p===this.value?this:j(p)?(--i.value,new _r):vc(this,t)?(this.value=p,this):new e(t,n,s,p)}let c=o(x());return j(c)?this:(++i.value,ry(t,r,this.hash,this,n,new e(t,n,s,c)))}},xf=class e{constructor(t,r,o){this.edit=t,this.hash=r,this.children=o,this._tag="CollisionNode"}modify(t,r,o,n,s,i){if(n===this.hash){let p=vc(this,t),u=this.updateCollisionList(p,t,this.hash,this.children,o,s,i);return u===this.children?this:u.length>1?new e(t,this.hash,u):u[0]}let c=o(x());return j(c)?this:(++i.value,ry(t,r,this.hash,this,n,new ns(t,n,s,c)))}updateCollisionList(t,r,o,n,s,i,c){let p=n.length;for(let f=0;f<p;++f){let h=n[f];if("key"in h&&O(i,h.key)){let y=h.value,b=s(y);return b===y?n:j(b)?(--c.value,df(t,f,n)):Qo(t,f,new ns(r,o,i,b),n)}}let u=s(x());return j(u)?n:(++c.value,Qo(t,p,new ns(r,o,i,u),n))}},Ri=class e{constructor(t,r,o){this.edit=t,this.mask=r,this.children=o,this._tag="IndexedNode"}modify(t,r,o,n,s,i){let c=this.mask,p=this.children,u=Co(r,n),f=Ro(u),h=Mc(c,f),y=c&f,b=vc(this,t);if(!y){let H=new _r().modify(t,r+5,o,n,s,i);return H?p.length>=Xg?hI(t,u,H,c,p):new e(t,c|f,ty(b,h,H,p)):this}let C=p[h],R=C.modify(t,r+5,o,n,s,i);if(C===R)return this;let v=c,w;if(Lt(R)){if(v&=~f,!v)return new _r;if(p.length<=2&&fI(p[h^1]))return p[h^1];w=df(b,h,p)}else w=Qo(b,h,R,p);return b?(this.mask=v,this.children=w,this):new e(t,v,w)}},gf=class e{constructor(t,r,o){this.edit=t,this.size=r,this.children=o,this._tag="ArrayNode"}modify(t,r,o,n,s,i){let c=this.size,p=this.children,u=Co(r,n),f=p[u],h=(f||new _r).modify(t,r+5,o,n,s,i);if(f===h)return this;let y=vc(this,t),b;if(Lt(f)&&!Lt(h))++c,b=Qo(y,u,h,p);else if(!Lt(f)&&Lt(h)){if(--c,c<=ey)return mI(t,c,u,p);b=Qo(y,u,new _r,p)}else b=Qo(y,u,h,p);return y?(this.size=c,this.children=b,this):new e(t,c,b)}};function mI(e,t,r,o){let n=new Array(t-1),s=0,i=0;for(let c=0,p=o.length;c<p;++c)if(c!==r){let u=o[c];u&&!Lt(u)&&(n[s++]=u,i|=1<<c)}return new Ri(e,i,n)}function hI(e,t,r,o,n){let s=[],i=o,c=0;for(let p=0;i;++p)i&1&&(s[p]=n[c++]),i>>>=1;return s[t]=r,new gf(e,c+1,s)}function dI(e,t,r,o,n,s){if(r===n)return new xf(e,r,[s,o]);let i=Co(t,r),c=Co(t,n);if(i===c)return p=>new Ri(e,Ro(i)|Ro(c),[p]);{let p=i<c?[o,s]:[s,o];return new Ri(e,Ro(i)|Ro(c),p)}}function ry(e,t,r,o,n,s){let i,c=t;for(;;){let p=dI(e,c,r,o,n,s);if(typeof p=="function")i=new Tc(p,i),c=c+5;else{let u=p;for(;i!=null;)u=i.value(u),i=i.previous;return u}}}var yf=Symbol.for("@effect/data/HashMap"),Ai=class{constructor(t,r,o,n){this._editable=t,this._edit=r,this._root=o,this._size=n,this._id=yf}[Symbol.iterator](){return new Ic(this,(t,r)=>[t,r])}[A](){let t=S("HashMap");for(let r of this)t^=I(S(r[0]))(S(r[1]));return t}[M](t){if(iy(t)){if(t._size!==this._size)return!1;for(let r of this){let o=wc(r[0],S(r[0]))(t);if(j(o))return!1;if(!O(r[1],o.value))return!1}return!0}return!1}toString(){return`HashMap(${Array.from(this).map(([t,r])=>`[${String(t)}, ${String(r)}]`).join(", ")})`}toJSON(){return{_tag:"HashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},Ic=class e{constructor(t,r){this.map=t,this.f=r,this.v=oy(this.map._root,this.f,void 0)}next(){if(j(this.v))return{done:!0,value:void 0};let t=this.v.value;return this.v=kc(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new e(this.map,this.f)}},kc=e=>e?ny(e[0],e[1],e[2],e[3],e[4]):x(),oy=(e,t,r=void 0)=>{switch(e._tag){case"LeafNode":return N(e.value)?d({value:t(e.key,e.value.value),cont:r}):kc(r);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let o=e.children;return ny(o.length,o,0,t,r)}default:return kc(r)}},ny=(e,t,r,o,n)=>{for(;r<e;){let s=t[r++];if(s&&!Lt(s))return oy(s,o,[e,t,r,o,n])}return kc(n)},is=()=>new Ai(!1,0,new _r,0),sy=(...e)=>bf(e),bf=e=>{let t=Pc(is());for(let r of e)Zo(r[0],r[1])(t);return py(t)},iy=e=>ce(e)&&"_id"in e&&e._id===yf,ay=e=>e&&Lt(e._root),cy=a(2,(e,t)=>wc(e,t,S(t))),wc=a(3,(e,t,r)=>{let o=e._root,n=0;for(;;)switch(o._tag){case"LeafNode":return O(t,o.key)?o.value:x();case"CollisionNode":{if(r===o.hash){let s=o.children;for(let i=0,c=s.length;i<c;++i){let p=s[i];if("key"in p&&O(t,p.key))return p.value}}return x()}case"IndexedNode":{let s=Co(n,r),i=Ro(s);if(o.mask&i){o=o.children[Mc(o.mask,i)],n+=5;break}return x()}case"ArrayNode":{if(o=o.children[Co(n,r)],o){n+=5;break}return x()}default:return x()}});var Sf=a(2,(e,t)=>N(wc(e,t,S(t))));var Zo=a(3,(e,t,r)=>Ef(e,t,()=>d(r))),gI=a(3,(e,t,r)=>e._editable?(e._root=t,e._size=r,e):t===e._root?e:new Ai(e._editable,e._edit,t,r)),Fc=e=>new Ic(e,t=>t);var as=e=>e._size,Pc=e=>new Ai(!0,e._edit+1,e._root,e._size),py=e=>(e._editable=!1,e);var Ef=a(3,(e,t,r)=>uy(e,t,S(t),r)),uy=a(4,(e,t,r,o)=>{let n={value:e._size},s=e._root.modify(e._editable?e._edit:NaN,0,o,r,t,n);return gI(s,n.value)(e)});var Mi=a(2,(e,t)=>Ef(e,t,x));var ly=a(2,(e,t)=>cs(e,is(),(r,o,n)=>Zo(r,n,t(o,n))));var Nc=a(2,(e,t)=>cs(e,void 0,(r,o,n)=>t(o,n))),cs=a(3,(e,t,r)=>{let o=e._root;if(o._tag==="LeafNode")return N(o.value)?r(t,o.value.value,o.key):t;if(o._tag==="EmptyNode")return t;let n=[o.children],s;for(;s=n.pop();)for(let i=0,c=s.length;i<c;){let p=s[i++];p&&!Lt(p)&&(p._tag==="LeafNode"?N(p.value)&&(t=r(t,p.value.value,p.key)):n.push(p.children))}return t});var _f=Symbol.for("@effect/data/HashSet"),ps=class{constructor(t){this._keyMap=t,this._id=_f}[Symbol.iterator](){return Fc(this._keyMap)}[A](){return I(S(this._keyMap))(S("HashSet"))}[M](t){return my(t)?as(this._keyMap)===as(t._keyMap)&&O(this._keyMap,t._keyMap):!1}toString(){return`HashSet(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"HashSet",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},my=e=>ce(e)&&"_id"in e&&e._id===_f,Ti=()=>new ps(is()),hy=e=>{let t=Dc(Ti());for(let r of e)us(t,r);return Lc(t)},dy=(...e)=>{let t=Dc(Ti());for(let r of e)us(t,r);return Lc(t)},xy=a(2,(e,t)=>Sf(e._keyMap,t));var gy=e=>as(e._keyMap),Dc=e=>new ps(Pc(e._keyMap)),Lc=e=>(e._keyMap._editable=!1,e),Of=a(2,(e,t)=>{let r=Dc(e);return t(r),Lc(r)}),us=a(2,(e,t)=>e._keyMap._editable?(Zo(t,!0)(e._keyMap),e):new ps(Zo(t,!0)(e._keyMap))),Cf=a(2,(e,t)=>e._keyMap._editable?(Mi(t)(e._keyMap),e):new ps(Mi(t)(e._keyMap))),yy=a(2,(e,t)=>Of(e,r=>{for(let o of t)Cf(r,o)}));var by=a(2,(e,t)=>Of(Ti(),r=>{Sy(e,o=>us(r,o));for(let o of t)us(r,o)}));var Sy=a(2,(e,t)=>Nc(e._keyMap,(r,o)=>t(o))),Ey=a(3,(e,t,r)=>cs(e._keyMap,t,(o,n,s)=>r(o,s)));var Xr=is,_y=sy,Hc=bf,Oy=ay,vi=cy;var Or=Zo,Rf=Fc;var qc=as;var Cy=Mi;var Ry=ly;var Ay=Nc,Af=cs;var bI=Symbol.for("@effect/data/MutableRef"),Mf=class{constructor(t){this.current=t,this._T=r=>r,this._id=bI}toString(){return`MutableRef(${String(this.current)})`}toJSON(){return{_tag:"MutableRef",current:this.current}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},st=e=>new Mf(e),Uc=a(3,(e,t,r)=>O(t,e.current)?(e.current=r,!0):!1);var St=e=>e.current;var My=e=>EI(e,t=>t+1),Ht=a(2,(e,t)=>(e.current=t,e)),SI=a(2,(e,t)=>(e.current=t,e.current)),Tf=a(2,(e,t)=>Ht(e,t(St(e)))),EI=a(2,(e,t)=>SI(e,t(St(e))));var _I=Symbol.for("@effect/data/MutableHashMap"),vf=class{constructor(){this._id=_I,this.backingMap=st(Xr())}[Symbol.iterator](){return this.backingMap.current[Symbol.iterator]()}toString(){return`MutableHashMap(${Array.from(this).map(([t,r])=>`[${String(t)}, ${String(r)}]`).join(", ")})`}toJSON(){return{_tag:"MutableHashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},tn=()=>new vf;var xe=a(2,(e,t)=>vi(e.backingMap.current,t)),tr=a(2,(e,t)=>N(xe(e,t)));var rn=a(2,(e,t)=>(Tf(e.backingMap,Cy(t)),e)),it=a(3,(e,t,r)=>(Tf(e.backingMap,Or(t,r)),e)),Wc=e=>qc(St(e.backingMap));var Ty=Symbol.for("@effect/data/Chunk");function OI(e,t,r,o,n){for(let s=t;s<Math.min(e.length,t+n);s++)r[o+s-t]=e[s];return r}var vy=[],CI=e=>ac((t,r)=>Ye(t).every((o,n)=>e(o,Ao(r,n)))),RI=CI(O),re=class{constructor(t){switch(this.backing=t,this._id=Ty,t._tag){case"IEmpty":{this.length=0,this.depth=0,this.left=this,this.right=this;break}case"IConcat":{this.length=t.left.length+t.right.length,this.depth=1+Math.max(t.left.depth,t.right.depth),this.left=t.left,this.right=t.right;break}case"IArray":{this.length=t.array.length,this.depth=0,this.left=rr,this.right=rr;break}case"ISingleton":{this.length=1,this.depth=0,this.left=rr,this.right=rr;break}case"ISlice":{this.length=t.length,this.depth=t.chunk.depth+1,this.left=rr,this.right=rr;break}}}toString(){return`Chunk(${Ye(this).map(String).join(", ")})`}toJSON(){return{_tag:"Chunk",values:Ye(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}[M](t){return Iy(t)&&RI(this,t)}[A](){return $r(Ye(this))}[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return vy[Symbol.iterator]();default:return Ye(this)[Symbol.iterator]()}}pipe(){return E(this,arguments)}},Iy=e=>ce(e)&&"_id"in e&&e._id===Ty,rr=new re({_tag:"IEmpty"}),Qe=()=>rr;var Ee=e=>new re({_tag:"ISingleton",a:e}),Cr=e=>Iy(e)?e:new re({_tag:"IArray",array:Y(e)}),kf=(e,t,r)=>{switch(e.backing._tag){case"IArray":{OI(e.backing.array,0,t,r,e.length);break}case"IConcat":{kf(e.left,t,r),kf(e.right,t,r+e.left.length);break}case"ISingleton":{t[r]=e.backing.a;break}case"ISlice":{let o=0,n=r;for(;o<e.length;)t[n]=Ao(e,o),o+=1,n+=1;break}}},Ye=e=>{switch(e.backing._tag){case"IEmpty":return vy;case"IArray":return e.backing.array;default:{let t=new Array(e.length);return kf(e,t,0),e.backing={_tag:"IArray",array:t},e.left=rr,e.right=rr,e.depth=0,t}}},eo=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return new re({_tag:"IArray",array:rf(e.backing.array)});case"IConcat":return new re({_tag:"IConcat",left:eo(e.backing.right),right:eo(e.backing.left)});case"ISlice":return Et(rf(Ye(e)))}},AI=a(2,(e,t)=>t<0||t>=e.length?x():d(Ao(e,t))),Et=e=>new re({_tag:"IArray",array:e});var Ao=a(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?Ao(e.left,t):Ao(e.right,t-e.left.length);case"ISlice":return Ao(e.backing.chunk,t+e.backing.offset)}}),jc=a(2,(e,t)=>ky(e,Ee(t))),Ae=a(2,(e,t)=>ky(Ee(t),e)),wf=a(2,(e,t)=>{if(t<=0)return rr;if(t>=e.length)return e;switch(e.backing._tag){case"ISlice":return new re({_tag:"ISlice",chunk:e.backing.chunk,length:t,offset:e.backing.offset});case"IConcat":return t>e.left.length?new re({_tag:"IConcat",left:e.left,right:wf(e.right,t-e.left.length)}):wf(e.left,t);default:return new re({_tag:"ISlice",chunk:e,offset:0,length:t})}}),ls=a(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return rr;switch(e.backing._tag){case"ISlice":return new re({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?ls(e.right,t-e.left.length):new re({_tag:"IConcat",left:ls(e.left,t),right:e.right});default:return new re({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}});var or=a(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;let r=t.depth-e.depth;if(Math.abs(r)<=1)return new re({_tag:"IConcat",left:e,right:t});if(r<-1)if(e.left.depth>=e.right.depth){let o=or(e.right,t);return new re({_tag:"IConcat",left:e.left,right:o})}else{let o=or(e.right.right,t);if(o.depth===e.depth-3){let n=new re({_tag:"IConcat",left:e.right.left,right:o});return new re({_tag:"IConcat",left:e.left,right:n})}else{let n=new re({_tag:"IConcat",left:e.left,right:e.right.left});return new re({_tag:"IConcat",left:n,right:o})}}else if(t.right.depth>=t.left.depth){let o=or(e,t.left);return new re({_tag:"IConcat",left:o,right:t.right})}else{let o=or(e,t.left.left);if(o.depth===t.depth-3){let n=new re({_tag:"IConcat",left:o,right:t.left.right});return new re({_tag:"IConcat",left:n,right:t.right})}else{let n=new re({_tag:"IConcat",left:t.left.right,right:t.right});return new re({_tag:"IConcat",left:o,right:n})}}}),ky=a(2,(e,t)=>or(e,t));var fs=e=>e.length===0,je=e=>e.length>0,on=AI(0),nn=e=>Ao(e,0),ze=nn;var wy=e=>Ao(e,e.length-1),Ff=a(2,(e,t)=>e.backing._tag==="ISingleton"?Ee(t(e.backing.a,0)):Et(Vr((r,o)=>t(r,o))(Ye(e))));var zc=a(2,(e,t)=>Et(Vo(Ye(e),t)));var MI=a(2,(e,t)=>[wf(e,t),ls(e,t)]);var Fy=a(2,(e,t)=>{let r=0;for(let o of Ye(e)){if(t(o))break;r++}return MI(e,r)});var Ke=e=>ls(e,1);var Py=e=>Et(Fg(Ye(e)));var TI=Symbol.for("@effect/data/MutableList"),Pf=class{constructor(){this._id=TI,this.head=void 0,this.tail=void 0,this._length=0}[Symbol.iterator](){let t=!1,r=this.head;return{next(){if(t)return this.return();if(r==null)return t=!0,this.return();let o=r.value;return r=r.next,{done:t,value:o}},return(o){return t||(t=!0),{done:!0,value:o}}}}toString(){return`MutableList(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableList",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},Nf=class{constructor(t){this.value=t,this.removed=!1,this.prev=void 0,this.next=void 0}},Ny=()=>new Pf;var Dy=e=>Df(e)===0,Df=e=>e._length;var Ly=a(2,(e,t)=>{let r=new Nf(t);return e.head===void 0&&(e.head=r),e.tail===void 0||(e.tail.next=r,r.prev=e.tail),e.tail=r,e._length+=1,e}),Hy=e=>{let t=e.head;if(t!==void 0)return vI(e,t),t.value};var vI=(e,t)=>{t.removed||(t.removed=!0,t.prev!==void 0&&t.next!==void 0?(t.prev.next=t.next,t.next.prev=t.prev):t.prev!==void 0?(e.tail=t.prev,t.prev.next=void 0):t.next!==void 0?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))};var kI=Symbol.for("@effect/data/MutableQueue"),Hf=Symbol.for("@effect/data/mutable/MutableQueue/Empty"),Lf=class{constructor(t=void 0){this.capacity=t,this._tag="Bounded",this._id=kI,this.queue=Ny()}[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()}toString(){return`MutableQueue(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableQueue",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}};var qy=()=>new Lf;var Uy=a(2,(e,t)=>{let r=Df(e.queue);return e.capacity!==void 0&&r===e.capacity?!1:(Ly(t)(e.queue),!0)});var Wy=a(2,(e,t)=>Dy(e.queue)?t:Hy(e.queue));var ms=Symbol.for("@effect/data/Differ/ContextPatch");function Rr(e){return e}var qf=class{constructor(){this._tag="Empty",this._Input=Rr,this._Output=Rr,this._id=ms}[A](){return ve("ContextPatch(Empty)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}},Uf=class{constructor(t,r){this.first=t,this.second=r,this._tag="AndThen",this._id=ms,this._Input=Rr,this._Output=Rr}[A](){return ve("ContextPatch(AndThen)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.first,t.first)&&O(this.second,t.second)}},Wf=class{constructor(t,r){this.tag=t,this.service=r,this._tag="AddService",this._id=ms,this._Input=Rr,this._Output=Rr}[A](){return ve("ContextPatch(AddService)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.tag,t.tag)&&O(this.service,t.service)}},jf=class{constructor(t){this.tag=t,this._tag="RemoveService",this._id=ms,this._Input=Rr,this._Output=Rr}[A](){return ve("ContextPatch(RemoveService)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.tag,t.tag)}},zf=class{constructor(t,r){this.tag=t,this.update=r,this._tag="UpdateService",this._id=ms,this._Input=Rr,this._Output=Rr}[A](){return ve("ContextPatch(AndThen)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.tag,t.tag)&&O(this.update,t.update)}},Kf=()=>new qf,jy=(e,t)=>{let r=new Map(e.unsafeMap),o=Kf();for(let[n,s]of t.unsafeMap.entries())if(r.has(n)){let i=r.get(n);r.delete(n),O(i,s)||(o=Ii(new zf(n,()=>s))(o))}else r.delete(n),o=Ii(new Wf(n,s))(o);for(let[n]of r.entries())o=Ii(new jf(n))(o);return o},Ii=a(2,(e,t)=>new Uf(e,t)),zy=a(2,(e,t)=>{let r=!1,o=Ee(e),n=new Map(t.unsafeMap);for(;je(o);){let i=ze(o),c=Ke(o);switch(i._tag){case"Empty":{o=c;break}case"AddService":{n.set(i.tag,i.service),o=c;break}case"AndThen":{o=Ae(Ae(c,i.second),i.first);break}case"RemoveService":{n.delete(i.tag),o=c;break}case"UpdateService":{n.set(i.tag,i.update(n.get(i.tag))),r=!0,o=c;break}}}if(!r)return new Yr(n);let s=new Map;for(let[i]of t.unsafeMap)n.has(i)&&(s.set(i,n.get(i)),n.delete(i));for(let[i,c]of n)s.set(i,c);return new Yr(s)});var Kc=Kf,Ky=jy,By=Ii,Gy=zy;var Be=Ti,at=hy,to=dy,Vy=xy;var ro=gy;var Ar=us,Bf=Cf,Gf=yy;var Ge=by;var sn=Ey;var ki=Symbol.for("@effect/data/Differ/HashSetPatch");function Gc(e){return e}var $f=class{constructor(){this._tag="Empty",this._Value=Gc,this._id=ki}[A](){return ve("HashSetPatch(Empty)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}},Vf=class{constructor(t,r){this.first=t,this.second=r,this._tag="AndThen",this._Value=Gc,this._id=ki}[A](){return ve("HashSetPatch(AndThen)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.first,t.first)&&O(this.second,t.second)}},Jf=class{constructor(t){this.value=t,this._tag="Add",this._Value=Gc,this._id=ki}[A](){return ve("HashSetPatch(Add)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.value,t.value)}},Yf=class{constructor(t){this.value=t,this._tag="Remove",this._Value=Gc,this._id=ki}[A](){return ve("HashSetPatch(Remove)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.value,t.value)}},Qf=()=>new $f,Jy=(e,t)=>{let[r,o]=sn([e,Qf()],([n,s],i)=>Vy(i)(n)?[Bf(i)(n),s]:[n,Bc(new Jf(i))(s)])(t);return sn(o,(n,s)=>Bc(new Yf(s))(n))(r)},Bc=a(2,(e,t)=>new Vf(e,t)),Yy=a(2,(e,t)=>{let r=t,o=Ee(e);for(;je(o);){let n=ze(o),s=Ke(o);switch(n._tag){case"Empty":{o=s;break}case"AndThen":{o=Ae(n.first)(Ae(n.second)(s));break}case"Add":{r=Ar(n.value)(r),o=s;break}case"Remove":r=Bf(n.value)(r),o=s}}return r});var $c=Qf,Qy=Jy,Zy=Bc,Xy=Yy;var tb=Symbol.for("@effect/data/Differ"),Zf=class{constructor(t){this._id=tb,this._P=F,this._V=F,this.empty=t.empty,this.diff=t.diff,this.combine=t.combine,this.patch=t.patch}},wi=e=>new Zf(e),rb=()=>wi({empty:Kc(),combine:(e,t)=>By(t)(e),diff:(e,t)=>Ky(e,t),patch:(e,t)=>Gy(t)(e)});var ob=()=>wi({empty:$c(),combine:(e,t)=>Zy(t)(e),diff:(e,t)=>Qy(e,t),patch:(e,t)=>Xy(t)(e)});var nb=()=>sb((e,t)=>t),sb=e=>wi({empty:F,combine:(t,r)=>t===F?r:r===F?t:o=>r(t(o)),diff:(t,r)=>O(t,r)?F:xi(r),patch:(t,r)=>e(r,t(r))});var ib=a(3,(e,t,r)=>e.diff(t,r)),ab=a(3,(e,t,r)=>e.combine(t,r)),cb=a(3,(e,t,r)=>e.patch(t,r)),Vc=wi,pb=rb;var ub=ob;var lb=nb;var tm=Symbol.for("@effect/data/List"),Fi=e=>Array.from(e),LI=e=>eg(wg(e),Fi),HI=LI(O),hs=class{constructor(t,r){this.head=t,this.tail=r,this._tag="Cons",this._id=tm}toString(){return`List.Cons(${Fi(this).map(String).join(", ")})`}toJSON(){return{_tag:"List.Cons",values:Fi(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}[M](t){return fb(t)&&this._tag===t._tag&&HI(this,t)}[A](){return $r(Fi(this))}[Symbol.iterator](){let t=!1,r=this;return{next(){if(t)return this.return();if(r._tag==="Nil")return t=!0,this.return();let o=r.head;return r=r.tail,{done:t,value:o}},return(o){return t||(t=!0),{done:!0,value:o}}}}pipe(){return E(this,arguments)}},em=class{constructor(){this._tag="Nil",this._id=tm}toString(){return"List.Nil"}toJSON(){return{_tag:"List.Nil"}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}[A](){return $r(Fi(this))}[M](t){return fb(t)&&this._tag===t._tag}[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}}pipe(){return E(this,arguments)}},fb=e=>ce(e)&&"_id"in e&&e._id===tm,ct=e=>e._tag==="Nil",Pi=e=>e._tag==="Cons";var mb=new em,qI=()=>mb,oo=(e,t)=>new hs(e,t),nr=qI,Ni=e=>new hs(e,mb);var hb=a(2,(e,t)=>UI(t,e));var Mo=a(2,(e,t)=>oo(t,e)),UI=a(2,(e,t)=>{if(ct(e))return t;if(ct(t))return e;{let r=new hs(t.head,e),o=r,n=t.tail;for(;!ct(n);){let s=new hs(n.head,e);o.tail=s,o=s,n=n.tail}return r}});var db=a(2,(e,t)=>{let r=e;for(;!ct(r);){if(t(r.head))return d(r.head);r=r.tail}return x()});var Jc=e=>ct(e)?x():d(e.head);var xb=a(3,(e,t,r)=>{let o=t,n=e;for(;!ct(n);)o=r(o,n.head),n=n.tail;return o});var gb=e=>{let t=nr(),r=e;for(;!ct(r);)t=Mo(t,r.head),r=r.tail;return t};var yb,bb,Sb,Qc="@effect/io/Fiber/Id",To=Symbol.for(Qc),Di="None",rm="Runtime",om="Composite",nm=class{constructor(){this[yb]=To,this._tag=Di}[(yb=To,A)](){return I(S(this._tag))(S(Qc))}[M](t){return Xc(t)&&t._tag===Di}},sm=class{constructor(t,r){this.id=t,this.startTimeMillis=r,this[bb]=To,this._tag=rm}[(bb=To,A)](){return I(S(this.startTimeMillis))(I(S(this.id))(I(S(this._tag))(S(Qc))))}[M](t){return Xc(t)&&t._tag===rm&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}},im=class{constructor(t,r){this.left=t,this.right=r,this[Sb]=To,this._tag=om}[(Sb=To,A)](){return I(S(this.right))(I(S(this.left))(I(S(this._tag))(S(Qc))))}[M](t){return Xc(t)&&t._tag===om&&O(this.left,t.left)&&O(this.right,t.right)}},Zc=new nm;var Xc=e=>typeof e=="object"&&e!=null&&To in e;var _b=a(2,(e,t)=>e._tag===Di?t:t._tag===Di?e:new im(e,t));var Yc=e=>{switch(e._tag){case Di:return Be();case rm:return to(e.id);case om:return Ge(Yc(e.right))(Yc(e.left))}},Eb=z(Symbol.for("@effect/io/Fiber/Id/_fiberCounter"),()=>st(0));var ep=e=>Array.from(Yc(e)).map(r=>`#${r}`).join(",");var Ob=()=>{let e=St(Eb);return Ht(e+1)(Eb),new sm(e,new Date().getTime())};var Ze=Zc;var am=_b;var Rb=ep;var tp=Ob;var an="Die",vo="Empty",cn="Fail",gs="Interrupt",pn="Annotated",un="Parallel",ln="Sequential";var kb="@effect/io/Cause",fm=Symbol.for(kb),jI={_E:e=>e},mn={[fm]:jI,[A](){return I(S(KI(this)))(S(kb))},[M](e){return sp(e)&&zI(this,e)},pipe(){return E(this,arguments)},toJSON(){return{_tag:"Cause",errors:pp(this)}},toString(){return io(this)},[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}},Xe=(()=>{let e=Object.create(mn);return e._tag=vo,e})(),hn=e=>{let t=Object.create(mn);return t._tag=cn,t.error=e,t},Ne=e=>{let t=Object.create(mn);return t._tag=an,t.defect=e,t},sr=e=>{let t=Object.create(mn);return t._tag=gs,t.fiberId=e,t},Io=(e,t)=>{let r=Object.create(mn);return r._tag=pn,r.cause=e,r.annotation=t,r},ke=(e,t)=>{let r=Object.create(mn);return r._tag=un,r.left=e,r.right=t,r},_e=(e,t)=>{let r=Object.create(mn);return r._tag=ln,r.left=e,r.right=t,r},sp=e=>typeof e=="object"&&e!=null&&fm in e,mm=e=>e._tag===vo;var ip=e=>e._tag===an;var hm=e=>e._tag===vo?!0:fn(e,!0,(t,r)=>{switch(r._tag){case vo:return d(t);case an:case cn:case gs:return d(!1);default:return x()}});var ko=e=>cp(void 0,GI)(e),Li=e=>eo(fn(e,Qe(),(t,r)=>r._tag===cn?d(Ae(r.error)(t)):x())),ap=e=>eo(fn(e,Qe(),(t,r)=>r._tag===an?d(Ae(r.defect)(t)):x())),Hi=e=>fn(e,Be(),(t,r)=>r._tag===gs?d(Ar(r.fiberId)(t)):x()),wb=e=>qi(e,t=>t._tag===cn?d(t.error):x()),no=e=>{let t=wb(e);switch(t._tag){case"None":return P(e);case"Some":return q(t.value)}};var dm=e=>bs(e,{onEmpty:x(),onFail:()=>x(),onDie:t=>d(Ne(t)),onInterrupt:()=>x(),onAnnotated:(t,r)=>Re(o=>Io(o,r))(t),onSequential:(t,r)=>N(t)&&N(r)?d(_e(t.value,r.value)):N(t)&&j(r)?d(t.value):j(t)&&N(r)?d(r.value):x(),onParallel:(t,r)=>N(t)&&N(r)?d(ke(t.value,r.value)):N(t)&&j(r)?d(t.value):j(t)&&N(r)?d(r.value):x()}),Fb=e=>bs(e,{onEmpty:x(),onFail:t=>d(Ne(t)),onDie:t=>d(Ne(t)),onInterrupt:()=>x(),onAnnotated:(t,r)=>Re(o=>Io(o,r))(t),onSequential:(t,r)=>N(t)&&N(r)?d(_e(t.value,r.value)):N(t)&&j(r)?d(t.value):j(t)&&N(r)?d(r.value):x(),onParallel:(t,r)=>N(t)&&N(r)?d(ke(t.value,r.value)):N(t)&&j(r)?d(t.value):j(t)&&N(r)?d(r.value):x()});var ys=e=>bs(e,{onEmpty:Xe,onFail:()=>Xe,onDie:t=>Ne(t),onInterrupt:t=>sr(t),onAnnotated:(t,r)=>mm(t)?t:Io(t,r),onSequential:_e,onParallel:ke}),Pb=e=>bs(e,{onEmpty:Xe,onFail:t=>Ne(t),onDie:t=>Ne(t),onInterrupt:t=>sr(t),onAnnotated:(t,r)=>mm(t)?t:Io(t,r),onSequential:(t,r)=>_e(t,r),onParallel:(t,r)=>ke(t,r)});var Nb=a(2,(e,t)=>bs(e,{onEmpty:Xe,onFail:r=>t(r),onDie:r=>Ne(r),onInterrupt:r=>sr(r),onAnnotated:(r,o)=>Io(r,o),onSequential:(r,o)=>_e(r,o),onParallel:(r,o)=>ke(r,o)})),xm=e=>Nb(e,F);var zI=(e,t)=>{let r=Ee(e),o=Ee(t);for(;je(r)&&je(o);){let[n,s]=fn([Be(),Qe()],([p,u],f)=>{let[h,y]=cm(f);return d([Ge(h)(p),or(y)(u)])})(ze(r)),[i,c]=fn([Be(),Qe()],([p,u],f)=>{let[h,y]=cm(f);return d([Ge(h)(p),or(y)(u)])})(ze(o));if(!O(n,i))return!1;r=s,o=c}return!0},KI=e=>BI(Ee(e),Qe()),BI=(e,t)=>{for(;;){let[r,o]=nt([Be(),Qe()],([s,i],c)=>{let[p,u]=cm(c);return[Ge(p)(s),or(u)(i)]})(e),n=ro(r)>0?Ae(r)(t):t;if(fs(o))return eo(n);e=o,t=n}throw new Error("BUG: Cause.flattenCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")};var qi=a(2,(e,t)=>{let r=[e];for(;r.length>0;){let o=r.pop(),n=t(o);switch(n._tag){case"None":{switch(o._tag){case ln:case un:{r.push(o.right),r.push(o.left);break}case pn:{r.push(o.cause);break}}break}case"Some":return n}}return x()});var cm=e=>{let t=e,r=[],o=Be(),n=Qe();for(;t!==void 0;)switch(t._tag){case vo:{if(r.length===0)return[o,n];t=r.pop();break}case cn:{if(r.length===0)return[Ar(t.error)(o),n];o=Ar(t.error)(o),t=r.pop();break}case an:{if(r.length===0)return[Ar(t.defect)(o),n];o=Ar(t.defect)(o),t=r.pop();break}case gs:{if(r.length===0)return[Ar(t.fiberId)(o),n];o=Ar(t.fiberId)(o),t=r.pop();break}case pn:{t=t.cause;break}case ln:{switch(t.left._tag){case vo:{t=t.right;break}case ln:{t=_e(t.left.left,_e(t.left.right,t.right));break}case un:{t=ke(_e(t.left.left,t.right),_e(t.left.right,t.right));break}case pn:{t=_e(t.left.cause,t.right);break}default:{n=Ae(t.right)(n),t=t.left;break}}break}case un:{r.push(t.right),t=t.left;break}}throw new Error("BUG: Cause.evaluateCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")};var GI={emptyCase:yr,failCase:wt,dieCase:wt,interruptCase:yr,annotatedCase:(e,t)=>t,sequentialCase:(e,t,r)=>t&&r,parallelCase:(e,t,r)=>t&&r};var Ab="SequentialCase",Mb="ParallelCase",Tb="AnnotatedCase",bs=a(2,(e,{onAnnotated:t,onDie:r,onEmpty:o,onFail:n,onInterrupt:s,onParallel:i,onSequential:c})=>cp(e,void 0,{emptyCase:()=>o,failCase:(p,u)=>n(u),dieCase:(p,u)=>r(u),interruptCase:(p,u)=>s(u),annotatedCase:(p,u,f)=>t(u,f),sequentialCase:(p,u,f)=>c(u,f),parallelCase:(p,u,f)=>i(u,f)})),fn=a(3,(e,t,r)=>{let o=t,n=e,s=[];for(;n!==void 0;){let i=r(o,n);switch(o=N(i)?i.value:o,n._tag){case ln:{s.push(n.right),n=n.left;break}case un:{s.push(n.right),n=n.left;break}case pn:{n=n.cause;break}default:{n=void 0;break}}n===void 0&&s.length>0&&(n=s.pop())}return o}),cp=a(3,(e,t,r)=>{let o=[e],n=[];for(;o.length>0;){let i=o.pop();switch(i._tag){case vo:{n.push(P(r.emptyCase(t)));break}case cn:{n.push(P(r.failCase(t,i.error)));break}case an:{n.push(P(r.dieCase(t,i.defect)));break}case gs:{n.push(P(r.interruptCase(t,i.fiberId)));break}case pn:{o.push(i.cause),n.push(q({_tag:Tb,annotation:i.annotation}));break}case ln:{o.push(i.right),o.push(i.left),n.push(q({_tag:Ab}));break}case un:{o.push(i.right),o.push(i.left),n.push(q({_tag:Mb}));break}}}let s=[];for(;n.length>0;){let i=n.pop();switch(i._tag){case"Left":{switch(i.left._tag){case Ab:{let c=s.pop(),p=s.pop(),u=r.sequentialCase(t,c,p);s.push(u);break}case Mb:{let c=s.pop(),p=s.pop(),u=r.parallelCase(t,c,p);s.push(u);break}case Tb:{let c=s.pop(),p=r.annotatedCase(t,c,i.left.annotation);s.push(p);break}}break}case"Right":{s.push(i.right);break}}}if(s.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/io/issues");return s.pop()}),Ui=(e,t)=>{let r={value:t,enumerable:!0},o={...e,toString(){return`${this._tag}: ${this.message}`}};return n=>Object.create(o,{_tag:r,message:{value:n,enumerable:!0}})},pm=Symbol.for("@effect/io/Cause/errors/RuntimeException"),gm=Ui({[pm]:pm},"RuntimeException");var rp=Symbol.for("@effect/io/Cause/errors/InterruptedException"),$I=Ui({[rp]:rp},"InterruptedException"),ym=e=>typeof e=="object"&&e!=null&&rp in e,um=Symbol.for("@effect/io/Cause/errors/IllegalArgument"),Ss=Ui({[um]:um},"IllegalArgumentException");var op=Symbol.for("@effect/io/Cause/errors/NoSuchElement"),so=Ui({[op]:op},"NoSuchElementException"),bm=e=>typeof e=="object"&&e!=null&&op in e,lm=Symbol.for("@effect/io/Cause/errors/InvalidHubCapacityException"),JW=Ui({[lm]:lm},"InvalidHubCapacityException");var np=Symbol.for("@effect/io/Cause/SpanAnnotation"),VI=e=>typeof e=="object"&&e!==null&&np in e,Db=e=>({_tag:"SpanAnnotation",[np]:np,span:e});var vb=e=>{if(typeof e=="object"&&e!=null&&"toString"in e&&typeof e.toString=="function"&&e.toString!==Object.prototype.toString)return e.toString();if(typeof e=="string")return`Error: ${e}`;if(typeof e=="object"&&e!==null&&"message"in e&&typeof e.message=="string"){let t=JSON.parse(JSON.stringify(e)),r=new Set(Object.keys(t));if(r.delete("name"),r.delete("message"),r.delete("_tag"),r.size===0)return`${"name"in e&&typeof e.name=="string"?e.name:"Error"}${"_tag"in e&&typeof e._tag=="string"?`(${e._tag})`:""}: ${e.message}`}return`Error: ${JSON.stringify(e)}`},Ib=e=>e instanceof Error?[vb(e),e.stack?.split(`
`).filter(t=>!t.startsWith("Error")).join(`
`)]:[vb(e),void 0];var JI=e=>{let t=e.split(`
`),r=[];for(let o=0;o<t.length;o++){if(t[o].includes("EffectPrimitive")||t[o].includes("Generator.next")||t[o].includes("FiberRuntime"))return r.join(`
`);r.push(t[o])}return r.join(`
`)},io=e=>{if(ko(e))return"All fibers interrupted without errors.";let t=pp(e).map(r=>{let o=r.message;if(r.stack&&(o+=`\r
${JI(r.stack)}`),r.span){let n=r.span,s=0;for(;n&&n._tag==="Span"&&s<10;)o+=`\r
    at ${n.name}`,n=Ue(n.parent),s++}return o}).join(`\r
\r
`);return t.includes(`\r
`)?`\r
${t}\r
`:t},pp=e=>cp(e,void 0,{emptyCase:()=>[],dieCase:(t,r)=>{let o=Ib(r);return[{message:o[0],stack:o[1],span:void 0}]},failCase:(t,r)=>{let o=Ib(r);return[{message:o[0],stack:o[1],span:void 0}]},interruptCase:()=>[],parallelCase:(t,r,o)=>[...r,...o],sequentialCase:(t,r,o)=>[...r,...o],annotatedCase:(t,r,o)=>VI(o)?r.map(n=>({...n,span:n.span??o.span})):r});var Lb=io;var Wi=255,Hb=8,up=e=>e&Wi,lp=e=>e>>Hb&Wi,xn=(e,t)=>(e&Wi)+((t&e&Wi)<<Hb),fp=xn(0,0),qb=e=>xn(e,e),Ub=e=>xn(e,0);var Wb=a(2,(e,t)=>xn(up(e)&~t,lp(e)));var Sm=a(2,(e,t)=>e|t);var jb=e=>~e>>>0&Wi;var Kb=0,ir=1,Em=2,mp=4,ji=16,hp=32;var _m=e=>zi(e,hp);var Om=a(2,(e,t)=>e|t);var Mr=e=>Es(e)&&!Bb(e),Es=e=>zi(e,ir);var zi=a(2,(e,t)=>(e&t)!==0),dp=(...e)=>e.reduce((t,r)=>t|r,0),Cm=dp(Kb);var Ki=e=>zi(e,mp);var Bb=e=>zi(e,ji);var gn=a(2,(e,t)=>xn(e^t,t)),_s=a(2,(e,t)=>e&(jb(up(t))|lp(t))|up(t)&lp(t));var Rm=Vc({empty:fp,diff:(e,t)=>gn(e,t),combine:(e,t)=>Sm(t)(e),patch:(e,t)=>_s(t,e)});var gp=fp;var Am=qb,Mm=Ub;var Tm=Wb;var $b,Vb,Jb,Yb={_tag:"Empty"},yn=(e,t)=>({_tag:"Par",left:e,right:t}),yp=(e,t)=>({_tag:"Seq",left:e,right:t}),km=(e,t)=>({_tag:"Single",dataSource:e,blockedRequest:t});var Qb=e=>{let t=Ni(e),r=nr();for(;;){let[o,n]=xb(t,[Zb(),nr()],([s,i],c)=>{let[p,u]=ek(c);return[Xb(s,p),hb(i,u)]});if(r=tk(r,o),ct(n))return gb(r);t=n}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/query/issues")},ek=e=>{let t=e,r=Zb(),o=nr(),n=nr();for(;;)switch(t._tag){case"Empty":{if(ct(o))return[r,n];t=o.head,o=o.tail;break}case"Par":{o=oo(t.right,o),t=t.left;break}case"Seq":{let s=t.left,i=t.right;switch(s._tag){case"Empty":{t=i;break}case"Par":{let c=s.left,p=s.right;t=yn(yp(c,i),yp(p,i));break}case"Seq":{let c=s.left,p=s.right;t=yp(c,yp(p,i));break}case"Single":{t=s,n=oo(i,n);break}}break}case"Single":{if(r=Xb(r,ik(t.dataSource,t.blockedRequest)),ct(o))return[r,n];t=o.head,o=o.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/query/issues")},tk=(e,t)=>{if(ct(e))return Ni(vm(t));if(ak(t))return e;let r=mk(e.head),o=ck(t);return r.length===1&&o.length===1&&O(r[0],o[0])?oo(fk(e.head,vm(t)),e.tail):oo(vm(t),e)},rk=Symbol.for("@effect/io/RequestBlock.Entry"),Im=class{constructor(t,r,o,n,s){this.request=t,this.result=r,this.listeners=o,this.ownerId=n,this.state=s,this[$b]=ok}};$b=rk;var ok={_R:e=>e};var wm=e=>new Im(e.request,e.result,e.listeners,e.ownerId,e.state),nk=Symbol.for("@effect/io/RequestBlockParallel"),sk={_R:e=>e},Bi=class{constructor(t){this.map=t,this[Vb]=sk}};Vb=nk;var Zb=()=>new Bi(Xr()),ik=(e,t)=>new Bi(_y([e,Array.of(t)])),Xb=(e,t)=>new Bi(Af(e.map,t.map,(r,o,n)=>Or(r,n,Pe(vi(r,n),{onNone:()=>o,onSome:s=>[...s,...o]})))),ak=e=>Oy(e.map),ck=e=>Array.from(Rf(e.map)),vm=e=>lk(Ry(e.map,t=>Array.of(t)));var pk=Symbol.for("@effect/io/RequestBlockSequential"),uk={_R:e=>e},bp=class{constructor(t){this.map=t,this[Jb]=uk}};Jb=pk;var lk=e=>new bp(e),fk=(e,t)=>new bp(Af(t.map,e.map,(r,o,n)=>Or(r,n,Pe(vi(r,n),{onNone:()=>[],onSome:s=>[...s,...o]}))));var mk=e=>Array.from(Rf(e.map)),eS=e=>Array.from(e.map);var bn="Pending",Gi="Done";var hk="@effect/io/Deferred",oS=Symbol.for(hk),nS={_E:e=>e,_A:e=>e},Sp=e=>({_tag:bn,joiners:e}),Fm=e=>({_tag:Gi,effect:e});var Os="Async",sS="Commit",ue="Failure",Cs="OnFailure",Rs="OnSuccess",As="OnSuccessAndFailure",le="Success",Ep="Sync",iS="Tag",ao="UpdateRuntimeFlags",Ms="While",_p="WithRuntime",Ts="Yield",$i="RevertFlags";var Cp=class{constructor(){this.buckets=[]}scheduleTask(t,r){let o,n;for(n=0;n<this.buckets.length&&this.buckets[n][0]<=r;n++)o=this.buckets[n];if(o)o[1].push(t);else{let s=[];for(let i=0;i<n;i++)s.push(this.buckets[i]);s.push([r,[t]]);for(let i=n;i<this.buckets.length;i++)s.push(this.buckets[i]);this.buckets=s}}},Pm=class{constructor(t){this.maxNextTickBeforeTimer=t,this.running=!1,this.tasks=new Cp}starveInternal(t){let r=this.tasks.buckets;this.tasks.buckets=[];for(let[o,n]of r)for(let s=0;s<n.length;s++)n[s]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}scheduleTask(t,r){this.tasks.scheduleTask(t,r),this.running||(this.running=!0,this.starve())}},Nm=z(Symbol.for("@effect/io/Scheduler/defaultScheduler"),()=>new Pm(2048)),Rp=class{constructor(){this.tasks=new Cp,this.deferred=!1}scheduleTask(t,r){this.deferred?Nm.scheduleTask(t,r):this.tasks.scheduleTask(t,r)}flush(){for(;this.tasks.buckets.length>0;){let t=this.tasks.buckets;this.tasks.buckets=[];for(let[r,o]of t)for(let n=0;n<o.length;n++)o[n]()}this.deferred=!0}};var cS,pS,uS,lS,xk="@effect/io/Effect/Error",Dm=Symbol.for(xk),mS=e=>typeof e=="object"&&e!=null&&Dm in e,hS=e=>({[Dm]:Dm,_tag:"EffectError",cause:e}),fe=(e,t)=>{let r=new Oe("Blocked");return r.i0=e,r.i1=t,r},Ip=e=>{let t=new Oe("RunBlocked");return t.i0=e,t},vs=Symbol.for("@effect/io/Effect"),Mp=class{constructor(t,r){this.patch=t,this.op=r,this._tag=$i}},Oe=class{constructor(t){this._tag=t,this.i0=void 0,this.i1=void 0,this.i2=void 0,this.trace=void 0,this[cS]=Lm}[(cS=vs,M)](t){return this===t}[A](){return Eo(this)}pipe(){return E(this,arguments)}},Tp=class{constructor(t){this._tag=t,this.i0=void 0,this.i1=void 0,this.i2=void 0,this.trace=void 0,this[pS]=Lm}[(pS=vs,M)](t){return this===t}[A](){return Eo(this)}get cause(){return this.i0}pipe(){return E(this,arguments)}toJSON(){return{_tag:this._tag,cause:this.cause.toJSON()}}toString(){return Lb(this.cause)}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}},vp=class{constructor(t){this._tag=t,this.i0=void 0,this.i1=void 0,this.i2=void 0,this.trace=void 0,this[uS]=Lm}[(uS=vs,M)](t){return this===t}[A](){return Eo(this)}get value(){return this.i0}pipe(){return E(this,arguments)}toJSON(){return{_tag:this._tag,value:this.value}}toString(){return`Success: ${String(this.value)}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}},Lm={_R:e=>e,_E:e=>e,_A:e=>e},me=e=>typeof e=="object"&&e!=null&&vs in e,pe=e=>{let t=new Oe(_p);return t.i0=e,t},Wt=a(3,(e,t,r)=>ge(o=>l(e,n=>l(Z(T(()=>o(t(n)))),s=>T(()=>r(n,s)).pipe(J({onFailure:i=>{switch(s._tag){case ue:return D(ke(s.i0,i));case le:return D(i)}},onSuccess:()=>s})))))),V=a(2,(e,t)=>l(e,()=>m(t))),Q=e=>V(e,void 0),jt=(e,t=Ze)=>T(()=>{let r,o,n=new Oe(Os);if(e.length!==1){let s=new AbortController;o=s,n.i0=i=>{r=e(i,s.signal)}}else n.i0=s=>{r=e(s)};return n.i1=t,Do(n,()=>(o&&o.abort(),r??k))}),Ir=(e,t=Ze)=>jt(r=>{let o=e(r);if(br(o))r(o.right);else return o.left},t),kr=a(2,(e,t)=>{let r=new Oe(Cs);return r.i0=e,r.i1=t,r}),pt=a(2,(e,t)=>ie(e,{onFailure:t,onSuccess:m})),wo=e=>(...t)=>e(...t),dS=a(2,(e,t)=>J(e,{onFailure:wo(r=>{let o=no(r);switch(o._tag){case"Left":return $(()=>D(r))(t(o.left));case"Right":return D(o.right)}}),onSuccess:m})),xS=e=>pe((t,r)=>e(Es(r.runtimeFlags))),Hm=e=>D(Ne(e)),Is=e=>Pr(()=>Ne(gm(e))),Fo=e=>Pr(()=>Ne(e())),wr=e=>ie(e,{onFailure:t=>m(q(t)),onSuccess:t=>m(P(t))}),Fr=()=>T(()=>$e(uo)),ks=e=>l(Fr(),e),Z=e=>Ji(e,{onFailure:K,onSuccess:X}),L=e=>D(hn(e)),ar=e=>Pr(()=>hn(e())),D=e=>{let t=new Tp(ue);return t.i0=e,t},Pr=e=>l(g(e),D),Po=pe(e=>m(e.id())),zt=e=>pe(t=>e(t.id())),l=a(2,(e,t)=>{let r=new Oe(Rs);return r.i0=e,r.i1=t,r}),Tr=e=>{let t=new Oe("OnStep");return t.i0=e,t.i1=X,t},ws=(e,t)=>{let r=new Oe("OnStep");return r.i0=e,r.i1=t,r},ut=e=>l(e,F),No=e=>ie(e,{onFailure:m,onSuccess:L}),Ji=a(2,(e,{onFailure:t,onSuccess:r})=>J(e,{onFailure:o=>m(t(o)),onSuccess:o=>m(r(o))})),J=a(2,(e,{onFailure:t,onSuccess:r})=>{let o=new Oe(As);return o.i0=e,o.i1=t,o.i2=r,o}),ie=a(2,(e,{onFailure:t,onSuccess:r})=>J(e,{onFailure:o=>{let n=Li(o);return ap(o).length>0?D(Pb(o)):n.length>0?t(nn(n)):D(o)},onSuccess:r})),De=a(2,(e,t)=>T(()=>{let r=Y(e),o=new Array(r.length),n=0;return V(Cn({while:()=>n<r.length,body:()=>t(r[n],n),step:s=>{o[n++]=s}}),o)})),lt=a(2,(e,t)=>T(()=>{let r=Y(e),o=0;return Cn({while:()=>o<r.length,body:()=>t(r[o],o),step:()=>{o++}})})),kp=a(e=>typeof e[0]=="boolean"||me(e[0]),(e,{onFalse:t,onTrue:r})=>typeof e=="boolean"?e?r:t:l(e,wo(o=>o?r:t))),wp=l(Po,e=>Fp(e)),Fp=e=>D(sr(e)),Ut=e=>{let t=new Oe(ao);t.i0=Am(ir);let r=o=>o._tag==="Blocked"?fe(o.i0,Ut(o.i1)):o;return t.i1=()=>ws(e,r),t},gS=e=>{let t=new Oe(ao);t.i0=Am(ir);let r=o=>o._tag==="Blocked"?fe(o.i0,Ut(o.i1)):o;return t.i1=o=>Es(o)?Tr(e(Ut)):Tr(e(vr)),l(t,r)},Nr=a(2,(e,t)=>ge(r=>l(Z(r(e)),o=>rh(t,o)))),_=a(2,(e,t)=>l(e,r=>g(()=>t(r)))),Pp=a(2,(e,{onFailure:t,onSuccess:r})=>ie(e,{onFailure:o=>ar(()=>t(o)),onSuccess:o=>g(()=>r(o))})),co=a(2,(e,t)=>J(e,{onFailure:r=>{let o=no(r);switch(o._tag){case"Left":return ar(()=>t(o.left));case"Right":return D(o.right)}},onSuccess:m})),Np=a(2,(e,t)=>cr(e,wo(r=>$p(r)?k:t(r.i0)))),cr=a(2,(e,t)=>ge(r=>J(r(e),{onFailure:o=>{let n=K(o);return J(t(n),{onFailure:s=>K(_e(o,s)),onSuccess:()=>n})},onSuccess:o=>{let n=X(o);return W(t(n),n)}}))),Do=a(2,(e,t)=>cr(e,Yp({onFailure:r=>ko(r)?Q(t(Hi(r))):k,onSuccess:()=>k}))),En=a(2,(e,t)=>gk(e,t,m)),_n=e=>qm(e,F),qm=a(2,(e,t)=>ie(e,{onFailure:r=>Hm(t(r)),onSuccess:m})),yS=(e,t)=>Y(e).reduceRight(([r,o],n)=>{let s=t(n);switch(s._tag){case"Left":return[[s.left,...r],o];case"Right":return[r,[s.right,...o]]}},[new Array,new Array]),Ot=a(2,(e,t)=>be(uo,t)(e)),bS=a(2,(e,t)=>Le(uo,r=>rs(r,t))(e)),On=a(2,(e,t)=>ks(r=>Ot(e,t(r)))),Dp=pe((e,t)=>m(t.runtimeFlags)),m=e=>{let t=new vp(le);return t.i0=e,t},T=e=>l(g(e),F),g=e=>{let t=new Oe(Ep);return t.i0=e,t},Ct=a(2,(e,t)=>l(e,r=>V(t(r),r))),Lp=e=>pe(t=>{let r=t.getFiberRef(Vi),o=$(()=>t.scope())(r);return e(be(Vi,d(o)))}),gk=a(3,(e,t,r)=>J(e,{onFailure:o=>ap(o).length>0?D(Cg(Fb(o))):t(),onSuccess:r})),vr=e=>{let t=new Oe(ao);t.i0=Mm(ir),t.i1=()=>ws(e,r);let r=o=>o._tag==="Blocked"?fe(o.i0,vr(o.i1)):o;return t},ge=e=>{let t=new Oe(ao);t.i0=Mm(ir);let r=o=>o._tag==="Blocked"?fe(o.i0,vr(o.i1)):o;return t.i1=o=>Es(o)?Tr(e(Ut)):Tr(e(vr)),l(t,r)},k=m(void 0),Fs=e=>{let t=new Oe(ao);return t.i0=e,t.i1=void 0,t},Ps=a(2,(e,t)=>l(t,r=>r?_(d)(e):m(x()))),Cn=e=>{let t=new Oe(Ms);return t.i0=e.while,t.i1=e.body,t.i2=e.step,t},SS=a(2,(e,t)=>be(e,zp,t)),ES=a(2,(e,t)=>be(e,Zi,t)),_S=a(2,(e,t)=>{let r=new Oe(ao);return r.i0=t,r.i1=()=>e,r}),OS=a(2,(e,t)=>be(e,ea,t)),Rt=e=>{let t=new Oe(Ts);return typeof e?.priority<"u"?Ym(e.priority)(t):t},Hp=a(2,(e,t)=>l(e,r=>_(t,o=>[r,o])));var Ns=a(2,(e,t)=>l(e,r=>V(t,r))),W=a(2,(e,t)=>l(e,()=>t)),po=a(3,(e,t,r)=>l(e,o=>_(t,n=>r(o,n)))),Rn=Ir(()=>{let e=setInterval(()=>{},2147483647);return q(g(()=>clearInterval(e)))}),Lo=e=>l(Po,t=>Kt(t)(e)),Kt=a(2,(e,t)=>l(e.interruptAsFork(t),()=>e.await())),Um={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return E(this,arguments)}},Wm={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return E(this,arguments)}},jm={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return E(this,arguments)}},zm={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return E(this,arguments)}},qp={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return E(this,arguments)}},Up={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return E(this,arguments)}},Km={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return E(this,arguments)}},Bm={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return E(this,arguments)}},Gm=[Um,Km,Up,qp,zm,jm,Wm,Bm],yk="@effect/io/FiberRef",bk=Symbol.for(yk),Sk={_A:e=>e},$e=e=>CS(e,t=>[t,t]);var ye=a(2,(e,t)=>l($e(e),t)),Sn=a(2,(e,t)=>CS(e,()=>[void 0,t]));var CS=a(2,(e,t)=>pe(r=>{let[o,n]=t(r.getFiberRef(e));return r.setFiberRef(e,n),m(o)}));var Ek="@effect/io/RequestResolver",RS=Symbol.for(Ek),_k={_R:e=>e,_A:e=>e},fS=class e{constructor(t,r){this.runAll=t,this.target=r,this[lS]=_k,this.runAll=t}[(lS=RS,A)](){return this.target?S(this.target):Eo(this)}[M](t){return this.target?Ok(t)&&O(this.target,t.target):this===t}identified(...t){return new e(this.runAll,Cr(t))}pipe(){return E(this,arguments)}},Ok=e=>typeof e=="object"&&e!=null&&RS in e;var be=a(3,(e,t,r)=>l(Wt(Ns($e(t),Sn(t,r)),()=>Tr(e),o=>Sn(t,o)),o=>o._tag==="Blocked"?fe(o.i0,be(o.i1,t,r)):o)),Le=a(3,(e,t,r)=>ye(t,o=>be(e,t,r(o)))),he=(e,t)=>Ds(e,{differ:lb(),fork:t?.fork??F,join:t?.join}),$m=e=>Ds(e,{differ:ub(),fork:$c()}),Wp=e=>Ds(e,{differ:pb(),fork:Kc()}),Ds=(e,t)=>({[bk]:Sk,initial:e,diff:(r,o)=>ib(r,o)(t.differ),combine:(r,o)=>ab(r,o)(t.differ),patch:r=>o=>cb(r,o)(t.differ),fork:t.fork,join:t.join??((r,o)=>o),pipe(){return E(this,arguments)}}),AS=e=>Ds(e,{differ:Rm,fork:gp}),uo=Wp(Dt()),Yi=he(0),Vm=he(2048),Qi=z(Symbol.for("@effect/io/FiberRef/currentLogAnnotation"),()=>he(Xr())),Jm=he(qp),jp=z(Symbol.for("@effect/io/FiberRef/currentLogSpan"),()=>he(nr())),lo=z(Symbol.for("@effect/io/FiberRef/currentScheduler"),()=>he(Nm)),MS=a(2,(e,t)=>be(e,lo,t)),Ym=a(2,(e,t)=>be(e,Yi,t)),TS=a(2,(e,t)=>be(e,Vm,t)),zp=z(Symbol.for("@effect/io/FiberRef/currentConcurrency"),()=>he("unbounded")),Zi=z(Symbol.for("@effect/io/FiberRef/currentRequestBatching"),()=>he(!0)),Xi=z(Symbol.for("@effect/io/FiberRef/currentUnhandledErrorLogLevel"),()=>he(d(Up))),vS=a(2,(e,t)=>be(e,Xi,t)),fo=$m(Be()),IS=$e(fo),Vi=z(Symbol.for("@effect/io/FiberRef/currentForkScopeOverride"),()=>he(x(),{fork:()=>x(),join:(e,t)=>e})),An=z(Symbol.for("@effect/io/FiberRef/currentInterruptedCause"),()=>he(Xe,{fork:()=>Xe,join:(e,t)=>e})),mo=z(Symbol.for("@effect/io/FiberRef/currentTracerSpan"),()=>he(nr())),ea=z(Symbol.for("@effect/io/FiberRef/currentTracerTiming"),()=>he(!0)),Kp=z(Symbol.for("@effect/io/FiberRef/currentTracerSpanAnnotations"),()=>he(Xr())),Bp=z(Symbol.for("@effect/io/FiberRef/currentTracerSpanLinks"),()=>he(Qe())),Gp=Symbol.for("@effect/io/Scope"),Qm=Symbol.for("@effect/io/CloseableScope");var Ls=(e,t)=>e.addFinalizer(t),Ho=(e,t)=>e.close(t),Zm=(e,t)=>e.fork(t),Xm=a(2,(e,t)=>_(Rk(e,t),Pe({onNone:()=>()=>k,onSome:r=>o=>Ck(r,o)(e)}))),Ck=a(3,(e,t,r)=>T(()=>{switch(e.state._tag){case"Exited":return k;case"Running":{let o=e.state.finalizers.get(t);return e.state.finalizers.delete(t),o!=null?e.state.update(o)(r):k}}})),Rk=a(2,(e,t)=>T(()=>{switch(e.state._tag){case"Exited":return e.state.nextKey+=1,V(t(e.state.exit),x());case"Running":{let r=e.state.nextKey;return e.state.finalizers.set(r,t),e.state.nextKey+=1,m(d(r))}}}));var kS=g(()=>({state:{_tag:"Running",nextKey:0,finalizers:new Map,update:F}}));var eh=e=>e._tag==="Failure",$p=e=>e._tag==="Success";var wS=a(2,(e,t)=>{switch(e._tag){case ue:return K(e.i0);case le:return X(t)}}),ta=e=>wS(e,void 0);var Hs=(e,t)=>Ak(e,t?.parallel?ke:_e),Vp=e=>K(Ne(e));var pr=e=>K(hn(e)),K=e=>{let t=new Tp(ue);return t.i0=e,t},FS=a(2,(e,t)=>{switch(e._tag){case ue:return K(e.i0);case le:return t(e.i0)}});var PS=e=>FS(F)(e);var Jp=e=>K(sr(e)),Ap=a(2,(e,t)=>{switch(e._tag){case ue:return K(e.i0);case le:return X(t(e.i0))}});var Yp=a(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case ue:return t(e.i0);case le:return r(e.i0)}}),Mn=a(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case ue:return t(e.i0);case le:return r(e.i0)}}),X=e=>{let t=new vp(le);return t.i0=e,t};var Dr=X(void 0);var ra=a(3,(e,t,{onFailure:r,onSuccess:o})=>{switch(e._tag){case ue:switch(t._tag){case le:return K(e.i0);case ue:return K(r(e.i0,t.i0))}case le:switch(t._tag){case le:return X(o(e.i0,t.i0));case ue:return K(t.i0)}}}),Ak=(e,t)=>{let r=Cr(e);return je(r)?d(Ap(o=>Array.from(o))(Ap(eo)(nt(Ap(Ee)(ze(r)),(o,n)=>ra(n,{onSuccess:(s,i)=>Ae(i)(s),onFailure:t})(o))(Ke(r))))):x()},qs=e=>({[oS]:nS,state:st(Sp([])),blockingOn:e,pipe(){return E(this,arguments)}}),et=()=>l(Po,e=>NS(e)),NS=e=>g(()=>qs(e)),Me=e=>Ir(t=>{let r=St(e.state);switch(r._tag){case Gi:return P(r.effect);case bn:return Ht(Sp([t,...r.joiners]))(e.state),q(Mk(e,t))}},e.blockingOn),th=a(2,(e,t)=>Nr(t,e)),Us=a(2,(e,t)=>g(()=>{let r=St(e.state);switch(r._tag){case Gi:return!1;case bn:{Ht(Fm(t))(e.state);for(let o=0;o<r.joiners.length;o++)r.joiners[o](t);return!0}}})),rh=a(2,(e,t)=>Us(e,t)),oa=a(2,(e,t)=>Us(e,L(t)));var Tn=a(2,(e,t)=>Us(e,D(t)));var DS=e=>l(Po,t=>Us(e,Fp(t)));var Ws=a(2,(e,t)=>Us(e,m(t)));var js=(e,t)=>{let r=St(e.state);if(r._tag===bn){Ht(Fm(t))(e.state);for(let o=r.joiners.length-1;o>=0;o--)r.joiners[o](t)}},Mk=(e,t)=>g(()=>{let r=St(e.state);r._tag===bn&&Ht(Sp(r.joiners.filter(o=>o!==t)))(e.state)});var vn=Me;var LS=rh;var HS=DS;var oh=qs;var US=PS;var WS=X;var BS,Tk="@effect/io/Clock",sh=Symbol.for(Tk),Lr=yt(sh),vk=2**31-1,zS={unsafeSchedule(e,t){let r=Er(t);if(r>vk)return wt;let o=!1,n=setTimeout(()=>{o=!0,e()},r);return()=>(clearTimeout(n),!o)}},KS=function(){let e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;let t="timeOrigin"in performance&&typeof performance.timeOrigin=="number"?BigInt(Math.round(performance.timeOrigin*1e6)):BigInt(Date.now())*e;return()=>t+BigInt(Math.round(performance.now()*1e6))}(),Ik=function(){let e=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!e)return KS;let t=KS()-e.bigint();return()=>t+e.bigint()}(),nh=class{constructor(){this[BS]=sh,this.currentTimeMillis=g(()=>this.unsafeCurrentTimeMillis()),this.currentTimeNanos=g(()=>this.unsafeCurrentTimeNanos())}unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return Ik()}scheduler(){return m(zS)}sleep(t){return Ir(r=>{let o=zS.unsafeSchedule(()=>r(k),t);return q(Q(g(o)))})}};BS=sh;var GS=()=>new nh;var Qp="And",Zp="Or",Xp="InvalidData",eu="MissingData",tu="SourceUnavailable",ru="Unsupported";var wk="@effect/io/Config/Error",ih=Symbol.for(wk),zs={[ih]:ih},ou=(e,t)=>{let r=Object.create(zs);return r._tag=Qp,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),r},nu=(e,t)=>{let r=Object.create(zs);return r._tag=Zp,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),r},Hr=(e,t,r={pathDelim:"."})=>{let o=Object.create(zs);return o._tag=Xp,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Invalid data at ${Jr(r.pathDelim)(this.path)}: "${this.message}")`}}),o},ur=(e,t,r={pathDelim:"."})=>{let o=Object.create(zs);return o._tag=eu,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Missing data at ${Jr(r.pathDelim)(this.path)}: "${this.message}")`}}),o},VS=(e,t,r,o={pathDelim:"."})=>{let n=Object.create(zs);return n._tag=tu,n.path=e,n.message=t,n.cause=r,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Source unavailable at ${Jr(o.pathDelim)(this.path)}: "${this.message}")`}}),n},su=(e,t,r={pathDelim:"."})=>{let o=Object.create(zs);return o._tag=ru,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${Jr(r.pathDelim)(this.path)}: "${this.message}")`}}),o};var ho=a(2,(e,t)=>{switch(e._tag){case Qp:return ou(ho(t)(e.left),ho(t)(e.right));case Zp:return nu(ho(t)(e.left),ho(t)(e.right));case Xp:return Hr([...t,...e.path],e.message);case eu:return ur([...t,...e.path],e.message);case tu:return VS([...t,...e.path],e.message,e.cause);case ru:return su([...t,...e.path],e.message)}}),Fk={andCase:(e,t,r)=>t&&r,orCase:(e,t,r)=>t&&r,invalidDataCase:wt,missingDataCase:yr,sourceUnavailableCase:wt,unsupportedCase:wt},JS=a(3,(e,t,r)=>{let o=[e],n=[];for(;o.length>0;){let i=o.pop();switch(i._tag){case Qp:{o.push(i.right),o.push(i.left),n.push(q({_tag:"AndCase"}));break}case Zp:{o.push(i.right),o.push(i.left),n.push(q({_tag:"OrCase"}));break}case Xp:{n.push(P(r.invalidDataCase(t,i.path,i.message)));break}case eu:{n.push(P(r.missingDataCase(t,i.path,i.message)));break}case tu:{n.push(P(r.sourceUnavailableCase(t,i.path,i.message,i.cause)));break}case ru:{n.push(P(r.unsupportedCase(t,i.path,i.message)));break}}}let s=[];for(;n.length>0;){let i=n.pop();switch(i._tag){case"Left":{switch(i.left._tag){case"AndCase":{let c=s.pop(),p=s.pop(),u=r.andCase(t,c,p);s.push(u);break}case"OrCase":{let c=s.pop(),p=s.pop(),u=r.orCase(t,c,p);s.push(u);break}}break}case"Right":{s.push(i.right);break}}}if(s.length===0)throw new Error("BUG: ConfigError.reduceWithContext - please report an issue at https://github.com/Effect-TS/io/issues");return s.pop()}),YS=e=>JS(e,void 0,Fk);var ah=YS;var QS="@effect/io/Config/Secret",ch=Symbol.for(QS),Nk={[ch]:ch,[A](){return I($r(this.raw))(S(QS))},[M](e){return Dk(e)&&this.raw.length===e.raw.length&&this.raw.every((t,r)=>O(t,e.raw[r]))}},Dk=e=>typeof e=="object"&&e!=null&&ch in e,Lk=e=>{let t=Object.create(Nk);return Object.defineProperty(t,"toString",{enumerable:!1,value(){return"ConfigSecret(<redacted>)"}}),Object.defineProperty(t,"raw",{enumerable:!1,value:e}),t};var ZS=e=>Lk(e.split("").map(t=>t.charCodeAt(0)));var au="Constant",cu="Fail",na="Fallback",pu="Described",uu="Lazy",lu="MapOrFail",fu="Nested",mu="Primitive",hu="Sequence",du="HashMap",xu="ZipWith";var qk="@effect/io/Config",yu=Symbol.for(qk),Uk={_A:e=>e},Bt={[yu]:Uk,pipe(){return E(this,arguments)}},tE=e=>{let t=qo("a boolean property",r=>{switch(r){case"true":case"yes":case"on":case"1":return P(!0);case"false":case"no":case"off":case"0":return P(!1);default:{let o=Hr([],`Expected a boolean value, but received ${r}`);return q(o)}}});return e===void 0?t:Gt(e)(t)},rE=(e,t)=>xo(Ye)(bu(e,t)),bu=(e,t)=>xo(t===void 0?gu(e):Gt(t)(gu(e)),Et),oE=e=>{let t=qo("a date property",r=>{let o=Date.parse(r);return Number.isNaN(o)?q(Hr([],`Expected a date value but received ${r}`)):P(new Date(o))});return e===void 0?t:Gt(e)(t)},nE=e=>{let t=Object.create(Bt);return t._tag=cu,t.message=e,t.parse=()=>q(su([],e)),t},sE=e=>{let t=qo("a number property",r=>{let o=Number.parseFloat(r);return Number.isNaN(o)?q(Hr([],`Expected an number value but received ${r}`)):P(o)});return e===void 0?t:Gt(e)(t)},iE=e=>{let t=qo("an integer property",r=>{let o=Number.parseInt(r,10);return Number.isNaN(o)?q(Hr([],`Expected an integer value but received ${r}`)):P(o)});return e===void 0?t:Gt(e)(t)},aE=e=>{let t=Ks(ph(),r=>{let o=r.toUpperCase(),n=Gm.find(s=>s.label===o);return n===void 0?q(Hr([],`Expected a log level, but found: ${r}`)):P(n)});return e===void 0?t:Gt(t,e)},xo=a(2,(e,t)=>Ks(e,r=>P(t(r)))),cE=a(2,(e,t)=>Ks(e,r=>{try{return P(t(r))}catch(o){return q(Hr([],o instanceof Error?o.message:`${o}`))}})),Ks=a(2,(e,t)=>{let r=Object.create(Bt);return r._tag=lu,r.original=e,r.mapOrFail=t,r}),pE=e=>t=>ur([],`Expected ${t.description} with name ${e}`),Gt=a(2,(e,t)=>{let r=Object.create(Bt);return r._tag=fu,r.name=t,r.config=e,r}),uE=a(2,(e,t)=>{let r=Object.create(Bt);return r._tag=na,r.first=e,r.second=sa(t),r.condition=yr,r}),Su=a(2,(e,t)=>{let r=Object.create(Bt);return r._tag=na,r.first=e,r.second=sa(t.orElse),r.condition=t.if,r}),lE=e=>Su({orElse:()=>Bs(x()),if:ah})(xo(d)(e)),qo=(e,t)=>{let r=Object.create(Bt);return r._tag=mu,r.description=e,r.parse=t,r},gu=e=>{let t=Object.create(Bt);return t._tag=hu,t.config=e,t},fE=e=>{let t=qo("a secret property",r=>P(ZS(r)));return e===void 0?t:Gt(e)(t)},mE=(e,t)=>{let r=xo(bu(e),at);return t===void 0?r:Gt(t)(r)},ph=e=>{let t=qo("a text property",P);return e===void 0?t:Gt(e)(t)},hE=e=>Array.isArray(e)?eE(e):Symbol.iterator in e?eE([...e]):dE(e),dE=e=>{let t=Object.entries(e),r=xo(n=>({[t[0][0]]:n}))(t[0][1]);if(t.length===1)return r;let o=t.slice(1);for(let[n,s]of o)r=ia(s,(i,c)=>({...i,[n]:c}))(r);return r},Bs=e=>{let t=Object.create(Bt);return t._tag=au,t.value=e,t.parse=()=>P(e),t},sa=e=>{let t=Object.create(Bt);return t._tag=uu,t.config=e,t},xE=e=>sa(()=>Bs(e())),gE=(e,t)=>{let r=Object.create(Bt);return r._tag=du,r.valueConfig=e,t===void 0?r:Gt(t)(r)},uh=e=>typeof e=="object"&&e!=null&&yu in e,eE=e=>{if(e.length===0)return Bs([]);if(e.length===1)return xo(e[0],r=>[r]);let t=xo(e[0],r=>[r]);for(let r=1;r<e.length;r++){let o=e[r];t=ia(o,(n,s)=>[...n,s])(t)}return t},lh=e=>uh(e)?e:dE(Object.fromEntries(Object.entries(e).map(([t,r])=>[t,lh(r)]))),yE=a(2,(e,{message:t,validation:r})=>Ks(e,o=>r(o)?P(o):q(Hr([],t)))),bE=a(2,(e,t)=>Su(e,{orElse:()=>Bs(t),if:ah})),SE=a(2,(e,t)=>{let r=Object.create(Bt);return r._tag=pu,r.config=e,r.description=t,r}),EE=a(2,(e,t)=>ia(e,t,(r,o)=>[r,o])),ia=a(3,(e,t,r)=>{let o=Object.create(Bt);return o._tag=xu,o.left=e,o.right=t,o.zip=r,o});var OE={_tag:"Empty"};var Eu=a(2,(e,t)=>{let r=Ni(t),o=e;for(;Pi(r);){let n=r.head;switch(n._tag){case"Empty":{r=r.tail;break}case"AndThen":{r=oo(n.first,oo(n.second,r.tail));break}case"MapName":{o=Vr(o,n.f),r=r.tail;break}case"Nested":{o=Xt(o,n.name),r=r.tail;break}case"Unnested":{if(Ag(n.name)(Ec(o)))o=Nt(o),r=r.tail;else return q(ur(o,`Expected ${n.name} to be in path in ConfigProvider#unnested`));break}}}return P(o)});var _u=(e,t)=>[...e,...t],jk="@effect/io/Config/Provider",fh=Symbol.for(jk),Gs=yt(fh),zk="@effect/io/Config/Provider/Flat",CE=Symbol.for(zk),Kk=e=>({[fh]:fh,pipe(){return E(this,arguments)},...e}),Bk=e=>({[CE]:CE,patch:e.patch,load:(t,r,o=!0)=>e.load(t,r,o),enumerateChildren:e.enumerateChildren}),Gk=e=>Kk({load:t=>l($t(e,Jo(),t,!1),r=>Pe(Ec(r),{onNone:()=>L(ur(Jo(),`Expected a single value having structure: ${t}`)),onSome:m})),flattened:e}),RE=(e={})=>{let{pathDelim:t,seqDelim:r}=Object.assign({},{pathDelim:"_",seqDelim:","},e),o=p=>Jr(t)(p),n=p=>p.split(t),s=()=>typeof process<"u"&&"env"in process&&typeof process.env=="object"?process.env:{};return Gk(Bk({load:(p,u,f=!0)=>{let h=o(p),y=s(),b=h in y?d(y[h]):x();return l(C=>Yk(C,p,u,r,f))(co(()=>ur(p,`Expected ${h} to exist in the process context`))(b))},enumerateChildren:p=>g(()=>{let u=s(),f=Object.keys(u),y=Array.from(f).map(b=>n(b.toUpperCase())).filter(b=>{for(let C=0;C<p.length;C++){let R=tf(C)(p),v=b[C];if(v===void 0||R!==v)return!1}return!0}).flatMap(b=>b.slice(p.length,p.length+1));return at(y)}),patch:OE}))};var $k=(e,t,r,o)=>{let n=nf(r.length,p=>p>=o.length?x():d([e(p),p+1])),s=nf(o.length,p=>p>=r.length?x():d([t(p),p+1])),i=_u(r,n),c=_u(o,s);return[i,c]},$t=(e,t,r,o)=>{let n=r;switch(n._tag){case au:return m(gt(n.value));case pu:return T(()=>$t(e,t,n.config,o));case cu:return L(ur(t,n.message));case na:return pt(s=>n.condition(s)?pt(i=>L(nu(s,i)))($t(e,t,n.second,o)):L(s))(T(()=>$t(e,t,n.first,o)));case uu:return T(()=>$t(e,t,n.config(),o));case lu:return T(()=>l(De(s=>co(ho(t))(n.mapOrFail(s))))($t(e,t,n.original,o)));case fu:return T(()=>$t(e,_u(t,gt(n.name)),n.config,o));case mu:return l(s=>l(i=>{if(i.length===0){let c=$(()=>"<n/a>")(vg(s));return L(pE(c))}return m(i)})(e.load(s,n,o)))(Eu(t,e.patch));case hu:return l(s=>l(i=>i.length===0?T(()=>_($t(e,s,n.config,!0),gt)):_(c=>{let p=Oc(c);return p.length===0?gt(Jo()):gt(p)})(De(i,c=>$t(e,Mg(t,`[${c}]`),n.config,!0))))(l(Xk)(e.enumerateChildren(s))))(Eu(t,e.patch));case du:return T(()=>l(s=>l(i=>_(c=>{if(c.length===0)return gt(Xr());let p=c.map(u=>Array.from(u));return Vr(u=>Hc(of(Y(i),u)))(Qk(p))})(De(c=>$t(e,_u(s,gt(c)),n.valueConfig,o))(i)))(e.enumerateChildren(s)))(Eu(t,e.patch)));case xu:return T(()=>l(s=>l(i=>{if(Ce(s)&&Ce(i))return L(ou(s.left,i.left));if(Ce(s)&&br(i))return L(s.left);if(br(s)&&Ce(i))return L(i.left);if(br(s)&&br(i)){let c=Jr(".")(t),p=Vk(t,c),[u,f]=$k(p,p,Vr(P)(s.right),Vr(P)(i.right));return De(([h,y])=>_(([b,C])=>n.zip(b,C))(Hp(h,y)))(of(f)(u))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/io/issues")})(wr($t(e,t,n.right,o))))(wr($t(e,t,n.left,o))))}},Vk=(e,t)=>r=>q(ur(e,`The element at index ${r} in a sequence at path "${t}" was missing`));var Jk=(e,t)=>e.split(new RegExp(`\\s*${Zk(t)}\\s*`)),Yk=(e,t,r,o,n)=>n?co(ho(t))(De(s=>r.parse(s.trim()))(Jk(e,o))):co(ho(t))(_(gt)(r.parse(e))),Qk=e=>Object.keys(e[0]).map(t=>e.map(r=>r[t])),Zk=e=>e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&"),Xk=e=>_(yc)(wr(Pp({onFailure:()=>Jo(),onSuccess:Vo(xt)})(De(e,tw))));var ew=/^(\[(\d+)\])$/,tw=e=>{let t=e.match(ew);if(t!==null){let r=t[2];return es(rw)(r!==void 0&&r.length>0?d(r):x())}return x()};var rw=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?x():d(t)};var mh=Symbol("@effect/io/Console"),AE=yt(mh),ME={[mh]:mh,assert(e,...t){return g(()=>{console.assert(e,...t)})},clear:g(()=>{console.clear()}),count(e){return g(()=>{console.count(e)})},countReset(e){return g(()=>{console.countReset(e)})},debug(...e){return g(()=>{console.debug(...e)})},dir(e,t){return g(()=>{console.dir(e,t)})},dirxml(...e){return g(()=>{console.dirxml(...e)})},error(...e){return g(()=>{console.error(...e)})},group(e){return e?.collapsed?g(()=>console.groupCollapsed(e?.label)):g(()=>console.group(e?.label))},groupEnd:g(()=>{console.groupEnd()}),info(...e){return g(()=>{console.info(...e)})},log(...e){return g(()=>{console.log(...e)})},table(e,t){return g(()=>{console.table(e,t)})},time(e){return g(()=>console.time(e))},timeEnd(e){return g(()=>console.timeEnd(e))},timeLog(e,...t){return g(()=>{console.timeLog(e,...t)})},trace(...e){return g(()=>{console.trace(...e)})},warn(...e){return g(()=>{console.warn(...e)})},withGroup(e,t){return Wt(t?.collapsed?g(()=>console.groupCollapsed(t?.label)):g(()=>console.group(t?.label)),()=>e,()=>g(()=>console.groupEnd()))},withTime(e,t){return Wt(g(()=>console.time(t)),()=>e,()=>g(()=>console.timeEnd(t)))}};var TE,sw="@effect/io/Random",dh=Symbol.for(sw),xh=yt(dh),hh=class{constructor(t){this.seed=t,this[TE]=dh,this.PRNG=new Qn(t)}next(){return g(()=>this.PRNG.number())}nextBoolean(){return _(this.next(),t=>t>.5)}nextInt(){return g(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,r){return _(this.next(),o=>(r-t)*o+t)}nextIntBetween(t,r){return g(()=>this.PRNG.integer(r-t)+t)}shuffle(t){return iw(t,r=>this.nextIntBetween(0,r+1))}};TE=dh;var iw=(e,t)=>T(()=>l(r=>{let o=[];for(let n=r.length;n>=2;n=n-1)o.push(n);return V(Cr(r))(lt(n=>_(s=>aw(r,n-1,s))(t(n)))(o))})(g(()=>Array.from(e)))),aw=(e,t,r)=>{let o=e[t];return e[t]=e[r],e[r]=o,e},vE=e=>new hh(e);var IE=Symbol.for("@effect/io/Tracer"),pw=e=>({[IE]:IE,...e}),$s=yt(Symbol.for("@effect/io/Tracer")),uw=z("@effect/io/Tracer/SpanId.ids",()=>st(0)),gh=class{constructor(t,r,o,n,s){this.name=t,this.parent=r,this.context=o,this.links=n,this.startTime=s,this._tag="Span",this.traceId="native",this.events=[],this.end=(i,c)=>{this.status={_tag:"Ended",endTime:i,exit:c,startTime:this.status.startTime}},this.attribute=(i,c)=>{this.attributes.set(i,c)},this.event=(i,c,p)=>{this.events.push([i,c,p??{}])},this.status={_tag:"Started",startTime:s},this.attributes=new Map,this.spanId=`span${My(uw)}`}},kE=pw({span:(e,t,r,o,n)=>new gh(e,t,r,o,n)});var lw=Ie($s,kE)(Ie(Gs,RE())(Ie(xh,vE(Math.random()*4294967296>>>0))(Ie(AE,ME)(Ie(Lr,GS())(Dt()))))),tt=Wp(lw),FE=e=>{let t=We(e);return aa(r=>r.sleep(t))},aa=e=>ye(tt,t=>e(Qr(t,Lr))),PE=aa(e=>e.currentTimeMillis),NE=aa(e=>e.currentTimeNanos),DE=a(2,(e,t)=>Le(tt,Ie(Lr,t))(e)),LE=a(2,(e,t)=>Le(tt,Ie(Gs,t))(e)),yh=e=>ye(tt,t=>e(Qr(t,Gs))),HE=e=>yh(t=>t.load(e));var Ou=e=>ye(tt,t=>e(Qr(t,xh)));var Cu=e=>ye(tt,t=>e(Qr(t,$s))),qE=a(2,(e,t)=>Le(tt,Ie($s,t))(e));var bh=FE,Ru=PE,Sh=NE,UE=aa;var jE;function zE(e){return new In(e)}var Eh=Symbol.for("@effect/io/FiberRefs"),In=class{constructor(t){this.locals=t,this[jE]=Eh}pipe(){return E(this,arguments)}};jE=Eh;var fw=(e,t,r,o=!1)=>{let n=e,s=t,i=r,c=o,p;for(;p===void 0;)if(Sr(s)&&Sr(i)){let u=Se(s)[0],f=Nt(s),h=Se(i)[0],y=Se(i)[1],b=Nt(i);u.startTimeMillis<h.startTimeMillis?(i=b,c=!0):u.startTimeMillis>h.startTimeMillis?s=f:u.id<h.id?(i=b,c=!0):u.id>h.id?s=f:p=[y,c]}else p=[n.initial,!0];return p},Au=a(3,(e,t,r)=>{let o=new Map(e.locals);for(let[n,s]of r.locals){let i=Se(s)[1];if(!O(Se(s)[0],t)){if(!o.has(n)){if(O(i,n.initial))continue;o.set(n,[[t,n.join(n.initial,i)]]);continue}let c=o.get(n),[p,u]=fw(n,c,s);if(u){let f=n.diff(p,i),h=Se(c)[1],y=n.join(h,n.patch(f)(h));if(!O(h,y)){let b,C=Se(c)[0];O(C,t)?b=Xt([C,y])(Nt(c)):b=Xt([t,y])(c),o.set(n,b)}}}}return new In(new Map(o))}),Mu=a(2,(e,t)=>{let r=new Map;for(let[o,n]of e.locals.entries()){let s=Se(n)[1],i=o.patch(o.fork)(s);O(s,i)?r.set(o,n):r.set(o,Xt([t,i])(n))}return new In(r)}),KE=e=>at(e.locals.keys()),BE=e=>lt(KE(e),t=>Sn(t,Vs(e,t))),pa=a(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new In(r)}),ua=a(2,(e,t)=>e.locals.has(t)?d(Se(e.locals.get(t))[1]):x()),Vs=a(2,(e,t)=>$(()=>t.initial)(ua(e,t))),kn=a(2,(e,{fiberId:t,fiberRef:r,value:o})=>{let n=e.locals.has(r)?e.locals.get(r):Jo(),s;if(ef(n))s=gt([t,o]);else{let[c,p]=Se(n);if(O(c,t)){if(O(p,o))return e;s=Xt([t,o])(Nt(n))}else s=Xt([t,o])(n)}let i=new Map(e.locals);return new In(i.set(r,s))});var GE=Mu;var $E=Au,VE=BE,Oh=kn,JE=zE;var QE="Empty",ZE="Add",XE="Remove",e_="Update",t_="AndThen",r_={_tag:QE},vu=(e,t)=>{let r=new Map(e.locals),o=r_;for(let[n,s]of t.locals.entries()){let i=Se(s)[1],c=r.get(n);if(c!==void 0){let p=Se(c)[1];O(p,i)||(o=Tu({_tag:e_,fiberRef:n,patch:n.diff(p,i)})(o))}else o=Tu({_tag:ZE,fiberRef:n,value:i})(o);r.delete(n)}for(let[n]of r.entries())o=Tu({_tag:XE,fiberRef:n})(o);return o},Tu=a(2,(e,t)=>({_tag:t_,first:e,second:t})),Iu=a(3,(e,t,r)=>{let o=r,n=gt(e);for(;Sr(n);){let s=Se(n),i=Nt(n);switch(s._tag){case QE:{n=i;break}case ZE:{o=kn(o,{fiberId:t,fiberRef:s.fiberRef,value:s.value}),n=i;break}case XE:{o=pa(o,s.fiberRef),n=i;break}case e_:{let c=Vs(o,s.fiberRef);o=kn(o,{fiberId:t,fiberRef:s.fiberRef,value:s.fiberRef.patch(s.patch)(c)}),n=i;break}case t_:{n=Xt(s.first)(Xt(s.second)(i));break}}}return o});var n_,s_="@effect/io/Metric/Label",Ch=Symbol.for(s_),Rh=class{constructor(t,r){this.key=t,this.value=r,this[n_]=Ch}[(n_=Ch,A)](){return I(S(this.value))(I(S(this.key))(S(s_)))}[M](t){return mw(t)&&this.key===t.key&&this.value===t.value}pipe(){return E(this,arguments)}},ku=(e,t)=>new Rh(e,t),mw=e=>typeof e=="object"&&e!=null&&Ch in e;var wu=class e{constructor(t){this.self=t,this.called=!1}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new e(this.self)}};var dw=Um,Ah=Wm,Mh=jm,Th=zm,vh=qp,Ih=Up,kh=Km,xw=Bm;var gw=gi(e=>e.ordinal)(xt);var a_=Hl(gw);var c_=e=>{switch(e){case"All":return dw;case"Debug":return Ih;case"Error":return Mh;case"Fatal":return Ah;case"Info":return vh;case"Trace":return kh;case"None":return xw;case"Warning":return Th}};var u_=(e,t)=>({label:e,startTime:t}),l_=e=>t=>`${t.label.replace(/[\s="]/g,"_")}=${e-t.startTime}ms`;var f_=u_,m_=l_;var d_,Fu=Symbol.for("@effect/io/Ref"),Fh={_A:e=>e},wh=class{constructor(t){this.ref=t,this[d_]=Fh}modify(t){return g(()=>{let r=St(this.ref),[o,n]=t(r);return r!==n&&Ht(n)(this.ref),o})}pipe(){return E(this,arguments)}};d_=Fu;var Pu=e=>new wh(st(e)),wn=e=>g(()=>Pu(e)),lr=e=>e.modify(t=>[t,t]),qr=a(2,(e,t)=>e.modify(()=>[void 0,t])),x_=a(2,(e,t)=>e.modify(r=>[r,t]));var Nu=a(2,(e,t)=>e.modify(t));var la=a(2,(e,t)=>e.modify(r=>[void 0,t(r)]));var fa=wn,Lu=lr,g_=x_;var y_=Nu;var b_=la;var E_=Cu;var __=a(e=>me(e[0]),function(){let e=arguments;return Le(e[0],Qi,typeof e[1]=="string"?Or(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[o,n])=>Or(r,o,n),t))}),Hu=e=>_(e,d),O_=e=>co(e,d),C_=(e,t=Ze)=>Ir(r=>{let o=e(r);switch(o._tag){case"None":return q(k);case"Some":return P(o.value)}},t),ma=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),g(()=>{try{return t()}catch(o){throw hS(hn(r?r(o):o))}})},R_=a(3,(e,t,r)=>pt(e,o=>typeof o=="object"&&o!=null&&t in o&&o[t]===r.failure?r.onFailure(o):L(o))),A_=a(2,(e,t)=>kr(e,wo(r=>{let o=qi(r,n=>ip(n)?d(n):x());switch(o._tag){case"None":return D(r);case"Some":return t(o.value.defect)}}))),M_=a(2,(e,t)=>J(e,{onFailure:r=>{let o=t(r);switch(o._tag){case"None":return D(r);case"Some":return o.value}},onSuccess:m})),T_=a(2,(e,t)=>kr(e,wo(r=>{let o=qi(r,n=>ip(n)?d(n):x());switch(o._tag){case"None":return D(r);case"Some":{let n=t(o.value.defect);return n._tag==="Some"?n.value:D(r)}}}))),v_=a(3,(e,t,r)=>pt(e,o=>ce(o)&&"_tag"in o&&o._tag===t?r(o):L(o))),I_=a(2,(e,t)=>pt(e,r=>{let o=Object.keys(t);return ce(r)&&"_tag"in r&&o.includes(r._tag)?t[r._tag](r):L(r)})),k_=e=>Ji(e,{onFailure:F,onSuccess:()=>Xe}),Ur=UE,w_=Ur(m),F_=a(2,(e,t)=>W(bh(t),e)),qu=e=>pe((t,r)=>e({id:t.id(),status:r,interruptors:Hi(t.getFiberRef(An))})),P_=qu(e=>ro(e.interruptors)>0?wp:k),N_=qu(m),Fn=e=>Uu(e,Dh,vu),D_=m({}),L_=a(3,(e,t,r)=>l(e,o=>_(r(o),n=>({...o,[t]:n})))),H_=a(2,(e,t)=>_(e,r=>({[t]:r}))),q_=a(3,(e,t,r)=>_(e,o=>({...o,[t]:r(o)}))),U_=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=m(!1),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>u?(o.push(c),m(!0)):t(c,p))}return _(s,()=>o)})),W_=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=m(!0),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>_(u?t(c,p):m(!1),f=>(f||o.push(c),f)))}return _(s,()=>o)})),j_=e=>_(Fr(),e),Nh=e=>En(e,()=>l(Rt(),()=>Nh(e)));var z_=a(3,(e,t,r)=>ha(e,t,()=>Fo(r))),K_=a(3,(e,t,r)=>ha(e,t,()=>Is(r))),ha=a(3,(e,t,r)=>l(e,o=>t(o)?m(o):r(o))),B_=a(3,(e,t,r)=>ha(e,t,o=>ar(()=>r(o)))),G_=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=r.next();return o.done?m(x()):$_(r,0,t,o.value)})),$_=(e,t,r,o)=>l(r(o,t),n=>{if(n)return m(d(o));let s=e.next();return s.done?m(x()):$_(e,t+1,r,s.value)}),V_=e=>T(()=>{let t=Cr(e);return je(t)?nt(ze(t),(r,o)=>En(r,()=>o))(Ke(t)):Fo(()=>Ss("Received an empty collection of effects"))}),J_=a(2,(e,t)=>No(t(No(e)))),da=a(2,(e,{onFailure:t,onSuccess:r})=>ie(e,{onFailure:o=>m(t(o)),onSuccess:o=>m(r(o))})),Y_=a(2,(e,t)=>T(()=>Q_(e[Symbol.iterator](),0,t))),Q_=(e,t,r)=>{let o=e.next();return o.done?m(!0):l(r(o.value,t),n=>n?Q_(e,t+1,r):m(n))},Z_=e=>{let t=l(l(e,()=>Rt()),()=>t);return t},Ph=class{constructor(t){this.value=t}[Symbol.iterator](){return new wu(this)}},Sw=function(){let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return new Ph(e)},X_=e=>T(()=>{let t=e(Sw),r=t.next(),o=n=>n.done?m(n.value):l(s=>o(t.next(s)))(n.value.value);return o(r)}),Dh=pe(e=>m(e.unsafeGetFiberRefs())),eO=e=>ie(e,{onFailure:t=>L(d(t)),onSuccess:t=>{let o=t[Symbol.iterator]().next();return o.done?L(x()):m(o.value)}}),tO=e=>da(e,{onFailure:Jn,onSuccess:Jn}),rO=e=>J(e,{onFailure:t=>Hh(t,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>k}),oO=e=>Wu((t,r)=>$E(r,t,e)),nO=e=>da(e,{onFailure:yr,onSuccess:wt}),sO=e=>da(e,{onFailure:wt,onSuccess:yr}),Lh=(e,t)=>T(()=>t.while(e)?l(t.body(e),r=>Lh(r,t)):m(e)),Pn=e=>(t,r)=>{let o=Pt(e),n,s;return sp(t)?(s=t,n=r??""):(n=t,s=r??Xe),pe(i=>(i.log(n,s,o),k))},iO=Pn(),aO=Pn(kh),Hh=Pn(Ih),cO=Pn(vh),pO=Pn(Th),uO=Pn(Mh),lO=Pn(Ah),fO=a(2,(e,t)=>l(Ru,r=>Le(e,jp,Mo(f_(t,r))))),mO=$e(Qi),hO=(e,t)=>t.discard?xO(e,t.while,t.step,t.body):_(dO(e,t.while,t.step,t.body),r=>Array.from(r)),dO=(e,t,r,o)=>T(()=>t(e)?l(o(e),n=>_(dO(r(e),t,r,o),Mo(n))):g(()=>nr())),xO=(e,t,r,o)=>T(()=>t(e)?l(o(e),()=>xO(r(e),t,r,o)):k),gO=a(3,(e,t,r)=>T(()=>{let o=e[Symbol.iterator](),n=[],s=m(t),i,c=0;for(;!(i=o.next()).done;){let p=c++;s=l(s,u=>_(r(u,i.value,p),([f,h])=>(n.push(h),f)))}return _(s,p=>[p,n])})),Js=a(2,(e,t)=>J(e,{onFailure:r=>Pr(()=>t(r)),onSuccess:m})),qh=e=>l(t=>_(r=>W(r,l(([o,n])=>V(Nn(o),n))(Me(t))))(Uh(Nr(t)(Fn(e)))))(et()),yO=e=>ie(e,{onFailure:t=>m(t),onSuccess:m}),xa=e=>_(e,t=>!t),bO=e=>ie(e,{onFailure:t=>L(d(t)),onSuccess:t=>{switch(t._tag){case"None":return k;case"Some":return L(x())}}}),Uh=e=>_(fa(!0),t=>Q(Ps(e,g_(t,!1)))),SO=e=>ie(e,{onFailure:()=>m(x()),onSuccess:t=>m(d(t))}),EO=a(2,(e,t)=>En(e,()=>ar(t))),_O=a(2,(e,t)=>En(e,()=>g(t))),OO=e=>J(e,{onFailure:t=>{let r=Array.from(Li(t));return r.length===0?D(t):L(r)},onSuccess:m}),Nn=e=>Wu((t,r)=>Iu(t,r)(e)),CO=e=>e.length>=1?jt((t,r)=>{e(r).then(o=>t(X(o))).catch(o=>t(Vp(o)))}):jt(t=>{e().then(r=>t(X(r))).catch(r=>t(Vp(r)))}),RO=a(3,(e,t,r)=>Wh(e,t,m(r))),Wh=a(3,(e,t,r)=>ks(o=>l(r,n=>Ot(e,Ie(t,n)(o))))),AO=Ou(m),MO=a(3,(e,t,r)=>Y(e).reduce((o,n,s)=>l(o,i=>r(i,n,s)),m(t))),TO=a(3,(e,t,r)=>Y(e).reduceRight((o,n,s)=>l(o,i=>r(n,i,s)),m(t))),vO=a(3,(e,t,r)=>l(g(()=>e[Symbol.iterator]()),o=>IO(o,0,t,r.while,r.body))),IO=(e,t,r,o,n)=>{let s=e.next();return!s.done&&o(r)?l(n(r,s.value,t),i=>IO(e,t+1,i,o,n)):m(r)},kO=a(2,(e,t)=>T(()=>wO(e,t))),wO=(e,t)=>l(e,r=>t<=0?m(r):W(Rt(),wO(e,t-1))),FO=e=>J(e,{onFailure:L,onSuccess:m}),PO=e=>T(()=>VE(e)),Ys=bh,NO=e=>ie(e,{onFailure:t=>L(d(t)),onSuccess:t=>{switch(t._tag){case"None":return L(x());case"Some":return m(t.value)}}}),Qs=m(x()),jh=e=>m(d(e)),Uu=a(3,(e,t,r)=>l(t,o=>l(e,n=>_(t,s=>[r(o,s),n])))),DO=a(3,(e,t,r)=>zh(e,[ku(t,r)])),zh=a(2,(e,t)=>Kh(e,at(t))),Kh=a(2,(e,t)=>Le(fo,r=>Ge(t)(r))(e)),LO=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=m(!1),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>u?m(!0):(o.push(c),t(c,p)))}return _(s,()=>o)})),HO=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=m(!0),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>_(f=>(f&&o.push(c),f))(u?t(c,p):m(!1)))}return _(s,()=>o)})),qO=a(2,(e,{onFailure:t,onSuccess:r})=>J(e,{onFailure:o=>{let n=no(o);switch(n._tag){case"Left":return W(t(n.left),D(o));case"Right":return D(o)}},onSuccess:o=>V(r(o),o)})),UO=a(2,(e,t)=>kr(e,r=>Pe(dm(r),{onNone:()=>D(r),onSome:o=>W(t(o),D(r))}))),Bh=a(2,(e,t)=>J(e,{onFailure:r=>{let o=no(r);switch(o._tag){case"Left":return W(t(o.left),D(r));case"Right":return D(r)}},onSuccess:m})),WO=a(3,(e,t,r)=>Bh(e,o=>ce(o)&&"_tag"in o&&o._tag===t?r(o):k)),jO=a(2,(e,t)=>J(e,{onFailure:r=>W(t(r),D(r)),onSuccess:m})),zO=e=>Gh(e,Sh),Gh=a(2,(e,t)=>Uu(e,t,(r,o)=>Ac(o-r))),KO=E_,BO=KO(m),$h=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),t.length>=1?T(()=>{let o=new AbortController;return l(ma(()=>t(o.signal)),n=>jt(s=>(n.then(i=>s(X(i))).catch(i=>s(pr(r?r(i):i))),g(()=>o.abort()))))}):l(ma(e),o=>jt(n=>{o.then(s=>n(X(s))).catch(s=>n(pr(r?r(s):s)))}))},GO=a(2,(e,t)=>l(e,r=>ma({try:()=>t.try(r),catch:t.catch}))),$O=a(2,(e,t)=>l(e,r=>$h({try:t.try.length>=1?o=>t.try(r,o):()=>t.try(r),catch:t.catch}))),VO=a(2,(e,t)=>T(()=>t()?Qs:Hu(e))),JO=a(2,(e,t)=>l(t,r=>r?Qs:Hu(e))),YO=e=>Js(e,xm),Wu=e=>pe(t=>(t.setFiberRefs(e(t.id(),t.unsafeGetFiberRefs())),k)),QO=a(3,(e,t,r)=>On(e,o=>Ie(o,t,r(Ci(o,t))))),ju=a(2,(e,t)=>T(()=>t()?_(e,d):m(x()))),ZO=a(3,(e,t,r)=>l($e(t),o=>r(o)?_(e,n=>[o,d(n)]):m([o,x()]))),XO=a(3,(e,t,r)=>l(Lu(t),o=>r(o)?_(e,n=>[o,d(n)]):m([o,x()]))),eC=a(2,(e,t)=>t(e)),tC=(e,t)=>(...r)=>l(e,o=>t(o)(...r)),rC=(e,t)=>(...r)=>_(e,o=>t(o)(...r)),Vh=e=>new Proxy({},{get(t,r,o){return(...n)=>l(e,s=>s[r](...n))}}),Jh=e=>new Proxy({},{get(t,r,o){return l(e,n=>n[r])}}),oC=e=>({functions:Vh(e),constants:Jh(e)}),nC=function(){let e=arguments;return l(Qh,t=>t._tag==="Some"?g(()=>{if(typeof e[0]=="string")t.value.attribute(e[0],e[1]);else for(let r in e[0])t.value.attribute(r,e[0][r])}):k)},sC=a(e=>me(e[0]),function(){let e=arguments;return Le(e[0],Kp,typeof e[1]=="string"?Or(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[o,n])=>Or(r,o,n),t))}),Yh=_($e(mo),Jc),Qh=_($e(mo),db(e=>e._tag==="Span")),Ew=BigInt(0),zu=ye(ea,e=>e?Sh:m(Ew)),iC=a(e=>me(e[0]),(e,t,r)=>Le(e,Bp,jc({_tag:"SpanLink",span:t,attributes:r??{}}))),Zs=(e,t)=>KO(r=>l(t?.parent?jh(t.parent):t?.root?Qs:Yh,o=>l($e(Kp),n=>l($e(Bp),s=>l(zu,i=>g(()=>{let c=t?.links?[...Ye(s),...t.links]:Ye(s),p=r.span(e,o,t?.context??Dt(),c,i);return Ay(n,(u,f)=>p.attribute(f,u)),Object.entries(t?.attributes??{}).forEach(([u,f])=>p.attribute(u,f)),p})))))),aC=$e(Kp),cC=$e(Bp),Zh=(e,...t)=>{let r=t.length===1?void 0:t[0],o=t[t.length-1];return Wt(Zs(e,r),o,(n,s)=>l(zu,i=>g(()=>n.end(i,s))))},Xh=a(2,(e,t)=>Le(e,mo,Mo(t))),pC=a(e=>typeof e[0]!="string",(e,t,r)=>Zh(t,r??{},o=>Xh(e,o))),uC=e=>T(()=>{let t=e();return t==null?L(so()):m(t)}),lC=e=>pt(_(e,d),t=>bm(t)?Qs:L(t));var fC,mC,hC,Ku="@effect/io/Fiber/Status",Uo=Symbol.for(Ku),ed="Done",dC="Running",xC="Suspended",td=class{constructor(){this[fC]=Uo,this._tag=ed}[(fC=Uo,A)](){return I(S(this._tag))(S(Ku))}[M](t){return Bu(t)&&t._tag===ed}},rd=class{constructor(t){this.runtimeFlags=t,this[mC]=Uo,this._tag=dC}[(mC=Uo,A)](){return I(S(this.runtimeFlags))(I(S(this._tag))(S(Ku)))}[M](t){return Bu(t)&&t._tag===dC&&this.runtimeFlags===t.runtimeFlags}},od=class{constructor(t,r){this.runtimeFlags=t,this.blockingOn=r,this[hC]=Uo,this._tag=xC}[(hC=Uo,A)](){return I(S(this.blockingOn))(I(S(this.runtimeFlags))(I(S(this._tag))(S(Ku))))}[M](t){return Bu(t)&&t._tag===xC&&this.runtimeFlags===t.runtimeFlags&&O(this.blockingOn,t.blockingOn)}},gC=new td,yC=e=>new rd(e),bC=(e,t)=>new od(e,t),Bu=e=>typeof e=="object"&&e!=null&&Uo in e,SC=e=>e._tag===ed;var EC=gC,nd=yC,_C=bC;var OC=SC;var ei=vu;var sd=Iu;var Gu=z(Symbol.for("@effect/io/FiberRef/currentRequestMap"),()=>he(new Map));var id=(e,t,r,o)=>{switch(e?.concurrency){case void 0:return t();case"unbounded":return r();case"inherit":return ye(zp,n=>n==="unbounded"?r():n>1?o(n):t());default:return e.concurrency>1?o(e.concurrency):t()}},ga=(e,t,r)=>{switch(e?.concurrency){case void 0:return t();case"unbounded":return r();case"inherit":return ye(zp,o=>o==="unbounded"||o>1?r():t());default:return e.concurrency>1?r():t()}};var RC="Sequential",AC="Parallel";var ti={_tag:RC},MC={_tag:AC};var TC=e=>e._tag===RC,vC=e=>e._tag===AC;var $u="InterruptSignal",Vu="Stateful",Ju="Resume",Yu="YieldNow",ad=e=>({_tag:$u,cause:e}),ri=e=>({_tag:Vu,onFiber:e}),Dn=e=>({_tag:Ju,effect:e}),kC=()=>({_tag:Yu});var FC,PC,Aw="@effect/io/Fiber/Scope",Qu=Symbol.for(Aw),cd=class{constructor(){this[FC]=Qu,this.fiberId=Ze,this.roots=new Set}add(t,r){this.roots.add(r),r.unsafeAddObserver(()=>{this.roots.delete(r)})}};FC=Qu;var pd=class{constructor(t,r){this.fiberId=t,this.parent=r,this[PC]=Qu}add(t,r){this.parent.tell(ri(o=>{o.addChild(r),r.unsafeAddObserver(()=>{o.removeChild(r)})}))}};PC=Qu;var NC=e=>new pd(e.id(),e),Ln=z(Symbol.for("@effect/io/FiberScope/Global"),()=>new cd);var Mw="@effect/io/Fiber",ya=Symbol.for(Mw),ba={_E:e=>e,_A:e=>e},Tw={[ya]:ba,pipe(){return E(this,arguments)}},vw="@effect/io/Fiber",LC=Symbol.for(vw);var ud=e=>e.await();var HC=e=>e.inheritAll();var qC=a(2,(e,t)=>e.interruptAsFork(t)),Hn=e=>Ns(ut(e.await()),e.inheritAll());var Yz={...Tw,id:()=>Ze,await:()=>Rn,children:()=>m([]),inheritAll:()=>Rn,poll:()=>m(x()),interruptAsFork:()=>Rn};var Wo="@effect/io/Fiber/Current";var Iw="@effect/io/Logger",WC=Symbol.for(Iw),jC={_Message:e=>e,_Output:e=>e},Zu=e=>({[WC]:jC,log:e,pipe(){return E(this,arguments)}});var Xz={[WC]:jC,log:Jn,pipe(){return E(this,arguments)}};var zC=Zu(({annotations:e,cause:t,date:r,fiberId:o,logLevel:n,message:s,spans:i})=>{let c=r.getTime(),u=[`timestamp=${r.toISOString()}`,`level=${n.label}`,`fiber=${ep(o)}`].join(" "),f=kw(s);if(f.length>0&&(u=u+" message=",u=ld(f,u)),t!=null&&t!=Xe&&(u=u+" cause=",u=ld(io(t),u)),Pi(i)){u=u+" ";let h=!0;for(let y of i)h?h=!1:u=u+" ",u=u+m_(c)(y)}if(qc(e)>0){u=u+" ";let h=!0;for(let[y,b]of e)h?h=!1:u=u+" ",u=u+Pw(y),u=u+"=",u=ld(String(b),u)}return u}),kw=e=>{try{return typeof e=="object"?JSON.stringify(e):String(e)}catch{return String(e)}},ww=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,Fw=/^[^\s"=]+$/,ld=(e,t)=>t+(e.match(Fw)?e:ww(e));var Pw=e=>e.replace(/[\s="]/g,"_");var KC,BC="@effect/io/Metric/Boundaries",fd=Symbol.for(BC),md=class{constructor(t){this.values=t,this[KC]=fd}[(KC=fd,A)](){return I(S(this.values))(S(BC))}[M](t){return Dw(t)&&O(this.values,t.values)}pipe(){return E(this,arguments)}},Dw=e=>typeof e=="object"&&e!=null&&fd in e,Lw=e=>{let t=Py(or(Ee(Number.POSITIVE_INFINITY))(e));return new md(t)};var GC=e=>Lw(Et(Xl(e.count-1,t=>e.start*Math.pow(e.factor,t))));var $C,VC,JC,YC,QC,ZC,XC,eR,tR,rR,qw="@effect/io/Metric/KeyType",Sa=Symbol.for(qw),iR="effect/io/Metric/KeyType/Counter",hd=Symbol.for(iR),aR="effect/io/Metric/KeyType/Frequency",dd=Symbol.for(aR),cR="effect/io/Metric/KeyType/Gauge",xd=Symbol.for(cR),pR="effect/io/Metric/KeyType/Histogram",gd=Symbol.for(pR),uR="effect/io/Metric/KeyType/Summary",yd=Symbol.for(uR),Ea={_In:e=>e,_Out:e=>e},bd=class{constructor(){this[$C]=Ea,this[VC]=hd}[($C=Sa,VC=hd,A)](){return S(iR)}[M](t){return Ed(t)}pipe(){return E(this,arguments)}},oR=class{constructor(){this[JC]=Ea,this[YC]=dd}[(JC=Sa,YC=dd,A)](){return S(aR)}[M](t){return _d(t)}pipe(){return E(this,arguments)}},nR=class{constructor(){this[QC]=Ea,this[ZC]=xd}[(QC=Sa,ZC=xd,A)](){return S(cR)}[M](t){return Od(t)}pipe(){return E(this,arguments)}},Sd=class{constructor(t){this.boundaries=t,this[XC]=Ea,this[eR]=gd}[(XC=Sa,eR=gd,A)](){return I(S(this.boundaries))(S(pR))}[M](t){return Cd(t)&&O(this.boundaries,t.boundaries)}pipe(){return E(this,arguments)}},sR=class{constructor(t,r,o,n){this.maxAge=t,this.maxSize=r,this.error=o,this.quantiles=n,this[tR]=Ea,this[rR]=yd}[(tR=Sa,rR=yd,A)](){return I(S(this.quantiles))(I(S(this.error))(I(S(this.maxSize))(I(S(this.maxAge))(S(uR)))))}[M](t){return Rd(t)&&O(this.maxAge,t.maxAge)&&this.maxSize===t.maxSize&&this.error===t.error&&O(this.quantiles,t.quantiles)}pipe(){return E(this,arguments)}},lR=new bd;var fR=e=>new Sd(e);var Ed=e=>typeof e=="object"&&e!=null&&hd in e,_d=e=>typeof e=="object"&&e!=null&&dd in e,Od=e=>typeof e=="object"&&e!=null&&xd in e,Cd=e=>typeof e=="object"&&e!=null&&gd in e,Rd=e=>typeof e=="object"&&e!=null&&yd in e;var hR,Uw="@effect/io/Metric/Key",dR=Symbol.for(Uw),Ww={_Type:e=>e},_a=class{constructor(t,r,o,n=Be()){this.name=t,this.keyType=r,this.description=o,this.tags=n,this[hR]=Ww}[(hR=dR,A)](){return I(S(this.tags))(I(S(this.description))(I(S(this.keyType))(S(this.name))))}[M](t){return jw(t)&&this.name===t.name&&O(this.keyType,t.keyType)&&O(this.description,t.description)&&O(this.tags,t.tags)}pipe(){return E(this,arguments)}},jw=e=>typeof e=="object"&&e!=null&&dR in e,xR=(e,t)=>new _a(e,lR,Pt(t));var gR=(e,t,r)=>new _a(e,fR(t),Pt(r));var yR=a(2,(e,t)=>ro(t)===0?e:new _a(e.name,e.keyType,e.description,Ge(t)(e.tags)));var bR,SR,ER,_R,OR,CR,RR,AR,MR,TR,Kw="@effect/io/Metric/State",Oa=Symbol.for(Kw),vR="effect/io/Metric/State/Counter",Ad=Symbol.for(vR),IR="effect/io/Metric/State/Frequency",Md=Symbol.for(IR),kR="effect/io/Metric/State/Gauge",Td=Symbol.for(kR),wR="effect/io/Metric/State/Histogram",vd=Symbol.for(wR),FR="effect/io/Metric/State/Summary",Id=Symbol.for(FR),Ca={_A:e=>e},kd=class{constructor(t){this.count=t,this[bR]=Ca,this[SR]=Ad}[(bR=Oa,SR=Ad,A)](){return I(S(this.count))(S(vR))}[M](t){return Bw(t)&&this.count===t.count}pipe(){return E(this,arguments)}},wd=class{constructor(t){this.occurrences=t,this[ER]=Ca,this[_R]=Md}[(ER=Oa,_R=Md,A)](){return I(S(this.occurrences))(S(IR))}[M](t){return Gw(t)&&O(this.occurrences,t.occurrences)}pipe(){return E(this,arguments)}},Fd=class{constructor(t){this.value=t,this[OR]=Ca,this[CR]=Td}[(OR=Oa,CR=Td,A)](){return I(S(this.value))(S(kR))}[M](t){return $w(t)&&this.value===t.value}pipe(){return E(this,arguments)}},Pd=class{constructor(t,r,o,n,s){this.buckets=t,this.count=r,this.min=o,this.max=n,this.sum=s,this[RR]=Ca,this[AR]=vd}[(RR=Oa,AR=vd,A)](){return I(S(this.sum))(I(S(this.max))(I(S(this.min))(I(S(this.count))(I(S(this.buckets))(S(wR))))))}[M](t){return Vw(t)&&O(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return E(this,arguments)}},Nd=class{constructor(t,r,o,n,s,i){this.error=t,this.quantiles=r,this.count=o,this.min=n,this.max=s,this.sum=i,this[MR]=Ca,this[TR]=Id}[(MR=Oa,TR=Id,A)](){return I(S(this.sum))(I(S(this.max))(I(S(this.min))(I(S(this.count))(I(S(this.quantiles))(I(S(this.error))(S(FR)))))))}[M](t){return Jw(t)&&this.error===t.error&&O(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return E(this,arguments)}},PR=e=>new kd(e),NR=e=>new wd(e),DR=e=>new Fd(e),LR=e=>new Pd(e.buckets,e.count,e.min,e.max,e.sum),HR=e=>new Nd(e.error,e.quantiles,e.count,e.min,e.max,e.sum);var Bw=e=>typeof e=="object"&&e!=null&&Ad in e,Gw=e=>typeof e=="object"&&e!=null&&Md in e,$w=e=>typeof e=="object"&&e!=null&&Td in e,Vw=e=>typeof e=="object"&&e!=null&&vd in e,Jw=e=>typeof e=="object"&&e!=null&&Id in e;var Qw="@effect/io/Metric/Hook",Zw=Symbol.for(Qw),Xw={_In:e=>e,_Out:e=>e},Ra=e=>({[Zw]:Xw,pipe(){return E(this,arguments)},...e});var UR=e=>{let t=0;return Ra({get:()=>PR(t),update:r=>{t=t+r}})},WR=e=>{let t=0,r=new Map,o=s=>{t=t+1;let i=r.get(s)??0;r.set(s,i+1)},n=()=>Hc(r.entries());return Ra({get:()=>NR(n()),update:o})},jR=(e,t)=>{let r=t;return Ra({get:()=>DR(r),update:o=>{r=o}})},zR=e=>{let t=e.keyType.boundaries.values,r=t.length,o=new Uint32Array(r+1),n=new Float32Array(r),s=0,i=0,c=Number.MAX_VALUE,p=Number.MIN_VALUE;Ff((h,y)=>{n[y]=h})(zc(xt)(t));let u=h=>{let y=0,b=r;for(;y!==b;){let C=Math.floor(y+(b-y)/2),R=n[C];h<=R?b=C:y=C,b===y+1&&(h<=n[y]?b=y:y=b)}o[y]=o[y]+1,s=s+1,i=i+h,h<c&&(c=h),h>p&&(p=h)},f=()=>{let h=Array(r),y=0;for(let b=0;b<r;b++){let C=n[b],R=o[b];y=y+R,h[b]=[C,y]}return Et(h)};return Ra({get:()=>LR({buckets:f(),count:s,min:c,max:p,sum:i}),update:u})},KR=e=>{let{error:t,maxAge:r,maxSize:o,quantiles:n}=e.keyType,s=zc(xt)(n),i=Array(o),c=0,p=0,u=0,f=Number.MAX_VALUE,h=Number.MIN_VALUE,y=C=>{let R=[],v=0;for(;v!==o-1;){let w=i[v];if(w!=null){let[H,U]=w,te=os(C-H);mf(te,lf)&&te<=r&&R.push(U)}v=v+1}return eF(t,s,zc(xt)(Et(R)))},b=(C,R)=>{if(o>0){c=c+1;let v=c%o;i[v]=[R,C]}p=p+1,u=u+C,C<f&&(f=C),C>h&&(h=C)};return Ra({get:()=>HR({error:t,quantiles:y(Date.now()),count:p,min:f,max:h,sum:u}),update:([C,R])=>b(C,R)})},eF=(e,t,r)=>{let o=r.length;if(fs(t))return Qe();let n=nn(t),s=ls(1)(t),i=nt(Ee(qR(e,o,x(),0,n,r)),(c,p)=>{let u=nn(c);return jc(qR(e,o,u.value,u.consumed,p,u.rest))(c)})(s);return Ff(c=>[c.quantile,c.value])(i)},qR=(e,t,r,o,n,s)=>{let i=e,c=t,p=r,u=o,f=n,h=s,y=e,b=t,C=r,R=o,v=n,w=s;for(;;){if(fs(h))return{quantile:f,value:x(),consumed:u,rest:Qe()};if(f===1)return{quantile:f,value:d(wy(h)),consumed:u+h.length,rest:Qe()};let H=Fy(ae=>ae>nn(h))(h),U=f*c,te=i/2*U,de=u+H[0].length,Te=Math.abs(de-U);if(de<U-te){y=i,b=c,C=on(h),R=de,v=f,w=H[1],i=y,c=b,p=C,u=R,f=v,h=w;continue}if(de>U+te)return{quantile:f,value:p,consumed:u,rest:h};switch(p._tag){case"None":{y=i,b=c,C=on(h),R=de,v=f,w=H[1],i=y,c=b,p=C,u=R,f=v,h=w;continue}case"Some":{let ae=Math.abs(U-p.value);if(Te<ae){y=i,b=c,C=on(h),R=de,v=f,w=H[1],i=y,c=b,p=C,u=R,f=v,h=w;continue}return{quantile:f,value:d(p.value),consumed:u,rest:h}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/io/issues")};var rF="@effect/io/Metric/Pair",oF=Symbol.for(rF),nF={_Type:e=>e};var BR=(e,t)=>({[oF]:nF,metricKey:e,metricState:t,pipe(){return E(this,arguments)}});var GR,iF="@effect/io/Metric/Registry",$R=Symbol.for(iF),Dd=class{constructor(){this[GR]=$R,this.map=tn()}snapshot(){let t=[];for(let[r,o]of this.map)t.push(BR(r,o.get()));return at(t)}get(t){let r=Ue(xe(t)(this.map));if(r==null){if(Ed(t.keyType))return this.getCounter(t);if(Od(t.keyType))return this.getGauge(t);if(_d(t.keyType))return this.getFrequency(t);if(Cd(t.keyType))return this.getHistogram(t);if(Rd(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/io/issues")}else return r}getCounter(t){let r=Ue(xe(t)(this.map));if(r==null){let o=UR(t);tr(t)(this.map)||it(t,o)(this.map),r=o}return r}getFrequency(t){let r=Ue(xe(t)(this.map));if(r==null){let o=WR(t);tr(t)(this.map)||it(t,o)(this.map),r=o}return r}getGauge(t){let r=Ue(xe(t)(this.map));if(r==null){let o=jR(t,0);tr(t)(this.map)||it(t,o)(this.map),r=o}return r}getHistogram(t){let r=Ue(xe(t)(this.map));if(r==null){let o=zR(t);tr(t)(this.map)||it(t,o)(this.map),r=o}return r}getSummary(t){let r=Ue(xe(t)(this.map));if(r==null){let o=KR(t);tr(t)(this.map)||it(t,o)(this.map),r=o}return r}};GR=$R;var VR=()=>new Dd;var cF="@effect/io/Metric",pF=Symbol.for(cF),uF={_Type:e=>e,_In:e=>e,_Out:e=>e},lF=z(Symbol.for("@effect/io/Metric/globalMetricRegistry"),()=>VR()),fF=function(e,t,r){return Object.assign(n=>Ct(n,s=>g(()=>t(s,Be()))),{[pF]:uF,keyType:e,unsafeUpdate:t,unsafeValue:r,pipe(){return E(this,arguments)}})};var Aa=(e,t)=>JR(xR(e,t));var JR=e=>{let t=r=>{let o=yR(r)(e);return lF.get(o)};return fF(e.keyType,(r,o)=>t(o).update(r),r=>t(r).get())};var YR=(e,t,r)=>JR(gR(e,t,r));var QR=a(2,(e,t)=>ye(Gu,r=>g(()=>{if(r.has(e)){let o=r.get(e);o.state.completed||(o.state.completed=!0,js(o.result,t))}})));var Ma=class{constructor(){this.count=0,this.observers=new Set}addObserver(t){this.observers.add(t)}removeObserver(t){this.observers.delete(t)}increment(){this.count++,this.observers.forEach(t=>t(this.count))}decrement(){this.count--,this.observers.forEach(t=>t(this.count))}};var ZR,XR,eA,tA,hF,dF="@effect/io/Supervisor",va=Symbol.for(dF),Xu={_T:e=>e},Ta=class e{constructor(t,r){this.underlying=t,this.value0=r,this[ZR]=Xu}value(){return this.value0()}onStart(t,r,o,n){this.underlying.onStart(t,r,o,n)}onEnd(t,r){this.underlying.onEnd(t,r)}onEffect(t,r){this.underlying.onEffect(t,r)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new e(this,()=>_(t)(this.value()))}zip(t){return new jo(this,t)}onRun(t,r){return this.underlying.onRun(t,r)}};ZR=va;var jo=class e{constructor(t,r){this.left=t,this.right=r,this[XR]=Xu}value(){return Hp(this.left.value(),this.right.value())}onStart(t,r,o,n){this.left.onStart(t,r,o,n),this.right.onStart(t,r,o,n)}onEnd(t,r){this.left.onEnd(t,r),this.right.onEnd(t,r)}onEffect(t,r){this.left.onEffect(t,r),this.right.onEffect(t,r)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new Ta(this,()=>_(t)(this.value()))}zip(t){return new e(this,t)}onRun(t,r){return this.right.onRun(()=>this.left.onRun(t,r),r)}};XR=va;var Ld=class{constructor(){this[eA]=Xu,this.fibers=new Set}value(){return g(()=>Array.from(this.fibers))}onStart(t,r,o,n){this.fibers.add(n)}onEnd(t,r){this.fibers.delete(r)}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new Ta(this,()=>_(t)(this.value()))}zip(t){return new jo(this,t)}onRun(t,r){return t()}};eA=va;var Hd=class{constructor(t){this.effect=t,this[tA]=Xu}value(){return this.effect}onStart(t,r,o,n){}onEnd(t,r){}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new Ta(this,()=>_(t)(this.value()))}zip(t){return new jo(this,t)}onRun(t,r){return t()}};tA=va;hF=va;var xF=()=>new Ld,rA=g(xF),gF=e=>new Hd(e),qn=gF(k);var oA="Empty",nA="AddSupervisor",sA="RemoveSupervisor",iA="AndThen",oi={_tag:oA},tl=(e,t)=>({_tag:iA,first:e,second:t}),yF=(e,t)=>bF(t,Ee(e)),bF=(e,t)=>{let r=e,o=t;for(;je(o);){let n=ze(o);switch(n._tag){case oA:{o=Ke(o);break}case nA:{r=r.zip(n.supervisor),o=Ke(o);break}case sA:{r=qd(r,n.supervisor),o=Ke(o);break}case iA:{o=Ae(n.first)(Ae(n.second)(Ke(o)));break}}}return r},qd=(e,t)=>O(e,t)?qn:e instanceof jo?qd(e.left,t).zip(qd(e.right,t)):e,rl=e=>O(e,qn)?Be():e instanceof jo?Ge(rl(e.right))(rl(e.left)):to(e),SF=(e,t)=>{if(O(e,t))return oi;let r=rl(e),o=rl(t),n=sn(oi,(i,c)=>tl(i,{_tag:nA,supervisor:c}))(Gf(r)(o)),s=sn(oi,(i,c)=>tl(i,{_tag:sA,supervisor:c}))(Gf(o)(r));return tl(n,s)},aA=Vc({empty:oi,patch:yF,combine:tl,diff:SF});var cA,pA,_F=Aa("effect_fiber_started"),uA=Aa("effect_fiber_active"),OF=Aa("effect_fiber_successes"),CF=Aa("effect_fiber_failures"),RF=YR("effect_fiber_lifetimes",GC({start:1,factor:2,count:100})),Ia="Continue",AF="Done",lA="Yield",MF={_E:e=>e,_A:e=>e},ka=e=>{throw new Error(`BUG: FiberRuntime - ${JSON.stringify(e)} - please report an issue at https://github.com/Effect-TS/io/issues`)},ol={[Rs]:(e,t,r)=>t.i1(r),OnStep:(e,t,r)=>t.i1(X(r)),[As]:(e,t,r)=>t.i2(r),[$i]:(e,t,r)=>(e.patchRuntimeFlags(e._runtimeFlags,t.patch),Mr(e._runtimeFlags)&&e.isInterrupted()?K(e.getInterruptedCause()):X(r)),[Ms]:(e,t,r)=>(t.i2(r),t.i0()?(e.pushStack(t),t.i1()):k)},TF={[$u]:(e,t,r,o)=>(e.processNewInterruptSignal(o.cause),Mr(t)?K(o.cause):r),[Ju]:(e,t,r,o)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[Vu]:(e,t,r,o)=>(o.onFiber(e,nd(t)),r),[Yu]:(e,t,r,o)=>l(Rt(),()=>r)},vF=e=>lt(Qb(e),t=>si(eS(t),([r,o])=>{let n=new Map;for(let s of o)for(let i of s)n.set(i.request,i);return be(UF(r.runAll(o),o.flat()),Gu,n)},!1)),wa=class{pipe(){return E(this,arguments)}constructor(t,r,o){if(this[cA]=ba,this[pA]=MF,this._queue=new Array,this._children=null,this._observers=new Array,this._running=!1,this._stack=[],this._asyncInterruptor=null,this._asyncBlockingOn=null,this._exitValue=null,this._steps=[!1],this.run=()=>{this.drainQueueOnCurrentThread()},this._runtimeFlags=o,this._fiberId=t,this._fiberRefs=r,this._supervisor=this.getFiberRef(ni),Ki(o)){let n=this.getFiberRef(fo);_F.unsafeUpdate(1,n),uA.unsafeUpdate(1,n)}}id(){return this._fiberId}resume(t){this.tell(Dn(t))}status(){return this.ask((t,r)=>r)}runtimeFlags(){return this.ask((t,r)=>OC(r)?t._runtimeFlags:r.runtimeFlags)}scope(){return NC(this)}children(){return this.ask(t=>Array.from(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(An)}fiberRefs(){return this.ask(t=>t.unsafeGetFiberRefs())}ask(t){return T(()=>{let r=qs(this._fiberId);return this.tell(ri((o,n)=>{js(r,g(()=>t(o,n)))})),Me(r)})}tell(t){this._queue.push(t),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}await(){return jt(t=>{let r=o=>t(m(o));return this.tell(ri((o,n)=>{o._exitValue!==null?r(this._exitValue):o.unsafeAddObserver(r)})),g(()=>this.tell(ri((o,n)=>{o.unsafeRemoveObserver(r)})))},this.id())}inheritAll(){return pe((t,r)=>{let o=t.id(),n=t.unsafeGetFiberRefs(),s=r.runtimeFlags,i=this.unsafeGetFiberRefs(),c=Au(n,o,i);t.setFiberRefs(c);let p=t.getFiberRef(mA),u=Tm(ji)(Tm(ir)(gn(s,p)));return Fs(u)})}poll(){return g(()=>Pt(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(t){return g(()=>this.tell(ad(sr(t))))}unsafeAddObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}unsafeRemoveObserver(t){this._observers=this._observers.filter(r=>r!==t)}unsafeGetFiberRefs(){return this.setFiberRef(mA,this._runtimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=pa(this._fiberRefs,t)}getFiberRef(t){return this._fiberRefs.locals.has(t)?this._fiberRefs.locals.get(t)[0][1]:t.initial}setFiberRef(t,r){this._fiberRefs=kn(this._fiberRefs,{fiberId:this._fiberId,fiberRef:t,value:r}),t===ni&&(this._supervisor=r)}setFiberRefs(t){this._fiberRefs=t,this._supervisor=this.getFiberRef(ni)}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let r=Ia,o=globalThis[Wo];globalThis[Wo]=this;try{for(;r===Ia;)r=this._queue.length===0?AF:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[Wo]=o}this._queue.length>0&&!this._running?(this._running=!0,r===lA?(this.drainQueueLaterOnExecutor(),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(){this.getFiberRef(lo).scheduleTask(this.run,this.getFiberRef(Yi))}drainQueueWhileRunning(t,r){let o=r;for(;this._queue.length>0;){let n=this._queue.splice(0,1)[0];o=TF[n._tag](this,t,o,n)}return o}isInterrupted(){return!hm(this.getFiberRef(An))}addInterruptedCause(t){let r=this.getFiberRef(An);this.setFiberRef(An,_e(r,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(let r of this._children)r.tell(ad(sr(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let t=this._children.values();this._children=null;let r=!1;return Cn({while:()=>!r,body:()=>{let n=t.next();return n.done?g(()=>{r=!0}):Q(n.value.await())},step:()=>{}})}return null}reportExitValue(t){if(Ki(this._runtimeFlags)){let r=this.getFiberRef(fo);switch(uA.unsafeUpdate(-1,r),t._tag){case le:{OF.unsafeUpdate(1,r);break}case ue:{CF.unsafeUpdate(1,r);break}}}if(t._tag==="Failure"){let r=this.getFiberRef(Xi);!ko(t.cause)&&r._tag==="Some"&&this.log("Fiber terminated with a non handled error",t.cause,r)}}setExitValue(t){if(this._exitValue=t,Ki(this._runtimeFlags)){let r=this.getFiberRef(fo),o=this.id().startTimeMillis,n=new Date().getTime();RF.unsafeUpdate((n-o)/1e3,r)}this.reportExitValue(t);for(let r=this._observers.length-1;r>=0;r--)this._observers[r](t)}getLoggers(){return this.getFiberRef(xA)}log(t,r,o){let n=N(o)?o.value:this.getFiberRef(Jm),s=this.getFiberRef(dA);if(a_(s,n))return;let i=this.getFiberRef(jp),c=this.getFiberRef(Qi),p=this.getLoggers(),u=this.unsafeGetFiberRefs();if(ro(p)>0){let f=Qr(this.getFiberRef(tt),Lr),h=new Date(f.unsafeCurrentTimeMillis());for(let y of p)y.log({fiberId:this.id(),logLevel:n,message:t,cause:r,context:u,spans:i,annotations:c,date:h})}}evaluateMessageWhileSuspended(t){switch(t._tag){case Yu:return lA;case $u:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(K(t.cause)),this._asyncInterruptor=null),Ia;case Ju:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),Ia;case Vu:return t.onFiber(this,this._exitValue!==null?EC:_C(this._runtimeFlags,this._asyncBlockingOn)),Ia;default:return ka(t)}}evaluateEffect(t){this._supervisor.onResume(this);try{let r=Mr(this._runtimeFlags)&&this.isInterrupted()?K(this.getInterruptedCause()):t;for(;r!==null;)try{let o=r,n=this.runLoop(o);this._runtimeFlags=Om(ji)(this._runtimeFlags);let s=this.interruptAllChildren();s!==null?r=l(s,()=>n):(this._queue.length===0?this.setExitValue(n):this.tell(Dn(n)),r=null)}catch(o){if(me(o))o._tag===Ts?_m(this._runtimeFlags)?(this.tell(kC()),this.tell(Dn(Dr)),r=null):r=Dr:o._tag===Os&&(r=null);else throw o}}finally{this._supervisor.onSuspend(this)}}start(t){if(this._running)this.tell(Dn(t));else{this._running=!0;let r=globalThis[Wo];globalThis[Wo]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[Wo]=r,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(t){this.tell(Dn(t))}patchRuntimeFlags(t,r){let o=_s(t,r);return globalThis[Wo]=this,this._runtimeFlags=o,o}initiateAsync(t,r){let o=!1,n=s=>{o||(o=!0,this.tell(Dn(s)))};Mr(t)&&(this._asyncInterruptor=n);try{r(n)}catch(s){n(D(Ne(s)))}}pushStack(t){this._stack.push(t),t._tag==="OnStep"&&this._steps.push(!0),t._tag==="RevertFlags"&&this._steps.push(!1)}popStack(){let t=this._stack.pop();if(t)return(t._tag==="OnStep"||t._tag==="RevertFlags")&&this._steps.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._tag!==Cs)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._tag!==Rs&&t._tag!==Ms)return t;t=this.popStack()}}[(cA=ya,pA=LC,iS)](t){return _($e(uo),r=>{try{return Ci(r,t)}catch(o){throw console.log(o),o}})}Left(t){return pr(t.i0)}None(t){return pr(so())}Right(t){return X(t.i0)}Some(t){return X(t.i0)}[Ep](t){let r=t.i0(),o=this.getNextSuccessCont();if(o!==void 0)return o._tag in ol||ka(o),ol[o._tag](this,o,r);throw X(r)}[le](t){let r=t,o=this.getNextSuccessCont();if(o!==void 0)return o._tag in ol||ka(o),ol[o._tag](this,o,r.i0);throw r}[ue](t){let r=this.getFiberRef(mo),o=ct(r)||r.head._tag==="ExternalSpan"?t.i0:Io(t.i0,Db(r.head)),n=this.getNextFailCont();if(n!==void 0)switch(n._tag){case Cs:case As:return Mr(this._runtimeFlags)&&this.isInterrupted()?K(ys(o)):n.i1(o);case"OnStep":return Mr(this._runtimeFlags)&&this.isInterrupted()?K(ys(o)):n.i1(K(o));case $i:return this.patchRuntimeFlags(this._runtimeFlags,n.patch),Mr(this._runtimeFlags)&&this.isInterrupted()?K(_e(o,this.getInterruptedCause())):K(o);default:ka(n)}else throw K(o)}[_p](t){return t.i0(this,nd(this._runtimeFlags))}Blocked(t){if(this._steps[this._steps.length-1]){let r=this.popStack();if(r)switch(r._tag){case"OnStep":return r.i1(t);case"OnSuccess":return fe(t.i0,l(t.i1,r.i1));case"OnSuccessAndFailure":return fe(t.i0,J(t.i1,{onFailure:r.i1,onSuccess:r.i2}));case"OnFailure":return fe(t.i0,kr(t.i1,r.i1));case"While":return fe(t.i0,l(t.i1,o=>(r.i2(o),r.i0()?Cn({while:r.i0,body:r.i1,step:r.i2}):k)));case"RevertFlags":{this.pushStack(r);break}}}return ge(r=>l(At(Ip(t.i0)),()=>r(t.i1)))}RunBlocked(t){return vF(t.i0)}[ao](t){let r=t.i0,o=this._runtimeFlags,n=_s(o,r);if(Mr(n)&&this.isInterrupted())return K(this.getInterruptedCause());if(this.patchRuntimeFlags(this._runtimeFlags,r),t.i1){let s=gn(n,o);return this.pushStack(new Mp(s,t)),t.i1(o)}else return Dr}[Rs](t){return this.pushStack(t),t.i0}OnStep(t){return this.pushStack(t),t.i0}[Cs](t){return this.pushStack(t),t.i0}[As](t){return this.pushStack(t),t.i0}[Os](t){throw this._asyncBlockingOn=t.i1,this.initiateAsync(this._runtimeFlags,t.i0),t}[Ts](t){throw t}[Ms](t){let r=t.i0,o=t.i1;return r()?(this.pushStack(t),o()):Dr}[sS](t){return t.commit()}runLoop(t){let r=t,o=0;for(;;){if(this._runtimeFlags&Em&&this._supervisor.onEffect(this,r),this._queue.length>0&&(r=this.drainQueueWhileRunning(this._runtimeFlags,r)),o+=1,o>=this.getFiberRef(Vm)){o=0;let n=r;r=l(Rt(),()=>n)}try{r._tag in this||(typeof r=="function"&&console.log(r()),ka(r)),r=this._supervisor.onRun(()=>this[r._tag](r),this)}catch(n){if(me(n)){if(n._tag===Ts||n._tag===Os)throw n;if(n._tag===le||n._tag===ue)return n}else mS(n)?r=K(n.cause):ym(n)?r=K(_e(Ne(n),sr(Ze))):r=K(Ne(n))}}}},dA=he(c_("Info")),IF=Zu(e=>{let t=zC.log(e);globalThis.console.log(t)});var kF=Zu(({annotations:e,cause:t,context:r,fiberId:o,logLevel:n,message:s})=>{let i=es(ua(r,mo),Jc),c=Re(ua(r,tt),u=>Qr(u,Lr));if(i._tag==="None"||i.value._tag==="ExternalSpan"||c._tag==="None")return;let p=Object.fromEntries(e);p["effect.fiberId"]=Rb(o),p["effect.logLevel"]=n.label,t!==null&&t!==Xe&&(p["effect.cause"]=io(t)),i.value.event(String(s),c.value.unsafeCurrentTimeNanos(),p)}),xA=$m(to(IF,kF)),Pa=a(e=>me(e[0]),(e,t)=>vr(Ct(e,r=>Na(o=>t(r,o))))),gA=a(e=>me(e[0]),(e,t)=>Wr(e,Na(r=>t(r)))),Na=e=>pe(t=>{let r=t.unsafeGetFiberRefs();return l(sl,o=>Ls(o,n=>pe(s=>{let i=s.unsafeGetFiberRefs(),c=ei(i,r),p=ei(r,i);return s.setFiberRefs(sd(c,s.id(),r)),Wr(e(n),g(()=>{s.setFiberRefs(sd(p,s.id(),s.unsafeGetFiberRefs()))}))})))}),yA=e=>be(Vi,d(Ln))(e),fA=Symbol("@effect/io/Effect/existsPar/found"),bA=a(e=>Ft(e[0]),(e,t,r)=>ga(r,()=>T(()=>SA(e[Symbol.iterator](),0,t)),()=>ie(Vt(e,(o,n)=>kp(t(o,n),{onTrue:L(fA),onFalse:k}),r),{onFailure:o=>o===fA?m(!0):L(o),onSuccess:()=>m(!1)}))),SA=(e,t,r)=>{let o=e.next();return o.done?m(!1):l(r(o.value,t),n=>n?m(n):SA(e,t+1,r))},EA=a(e=>Ft(e[0]),(e,t,r)=>{let o=r?.negate?(n,s)=>_(t(n,s),ug):t;return ga(r,()=>T(()=>Y(e).reduceRight((n,s,i)=>po(n,T(()=>o(s,i)),(c,p)=>p?[s,...c]:c),g(()=>new Array))),()=>_(Vt(e,(n,s)=>_(o(n,s),i=>i?d(n):x()),r),kg))}),wF=e=>{if(Array.isArray(e)||Ft(e))return[e,x()];let t=Object.keys(e),r=t.length;return[t.map(o=>e[o]),d(o=>{let n={};for(let s=0;s<r;s++)n[t[s]]=o[s];return n})]},FF=(e,t,r)=>{let o=[];for(let n of e)o.push(wr(n));return l(Vt(o,F,{concurrency:r?.concurrency,batching:r?.batching}),n=>{let s=x(),i=n.length,c=new Array(i),p=new Array(i),u=!1;for(let f=0;f<i;f++){let h=n[f];h._tag==="Left"?(c[f]=d(h.left),u=!0):(p[f]=h.right,c[f]=s)}return u?t._tag==="Some"?L(t.value(c)):L(c):r?.discard?k:t._tag==="Some"?m(t.value(p)):m(p)})},PF=(e,t,r)=>{let o=[];for(let n of e)o.push(wr(n));return r?.discard?Vt(o,F,{concurrency:r?.concurrency,batching:r?.batching,discard:!0}):_(Vt(o,F,{concurrency:r?.concurrency,batching:r?.batching}),n=>t._tag==="Some"?t.value(n):n)},ii=(e,t)=>{let[r,o]=wF(e);return t?.mode==="validate"?FF(r,o,t):t?.mode==="either"?PF(r,o,t):o._tag==="Some"?_(Vt(r,F,t),o.value):Vt(r,F,t)},_A=e=>t=>ii(t,e),OA=(e,t)=>_(ii(Y(e).map(Z),t),Oi(r=>$p(r)?d(r.i0):x())),zd=a(2,(e,t)=>Array.from({length:t},()=>e)),CA=a(e=>me(e[0]),(e,t,r)=>ii(zd(t)(e),r)),Vt=a(e=>Ft(e[0]),(e,t,r)=>pe(o=>{let n=r?.batching===!0||r?.batching==="inherit"&&o.getFiberRef(Zi);return r?.discard?id(r,()=>n?Ud(e,t):lt(e,t),()=>si(e,t,n),s=>Kd(e,s,t,n)):id(r,()=>n?Wd(e,1,t,!0):De(e,t),()=>Fa(e,t,n),s=>Wd(e,s,t,n))})),Fa=(e,t,r)=>T(()=>{let o=Y(e),n=new Array(o.length);return W(si(o,(i,c)=>l(t(i,c),p=>g(()=>n[c]=p)),r),m(n))}),Ud=(e,t)=>T(()=>{let r=Y(e),o=r.length;if(o===0)return k;if(o===1)return Q(t(r[0],0));let n=r.map(t),s=new Array,i=c=>c===n.length?T(()=>{if(s.length>0){let p=s.map(u=>u.i0).reduce(yn);return fe(p,Ud(s.map(u=>u.i1),F))}return k}):ws(n[c],p=>p._tag==="Blocked"?(s.push(p),i(c+1)):p._tag==="Failure"?T(()=>{if(s.length>0){let u=s.map(f=>f.i0).reduce(yn);return fe(u,l(Ud(s.map(f=>f.i1),F),()=>p))}return k}):i(c+1));return i(0)}),si=(e,t,r)=>T(()=>{let o=Y(e),n=o.length;return n===0?k:n===1?Q(t(o[0],0)):ge(s=>{let i=qs(Ze),c=0,p=[],u=[],f=Lp(h=>De(o,(y,b)=>_(C=>(C.unsafeAddObserver(()=>{u.push(C)}),C))(Un(h(l(C=>{switch(C._tag){case"Failure":{if(p.length>0){let R=p.map(w=>w.i0).reduce(yn),v=si(p,w=>w.i1,r);return fe(R,J(v,{onFailure:w=>W(oa(i,void 0),D(ke(w,C.cause))),onSuccess:()=>W(oa(i,void 0),D(C.cause))}))}return W(oa(i,void 0),D(C.cause))}default:{if(C._tag==="Blocked"&&p.push(C),c+1===n)if(p.length>0){let R=p.map(w=>w.i0).reduce(yn),v=si(p,w=>w.i1,r);return Ws(i,fe(R,v))}else js(i,X(Dr));else c=c+1;return k}}})(T(()=>s((r?Tr:Z)(t(y,b))))))))));return l(f,h=>J(s(Me(i)),{onFailure:y=>l(Fa(h,Lo,r),b=>{let C=Hs(b,{parallel:!0});return C._tag==="Some"&&eh(C.value)?D(ke(ys(y),C.value.i0)):D(ys(y))}),onSuccess:y=>l(y,()=>lt(u,b=>b.inheritAll()))}))})}),Wd=(e,t,r,o)=>T(()=>{let n=Y(e),s=new Array(n.length);return W(Kd(n,t,(c,p)=>_(r(c,p),u=>s[p]=u),o),m(s))}),Kd=(e,t,r,o)=>T(()=>{let n=0,s=e[Symbol.iterator](),i=[],c=l(g(()=>s.next()),u=>u.done?k:l((o?Tr:Z)(Q(r(u.value,n++))),f=>{switch(f._tag){case"Blocked":return i.push(f),c;case"Failure":return f;case"Success":return c}})),p=[];for(let u=0;u<t;u++)p.push(c);return l(Z(si(p,F,o)),u=>{if(i.length===0)return u;let f=i.map(y=>y.i0).reduce(yn),h=Kd(i,t,y=>y.i1,o);return u._tag==="Failure"?fe(f,J(h,{onFailure:y=>K(ke(u.cause,y)),onSuccess:()=>u})):fe(f,h)})}),At=e=>pe((t,r)=>m(AA(e,t,r.runtimeFlags))),Un=e=>NF(e,Ln),RA=a(2,(e,t)=>At(Np(e,r=>{let o=no(r);switch(o._tag){case"Left":return t(o.left);case"Right":return D(o.right)}}))),AA=(e,t,r,o=null)=>{let n=jd(e,t,r,o);return n.resume(e),n},jd=(e,t,r,o=null)=>{let n=tp(),s=t.unsafeGetFiberRefs(),i=Mu(s,n),c=new wa(n,i,r),p=Vs(i,uo),u=c._supervisor;return u.onStart(p,e,d(t),c),c.unsafeAddObserver(h=>u.onEnd(h,c)),(o!==null?o:$(()=>t.scope())(t.getFiberRef(Vi))).add(r,c),c},NF=(e,t)=>pe((r,o)=>m(AA(e,r,o.runtimeFlags,t))),Bd=a(e=>Ft(e[0]),(e,t,r,o)=>ga(o,()=>Y(e).reduce((n,s,i)=>po(n,s,(c,p)=>r(c,p,i)),m(t)),()=>l(fa(t),n=>l(Vt(e,(s,i)=>l(s,c=>b_(n,p=>r(p,c,i))),o),()=>Lu(n))))),Gd=a(e=>Ft(e[0]),(e,t,r)=>_(o=>yS(o,F))(Vt(e,(o,n)=>wr(t(o,n)),r))),MA=a(e=>Ft(e[0]),(e,t,r)=>l(Gd(e,t,{concurrency:r?.concurrency,batching:r?.batching}),([o,n])=>o.length===0?r?.discard?k:m(n):L(o))),TA=e=>{let t=Cr(e);if(!je(t))return Fo(()=>Ss("Received an empty collection of effects"));let r=ze(t),o=Ke(t),n=s=>V(s[0])(HC(s[1]));return l(s=>l(i=>ge(c=>l(p=>l(u=>Do(()=>nt(k,(f,h)=>Ns(Lo(h))(f))(u))(c(l(n)(vn(s)))))(Ct(u=>nt(k,(f,h)=>W(Q(At(l(DF(u,h,s,i))(ud(h)))))(f))(u))(_(u=>Ae(p)(u))(_(Et)(De(u=>At(Ut(u)))(o))))))(At(Ut(r)))))(fa(o.length)))(et())},DF=(e,t,r,o)=>n=>Mn(n,{onFailure:s=>ut(y_(o,i=>[i===0?Q(Tn(r,s)):k,i-1])),onSuccess:s=>l(i=>i?nt(k,(c,p)=>p===t?c:Ns(Lo(p))(c))(Cr(e)):k)(Ws(r,[s,t]))}),vA=a(e=>Ft(e[0]),(e,t,r,o)=>ga(o,()=>Y(e).reduce((n,s,i)=>po(n,s,(c,p)=>r(c,p,i)),t),()=>T(()=>_(n=>{switch(n._tag){case"None":throw new Error("BUG: Effect.reduceEffect - please report an issue at https://github.com/Effect-TS/io/issues");case"Some":return n.value}})(Bd([t,...e],x(),(n,s,i)=>{switch(n._tag){case"None":return d(s);case"Some":return d(r(n.value,s,i))}},o))))),IA=e=>l(sl,t=>l(Wn(MC),r=>W(jn(e,r))(t.addFinalizer(o=>r.close(o))))),zo=e=>l(Zd,e),$d=e=>l(Wn(),t=>HF(t)(e)),kA=e=>zo(t=>l(r=>jn(r)(e))(Zm(t,ti))),wA=(e,t)=>Vd([ku(e,t)]),Vd=e=>Jd(at(e)),Jd=e=>fr(fo,t=>Ge(e)(t)),FA=a(2,(e,t)=>Wt(Wn(),r=>l(jn(e,r),t),(r,o)=>Ho(r,o))),PA=e=>ie(e,{onFailure:t=>{switch(t._tag){case"None":return m(x());case"Some":return L(t.value)}},onSuccess:t=>m(d(t))}),NA=a(e=>me(e[1]),(e,t,r)=>Yd(e,t,(o,n)=>[o,n],r)),Yd=a(e=>me(e[1]),(e,t,r,o)=>ut(go(Z(e),Z(t),(n,s)=>ra(n,s,{onSuccess:r,onFailure:(i,c)=>o?.concurrent?ke(i,c):_e(i,c)}),o)));var DA=a(e=>Ft(e[0]),(e,t,r)=>No(Vt(e,(o,n)=>No(t(o,n)),r))),LA=e=>fr(tt,Ie(Lr,e)),nl=e=>fr(tt,Ie(Gs,e)),HA=e=>zo(t=>l(Zm(t,ti),r=>_(o=>[zt(n=>Ho(r,Jp(n))),o])(jn(r)(e)))),qA=a(e=>me(e[1]),(e,t,r)=>go(e,t,(o,n)=>[o,n],r)),UA=a(e=>me(e[1]),(e,t,r)=>go(e,t,(o,n)=>o,r)),WA=a(e=>me(e[1]),(e,t,r)=>go(e,t,(o,n)=>n,r)),go=a(e=>me(e[1]),(e,t,r,o)=>_(ii([e,t],{concurrency:o?.concurrent?2:1,batching:o?.batching}),([n,s])=>r(n,s))),Qd=e=>e===gp?k:vr(l(t=>{let r=_s(t,e),o=gn(r,t);return Q(W(Na(()=>Fs(o)))(Fs(e)))})(Dp)),LF=(e,t)=>r=>T(()=>{switch(r.state._tag){case"Exited":return k;case"Running":{let o=r.state.finalizers,n=r.state.update,s=Array.from(o.keys()).sort((i,c)=>c-i).map(i=>o.get(i));return r.state={_tag:"Exited",nextKey:r.state.nextKey,exit:t,update:n},TC(e)?l(i=>$(()=>Dr)(Re(ta)(Hs(i))))(De(i=>Z(n(i)(t)))(s)):vC(e)?l(i=>$(()=>Dr)(Re(ta)(Hs(i,{parallel:!0}))))(Fa(s,i=>Z(n(i)(t)),!1)):l(i=>$(()=>Dr)(Re(ta)(Hs(i,{parallel:!0}))))(Wd(s,e.parallelism,i=>Z(n(i)(t)),!1))}}}),Zd=yt(Gp),sl=Zd,Wn=(e=ti)=>_(kS,t=>({[Gp]:Gp,[Qm]:Qm,pipe(){return E(this,arguments)},fork:r=>vr(l(o=>V(o)(Ct(n=>Ls(o,n))(Xm(t,n=>Ho(o,n)))))(Wn(r))),close:r=>Q(LF(e,r)(t)),addFinalizer:r=>Q(Xm(r)(t))})),jn=a(2,(e,t)=>On(e,rs(pf(Zd,t)))),HF=a(2,(e,t)=>cr(r=>t.close(r))(jn(t)(e))),qF=e=>Ds(e,{differ:aA,fork:oi}),Jt=a(2,(e,t)=>Q(Pa(l($e(e),r=>V(Sn(e,t),r)),r=>Sn(e,r)))),fr=a(2,(e,t)=>ye(e,r=>Jt(e,t(r))));var mA=AS(Cm),ni=qF(qn),jA=e=>Q(ud(il(e))),il=e=>({[ya]:ba,id:()=>Y(e).reduce((t,r)=>am(t,r.id()),Ze),await:()=>Z(Fa(e,t=>ut(t.await()),!1)),children:()=>_(Fa(e,t=>t.children(),!1),Oc),inheritAll:()=>lt(e,t=>t.inheritAll()),poll:()=>_(De(e,t=>t.poll()),Cc(d(X(new Array)),(t,r)=>{switch(r._tag){case"None":return x();case"Some":switch(t._tag){case"None":return x();case"Some":return d(ra(r.value,t.value,{onSuccess:(o,n)=>[o,...n],onFailure:ke}))}}})),interruptAsFork:t=>lt(e,r=>r.interruptAsFork(t)),pipe(){return E(this,arguments)}});var Xd=a(3,(e,t,r)=>ex(e,t,{onSelfWin:(o,n)=>l(o.await(),s=>{switch(s._tag){case le:return l(o.inheritAll(),()=>r.onSelfDone(s,n));case ue:return r.onSelfDone(s,n)}}),onOtherWin:(o,n)=>l(o.await(),s=>{switch(s._tag){case le:return l(o.inheritAll(),()=>r.onOtherDone(s,n));case ue:return r.onOtherDone(s,n)}})})),zA=e=>ge(t=>zt(r=>l(Un(t(e)),o=>Do(()=>qC(r)(o))(t(Hn(o)))))),al=a(2,(e,t)=>zt(r=>Xd(e,t,{onSelfDone:(o,n)=>Mn(o,{onFailure:s=>Js(i=>ke(s,i))(Hn(n)),onSuccess:s=>V(s)(Kt(r)(n))}),onOtherDone:(o,n)=>Mn(o,{onFailure:s=>Js(i=>ke(i,s))(Hn(n)),onSuccess:s=>V(s)(Kt(r)(n))})}))),ex=a(3,(e,t,r)=>pe((o,n)=>{let s=n.runtimeFlags,i=st(!0),c=jd(e,o,s,r.selfScope),p=jd(t,o,s,r.otherScope);return jt(u=>{c.unsafeAddObserver(()=>hA(c,p,r.onSelfWin,i,u)),p.unsafeAddObserver(()=>hA(p,c,r.onOtherWin,i,u)),c.startFork(e),p.startFork(t)},am(c.id(),p.id()))})),hA=(e,t,r,o,n)=>{Uc(!0,!1)(o)&&n(r(e,t))},Wr=a(2,(e,t)=>ge(r=>J(r(e),{onFailure:o=>J(t,{onFailure:n=>D(_e(o,n)),onSuccess:()=>D(o)}),onSuccess:o=>V(t,o)}))),UF=(e,t)=>zt(r=>l(l(Un(Ut(e)),o=>jt(n=>{let s=t.map(p=>p.listeners.count),i=()=>{s.every(p=>p===0)&&(c.forEach(p=>p()),n(Lo(o)))};o.unsafeAddObserver(p=>{c.forEach(u=>u()),n(p)});let c=t.map((p,u)=>{let f=h=>{s[u]=h,i()};return p.listeners.addObserver(f),()=>p.listeners.removeObserver(f)});return i(),g(()=>{c.forEach(p=>p())})})),()=>T(()=>{let o=t.flatMap(n=>n.state.completed?[]:[n]);return lt(o,n=>QR(n.request,Jp(r)))})));var KA=(e,t)=>Pa(Zs(e,t),(r,o)=>l(zu,n=>g(()=>r.end(n,o)))),cl=(e,t)=>l(Zs(e,t),r=>fr(mo,Mo(r))),pl=e=>fr(tt,Ie($s,e)),ul=e=>fr(mo,Mo(e));var BA,VA,GA=(e,t,r,o)=>Zr({_tag:"Complete",key:e,exit:t,entryStats:r,timeToLiveMillis:o}),$A=(e,t)=>Zr({_tag:"Pending",key:e,deferred:t}),WF=(e,t)=>Zr({_tag:"Refreshing",deferred:e,complete:t}),tx=Symbol.for("@effect/cache/Cache/MapKey"),rx=class{constructor(t){this.current=t,this[BA]=tx,this.previous=void 0,this.next=void 0}[(BA=tx,A)](){return I(S(this.next))(I(S(this.previous))(S(this.current)))}[M](t){return this===t?!0:jF(t)&&O(this.current,t.current)&&O(this.previous,t.previous)&&O(this.next,t.next)}},ai=e=>new rx(e),jF=e=>typeof e=="object"&&e!=null&&tx in e,ox=class{constructor(){this.head=void 0,this.tail=void 0}add(t){if(t!==this.tail)if(this.tail===void 0)this.head=t,this.tail=t;else{let r=t.previous,o=t.next;o!==void 0&&(t.next=void 0,r!==void 0?(r.next=o,o.previous=r):(this.head=o,this.head.previous=void 0)),this.tail.next=t,t.previous=this.tail,this.tail=t}}remove(){let t=this.head;if(t!==void 0){let r=t.next;r!==void 0?(t.next=void 0,this.head=r,this.head.previous=void 0):(this.head=void 0,this.tail=void 0)}return t}},zF=()=>new ox,KF=(e,t,r,o,n,s)=>({map:e,keys:t,accesses:r,updating:o,hits:n,misses:s}),BF=()=>KF(tn(),zF(),qy(),st(!1),0,0),GF="@effect/cache/Cache",$F=Symbol.for(GF),VF={_Key:e=>e,_Error:e=>e,_Value:e=>e},JF=e=>e,ll=e=>({loadedMillis:e}),nx=class{constructor(t,r,o,n,s){this.capacity=t,this.context=r,this.fiberId=o,this.lookup=n,this.timeToLive=s,this[VA]=VF,this.cacheState=BF()}get(t){return _(this.getEither(t),yc)}cacheStats(){return g(()=>JF({hits:this.cacheState.hits,misses:this.cacheState.misses,size:Wc(this.cacheState.map)}))}getOption(t){return T(()=>Pe(xe(this.cacheState.map,t),{onNone:()=>{let r=ai(t);return this.trackAccess(r),this.trackMiss(),m(x())},onSome:r=>this.resolveMapValue(r)}))}getOptionComplete(t){return T(()=>Pe(xe(this.cacheState.map,t),{onNone:()=>{let r=ai(t);return this.trackAccess(r),this.trackMiss(),m(x())},onSome:r=>this.resolveMapValue(r,!0)}))}contains(t){return g(()=>tr(this.cacheState.map,t))}entryStats(t){return g(()=>{let r=xe(this.cacheState.map,t);if(N(r))switch(r.value._tag){case"Complete":{let o=r.value.entryStats.loadedMillis;return d(ll(o))}case"Pending":return x();case"Refreshing":{let o=r.value.complete.entryStats.loadedMillis;return d(ll(o))}}return x()})}getEither(t){return T(()=>{let r=t,o,n,s=Ue(xe(this.cacheState.map,r));return s===void 0&&(n=oh(this.fiberId),o=ai(r),tr(this.cacheState.map,r)?s=Ue(xe(this.cacheState.map,r)):it(this.cacheState.map,r,$A(o,n))),s===void 0?(this.trackAccess(o),this.trackMiss(),_(this.lookupValueOf(t,n),P)):l(this.resolveMapValue(s),Pe({onNone:()=>this.getEither(t),onSome:i=>m(q(i))}))})}invalidate(t){return g(()=>{rn(this.cacheState.map,t)})}invalidateWhen(t,r){return g(()=>{let o=xe(this.cacheState.map,t);N(o)&&o.value._tag==="Complete"&&o.value.exit._tag==="Success"&&r(o.value.exit.value)&&rn(this.cacheState.map,t)})}invalidateAll(){return g(()=>{this.cacheState.map=tn()})}refresh(t){return Ur(r=>T(()=>{let o=t,n=oh(this.fiberId),s=Ue(xe(this.cacheState.map,o));if(s===void 0&&(tr(this.cacheState.map,o)?s=Ue(xe(this.cacheState.map,o)):it(this.cacheState.map,o,$A(ai(o),n))),s===void 0)return Q(this.lookupValueOf(t,n));switch(s._tag){case"Complete":{if(this.hasExpired(r,s.timeToLiveMillis)){let i=Ue(xe(this.cacheState.map,o));return O(i,s)&&rn(this.cacheState.map,o),Q(this.get(t))}return Q(ju(()=>{let i=Ue(xe(this.cacheState.map,o));if(O(i,s)){let c=WF(n,s);return it(this.cacheState.map,o,c),!0}return!1})(this.lookupValueOf(t,n)))}case"Pending":return vn(s.deferred);case"Refreshing":return vn(s.deferred)}}))}set(t,r){return Ur(o=>g(()=>{let n=o.unsafeCurrentTimeMillis(),s=t,i=WS(r),c=GA(ai(s),i,ll(n),n+Er(We(this.timeToLive(i))));it(this.cacheState.map,s,c)}))}size(){return g(()=>Wc(this.cacheState.map))}values(){return g(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[1].exit.value);return t})}entries(){return g(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push([r[0],r[1].exit.value]);return t})}keys(){return g(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[0]);return t})}resolveMapValue(t,r=!1){return Ur(o=>{switch(t._tag){case"Complete":return this.trackAccess(t.key),this.trackHit(),this.hasExpired(o,t.timeToLiveMillis)?(rn(this.cacheState.map,t.key.current),m(x())):_(t.exit,d);case"Pending":return this.trackAccess(t.key),this.trackHit(),r?m(x()):_(vn(t.deferred),d);case"Refreshing":return this.trackAccess(t.complete.key),this.trackHit(),this.hasExpired(o,t.complete.timeToLiveMillis)?r?m(x()):_(vn(t.deferred),d):_(t.complete.exit,d)}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(t){if(Uy(this.cacheState.accesses,t),Uc(this.cacheState.updating,!1,!0)){let r=!0;for(;r;){let n=Wy(this.cacheState.accesses,Hf);n===Hf?r=!1:this.cacheState.keys.add(n)}let o=Wc(this.cacheState.map);for(r=o>this.capacity;r;){let n=this.cacheState.keys.remove();n!==void 0?tr(this.cacheState.map,n.current)&&(rn(this.cacheState.map,n.current),o=o-1,r=o>this.capacity):r=!1}Ht(this.cacheState.updating,!1)}}hasExpired(t,r){return t.unsafeCurrentTimeMillis()>r}lookupValueOf(t,r){return Ur(o=>T(()=>{let n=t;return Do(()=>W(HS(r),g(()=>{rn(this.cacheState.map,n)})))(l(s=>{let i=o.unsafeCurrentTimeMillis(),c=ll(i),p=GA(ai(n),s,c,i+Er(We(this.timeToLive(s))));return it(this.cacheState.map,n,p),W(LS(r,s),s)})(Z(Ot(this.context)(this.lookup(t)))))}))}};VA=$F;var JA=(e,t,r)=>new nx(e,Dt(),Zc,t,o=>We(r(o)));var YF="@effect/io/Schedule/Interval",sx=Symbol.for(YF),YA={[sx]:sx,startMillis:0,endMillis:0};var QA=YA;var ZA=e=>$(()=>QA)(on(e.intervals)).startMillis;var XA=ZA;var tP="Done";var eM=e=>e._tag===tP;var tM=eM;var nP,rM,sP="@effect/io/Schedule",iP=Symbol.for(sP),aP="@effect/io/Schedule/Driver",cP=Symbol.for(aP);var pP={_Env:e=>e,_In:e=>e,_Out:e=>e};nP=iP;var ix=class{constructor(t,r){this.schedule=t,this.ref=r,this[rM]=pP}state(){return _(lr(this.ref),t=>t[1])}last(){return l(lr(this.ref),([t,r])=>{switch(t._tag){case"None":return ar(()=>so());case"Some":return m(t.value)}})}reset(){return qr(this.ref,[x(),this.schedule.initial])}next(t){return l(r=>l(o=>l(([n,s,i])=>tM(i)?W(L(x()))(qr(this.ref,[d(s),n])):V(s)(W(Ys(os(XA(i.intervals)-o)))(qr(this.ref,[d(s),n]))))(T(()=>this.schedule.step(o,t,r))))(Ru))(_(lr(this.ref),r=>r[1]))}};rM=cP;var ax=e=>_(t=>new ix(e,t))(wn([x(),e.initial]));var oM=a(2,(e,t)=>cx(e,t,(r,o)=>L(r))),cx=a(3,(e,t,r)=>l(ax(t),o=>ie(e,{onFailure:n=>r(n,x()),onSuccess:n=>nM(e,o,r,n)}))),nM=(e,t,r,o)=>ie(t.next(o),{onFailure:()=>_n(t.last()),onSuccess:n=>ie(e,{onFailure:s=>r(s,d(n)),onSuccess:s=>nM(e,t,r,s)})}),sM=a(2,(e,t)=>La(e,r=>g(()=>t(r)))),La=a(2,(e,t)=>l(e,r=>l(t(r),o=>o?m(r):l(Rt(),()=>La(e,t))))),iM=a(2,(e,t)=>px(e,r=>g(()=>t(r)))),px=a(2,(e,t)=>La(e,r=>xa(t(r)))),aM=a(2,(e,t)=>ux(e,t,(r,o)=>L(r))),cM=a(2,(e,t)=>pM(e,t)),pM=(e,t)=>pt(e,r=>t<0?L(r):l(Rt(),()=>pM(e,t-1))),ux=a(3,(e,t,r)=>l(ax(t),o=>uM(e,o,r))),uM=(e,t,r)=>pt(e,o=>ie(t.next(o),{onFailure:()=>l(n=>r(o,n))(_n(t.last())),onSuccess:()=>uM(e,t,r)})),lM=a(2,(e,t)=>Ha(e,r=>g(()=>t(r)))),Ha=a(2,(e,t)=>pt(e,r=>l(t(r),o=>o?L(r):l(Rt(),()=>Ha(e,t))))),fM=a(2,(e,t)=>lx(e,r=>g(()=>t(r)))),lx=a(2,(e,t)=>Ha(e,r=>xa(t(r)))),fl=a(2,(e,t)=>fx(e,void 0,t)),fx=a(3,(e,t,r)=>l(ax(r),o=>mM(e,t,o))),mM=(e,t,r)=>ie(r.next(t),{onFailure:()=>_n(r.last()),onSuccess:()=>l(e,o=>mM(e,o,r))});var dM,gM,yM,hx=class{constructor(t){this.permits=t,this.waiters=new Array,this.taken=0,this.take=r=>Ir(o=>{if(this.free<r){let n=()=>{if(this.free>=r){let s=this.waiters.findIndex(i=>i===n);s!==-1&&this.waiters.splice(s,1),this.taken+=r,o(m(r))}};return this.waiters.push(n),q(g(()=>{let s=this.waiters.findIndex(i=>i===n);s!==-1&&this.waiters.splice(s,1)}))}return this.taken+=r,P(m(r))}),this.release=r=>pe(o=>(this.taken-=r,o.getFiberRef(lo).scheduleTask(()=>{this.waiters.forEach(n=>n())},o.getFiberRef(Yi)),k)),this.withPermits=r=>o=>ge(n=>l(n(this.take(r)),s=>Wr(n(o),this.release(s))))}get free(){return this.permits-this.taken}},hl=e=>new hx(e),bM=e=>g(()=>hl(e)),SM=e=>dl(e,jA),EM=a(2,(e,t)=>_(xx(e,t),r=>r[0])),xx=a(2,(e,t)=>{let r=We(t);return l(Fr(),o=>_(xl(x()),n=>[Ot(uP(e,r,n),o),lP(n)]))}),xM=(e,t,r)=>{let o=Er(We(t));return _(n=>d([r+o,n]))(Ct(n=>Nr(e,n))(et()))},uP=(e,t,r)=>ge(o=>l(n=>j(n)?Is("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/io/issues"):o(Me(n.value[1])))(l(n=>xP(r,s=>{switch(s._tag){case"None":return d(xM(e,t,n));case"Some":{let[i]=s.value;return i-n<=0?d(xM(e,t,n)):x()}}}))(Ur(n=>n.currentTimeMillis)))),lP=e=>qr(e,x()),_M=a(2,(e,t)=>dl(e,r=>t(il(r)))),dl=a(2,(e,t)=>l(rA,r=>Wr(l(r.value(),t))(bx(e,r)))),OM=a(e=>Ft(e[0]),(e,t)=>t?.discard?lt(e,At):_(De(e,At),il)),gx=a(2,(e,t)=>ge(r=>l(t.fork(ti),o=>Ct(n=>o.addFinalizer(()=>zt(s=>O(s,n.id())?k:Q(Lo(n)))))(Un(cr(n=>o.close(n))(r(e))))))),yx=e=>zo(t=>gx(e,t)),CM=e=>Hn(e),RM=e=>T(()=>l(e,Hn)),mx=Symbol.for("@effect/io/Effect/memoizeFunction.key"),ml=class{constructor(t,r){this.a=t,this.eq=r,this[dM]=mx}[(dM=mx,M)](t){return typeof t=="object"&&t!==null&&mx in t?this.eq?this.eq(this.a,t.a):O(this.a,t.a):!1}[A](){return this.eq?0:S(this.a)}},AM=(e,t)=>_(r=>o=>l(([n,s])=>V(s)(Nn(n)))(l(Me)(r.modifyEffect(n=>{let s=xe(new ml(o,t))(n);return j(s)?_(i=>[i,it(new ml(o,t),i)(n)])(Ct(i=>At(Nr(i)(Fn(e(o)))))(et())):m([s.value,n])}))))(l(xl)(g(()=>tn()))),MM=a(2,(e,t)=>(r=>ut(r))(al(Z(t))(Z(e)))),TM=a(2,(e,t)=>yx(fl(t)(e))),bx=a(2,(e,t)=>Le(ni,o=>o.zip(t))(e)),vM=a(2,(e,t)=>qa(e,{onTimeout:x,onSuccess:d,duration:t})),IM=a(2,(e,{duration:t,onTimeout:r})=>ut(qa(e,{onTimeout:()=>ar(r),onSuccess:m,duration:t}))),kM=a(2,(e,{duration:t,onTimeout:r})=>ut(qa(e,{onTimeout:()=>Pr(r),onSuccess:m,duration:t}))),qa=a(2,(e,{duration:t,onSuccess:r,onTimeout:o})=>zt(n=>ex(e,Ut(Ys(t)),{onSelfWin:(s,i)=>l(s.await(),c=>c._tag==="Success"?l(s.inheritAll(),()=>V(Kt(i,n),r(c.value))):l(Kt(i,n),()=>K(c.cause))),onOtherWin:(s,i)=>l(s.await(),c=>c._tag==="Success"?l(s.inheritAll(),()=>V(Kt(i,n),o())):l(Kt(i,n),()=>K(c.cause))),otherScope:Ln}))),fP="@effect/io/Ref/Synchronized",mP=Symbol.for(fP),hP={_A:e=>e},dx=class{constructor(t,r){this.ref=t,this.withLock=r,this[gM]=hP,this[yM]=Fh}modify(t){return this.modifyEffect(r=>m(t(r)))}modifyEffect(t){return this.withLock(l(([r,o])=>V(qr(this.ref,o),r))(l(lr(this.ref),t)))}pipe(){return E(this,arguments)}};gM=mP,yM=Fu;var xl=e=>g(()=>dP(e)),dP=e=>{let t=Pu(e),r=hl(1);return new dx(t,r.withPermits(1))},xP=a(2,(e,t)=>e.modifyEffect(r=>{let o=t(r);switch(o._tag){case"None":return m([r,r]);case"Some":return _(o.value,n=>[n,n])}}));var FM="Fresh",PM="FromEffect",NM="Scoped",DM="Suspend";var LM="ZipWithPar";var HM=Kt;var yl=e=>(t,r)=>{let o=tp(),n=t,s=Oh(e.fiberRefs,{fiberId:o,fiberRef:uo,value:e.context});r?.scheduler&&(s=Oh(s,{fiberId:o,fiberRef:lo,value:r.scheduler})),r?.updateRefs&&(s=r.updateRefs(s,o));let i=new wa(o,GE(s,o),e.runtimeFlags),c=i._supervisor;return c!==qn&&(c.onStart(e.context,n,x(),i),i.unsafeAddObserver(p=>c.onEnd(p,i))),Ln.add(e.runtimeFlags,i),i.start(n),i},Sx=e=>(t,r)=>{let o=yl(e)(t);return r&&o.unsafeAddObserver(n=>{r(n)}),(n,s)=>Sx(e)(HM(n??Ze)(o),s?i=>s(US(i)):void 0)},bP=e=>t=>{let r=zM(e)(t);if(r._tag==="Failure")throw WM(r.i0);return r.i0},SP=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new Error;Error.stackTraceLimit=t;let o=`Fiber #${e.id().id} cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work`,n="AsyncFiberException";return Object.defineProperties(r,{_tag:{value:n},message:{value:o},name:{value:n},toString:{get(){return()=>o}},[UM]:{get(){return()=>o}}}),r};var qM=Symbol.for("@effect/io/Runtime/FiberFailure"),EP=Symbol.for("@effect/io/Runtime/FiberFailure/Cause"),UM=Symbol.for("nodejs.util.inspect.custom"),WM=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new Error;Error.stackTraceLimit=t;let o=pp(e);return o.length>0&&(r.name=o[0].message.split(":")[0],r.message=o[0].message.substring(r.name.length+2),r.stack=`${r.name}: ${r.message}
${o[0].stack}`),r[qM]=qM,r[EP]=e,r.toString=()=>io(e),r[UM]=()=>r.toString(),r};var jM=e=>{let t=e;switch(t._tag){case"Failure":case"Success":return t;case"Left":return pr(t.left);case"Right":return X(t.right);case"Some":return X(t.value);case"None":return pr(so())}},zM=e=>t=>{let r=jM(t);if(r)return r;let o=new Rp,n=yl(e)(t,{scheduler:o});o.flush();let s=n.unsafePoll();if(s)return s;throw SP(n)},_P=e=>t=>KM(e)(t).then(r=>{switch(r._tag){case le:return r.i0;case ue:throw WM(r.i0)}}),KM=e=>t=>new Promise(r=>{let o=jM(t);o&&r(o),yl(e)(t).unsafeAddObserver(n=>{r(n)})}),gl=class{constructor(t,r,o){this.context=t,this.runtimeFlags=r,this.fiberRefs=o}pipe(){return E(this,arguments)}},OP=e=>new gl(e.context,e.flags,e.fiberRefs),Ex=()=>pe((e,t)=>m(new gl(e.getFiberRef(uo),t.runtimeFlags,e.unsafeGetFiberRefs()))),CP=dp(ir,hp,mp),mr=OP({context:Dt(),flags:CP,fiberRefs:JE(new Map)}),BM=Sx(mr),GM=yl(mr),$M=_P(mr),VM=KM(mr),JM=bP(mr),YM=zM(mr),QM=e=>l(et(),t=>l(Ex(),r=>ge(o=>W(At(o(kr(e(n=>Sx(r)(Nr(n,t))),n=>Tn(t,n)))),o(Me(t))))));var ZM=a(2,(e,t)=>e.modifyEffect(t));var MP="@effect/io/Layer",TP=Symbol.for(MP),vP={_RIn:e=>e,_E:e=>e,_ROut:e=>e},bl={[TP]:vP,pipe(){return E(this,arguments)}};var IP=e=>e._tag===FM,_x=class{constructor(t){this.ref=t}getOrElseMemoize(t,r){return ut(ZM(this.ref,o=>{let n=o.get(t);if(n!==void 0){let[s,i]=n,c=cr(Yp({onFailure:()=>k,onSuccess:()=>Ls(r,i)}))(l(([p,u])=>V(u)(Nn(p)))(s));return m([c,o])}return l(s=>l(i=>_(c=>{let p=ge(f=>l(h=>l(y=>{switch(y._tag){case ue:return W(D(y.i0))(W(Ho(h,y))(Tn(i,y.i0)));case le:return V(y.i0[1])(W(Ws(i,y.i0))(W(Ls(r,b=>l(C=>C(b))(lr(c))))(W(la(s,b=>b+1))(qr(c,b=>Q(Ps(Nu(s,C=>[C===1,C-1]))(Ho(h,b))))))))}})(Z(f(l(eT(t,h),y=>Fn(y(this)))))))(Wn())),u=[cr(Mn({onFailure:()=>k,onSuccess:()=>la(s,f=>f+1)}))(Me(i)),f=>l(h=>h(f))(lr(c))];return[p,IP(t)?o:o.set(t,u)]})(wn(()=>k)))(et()))(wn(0))}))}},kP=()=>_(xl(new Map),e=>new _x(e));var XM=a(2,(e,t)=>l(kP(),r=>l(eT(e,t),o=>o(r)))),eT=(e,t)=>{let r=e;switch(r._tag){case"Locally":return g(()=>o=>r.f(o.getOrElseMemoize(r.self,t)));case"ExtendScope":return g(()=>o=>zo(n=>o.getOrElseMemoize(r.layer,n)));case"Fold":return g(()=>o=>J({onFailure:n=>o.getOrElseMemoize(r.failureK(n),t),onSuccess:n=>o.getOrElseMemoize(r.successK(n),t)})(o.getOrElseMemoize(r.layer,t)));case"Fresh":return g(()=>o=>XM(t)(r.layer));case"FromEffect":return g(()=>o=>r.effect);case"ProvideTo":return g(()=>o=>l(n=>Ot(n)(o.getOrElseMemoize(r.second,t)))(o.getOrElseMemoize(r.first,t)));case"Scoped":return g(()=>o=>jn(r.effect,t));case"Suspend":return g(()=>o=>o.getOrElseMemoize(r.evaluate(),t));case"ZipWith":return g(()=>o=>po(o.getOrElseMemoize(r.second,t),r.zipK)(o.getOrElseMemoize(r.first,t)));case"ZipWithPar":return g(()=>o=>go(o.getOrElseMemoize(r.second,t),r.zipK,{concurrent:!0})(o.getOrElseMemoize(r.first,t)))}};var wP=()=>FP(Fr());function FP(e){let t=Object.create(bl);return t._tag=PM,t.effect=e,t}var PP=a(2,(e,t)=>LP(e,t,(r,o)=>rs(o)(r)));var Mt=e=>NP(V(Dt())(e)),NP=e=>{let t=Object.create(bl);return t._tag=NM,t.effect=e,t};var DP=e=>{let t=Object.create(bl);return t._tag=DM,t.evaluate=e,t};var LP=a(3,(e,t,r)=>DP(()=>{let o=Object.create(bl);return o._tag=LM,o.first=e,o.second=t,o.zipK=r,o})),Ox=a(2,(e,t)=>Wt(Wn(),r=>l(XM(t,r),o=>Ot(e,o)),(r,o)=>Ho(r,o))),tT=a(2,(e,t)=>Ox(e,PP(wP(),t)));var oT=e=>Mt(nl(e)),nT=e=>Mt(ul(e)),sT=(e,t)=>Mt(cl(e,t)),iT=e=>Mt(pl(e));var Cx=gn;var ci=he(JA(65536,()=>_(et(),e=>({listeners:new Ma,handle:e})),()=>ff(60))),Ua=z(Symbol.for("@effect/io/FiberRef/currentCacheEnabled"),()=>he(!1)),Rx=(e,t)=>l(me(t)?t:m(t),r=>zt(o=>{let n=new Proxy(e,{});return ye(Ua,s=>{if(s)return ye(ci,c=>l(c.getEither(n),p=>{switch(p._tag){case"Left":return p.left.listeners.increment(),fe(Yb,l(Z(Me(p.left.handle)),u=>u._tag==="Failure"&&ko(u.cause)?(p.left.listeners.decrement(),l(c.invalidateWhen(n,f=>f.handle===p.left.handle),()=>Rx(n,t))):Wr(Me(p.left.handle),g(()=>p.left.listeners.decrement()))));case"Right":return p.right.listeners.increment(),fe(km(r,wm({request:n,result:p.right.handle,listeners:p.right.listeners,ownerId:o,state:{completed:!1}})),ge(u=>l(Z(u(Me(p.right.handle))),f=>(p.right.listeners.decrement(),f))))}}));let i=new Ma;return i.increment(),l(et(),c=>fe(km(r,wm({request:n,result:c,listeners:i,ownerId:o,state:{completed:!1}})),Wr(Me(c),g(()=>i.decrement()))))})})),aT=(e,t)=>ye(Ua,r=>r?ye(ci,o=>l(o.getEither(e),n=>{switch(n._tag){case"Left":return k;case"Right":return th(n.right.handle,t)}})):k),cT=a(2,(e,t)=>be(e,Ua,t)),pT=a(2,(e,t)=>be(e,ci,t));var WP=vs,jP=me,zP=EM,KP=xx,BP=qh,GP=AM,$P=Uh,VP=ii,JP=_A,YP=OA,QP=U_,ZP=W_,XP=Y_,e0=bA,t0=EA,r0=G_,o0=V_,Wa=Vt,n0=eO,s0=Bd,i0=Gd,a0=MO,c0=vA,p0=TO,u0=vO,l0=zd,f0=CA,m0=LO,h0=HO,d0=MA,x0=DA,g0=jt,y0=QM,b0=C_,S0=Ir,E0=L,_0=ar,O0=D,C0=Pr,R0=Hm,A0=Is,M0=Fo,T0=X_,v0=Rn,I0=bO,k0=CO,w0=m,F0=Qs,P0=jh,pi=T,N0=g,ft=k,D0=Rt,L0=R_;var H0=pt,q0=kr,U0=A_,W0=dS,j0=M_,z0=T_,K0=v_,B0=I_,G0=k_,$0=Nh,V0=tO,J0=rO,Y0=OO,Q0=FO,Z0=aM,X0=cM,eN=ux,tN=lM,rN=Ha,oN=fM,nN=lx,sN=ma;var iN=GO,aN=$O,cN=$h,pN=YO,uN=P_,lN=xS,fN=zA,mN=wp,hN=Fp,dN=Ut,xN=gS,gN=Do,yN=vr,bN=ge,SN=V,EN=Hu,_N=O_,ON=Q,CN=No,RN=J_,Tx=_,AN=gO,MN=Pp,TN=co,vN=Js,IN=yO,kN=xa,wN=Pa,FN=gA,uT=Wt,PN=Na,NN=Wr,DN=Np,LN=cr,HN=IA,qN=kA,UN=sl,WN=zo,jN=$d,zN=FA,KN=HA,BN=SM,GN=yA,$N=N_,VN=qu,JN=Fn,YN=_M,QN=dl,ZN=Po,XN=zt,eD=At,tD=Un,rD=OM,oD=gx,nD=yx,sD=RA,iD=CM,aD=RM,cD=bx,pD=Lp,uD=SS,lD=e=>Mt(Jt(lo,e)),fD=TS,mD=MS,hD=Ym,dD=w_,xD=Ur,gD=e=>Mt(fr(tt,Ie(Lr,e))),yD=LA,bD=DE,SD=F_,ED=Ys,_D=zO,OD=Gh,CD=vM,RD=IM,AD=kM,MD=qa,TD=HE,vD=yh,ID=oT,kD=LE,wD=nl,FD=Fr,lT=j_,PD=ks,ND=On,DD=Ot,fT=bS,LD=a(2,(e,t)=>{let r=Cx(mr.runtimeFlags,t.runtimeFlags),o=Cx(t.runtimeFlags,mr.runtimeFlags),n=ei(mr.fiberRefs,t.fiberRefs),s=ei(t.fiberRefs,mr.fiberRefs);return uT(l(Mx(r),()=>Ax(n)),()=>fT(e,t.context),()=>l(Mx(o),()=>Ax(s)))}),HD=Ox,qD=RO,UD=Wh,WD=tT,jD=rC,zD=tC,KD=Vh,BD=Jh,GD=oC,$D=e=>lT(t=>jg(t,e)),VD=QO,JD=D_,YD=L_,QD=H_,ZD=q_;var Ko=wr,XD=Z,eL=Nr,tL=SO,rL=NO,oL=PA,nL=kp;var sL=z_,iL=K_,aL=ha,cL=B_,pL=VO,uL=JO,lL=ju,fL=Ps,mL=ZO,hL=XO,Tt=l,dL=ut,xL=TA,gL=al,yL=MM,bL=Xd,SL=Uu,EL=Ct,_L=qO,OL=UO,CL=Bh,RL=WO,AL=jO,ML=Z_,TL=Lh,vL=hO,IL=oM,kL=kO,wL=cx,FL=sM,PL=La,NL=iM,DL=px,LL=fl,HL=TM,qL=fx,UL=Cn,WL=Dh,jL=oO,zL=be,KL=Le,BL=Jt,GL=fr,Ax=Nn,$L=PO,VL=Wu,JL=nO,YL=sO,QL=da,ZL=Ji,XL=J,e2=ie,t2=iO,r2=aO,o2=Hh,n2=cO,s2=pO,i2=uO,a2=lO,c2=fO,p2=__,u2=mO,l2=vS,f2=e=>Mt(Jt(Xi,e)),m2=_n,h2=qm,d2=En,x2=EO,g2=_O,y2=AO,b2=Ou,S2=Ex,E2=Dp,Mx=Fs,_2=_S,O2=Qd,C2=DO,R2=zh,A2=Kh,M2=wA,T2=Vd,v2=Jd,I2=IS,k2=eC,w2=wo,F2=F,P2=hl,N2=bM,D2=GM,L2=BM,mT=$M,H2=VM,q2=JM,U2=YM,W2=NA,j2=Yd,z2=qA,K2=UA,B2=WA,G2=go,$2=fe,V2=Ip,J2=Tr,Y2=ws,Q2=Rx,Z2=aT,X2=ES,eH=e=>Mt(Jt(Zi,e)),tH=e=>Mt(Jt(Ua,e)),rH=e=>Mt(me(e)?l(e,t=>Jt(ci,t)):Jt(ci,e)),oH=cT,nH=pT,sH=iT,iH=BO,aH=Cu,cH=qE,pH=pl,uH=OS,lH=e=>Mt(Jt(ea,e)),fH=sC,mH=nC,hH=Qh,dH=Yh,xH=aC,gH=cC,yH=iC,bH=Zs,SH=nT,EH=sT,_H=Zh,OH=KA,CH=pC,RH=cl,AH=Xh,MH=ul,TH=uC,vH=lC;var mt={};sc(mt,{ConfigTypeId:()=>IH,all:()=>kH,array:()=>wH,boolean:()=>FH,chunk:()=>PH,date:()=>NH,fail:()=>DH,hashMap:()=>rq,hashSet:()=>QH,integer:()=>HH,isConfig:()=>UH,logLevel:()=>qH,map:()=>WH,mapAttempt:()=>jH,mapOrFail:()=>zH,nested:()=>KH,number:()=>LH,option:()=>$H,orElse:()=>BH,orElseIf:()=>GH,primitive:()=>VH,repeat:()=>JH,secret:()=>YH,string:()=>ZH,succeed:()=>XH,suspend:()=>eq,sync:()=>tq,unwrap:()=>oq,validate:()=>nq,withDefault:()=>sq,withDescription:()=>iq,zip:()=>aq,zipWith:()=>cq});var IH=yu,kH=hE,wH=rE,FH=tE,PH=bu,NH=oE,DH=nE,LH=sE,HH=iE,qH=aE,UH=uh,WH=xo,jH=cE,zH=Ks,KH=Gt,BH=uE,GH=Su,$H=lE,VH=qo,JH=gu,YH=fE,QH=mE,ZH=ph,XH=Bs,eq=sa,tq=xE,rq=gE,oq=lh,nq=yE,sq=bE,iq=SE,aq=EE,cq=ia;var Sl={};sc(Sl,{Class:()=>Bg,TaggedClass:()=>Zv,array:()=>Yv,case:()=>Qv,struct:()=>Zr,tagged:()=>Kg,taggedEnum:()=>Xv,tuple:()=>Jv,unsafeArray:()=>uf,unsafeStruct:()=>zg});var oe={};sc(oe,{Do:()=>JD,EffectTypeId:()=>WP,acquireRelease:()=>wN,acquireReleaseInterruptible:()=>FN,acquireUseRelease:()=>uT,addFinalizer:()=>PN,all:()=>VP,allSuccesses:()=>YP,allWith:()=>JP,allowInterrupt:()=>uN,annotateCurrentSpan:()=>mH,annotateLogs:()=>p2,annotateSpans:()=>fH,as:()=>SN,asSome:()=>EN,asSomeError:()=>_N,asUnit:()=>ON,async:()=>g0,asyncEffect:()=>y0,asyncEither:()=>S0,asyncOption:()=>b0,awaitAllChildren:()=>BN,bind:()=>YD,bindTo:()=>QD,blocked:()=>$2,cacheRequestResult:()=>Z2,cached:()=>BP,cachedFunction:()=>GP,cachedInvalidateWithTTL:()=>KP,cachedWithTTL:()=>zP,catch:()=>L0,catchAll:()=>H0,catchAllCause:()=>q0,catchAllDefect:()=>U0,catchSome:()=>W0,catchSomeCause:()=>j0,catchSomeDefect:()=>z0,catchTag:()=>K0,catchTags:()=>B0,cause:()=>G0,checkInterruptible:()=>lN,clock:()=>dD,clockWith:()=>xD,config:()=>TD,configProviderWith:()=>vD,context:()=>FD,contextWith:()=>lT,contextWithEffect:()=>PD,currentParentSpan:()=>dH,currentSpan:()=>hH,daemonChildren:()=>GN,delay:()=>SD,descriptor:()=>$N,descriptorWith:()=>VN,die:()=>R0,dieMessage:()=>A0,dieSync:()=>M0,diffFiberRefs:()=>JN,disconnect:()=>fN,dropUntil:()=>QP,dropWhile:()=>ZP,either:()=>Ko,ensuring:()=>NN,ensuringChild:()=>YN,ensuringChildren:()=>QN,eventually:()=>$0,every:()=>XP,exists:()=>e0,exit:()=>XD,fail:()=>E0,failCause:()=>O0,failCauseSync:()=>C0,failSync:()=>_0,fiberId:()=>ZN,fiberIdWith:()=>XN,filter:()=>t0,filterOrDie:()=>sL,filterOrDieMessage:()=>iL,filterOrElse:()=>aL,filterOrFail:()=>cL,findFirst:()=>r0,firstSuccessOf:()=>o0,flatMap:()=>Tt,flatMapStep:()=>Y2,flatten:()=>dL,flip:()=>CN,flipWith:()=>RN,forEach:()=>Wa,forever:()=>ML,fork:()=>eD,forkAll:()=>rD,forkDaemon:()=>tD,forkIn:()=>oD,forkScoped:()=>nD,forkWithErrorHandler:()=>sD,fromFiber:()=>iD,fromFiberEffect:()=>aD,fromNullable:()=>TH,gen:()=>T0,getFiberRefs:()=>WL,head:()=>n0,if:()=>nL,ignore:()=>V0,ignoreLogged:()=>J0,inheritFiberRefs:()=>jL,interrupt:()=>mN,interruptWith:()=>hN,interruptible:()=>dN,interruptibleMask:()=>xN,intoDeferred:()=>eL,isEffect:()=>jP,isFailure:()=>JL,isSuccess:()=>YL,iterate:()=>TL,labelMetrics:()=>R2,labelMetricsScoped:()=>T2,labelMetricsScopedSet:()=>v2,labelMetricsSet:()=>A2,let:()=>ZD,linkSpans:()=>yH,locally:()=>zL,locallyScoped:()=>BL,locallyScopedWith:()=>GL,locallyWith:()=>KL,log:()=>t2,logAnnotations:()=>u2,logDebug:()=>o2,logError:()=>i2,logFatal:()=>a2,logInfo:()=>n2,logTrace:()=>r2,logWarning:()=>s2,loop:()=>vL,makeSemaphore:()=>N2,makeSpan:()=>bH,map:()=>Tx,mapAccum:()=>AN,mapBoth:()=>MN,mapError:()=>TN,mapErrorCause:()=>vN,mapInputContext:()=>ND,match:()=>QL,matchCause:()=>ZL,matchCauseEffect:()=>XL,matchEffect:()=>e2,merge:()=>IN,mergeAll:()=>s0,metricLabels:()=>I2,negate:()=>kN,never:()=>v0,none:()=>I0,onError:()=>DN,onExit:()=>LN,onInterrupt:()=>gN,once:()=>$P,option:()=>tL,optionFromOptional:()=>vH,orDie:()=>m2,orDieWith:()=>h2,orElse:()=>d2,orElseFail:()=>x2,orElseSucceed:()=>g2,parallelErrors:()=>Y0,parallelFinalizers:()=>HN,partition:()=>i0,patchFiberRefs:()=>Ax,promise:()=>k0,provideContext:()=>DD,provideLayer:()=>HD,provideService:()=>qD,provideServiceEffect:()=>UD,provideSomeContext:()=>fT,provideSomeLayer:()=>WD,provideSomeRuntime:()=>LD,race:()=>gL,raceAll:()=>xL,raceFirst:()=>yL,raceWith:()=>bL,random:()=>y2,randomWith:()=>b2,reduce:()=>a0,reduceEffect:()=>c0,reduceRight:()=>p0,reduceWhile:()=>u0,repeat:()=>IL,repeatN:()=>kL,repeatOrElse:()=>wL,repeatUntil:()=>FL,repeatUntilEffect:()=>PL,repeatWhile:()=>NL,repeatWhileEffect:()=>DL,replicate:()=>l0,replicateEffect:()=>f0,request:()=>Q2,retry:()=>Z0,retryN:()=>X0,retryOrElse:()=>eN,retryUntil:()=>tN,retryUntilEffect:()=>rN,retryWhile:()=>oN,retryWhileEffect:()=>nN,runCallback:()=>L2,runFork:()=>D2,runPromise:()=>mT,runPromiseExit:()=>H2,runRequestBlock:()=>V2,runSync:()=>q2,runSyncExit:()=>U2,runtime:()=>S2,runtimeFlags:()=>E2,sandbox:()=>Q0,schedule:()=>LL,scheduleForked:()=>HL,scheduleFrom:()=>qL,scope:()=>UN,scopeWith:()=>WN,scoped:()=>jN,sequentialFinalizers:()=>qN,serviceConstants:()=>BD,serviceFunction:()=>jD,serviceFunctionEffect:()=>zD,serviceFunctions:()=>KD,serviceMembers:()=>GD,serviceOption:()=>$D,setClock:()=>gD,setConfigProvider:()=>ID,setFiberRefs:()=>$L,setParentSpan:()=>SH,setRequestBatching:()=>eH,setRequestCache:()=>rH,setRequestCaching:()=>tH,setScheduler:()=>lD,setSpan:()=>EH,setTracer:()=>sH,setTracerTiming:()=>lH,setUnhandledErrorLogLevel:()=>f2,sleep:()=>ED,some:()=>rL,spanAnnotations:()=>xH,spanLinks:()=>gH,step:()=>J2,succeed:()=>w0,succeedNone:()=>F0,succeedSome:()=>P0,summarized:()=>SL,supervised:()=>cD,suspend:()=>pi,sync:()=>N0,tagMetrics:()=>C2,tagMetricsScoped:()=>M2,takeUntil:()=>m0,takeWhile:()=>h0,tap:()=>EL,tapBoth:()=>_L,tapDefect:()=>OL,tapError:()=>CL,tapErrorCause:()=>AL,tapErrorTag:()=>RL,timed:()=>_D,timedWith:()=>OD,timeout:()=>CD,timeoutFail:()=>RD,timeoutFailCause:()=>AD,timeoutTo:()=>MD,tracer:()=>iH,tracerWith:()=>aH,transplant:()=>pD,try:()=>sN,tryMap:()=>iN,tryMapPromise:()=>aN,tryPromise:()=>cN,unified:()=>F2,unifiedFn:()=>w2,uninterruptible:()=>yN,uninterruptibleMask:()=>bN,unit:()=>ft,unless:()=>pL,unlessEffect:()=>uL,unsafeMakeSemaphore:()=>P2,unsandbox:()=>pN,unsome:()=>oL,updateFiberRefs:()=>VL,updateRuntimeFlags:()=>Mx,updateService:()=>VD,useSpan:()=>_H,useSpanScoped:()=>OH,using:()=>zN,validate:()=>W2,validateAll:()=>d0,validateFirst:()=>x0,validateWith:()=>j2,when:()=>lL,whenEffect:()=>fL,whenFiberRef:()=>mL,whenRef:()=>hL,whileLoop:()=>UL,withClock:()=>bD,withClockScoped:()=>yD,withConcurrency:()=>uD,withConfigProvider:()=>kD,withConfigProviderScoped:()=>wD,withEarlyRelease:()=>KN,withLogSpan:()=>c2,withMaxFiberOps:()=>fD,withMetric:()=>k2,withParentSpan:()=>AH,withParentSpanScoped:()=>MH,withRequestBatching:()=>X2,withRequestCache:()=>nH,withRequestCaching:()=>oH,withRuntimeFlags:()=>_2,withRuntimeFlagsScoped:()=>O2,withScheduler:()=>mD,withSchedulingPriority:()=>hD,withSpan:()=>CH,withSpanScoped:()=>RH,withTracer:()=>cH,withTracerScoped:()=>pH,withTracerTiming:()=>uH,withUnhandledErrorLogLevel:()=>l2,yieldNow:()=>D0,zip:()=>z2,zipLeft:()=>K2,zipRight:()=>B2,zipWith:()=>G2});var za={};sc(za,{SafeRefinementId:()=>Eq,any:()=>Aq,bigint:()=>kq,boolean:()=>Tq,date:()=>wq,defined:()=>Mq,discriminator:()=>dT,discriminators:()=>kx,discriminatorsExhaustive:()=>xT,either:()=>El,exhaustive:()=>bT,instanceOf:()=>gT,instanceOfUnsafe:()=>Pq,is:()=>Oq,nonEmptyString:()=>_q,not:()=>Sq,null:()=>Iq,number:()=>Rq,option:()=>Dq,orElse:()=>yT,orElseAbsurd:()=>Nq,record:()=>Fq,string:()=>Cq,tag:()=>yq,tags:()=>bq,tagsExhaustive:()=>wx,type:()=>lq,typeTags:()=>hq,undefined:()=>vq,value:()=>fq,valueTags:()=>mq,when:()=>dq,whenAnd:()=>gq,whenOr:()=>xq});var ja=class e{constructor(t){this.cases=t,this._tag="TypeMatcher",this._input=F,this._filters=F,this._remaining=F,this._result=F}add(t){return new e([...this.cases,t])}pipe(){return E(this,arguments)}},vx=class e{constructor(t,r){this.provided=t,this.value=r,this._tag="ValueMatcher",this._input=F,this._filters=F,this._result=F}add(t){return this.value._tag==="Right"?this:t._tag==="When"&&t.guard(this.provided)===!0?new e(this.provided,P(t.evaluate(this.provided))):t._tag==="Not"&&t.guard(this.provided)===!1?new e(this.provided,P(t.evaluate(this.provided))):this}pipe(){return E(this,arguments)}},zn=class{constructor(t,r){this.guard=t,this.evaluate=r,this._tag="When"}},Ix=class{constructor(t,r){this.guard=t,this.evaluate=r,this._tag="Not"}},ui=e=>{if(typeof e=="function")return e;if(Array.isArray(e)){let t=e.map(ui),r=t.length;return o=>{if(!Array.isArray(o))return!1;for(let n=0;n<r;n++)if(t[n](o[n])===!1)return!1;return!0}}else if(e!==null&&typeof e=="object"){let t=Object.entries(e).map(([o,n])=>[o,ui(n)]),r=t.length;return o=>{if(typeof o!="object"||o===null)return!1;for(let n=0;n<r;n++){let[s,i]=t[n];if(!(s in o)||i(o[s])===!1)return!1}return!0}}return t=>t===e},pq=e=>{let t=e.map(ui),r=t.length;return o=>{for(let n=0;n<r;n++)if(t[n](o)===!0)return!0;return!1}},uq=e=>{let t=e.map(ui),r=t.length;return o=>{for(let n=0;n<r;n++)if(t[n](o)===!1)return!1;return!0}},lq=()=>new ja([]),fq=e=>new vx(e,q(e)),mq=e=>{let t=wx(e)(new ja([]));return r=>t(r)},hq=()=>e=>{let t=wx(e)(new ja([]));return r=>t(r)},dq=(e,t)=>r=>r.add(new zn(ui(e),t)),xq=(...e)=>t=>{let r=e[e.length-1],o=e.slice(0,-1);return t.add(new zn(pq(o),r))},gq=(...e)=>t=>{let r=e[e.length-1],o=e.slice(0,-1);return t.add(new zn(uq(o),r))},dT=e=>(...t)=>{let r=t[t.length-1],o=t.slice(0,-1),n=o.length===1?s=>s[e]===o[0]:s=>o.includes(s[e]);return s=>s.add(new zn(n,r))},kx=e=>t=>{let r=[];for(let n in t){let s=c=>c[e]===n,i=t[n];i&&r.push(new zn(s,i))}let o=r.length;return n=>{let s=n;for(let i=0;i<o;i++)s=s.add(r[i]);return s}},xT=e=>t=>{let r=kx(e)(t);return o=>bT(r(o))},yq=dT("_tag"),bq=kx("_tag"),wx=xT("_tag"),Sq=(e,t)=>r=>r.add(new Ix(ui(e),t)),Eq=Symbol.for("@effect/match/SafeRefinementId"),_q=e=>typeof e=="string"&&e.length>0,Oq=(...e)=>{let t=e.length;return r=>{for(let o=0;o<t;o++)if(r===e[o])return!0;return!1}},Cq=yi,Rq=Go,Aq=()=>!0,Mq=e=>e!=null,Tq=pc,vq=bi;var Iq=ag;var kq=Yn,wq=uc,Fq=Si,gT=e=>t=>t instanceof e,Pq=gT,yT=e=>t=>{let r=El(t);return xc(r)?r._tag==="Right"?r.right:e(r.left):o=>{let n=r(o);return n._tag==="Right"?n.right:e(n.left)}},Nq=e=>yT(()=>{throw new Error("absurd")})(e),El=e=>{if(e._tag==="ValueMatcher")return e.value;let t=e.cases.length;return r=>{for(let o=0;o<t;o++){let n=e.cases[o];if(n._tag==="When"&&n.guard(r)===!0)return P(n.evaluate(r));if(n._tag==="Not"&&n.guard(r)===!1)return P(n.evaluate(r))}return q(r)}},Dq=e=>{let t=El(e);return xc(t)?gc(t,{onLeft:()=>x(),onRight:d}):r=>gc(t(r),{onLeft:()=>x(),onRight:o=>d(o)})},bT=e=>{let t=El(e);if(xc(t)){if(t._tag==="Right")return t.right;throw new Error("@effect/match: exhaustive absurd")}return r=>{let o=t(r);if(o._tag==="Right")return o.right;throw new Error("@effect/match: exhaustive absurd")}};var _l="@effect/schema/ArbitraryHookId",Fx="@effect/schema/PrettyHookId",Px=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return Px(e,t.from)}},Ka=e=>Object.keys(e).concat(Object.getOwnPropertySymbols(e)),Ol=e=>{let t=!1,r;return()=>(t||(r=e(),t=!0),r)};var Nx=e=>({_tag:"ParseError",errors:e}),hr=(e,t,r)=>({_tag:"Type",expected:e,actual:t,message:Pt(r)}),ET={_tag:"Forbidden"},yo=(e,t)=>({_tag:"Index",index:e,errors:t}),jr=(e,t)=>({_tag:"Key",key:e,errors:t}),Cl={_tag:"Missing"},Dx=e=>({_tag:"Unexpected",actual:e}),Lx=e=>({_tag:"UnionMember",errors:e}),Ve=P,Yt=e=>q(Nx([e])),He=e=>q(Nx(e)),zr=e=>{let t=e;if(t._tag==="Left"||t._tag==="Right")return t},li=(e,t)=>{let r=e;return r._tag==="Left"?r:r._tag==="Right"?t(r.right):Tt(e,t)},_T=(e,t)=>{let r=e;return r._tag==="Left"?r:r._tag==="Right"?P(t(r.right)):Tx(e,t)};var Ux="@effect/schema/TypeAnnotationId",Al="@effect/schema/MessageAnnotationId",fi="@effect/schema/IdentifierAnnotationId",rt="@effect/schema/TitleAnnotationId",Bo="@effect/schema/DescriptionAnnotationId",RT="@effect/schema/ExamplesAnnotationId",AT="@effect/schema/JSONSchemaAnnotationId",MT="@effect/schema/DocumentationAnnotationId",$a=e=>t=>Object.prototype.hasOwnProperty.call(t.annotations,e)?d(t.annotations[e]):x(),mi=(e,t,r,o={})=>({_tag:"Declaration",typeParameters:e,type:t,decode:r,annotations:o});var TT=e=>({_tag:"Literal",literal:e,annotations:{}}),Kn=e=>e._tag==="Literal";var Lq=e=>e._tag==="UniqueSymbol",Hq={_tag:"UndefinedKeyword",annotations:{[rt]:"undefined"}};var qq={_tag:"VoidKeyword",annotations:{[rt]:"void"}};var Va={_tag:"NeverKeyword",annotations:{[rt]:"never"}};var hi={_tag:"UnknownKeyword",annotations:{[rt]:"unknown"}},Uq=e=>e._tag==="UnknownKeyword",vT={_tag:"AnyKeyword",annotations:{[rt]:"any"}},Wq=e=>e._tag==="AnyKeyword",Ml={_tag:"StringKeyword",annotations:{[rt]:"string"}},Ga=e=>e._tag==="StringKeyword",IT={_tag:"NumberKeyword",annotations:{[rt]:"number"}},Rl=e=>e._tag==="NumberKeyword",jq={_tag:"BooleanKeyword",annotations:{[rt]:"boolean"}},OT=e=>e._tag==="BooleanKeyword",zq={_tag:"BigIntKeyword",annotations:{[rt]:"bigint"}},CT=e=>e._tag==="BigIntKeyword",Wx={_tag:"SymbolKeyword",annotations:{[rt]:"symbol"}},qx=e=>e._tag==="SymbolKeyword",Kq={_tag:"ObjectKeyword",annotations:{[rt]:"object"}};var Ja=(e,t)=>({type:e,isOptional:t}),Bn=(e,t,r,o={})=>({_tag:"Tuple",elements:e,rest:t,isReadonly:r,annotations:o});var Fe=(e,t,r,o,n={})=>({name:e,type:t,isOptional:r,isReadonly:o,annotations:n}),kT=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return kT(e.from);default:return!1}},di=(e,t,r)=>{if(kT(e))return{parameter:e,type:t,isReadonly:r};throw new Error("An index signature parameter type must be 'string', 'symbol', a template literal type or a refinement of the previous types")},bo=(e,t,r={})=>{let o={};for(let s=0;s<e.length;s++){let i=e[s].name;if(Object.prototype.hasOwnProperty.call(o,i))throw new Error(`Duplicate property signature ${String(i)}`);o[i]=null}let n={string:!1,symbol:!1};for(let s=0;s<t.length;s++){let i=vl(t[s].parameter);if(Ga(i)){if(n.string)throw new Error("Duplicate index signature for type `string`");n.string=!0}else if(qx(i)){if(n.symbol)throw new Error("Duplicate index signature for type `symbol`");n.symbol=!0}}return{_tag:"TypeLiteral",propertySignatures:Bq(e),indexSignatures:t,annotations:r}};var So=(e,t={})=>{let r=Jq(e);switch(r.length){case 0:return Va;case 1:return r[0];default:return{_tag:"Union",types:Vq(r),annotations:t}}};var Ya=(e,t={})=>({_tag:"Lazy",f:Ol(e),annotations:t});var Qa=(e,t,r,o={})=>({_tag:"Refinement",from:e,decode:t,isReversed:r,annotations:o}),wT=e=>e._tag==="Refinement",Za=(e,t,r,o)=>({from:e,to:t,decode:r,encode:o}),Tl=(e,t,r,o,n,s={})=>({_tag:"Transform",from:e,to:t,decode:r,encode:o,propertySignatureTransformations:n,annotations:s}),FT=(e,t,r,o,n={})=>Tl(e,t,r,o,[],n),PT=(e,t,r,o={})=>Tl(e,t,n=>{for(let s=0;s<r.length;s++){let i=r[s],c=i.from,p=Object.prototype.hasOwnProperty.call(n,c)?d(n[c]):x();delete n[c];let u=i.decode(p);N(u)&&(n[i.to]=u.value)}return Ve(n)},n=>{for(let s=0;s<r.length;s++){let i=r[s],c=i.to,p=Object.prototype.hasOwnProperty.call(n,c)?d(n[c]):x();delete n[c];let u=i.encode(p);N(u)&&(n[i.from]=u.value)}return Ve(n)},r,o);var NT=(e,t,r)=>({...e,annotations:{...e.annotations,[t]:r}});var DT=e=>e.map(t=>Fe(t.name,we(t.type),t.isOptional,t.isReadonly,t.annotations)),LT=e=>e.map(t=>di(t.parameter,we(t.type),t.isReadonly)),we=e=>{switch(e._tag){case"Declaration":return mi(e.typeParameters.map(we),we(e.type),e.decode,e.annotations);case"Tuple":return Bn(e.elements.map(t=>Ja(we(t.type),t.isOptional)),Re(e.rest,ts(we)),e.isReadonly,e.annotations);case"TypeLiteral":return bo(DT(e.propertySignatures),LT(e.indexSignatures),e.annotations);case"Union":return So(e.types.map(we),e.annotations);case"Lazy":return Ya(()=>we(e.f()),e.annotations);case"Refinement":return Qa(we(e.from),e.decode,!1,e.annotations);case"Transform":return we(e.to)}return e},Qt=e=>{switch(e._tag){case"Declaration":return mi(e.typeParameters.map(Qt),Qt(e.type),e.decode,e.annotations);case"Tuple":return Bn(e.elements.map(t=>Ja(Qt(t.type),t.isOptional)),Re(e.rest,ts(Qt)),e.isReadonly);case"TypeLiteral":return bo(e.propertySignatures.map(t=>Fe(t.name,Qt(t.type),t.isOptional,t.isReadonly)),e.indexSignatures.map(t=>di(t.parameter,Qt(t.type),t.isReadonly)));case"Union":return So(e.types.map(Qt));case"Lazy":return Ya(()=>Qt(e.f()));case"Refinement":case"Transform":return Qt(e.from)}return e},HT=e=>{switch(e._tag){case"Declaration":return HT(e.type);case"NeverKeyword":return 0;case"Literal":case"UndefinedKeyword":case"VoidKeyword":case"UniqueSymbol":return 1;case"BooleanKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3;case"ObjectKeyword":return 5;case"UnknownKeyword":case"AnyKeyword":return 6;default:return 4}},Bq=Vo(ne(xt,gi(e=>HT(e.type)))),qT=ng(xt,xt,xt),Gq=ql(qT),UT=[0,0,0],$q=e=>e.reduce(Gq,UT),Ba=e=>{switch(e._tag){case"Tuple":{let t=e.elements.length,r=N(e.rest)?e.rest.value.length:0;return[2,t,r]}case"TypeLiteral":{let t=e.propertySignatures.length,r=e.indexSignatures.length;return t+r===0?[-4,0,0]:[4,t,r]}case"Declaration":{let[t,r,o]=Ba(e.type);return[6,r,o]}case"Lazy":return[8,0,0];case"Union":return $q(e.types.map(Ba));case"Refinement":{let[t,r,o]=Ba(e.from);return[t+1,r,o]}case"Transform":return Ba(e.from);case"ObjectKeyword":return[-2,0,0];case"UnknownKeyword":case"AnyKeyword":return[-4,0,0];default:return UT}},Vq=Vo(og(gi(qT,Ba))),Jq=e=>{let t=ne(e,_c(o=>{switch(o._tag){case"NeverKeyword":return[];case"Union":return o.types;default:return[o]}}));if(t.some(Wq))return[vT];if(t.some(Uq))return[hi];let r;return(r=t.findIndex(Ga))!==-1&&(t=t.filter((o,n)=>n===r||!Ga(o)&&!(Kn(o)&&typeof o.literal=="string"))),(r=t.findIndex(Rl))!==-1&&(t=t.filter((o,n)=>n===r||!Rl(o)&&!(Kn(o)&&typeof o.literal=="number"))),(r=t.findIndex(OT))!==-1&&(t=t.filter((o,n)=>n===r||!OT(o)&&!(Kn(o)&&typeof o.literal=="boolean"))),(r=t.findIndex(CT))!==-1&&(t=t.filter((o,n)=>n===r||!CT(o)&&!(Kn(o)&&typeof o.literal=="bigint"))),(r=t.findIndex(qx))!==-1&&(t=t.filter((o,n)=>n===r||!qx(o)&&!Lq(o))),t},vl=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return vl(e.from)}};var Kr=(e,t=[])=>({value:e,forest:t}),WT=e=>Yq(Kr("error(s) found",e.map(kl))),Yq=e=>e.value+jT(`
`,e.forest),jT=(e,t)=>{let r="",o=t.length,n;for(let s=0;s<o;s++){n=t[s];let i=s===o-1;r+=e+(i?"\u2514":"\u251C")+"\u2500 "+n.value,r+=jT(e+(o>1&&!i?"\u2502  ":"   "),n.forest)}return r},Xa=e=>{if(e==null||typeof e=="number"||typeof e=="symbol"||e instanceof Date)return String(e);if(typeof e=="bigint")return String(e)+"n";try{return JSON.stringify(e)}catch{return String(e)}},Qq=e=>{switch(e.type._tag){case"StringKeyword":return"${string}";case"NumberKeyword":return"${number}"}},Zq=e=>e.head+e.spans.map(t=>Qq(t)+t.literal).join(""),Xq=$a(Al),eU=$a(rt),tU=$a(fi),rU=$a(Bo),dr=e=>ne(tU(e),Xn(()=>eU(e)),Xn(()=>rU(e))),Il=e=>{switch(e._tag){case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"UndefinedKeyword":case"SymbolKeyword":case"ObjectKeyword":case"AnyKeyword":case"UnknownKeyword":case"VoidKeyword":case"NeverKeyword":return $(dr(e),()=>e._tag);case"Literal":return $(dr(e),()=>Xa(e.literal));case"UniqueSymbol":return $(dr(e),()=>Xa(e.symbol));case"Union":return e.types.map(Il).join(" or ");case"TemplateLiteral":return $(dr(e),()=>Zq(e));case"Tuple":return $(dr(e),()=>"<anonymous tuple or array schema>");case"TypeLiteral":return $(dr(e),()=>"<anonymous type literal schema>");case"Enums":return $(dr(e),()=>e.enums.map((t,r)=>JSON.stringify(r)).join(" | "));case"Lazy":return $(dr(e),()=>"<anonymous lazy schema>");case"Declaration":return $(dr(e),()=>"<anonymous declaration schema>");case"Refinement":return $(dr(e),()=>"<anonymous refinement schema>");case"Transform":return $(dr(e),()=>`${Il(e.from)} -> ${Il(e.to)}`)}},kl=e=>{switch(e._tag){case"Type":return Kr(ne(Xq(e.expected),Re(t=>t(e.actual)),Xn(()=>e.message),$(()=>`Expected ${Il(e.expected)}, actual ${Xa(e.actual)}`)));case"Forbidden":return Kr("is forbidden");case"Index":{let t=e.errors.map(kl);return t.length===1&&t[0].forest.length!==0?Kr(`[${e.index}]${t[0].value}`,t[0].forest):Kr(`[${e.index}]`,t)}case"Unexpected":return Kr("is unexpected");case"Key":{let t=e.errors.map(kl);return t.length===1&&t[0].forest.length!==0?Kr(`[${Xa(e.key)}]${t[0].value}`,t[0].forest):Kr(`[${Xa(e.key)}]`,t)}case"Missing":return Kr("is missing");case"UnionMember":return Kr("union member",e.errors.map(kl))}};var KT=e=>{let t=ot(e);return(r,o)=>t(r,{...o,isEffectAllowed:!0})};var Kx=e=>ot(e.ast);var Bx=e=>KT(e.ast);var Gx=e=>KT(xr(e.ast)),ot=(e,t=!0)=>{switch(e._tag){case"Refinement":if(e.isReversed){let r=ot(we(e),t),o=ot(xr(BT(e.from)),!1);return(n,s)=>ec(li(r(n,s),i=>o(i,s)),s)}else{let r=ot(e.from,t);return(o,n)=>ec(li(r(o,n),s=>e.decode(s,n)),n)}case"Transform":{let r=ot(e.to,!1);if(t){let o=ot(e.from);return(n,s)=>ec(li(o(n,s),i=>li(e.decode(i,s),c=>r(c,s))),s)}else return(o,n)=>ec(li(e.decode(o,n),s=>r(s,n)),n)}case"Declaration":{let r=e.decode(...e.typeParameters);return(o,n)=>ec(r(o,n),n)}case"Literal":return ht(e,r=>r===e.literal);case"UniqueSymbol":return ht(e,r=>r===e.symbol);case"UndefinedKeyword":return ht(e,bi);case"VoidKeyword":return ht(e,bi);case"NeverKeyword":return ht(e,cg);case"UnknownKeyword":case"AnyKeyword":return Ve;case"StringKeyword":return ht(e,yi);case"NumberKeyword":return ht(e,Go);case"BooleanKeyword":return ht(e,pc);case"BigIntKeyword":return ht(e,Yn);case"SymbolKeyword":return ht(e,sg);case"ObjectKeyword":return ht(e,ce);case"Enums":return ht(e,r=>e.enums.some(([o,n])=>n===r));case"TemplateLiteral":{let r=sU(e);return ht(e,o=>yi(o)&&r.test(o))}case"Tuple":{let r=e.elements.map(s=>ot(s.type,t)),o=ne(e.rest,Re(ts(s=>ot(s)))),n=e.elements.filter(s=>!s.isOptional).length;return N(e.rest)&&(n+=e.rest.value.length-1),(s,i)=>{if(!Array.isArray(s))return Yt(hr(nU,s));let c=i?.errors==="all",p=[],u=0,f=s.length;for(let R=f;R<=n-1;R++){let v=yo(R,[Cl]);if(c){p.push([u++,v]);continue}else return Yt(v)}if(j(e.rest))for(let R=e.elements.length;R<=f-1;R++){let v=yo(R,[Dx(s[R])]);if(c){p.push([u++,v]);continue}else return He(vt(qe(p),v))}let h=[],y=0,b;for(;y<r.length;y++)if(f<y+1){if(e.elements[y].isOptional)continue}else{let R=r[y],v=R(s[y],i),w=zr(v);if(w){if(Ce(w)){let H=yo(y,w.left.errors);if(c){p.push([u++,H]);continue}else return He(vt(qe(p),H))}h.push([u++,w.right])}else{let H=u++,U=y;b||(b=[]),b.push(({es:te,output:de})=>Tt(Ko(v),Te=>{if(Ce(Te)){let ae=yo(U,Te.left.errors);return c?(te.push([H,ae]),ft):He(vt(qe(te),ae))}return de.push([H,Te.right]),ft}))}}if(N(o)){let R=Se(o.value),v=Nt(o.value);for(;y<f-v.length;y++){let w=R(s[y],i),H=zr(w);if(H)if(Ce(H)){let U=yo(y,H.left.errors);if(c){p.push([u++,U]);continue}else return He(vt(qe(p),U))}else h.push([u++,H.right]);else{let U=u++,te=y;b||(b=[]),b.push(({es:de,output:Te})=>Tt(Ko(w),ae=>{if(Ce(ae)){let gr=yo(te,ae.left.errors);return c?(de.push([U,gr]),ft):He(vt(qe(de),gr))}else return Te.push([U,ae.right]),ft}))}}for(let w=0;w<v.length;w++)if(y+=w,!(f<y+1)){let H=v[w](s[y],i),U=zr(H);if(U){if(Ce(U)){let te=yo(y,U.left.errors);if(c){p.push([u++,te]);continue}else return He(vt(qe(p),te))}h.push([u++,U.right])}else{let te=u++,de=y;b||(b=[]),b.push(({es:Te,output:ae})=>Tt(Ko(H),gr=>{if(Ce(gr)){let Br=yo(de,gr.left.errors);return c?(Te.push([te,Br]),ft):He(vt(qe(Te),Br))}return ae.push([te,gr.right]),ft}))}}}let C=({es:R,output:v})=>Sc(R)?He(qe(R)):Ve(qe(v));if(b&&b.length>0){let R=b;return pi(()=>{let v={es:Array.from(p),output:Array.from(h)};return Tt(Wa(R,w=>w(v),{concurrency:"unbounded",discard:!0}),()=>C(v))})}return C({output:h,es:p})}}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return ht(e,pg);let r=e.propertySignatures.map(i=>ot(i.type,t)),o=e.indexSignatures.map(i=>[ot(i.parameter,t),ot(i.type,t)]),n=ot(So(e.indexSignatures.map(i=>vl(i.parameter)))),s={};for(let i=0;i<r.length;i++)s[e.propertySignatures[i].name]=null;return(i,c)=>{if(!Si(i))return Yt(hr(zT,i));let p=c?.errors==="all",u=[],f=0;if(c?.onExcessProperty==="error"){for(let R of Ka(i))if(!Object.prototype.hasOwnProperty.call(s,R)){let v=n(R),w=zr(v);if(w&&Ce(w)){let H=jr(R,[Dx(i[R])]);if(p){u.push([f++,H]);continue}else return He(vt(qe(u),H))}}}let y={},b;for(let R=0;R<r.length;R++){let v=e.propertySignatures[R],w=r[R],H=v.name;if(Object.prototype.hasOwnProperty.call(i,H)){let U=w(i[H],c),te=zr(U);if(te){if(Ce(te)){let de=jr(H,te.left.errors);if(p){u.push([f++,de]);continue}else return He(vt(qe(u),de))}y[H]=te.right}else{let de=f++,Te=H;b||(b=[]),b.push(({es:ae,output:gr})=>Tt(Ko(U),Br=>{if(Ce(Br)){let oc=jr(Te,Br.left.errors);return p?(ae.push([de,oc]),ft):He(vt(qe(ae),oc))}return gr[Te]=Br.right,ft}))}}else if(!v.isOptional){let U=jr(H,[Cl]);if(p){u.push([f++,U]);continue}else return Yt(U)}}for(let R=0;R<o.length;R++){let v=o[R][0],w=o[R][1],H=Px(i,e.indexSignatures[R].parameter);for(let U of H){if(Object.prototype.hasOwnProperty.call(s,U))continue;let te=zr(v(U,c));if(te&&Ce(te)){let ae=jr(U,te.left.errors);if(p){u.push([f++,ae]);continue}else return He(vt(qe(u),ae))}let de=w(i[U],c),Te=zr(de);if(Te)if(Ce(Te)){let ae=jr(U,Te.left.errors);if(p){u.push([f++,ae]);continue}else return He(vt(qe(u),ae))}else y[U]=Te.right;else{let ae=f++,gr=U;b||(b=[]),b.push(({es:Br,output:oc})=>Tt(Ko(de),Dl=>{if(Ce(Dl)){let Qx=jr(gr,Dl.left.errors);return p?(Br.push([ae,Qx]),ft):He(vt(qe(Br),Qx))}else return oc[U]=Dl.right,ft}))}}}let C=({es:R,output:v})=>Sc(R)?He(qe(R)):Ve(v);if(b&&b.length>0){let R=b;return pi(()=>{let v={es:Array.from(u),output:Object.assign({},y)};return Tt(Wa(R,w=>w(v),{concurrency:"unbounded",discard:!0}),()=>C(v))})}return C({es:u,output:y})}}case"Union":{let r=oU(e.types),o=Ka(r.keys),n=o.length,s=new Map;for(let i=0;i<e.types.length;i++)s.set(e.types[i],ot(e.types[i],!0));return(i,c)=>{let p=[],u=0,f=[];if(n>0)if(Si(i))for(let b=0;b<n;b++){let C=o[b],R=r.keys[C].buckets;if(Object.prototype.hasOwnProperty.call(i,C)){let v=String(i[C]);Object.prototype.hasOwnProperty.call(R,v)?f=f.concat(R[v]):p.push([u++,jr(C,[hr(r.keys[C].ast,i[C])])])}else p.push([u++,jr(C,[Cl])])}else p.push([u++,hr(zT,i)]);r.otherwise.length>0&&(f=f.concat(r.otherwise));let h;for(let b=0;b<f.length;b++){let C=s.get(f[b])(i,c),R=!h||h.length===0?zr(C):void 0;if(R){if(br(R))return Ve(R.right);p.push([u++,Lx(R.left.errors)])}else{let v=u++;h||(h=[]),h.push(w=>pi(()=>"finalResult"in w?ft:Tt(Ko(C),H=>(br(H)?w.finalResult=Ve(H.right):w.es.push([v,Lx(H.left.errors)]),ft))))}}let y=b=>Sc(b)?He(qe(b)):Yt(hr(Va,i));if(h&&h.length>0){let b=h;return pi(()=>{let C={es:Array.from(p)};return Tt(Wa(b,R=>R(C),{concurrency:1,discard:!0}),()=>"finalResult"in C?C.finalResult:y(C.es))})}return y(p)}}case"Lazy":{let r=Ol(()=>ot(e.f(),t));return(o,n)=>r()(o,n)}}},ht=(e,t)=>r=>t(r)?Ve(r):Yt(hr(e,r)),zx=e=>{switch(e._tag){case"Declaration":return zx(e.type);case"TypeLiteral":{let t=[];for(let r=0;r<e.propertySignatures.length;r++){let o=e.propertySignatures[r],n=Qt(o.type);Kn(n)&&!o.isOptional&&t.push([o.name,n])}return t}case"Refinement":case"Transform":return zx(e.from)}return[]},oU=e=>{let t={},r=[];for(let o=0;o<e.length;o++){let n=e[o],s=zx(n);if(s.length>0)for(let i=0;i<s.length;i++){let[c,p]=s[i],u=String(p.literal);t[c]=t[c]||{buckets:{},ast:Va};let f=t[c].buckets;if(Object.prototype.hasOwnProperty.call(f,u)){if(i<s.length-1)continue;f[u].push(n),t[c].ast=So([t[c].ast,p])}else{f[u]=[n],t[c].ast=So([t[c].ast,p]);break}}else r.push(n)}return{keys:t,otherwise:r}},BT=e=>wT(e)?BT(e.from):e,ec=(e,t)=>{let r=zr(e);return r||(t?.isEffectAllowed===!0?e:Yt(ET))},nU=Bn([],d([hi]),!0,{[Bo]:"a generic array"}),zT=bo([],[di(Ml,hi,!0),di(Wx,hi,!0)],{[Bo]:"a generic object"}),vt=(e,t)=>(e.push(t),e),sU=e=>{let t=`^${e.head}`;for(let r of e.spans)Ga(r.type)?t+=".*":Rl(r.type)&&(t+="-?\\d+(\\.\\d+)?"),t+=r.literal;return t+="$",new RegExp(t)};function qe(e){return e.sort(([t],[r])=>t>r?1:t<r?-1:0).map(([t,r])=>r)}var xr=e=>{switch(e._tag){case"Declaration":return mi(e.typeParameters.map(xr),e.type,e.decode,e.annotations);case"Tuple":return Bn(e.elements.map(t=>Ja(xr(t.type),t.isOptional)),Re(e.rest,ts(xr)),e.isReadonly);case"TypeLiteral":return bo(e.propertySignatures.map(t=>Fe(t.name,xr(t.type),t.isOptional,t.isReadonly,t.annotations)),e.indexSignatures.map(t=>di(t.parameter,xr(t.type),t.isReadonly)));case"Union":return So(e.types.map(xr));case"Lazy":return Ya(()=>xr(e.f()));case"Refinement":return Qa(e.from,e.decode,!e.isReversed,e.annotations);case"Transform":return Tl(xr(e.to),xr(e.from),e.encode,e.decode,e.propertySignatureTransformations.map(t=>Za(t.to,t.from,t.encode,t.decode)))}return e};var lU=Symbol.for("@effect/schema/Schema");var $x=class{constructor(t){kt(this,"ast");kt(this,"_id",lU);kt(this,"From");kt(this,"To");this.ast=t}pipe(){return E(this,arguments)}},It=e=>new $x(e);var fU=e=>It(TT(e)),wl=(...e)=>Pl(...e.map(t=>fU(t)));var GT=(e,t,r,o)=>It(mi(e.map(n=>n.ast),t.ast,(...n)=>r(...n.map(It)),o)),Pl=(...e)=>It(So(e.map(t=>t.ast)));var Vx=e=>It(Bn([],d([e.ast]),!0));var Fl=class e{constructor(t,r,o){kt(this,"_from");kt(this,"_annotations");kt(this,"_optional");kt(this,"From");kt(this,"FromIsOptional");kt(this,"To");kt(this,"ToIsOptional");this._from=t,this._annotations=r,this._optional=o}optional(){if(this._optional)throw new Error("duplicate optional configuration");return new e(this._from,this._annotations,{to:"optional"})}withDefault(t){if(this._optional&&this._optional.to!=="optional")throw new Error("duplicate optional configuration");return new e(this._from,this._annotations,{to:"default",value:t})}toOption(){if(this._optional&&this._optional.to!=="optional")throw new Error("duplicate optional configuration");return new e(this._from,this._annotations,{to:"Option"})}},mU=(e,t)=>new Fl(e.ast,t),$n=(e,t)=>mU(e,t).optional(),Gn=e=>{let t=Ka(e),r=[],o=[],n=[],s=[];for(let i=0;i<t.length;i++){let c=t[i],p=e[c];if(p instanceof Fl){let u=p._optional;if(u)switch(u.to){case"optional":{r.push(Fe(c,p._from,!0,!0,p._annotations)),o.push(Fe(c,p._from,!0,!0)),n.push(Fe(c,we(p._from),!0,!0,p._annotations));break}case"default":{o.push(Fe(c,p._from,!0,!0)),n.push(Fe(c,we(p._from),!1,!0,p._annotations)),s.push(Za(c,c,Xn(()=>d(u.value())),F));break}case"Option":{o.push(Fe(c,p._from,!0,!0)),n.push(Fe(c,CU(It(we(p._from))).ast,!1,!0,p._annotations)),s.push(Za(c,c,d,Rg));break}}else r.push(Fe(c,p._from,!1,!0,p._annotations)),o.push(Fe(c,p._from,!1,!0)),n.push(Fe(c,we(p._from),!1,!0,p._annotations))}else r.push(Fe(c,p.ast,!1,!0)),o.push(Fe(c,p.ast,!1,!0)),n.push(Fe(c,we(p.ast),!1,!0))}return s.length>0?It(PT(bo(o,[]),bo(n,[]),s)):It(bo(r,[]))};var hU=e=>{let t={};if(e?.typeId!==void 0){let r=e?.typeId;typeof r=="object"?(t[Ux]=r.id,t[r.id]=r.params):t[Ux]=r}return e?.message!==void 0&&(t[Al]=e?.message),e?.identifier!==void 0&&(t[fi]=e?.identifier),e?.title!==void 0&&(t[rt]=e?.title),e?.description!==void 0&&(t[Bo]=e?.description),e?.examples!==void 0&&(t[RT]=e?.examples),e?.documentation!==void 0&&(t[MT]=e?.documentation),e?.jsonSchema!==void 0&&(t[AT]=e?.jsonSchema),e?.arbitrary!==void 0&&(t[_l]=e?.arbitrary),t};function $T(e,t){return r=>{let o=s=>e(s)?Ve(s):Yt(hr(n,s)),n=Qa(r.ast,o,!1,hU(t));return It(n)}}var dU=a(4,(e,t,r,o)=>It(FT(e.ast,t.ast,r,o)));var tc=e=>t=>It(NT(t.ast,Bo,e));var Vn=It(Ml),Jx=It(IT);var xU=()=>e=>e.date(),gU=()=>e=>`new Date(${JSON.stringify(e)})`,VT=GT([],Gn({}),()=>e=>uc(e)?Ve(e):Yt(hr(VT.ast,e)),{[fi]:"Date",[Fx]:gU,[_l]:xU}),yU="@effect/schema/ValidDateTypeId",bU=e=>t=>t.pipe($T(r=>!isNaN(r.getTime()),{typeId:yU,description:"a valid Date",...e})),SU=VT.pipe(bU()),Yx=e=>dU(e,SU,r=>Ve(new Date(r)),r=>Ve(r.toISOString()));var EU=e=>t=>t.oneof(t.constant(x()),e(t).map(d)),_U=e=>Pe({onNone:()=>"none()",onSome:t=>`some(${e(t)})`}),OU=e=>Pl(Gn({_tag:wl("None")}),Gn({_tag:wl("Some"),value:e})),CU=e=>{let t=GT([e],OU(e),r=>{let o=Kx(r);return(n,s)=>Og(n)?j(n)?Ve(x()):_T(o(n.value,s),d):Yt(hr(t.ast,n))},{[fi]:"Option",[Fx]:_U,[_l]:EU});return t};var RU="@effect/schema/MaxLengthTypeId",rc=(e,t)=>r=>r.pipe($T(o=>o.length<=e,{typeId:RU,description:`a string at most ${e} character(s) long`,jsonSchema:{maxLength:e},...t}));var YT=Zx(require("fs/promises")),QT=Zx(require("@actions/glob"));var Zt=class extends Sl.TaggedClass("GenericError"){};var MU=mt.string("INPUT_FILE").pipe(mt.map(e=>({_tag:"File",path:e})),mt.orElse(()=>mt.string("JSON").pipe(mt.map(e=>({_tag:"Json",stringified:e})))),mt.orElse(()=>ne(mt.all({key:mt.string("KEY"),value:mt.number("VALUE")}),mt.map(({key:e,value:t})=>({_tag:"KeyVal",key:e,value:t})))),mt.nested("INPUT")),ZT=ne(oe.config(MU),oe.mapError(e=>new Zt({error:e,message:"Failed to read input"}))),XT=e=>oe.try({try:()=>JSON.parse(e),catch:t=>new Zt({message:"Failed to parse JSON",error:t})}),ev=wl("lower-is-better","higher-is-better"),TU=Gn({key:ne(Vn,rc(120)),sortDate:ne(Vn,Yx,$n),value:Jx,units:ne(Vn,rc(32),$n),trend:ne(ev,$n)}),i3=Gn({metrics:ne(TU,Vx)}),JT=Gn({key:ne(Vn,rc(120),tc("a key to identify the metric across runs")),value:ne(Jx,tc("the value of the metric")),sortDate:ne(Vn,Yx,tc("the date to apply sorting by. defaults to the commit time"),$n),units:ne(Vn,rc(32),tc("the units of the metric. example: ms, MiB"),$n),trend:ne(ev,$n)}),tv=Pl(ne(JT,Vx),JT),a3=Gx(tv),rv=e=>Bx(tv)(e).pipe(oe.map(t=>[t].flat()),oe.mapError(t=>new Zt({error:t,message:`Failed to parse given JSON:
${WT(t.errors)}`}))),vU=e=>oe.tryPromise({try:()=>YT.default.readFile(e,"utf-8"),catch:t=>new Zt({message:"Failed to read file",error:t})}).pipe(oe.flatMap(XT),oe.flatMap(rv)),IU=e=>oe.gen(function*(t){let r=yield*t(oe.tryPromise({try:()=>QT.create(e),catch:s=>new Zt({message:"Failed to parse glob syntax",error:s})})),o=yield*t(oe.tryPromise({try:()=>r.glob(),catch:s=>new Zt({message:"Failed to iterate through glob",error:s})}));return(yield*t(oe.all(o.map(vU),{concurrency:5}))).flat()}),ov=ne(za.type(),za.tagsExhaustive({File:({path:e})=>IU(e),Json:({stringified:e})=>XT(e).pipe(oe.flatMap(rv)),KeyVal:({key:e,value:t})=>oe.succeed([{key:e,value:t}])}));var Nl=require("@actions/core"),sv=require("@actions/http-client");var nv=e=>e;var kU=oe.gen(function*(e){let t=yield*e(oe.tryPromise({try:()=>(0,Nl.getIDToken)(),catch:o=>new Zt({message:"Failed to get ID token, maybe you need to configure the permissions.",error:o})}));return new sv.HttpClient("bnz-action",[],{headers:{Authorization:`Bearer ${t}`}})}),wU=oe.gen(function*(e){let t=yield*e(ZT),r=yield*e(ov(t)),o=yield*e(kU),n=yield*e(oe.tryPromise({try:()=>o.postJson("https://bnz-web.vercel.app/api/metrics",{metrics:r}),catch:s=>new Zt({message:"Failed to send metrics",error:s})}));console.log("received",n)});wU.pipe(oe.catchTag("GenericError",e=>((0,Nl.error)(e.message),process.exitCode=1,oe.unit)),nv,oe.runPromise);
