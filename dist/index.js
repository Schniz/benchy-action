"use strict";var Uv=Object.create;var hc=Object.defineProperty;var Wv=Object.getOwnPropertyDescriptor;var jv=Object.getOwnPropertyNames;var zv=Object.getPrototypeOf,Kv=Object.prototype.hasOwnProperty;var Bv=(e,t,r)=>t in e?hc(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;var dc=(e,t)=>{for(var r in t)hc(e,r,{get:t[r],enumerable:!0})},Gv=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let n of jv(t))!Kv.call(e,n)&&n!==r&&hc(e,n,{get:()=>t[n],enumerable:!(o=Wv(t,n))||o.enumerable});return e};var Oi=(e,t,r)=>(r=e!=null?Uv(zv(e)):{},Gv(t||!e||!e.__esModule?hc(r,"default",{value:e,enumerable:!0}):r,e));var Ft=(e,t,r)=>(Bv(e,typeof t!="symbol"?t+"":t,r),r);var gg=e=>typeof e=="function",a=function(e,t){if(typeof e=="function")return function(){return e(arguments)?t.apply(this,arguments):r=>t(r,...arguments)};switch(e){case 0:return t;case 1:return function(r){return arguments.length>=1?t(r):function(){return t(r)}};case 2:return function(r,o){return arguments.length>=2?t(r,o):function(n){return t(n,r)}};case 3:return function(r,o,n){return arguments.length>=3?t(r,o,n):function(s){return t(s,r,o)}};case 4:return function(r,o,n,s){return arguments.length>=4?t(r,o,n,s):function(i){return t(i,r,o,n)}};case 5:return function(r,o,n,s,i){return arguments.length>=5?t(r,o,n,s,i):function(c){return t(c,r,o,n,s)}};default:return function(){if(arguments.length>=e)return t.apply(this,arguments);let r=arguments;return function(o){return t(o,...r)}}}};var F=e=>e;var Ci=e=>()=>e,_r=Ci(!0),Pt=Ci(!1);var xc=Ci(void 0),Xn=xc;function ne(e,t,r,o,n,s,i,c,p){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return r(t(e));case 4:return o(r(t(e)));case 5:return n(o(r(t(e))));case 6:return s(n(o(r(t(e)))));case 7:return i(s(n(o(r(t(e))))));case 8:return c(i(s(n(o(r(t(e)))))));case 9:return p(c(i(s(n(o(r(t(e))))))));default:{let u=arguments[0];for(let f=1;f<arguments.length;f++)u=arguments[f](u);return u}}}var gc=e=>(t,r)=>t===r||e(t,r);var yg=a(2,(e,t)=>gc((r,o)=>e(t(r),t(o))));var bg=e=>gc((t,r)=>{if(t.length!==r.length)return!1;for(let o=0;o<t.length;o++)if(!e(t[o],r[o]))return!1;return!0});var yc=e=>(t,r)=>t===r?0:e(t,r);var Sg=yc((e,t)=>e<t?-1:1);var Eg=e=>yc((t,r)=>e(r,t));var Ri=a(2,(e,t)=>yc((r,o)=>e(t(r),t(o))));var $v=e=>yc((t,r)=>{let o=Math.min(t.length,r.length),n=0;for(let s of e){if(n>=o)break;let i=s(t[n],r[n]);if(i!==0)return i;n++}return 0});var _g=(...e)=>$v(e);var Zl=e=>a(2,(t,r)=>e(t,r)===1);var Xl=e=>a(2,(t,r)=>t===r||e(t,r)>-1?t:r);var Ai=e=>typeof e=="string",Jo=e=>typeof e=="number",bc=e=>typeof e=="boolean",es=e=>typeof e=="bigint",Og=e=>typeof e=="symbol",Cg=gg,Mi=e=>e===void 0;var Rg=e=>e===null;var Ag=e=>!1;var pe=e=>typeof e=="object"&&e!=null||Cg(e);var Qo=e=>e==null,Mg=e=>e!=null;var Sc=e=>e instanceof Date,Nt=e=>pe(e)&&Symbol.iterator in e,Ti=e=>pe(e)&&!Array.isArray(e);var Tg=e=>!e;var Yv=335903614,Jv=4150755663,Qv=1481765933,Zv=1284865837,Xv=9007199254740992,eI=134217728,ts=class{constructor(t,r,o,n){return Qo(r)&&Qo(t)?(r=Math.random()*4294967295>>>0,t=0):Qo(r)&&(r=t,t=0),Qo(n)&&Qo(o)?(n=this._state?this._state[3]:Jv,o=this._state?this._state[2]:Yv):Qo(n)&&(n=o,o=0),this._state=new Int32Array([0,0,o>>>0,((n||0)|1)>>>0]),this._next(),vg(this._state,this._state[0],this._state[1],t>>>0,r>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){if(!t)return this._next();if(t=t>>>0,!(t&t-1))return this._next()&t-1;let r=0,o=(-t>>>0)%t>>>0;for(r=this._next();r<o;r=this._next());return r%t}number(){let t=(this._next()&67108863)*1,r=(this._next()&134217727)*1;return(t*eI+r)/Xv}_next(){let t=this._state[0]>>>0,r=this._state[1]>>>0;tI(this._state,t,r,Qv,Zv),vg(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let o=t>>>18,n=(r>>>18|t<<14)>>>0;o=(o^t)>>>0,n=(n^r)>>>0;let s=(n>>>27|o<<5)>>>0,i=t>>>27,c=(-i>>>0&31)>>>0;return(s>>>i|s<<c)>>>0}};function tI(e,t,r,o,n){let s=(r>>>16)*(n&65535)>>>0,i=(r&65535)*(n>>>16)>>>0,c=(r&65535)*(n&65535)>>>0,p=(r>>>16)*(n>>>16)+((i>>>16)+(s>>>16))>>>0;i=i<<16>>>0,c=c+i>>>0,c>>>0<i>>>0&&(p=p+1>>>0),s=s<<16>>>0,c=c+s>>>0,c>>>0<s>>>0&&(p=p+1>>>0),p=p+Math.imul(r,o)>>>0,p=p+Math.imul(t,n)>>>0,e[0]=p,e[1]=c}function vg(e,t,r,o,n){let s=t+o>>>0,i=r+n>>>0;i>>>0<r>>>0&&(s=s+1|0),e[0]=s,e[1]=i}var rf=Symbol.for("@effect/data/Global/globalStoreId");rf in globalThis||(globalThis[rf]=new Map);var tf=globalThis[rf],z=(e,t)=>(tf.has(e)||tf.set(e,t()),tf.get(e));var of=z(Symbol.for("@effect/data/Hash/randomHashCache"),()=>new WeakMap),nI=z(Symbol.for("@effect/data/Hash/pcgr"),()=>new ts),A=Symbol.for("@effect/data/Hash"),S=e=>{switch(typeof e){case"number":return _c(e);case"bigint":return ke(e.toString(10));case"boolean":return ke(String(e));case"symbol":return ke(String(e));case"string":return ke(e);case"undefined":return ke("undefined");case"function":case"object":return e===null?ke("null"):sI(e)?e[A]():Ro(e);default:throw new Error("Bug in Equal.hash")}},Ro=e=>(of.has(e)||of.set(e,_c(nI.integer(Number.MAX_SAFE_INTEGER))),of.get(e)),I=e=>t=>t*53^e,Ec=e=>e&3221225471|e>>>1&1073741824,sI=e=>typeof e=="object"&&e!==null&&A in e,_c=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return Ec(e)},ke=e=>{let t=5381,r=e.length;for(;r;)t=t*33^e.charCodeAt(--r);return Ec(t)},iI=(e,t)=>{let r=12289;for(let o=0;o<t.length;o++)r^=I(S(e[t[o]]))(ke(t[o]));return Ec(r)},Ii=e=>iI(e,Object.keys(e)),Qr=e=>{let t=6151;for(let r=0;r<e.length;r++)t=I(S(e[r]))(t);return Ec(t)};var M=Symbol.for("@effect/data/Equal");function O(){return arguments.length===1?e=>Ig(e,arguments[0]):Ig(arguments[0],arguments[1])}function Ig(e,t){if(e===t)return!0;let r=typeof e;return r!==typeof t?!1:(r==="object"||r==="function")&&e!==null&&t!==null&&rs(e)&&rs(t)?S(e)===S(t)&&e[M](t):!1}var rs=e=>typeof e=="object"&&e!==null&&M in e,Oc=()=>(e,t)=>S(e)===S(t)&&O(e,t);var Ao=Symbol.for("@effect/io/Effect"),Mo={_R:e=>e,_E:e=>e,_A:e=>e};var E=(e,t)=>{switch(t.length){case 1:return t[0](e);case 2:return t[1](t[0](e));case 3:return t[2](t[1](t[0](e)));case 4:return t[3](t[2](t[1](t[0](e))));case 5:return t[4](t[3](t[2](t[1](t[0](e)))));case 6:return t[5](t[4](t[3](t[2](t[1](t[0](e))))));case 7:return t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))));case 8:return t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e))))))));case 9:return t[8](t[7](t[6](t[5](t[4](t[3](t[2](t[1](t[0](e)))))))));default:{let r=e;for(let o=0,n=t.length;o<n;o++)r=t[o](r);return r}}};var kg,wg,Cc=Symbol.for("@effect/data/Option"),nf=class{[(kg=Ao,M)](t){return Fg(t)&&cf(t)&&O(t.i0,this.i0)}[A](){return S(this.i0)}toString(){return`Some(${String(this.i0)})`}toJSON(){return{_tag:this._tag,value:this.i0}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}get[Cc](){return{_A:t=>t}}get value(){return this.i0}constructor(t){this.i0=t,this._tag="Some",this._id=Cc,this.i1=void 0,this.i2=void 0,this[kg]=Mo}pipe(){return E(this,arguments)}},sf=class{constructor(){this._tag="None",this._id=Cc,this.i0=void 0,this.i1=void 0,this.i2=void 0,this[wg]=Mo}[(wg=Ao,M)](t){return Fg(t)&&af(t)}[A](){return S(this._tag)}toString(){return"None()"}toJSON(){return{_tag:this._tag}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}get[Cc](){return{_A:t=>t}}pipe(){return E(this,arguments)}},Fg=e=>typeof e=="object"&&e!=null&&"_tag"in e&&(e._tag==="None"||e._tag==="Some")&&rs(e),af=e=>e._tag==="None",cf=e=>e._tag==="Some",Pg=new sf,Ng=e=>new nf(e);var Dg,Lg,Rc=Symbol.for("@effect/data/Either"),pf=class{[(Dg=Ao,M)](t){return Hg(t)&&ff(t)&&O(t.i0,this.i0)}[A](){return S(this.i0)}get right(){return this.i0}constructor(t){this.i0=t,this._tag="Right",this._id=Rc,this.i1=void 0,this.i2=void 0,this[Dg]=Mo}get[Rc](){return{_E:t=>t,_A:t=>t}}toString(){return`right(${String(this.i0)})`}toJSON(){return{_tag:this._tag,right:this.i0}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},uf=class{[(Lg=Ao,M)](t){return Hg(t)&&lf(t)&&O(t.i0,this.i0)}[A](){return S(this.i0)}get[Rc](){return{_E:t=>t,_A:t=>t}}get left(){return this.i0}constructor(t){this.i0=t,this._tag="Left",this._id=Rc,this.i1=void 0,this.i2=void 0,this[Lg]=Mo}toString(){return`left(${String(this.i0)})`}toJSON(){return{_tag:this._tag,left:this.i0}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},Hg=e=>typeof e=="object"&&e!=null&&"_tag"in e&&(e._tag==="Left"||e._tag==="Right")&&rs(e),lf=e=>e._tag==="Left",ff=e=>e._tag==="Right",qg=e=>new uf(e),Ug=e=>new pf(e);var uI=Symbol.for("@effect/data/Either"),P=Ug,q=qg;var Ac=e=>pe(e)&&"_id"in e&&e._id===uI,Ae=lf,Or=ff;var Mc=a(2,(e,{onLeft:t,onRight:r})=>Ae(e)?t(e.left):r(e.right)),Tc=Mc({onLeft:F,onRight:F});var yt=Sg;var hI=Symbol.for("@effect/data/Option"),x=()=>Pg,d=Ng,Wg=e=>pe(e)&&"_id"in e&&e._id===hI,j=af,N=cf,De=a(2,(e,{onNone:t,onSome:r})=>j(e)?t():r(e.value));var $=a(2,(e,t)=>j(e)?t():e.value),os=a(2,(e,t)=>j(e)?t():e);var Dt=e=>e==null?x():d(e);var je=$(xc);var dI=a(2,(e,t)=>{if(N(e))return e.value;throw t()}),jg=dI(()=>new Error("getOrThrow called on a None")),Me=a(2,(e,t)=>j(e)?x():d(t(e.value)));var ns=a(2,(e,t)=>j(e)?x():t(e.value));var zg=ns(F);var xI=e=>a(2,(t,r)=>j(t)?!1:e(t.value,r)),gI=Oc(),Kg=xI(gI);var mf=e=>e.length>0;var hf=(e,t)=>{let r=Math.max(1,Math.floor(e)),o=[t(0)];for(let n=1;n<r;n++)o.push(t(n));return o};var J=e=>Array.isArray(e)?e:Array.from(e);var rr=a(2,(e,t)=>[t,...e]);var Bg=a(2,(e,t)=>[...e,t]);var bI=e=>e.length===0,df=bI,Ic=mf,Cr=mf;var Gg=(e,t)=>e<0||e>=t.length;var SI=a(2,(e,t)=>{let r=Math.floor(t);return Gg(r,e)?x():d(e[r])}),xf=a(2,(e,t)=>{let r=Math.floor(t);if(Gg(r,e))throw new Error(`Index ${r} out of bounds`);return e[r]});var kc=SI(0),_e=xf(0),$g=e=>Cr(e)?d(EI(e)):x(),EI=e=>e[e.length-1];var Lt=e=>e.slice(1);var gf=e=>Array.from(e).reverse();var Zo=a(2,(e,t)=>{let r=Array.from(e);return r.sort(t),r});var yf=a(2,(e,t)=>Vg(e,t,(r,o)=>[r,o])),Vg=a(3,(e,t,r)=>{let o=J(e),n=J(t);return Cr(o)&&Cr(n)?_I(n,r)(o):[]});var _I=a(3,(e,t,r)=>{let o=[r(_e(e),_e(t))],n=Math.min(e.length,t.length);for(let s=1;s<n;s++)o[s]=r(e[s],t[s]);return o});var OI=a(2,(e,t)=>{let r=[_e(e)],o=Lt(e);for(let n of o)r.every(s=>!t(n,s))&&r.push(n);return r});var Xo=()=>[],bt=e=>[e],Zr=a(2,(e,t)=>e.map(t)),ss=Zr,wc=a(2,(e,t)=>{if(df(e))return[];let r=[];for(let o=0;o<e.length;o++)r.push(...t(e[o],o));return r});var Fc=wc(F);var ki=a(2,(e,t)=>{let r=J(e),o=[];for(let n=0;n<r.length;n++){let s=t(r[n],n);N(s)&&o.push(s.value)}return o});var Yg=ki(F);var it=a(3,(e,t,r)=>J(e).reduce((o,n,s)=>r(o,n,s),t)),Pc=a(3,(e,t,r)=>J(e).reduceRight((o,n,s)=>r(o,n,s),t));var bf=(e,t)=>{let r=[],o=e,n;for(;N(n=t(o));){let[s,i]=n.value;r.push(s),o=i}return r};var Jg=bg;var CI=a(2,(e,t)=>{let r=J(e);return Cr(r)?OI(t)(r):[]}),Qg=CI(Oc());var Xr=a(2,(e,t)=>J(e).join(t));var Zg,Xg=Symbol.for("@effect/data/Context/Tag"),Nc=class{[(Zg=Ao,M)](t){return this===t}[A](){return Ro(this)}get[Xg](){return{_S:t=>t,_I:t=>t}}constructor(t){this._tag="Tag",this.i0=void 0,this.i1=void 0,this.i2=void 0,this[Zg]=Mo;let r=Error.stackTraceLimit;if(Error.stackTraceLimit=3,this.creationError=new Error,Error.stackTraceLimit=r,typeof t<"u")return this.i0=t,z(t,()=>this)}get stack(){return this.creationError.stack}toString(){return JSON.stringify(this)}toJSON(){return{_tag:"Tag",identifier:this.i0,stack:this.stack}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}of(t){return t}context(t){return Ef(this,t)}},Sf=Symbol.for("@effect/data/Context"),eo=class{[M](t){if(ey(t)&&this.unsafeMap.size===t.unsafeMap.size){for(let r of this.unsafeMap.keys())if(!t.unsafeMap.has(r)||!O(this.unsafeMap.get(r),t.unsafeMap.get(r)))return!1;return!0}return!1}[A](){return _c(this.unsafeMap.size)}constructor(t){this.unsafeMap=t,this._id=Sf,this._S=r=>r}pipe(){return E(this,arguments)}},RI=e=>{let t=new Error(`Service not found${e.i0?`: ${String(e.i0)}`:""}`);if(e.stack){let r=e.stack.split(`
`);if(r.length>2){let o=r[3].match(/at (.*)/);o&&(t.message=t.message+` (defined at ${o[1]})`)}}if(t.stack){let r=t.stack.split(`
`);r.splice(1,3),t.stack=r.join(`
`)}return t},ey=e=>typeof e=="object"&&e!==null&&"_id"in e&&e._id===Sf;var ty=()=>new eo(new Map),Ef=(e,t)=>new eo(new Map([[e,t]])),ry=a(3,(e,t,r)=>{let o=new Map(e.unsafeMap);return o.set(t,r),new eo(o)}),_f=a(2,(e,t)=>{if(!e.unsafeMap.has(t))throw RI(t);return e.unsafeMap.get(t)}),oy=_f,ny=a(2,(e,t)=>e.unsafeMap.has(t)?d(e.unsafeMap.get(t)):x()),sy=a(2,(e,t)=>{let r=new Map(e.unsafeMap);for(let[o,n]of t.unsafeMap)r.set(o,n);return new eo(r)});var St=e=>new Nc(e);var Ht=ty,Of=Ef,we=ry,to=oy,wi=_f,iy=ny,is=sy;var MI=(()=>{let e={[A](){return Qr(this)},[M](t){return Array.isArray(t)&&this.length===t.length?this.every((r,o)=>O(r,t[o])):!1}};return Object.setPrototypeOf(e,Array.prototype)})(),TI=(()=>{let e={[A](){return Ii(this)},[M](t){let r=Object.keys(this),o=Object.keys(t);if(r.length!==o.length)return!1;for(let n of r)if(!(n in t&&O(this[n],t[n])))return!1;return!0}};return Object.setPrototypeOf(e,Object.prototype)})(),ro=e=>ay(Object.assign({},e)),ay=e=>Object.setPrototypeOf(e,TI),vI=(...e)=>Cf(e),II=e=>Cf(e.slice(0)),Cf=e=>Object.setPrototypeOf(e,MI),kI=()=>e=>ro(e===void 0?{}:e);var cy=e=>t=>ro(t===void 0?{_tag:e}:{...t,_tag:e}),wI=e=>{class t extends py{constructor(){super(...arguments),this._tag=e}}return t},py=(()=>{class e{constructor(r){r&&Object.assign(this,r)}[A](){return Ii(this)}[M](r){let o=Object.keys(this),n=Object.keys(r);if(o.length!==n.length)return!1;for(let s of o)if(!(s in r&&O(this[s],r[s])))return!1;return!0}}return e})(),FI=()=>cy;var my=Symbol.for("@effect/data/Duration"),NI=BigInt(1e3),uy=BigInt(1e9),ly=/^(-?\d+(?:\.\d+)?)\s+(nanos|micros|millis|seconds|minutes|hours|days|weeks)$/,ze=e=>{if(hy(e))return e;if(Jo(e))return as(e);if(es(e))return Dc(e);{ly.lastIndex=0;let t=ly.exec(e);if(t){let[r,o,n]=t,s=Number(o);switch(n){case"nanos":return Dc(BigInt(o));case"micros":return LI(BigInt(o));case"millis":return as(s);case"seconds":return Af(s);case"minutes":return HI(s);case"hours":return qI(s);case"days":return UI(s);case"weeks":return WI(s)}}}throw new Error("Invalid duration input")},fy={_tag:"Millis",millis:0},DI={_tag:"Infinity"},or=class{constructor(t){this._id=my,Jo(t)?isNaN(t)||t<0?this.value=fy:Number.isFinite(t)?Number.isInteger(t)?this.value={_tag:"Millis",millis:t}:this.value={_tag:"Nanos",nanos:BigInt(Math.round(t*1e6))}:this.value=DI:t<BigInt(0)?this.value=fy:this.value={_tag:"Nanos",nanos:t}}[A](){return Ii(this.value)}[M](t){return hy(t)&&KI(this,t)}toString(){switch(this.value._tag){case"Millis":return`Duration("${this.value.millis} millis")`;case"Nanos":return`Duration("${this.value.nanos} nanos")`;case"Infinity":return"Duration(Infinity)"}}toJSON(){return this.value._tag==="Nanos"?{_tag:"Duration",value:{_tag:"Nanos",hrtime:jI(this)}}:{_tag:"Duration",value:this.value}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},hy=e=>pe(e)&&"_id"in e&&e._id===my,Rf=new or(0);var Dc=e=>new or(e),LI=e=>new or(e*NI),as=e=>new or(e),Af=e=>new or(e*1e3),HI=e=>new or(e*6e4),qI=e=>new or(e*36e5),UI=e=>new or(e*864e5),WI=e=>new or(e*6048e5),Rr=e=>{let t=ze(e);switch(t.value._tag){case"Infinity":return 1/0;case"Nanos":return Number(t.value.nanos)/1e6;case"Millis":return t.value.millis}};var jI=e=>{let t=ze(e);switch(t.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(t.value.nanos/uy),Number(t.value.nanos%uy)];case"Millis":return[Math.floor(t.value.millis/1e3),Math.round(t.value.millis%1e3*1e6)]}};var dy=a(3,(e,t,r)=>{let o=ze(e),n=ze(t);if(o.value._tag==="Infinity"||n.value._tag==="Infinity")return r.onMillis(Rr(o),Rr(n));if(o.value._tag==="Nanos"||n.value._tag==="Nanos"){let s=o.value._tag==="Nanos"?o.value.nanos:BigInt(Math.round(o.value.millis*1e6)),i=n.value._tag==="Nanos"?n.value.nanos:BigInt(Math.round(n.value.millis*1e6));return r.onNanos(s,i)}return r.onMillis(o.value.millis,n.value.millis)});var zI=(e,t)=>dy(e,t,{onMillis:(r,o)=>r===o,onNanos:(r,o)=>r===o});var Mf=a(2,(e,t)=>dy(e,t,{onMillis:(r,o)=>r>=o,onNanos:(r,o)=>r>=o})),KI=a(2,(e,t)=>zI(ze(e),ze(t)));var Tf=Math.pow(2,5),xy=Tf-1,gy=Tf/2,yy=Tf/4;function BI(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function To(e,t){return t>>>e&xy}function vo(e){return 1<<e}function Lc(e,t){return BI(e&t-1)}function tn(e,t,r,o){let n=o;if(!e){let s=o.length;n=new Array(s);for(let i=0;i<s;++i)n[i]=o[i]}return n[t]=r,n}function vf(e,t,r){let o=r.length-1,n=0,s=0,i=r;if(e)n=s=t;else for(i=new Array(o);n<t;)i[s++]=r[n++];for(++n;n<=o;)i[s++]=r[n++];return e&&(i.length=o),i}function by(e,t,r,o){let n=o.length;if(e){let p=n;for(;p>=t;)o[p--]=o[p];return o[t]=r,o}let s=0,i=0,c=new Array(n+1);for(;s<t;)c[i++]=o[s++];for(c[t]=r;s<n;)c[++i]=o[s++];return c}var Hc=class{constructor(t,r){this.value=t,this.previous=r}};var Ar=class e{constructor(){this._tag="EmptyNode"}modify(t,r,o,n,s,i){let c=o(x());return j(c)?new e:(++i.value,new cs(t,n,s,c))}};function qt(e){return e instanceof Ar}function GI(e){return qt(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function qc(e,t){return qt(e)?!1:t===e.edit}var cs=class e{constructor(t,r,o,n){this.edit=t,this.hash=r,this.key=o,this.value=n,this._tag="LeafNode"}modify(t,r,o,n,s,i){if(O(s,this.key)){let p=o(this.value);return p===this.value?this:j(p)?(--i.value,new Ar):qc(this,t)?(this.value=p,this):new e(t,n,s,p)}let c=o(x());return j(c)?this:(++i.value,Sy(t,r,this.hash,this,n,new e(t,n,s,c)))}},If=class e{constructor(t,r,o){this.edit=t,this.hash=r,this.children=o,this._tag="CollisionNode"}modify(t,r,o,n,s,i){if(n===this.hash){let p=qc(this,t),u=this.updateCollisionList(p,t,this.hash,this.children,o,s,i);return u===this.children?this:u.length>1?new e(t,this.hash,u):u[0]}let c=o(x());return j(c)?this:(++i.value,Sy(t,r,this.hash,this,n,new cs(t,n,s,c)))}updateCollisionList(t,r,o,n,s,i,c){let p=n.length;for(let f=0;f<p;++f){let m=n[f];if("key"in m&&O(i,m.key)){let y=m.value,b=s(y);return b===y?n:j(b)?(--c.value,vf(t,f,n)):tn(t,f,new cs(r,o,i,b),n)}}let u=s(x());return j(u)?n:(++c.value,tn(t,p,new cs(r,o,i,u),n))}},Fi=class e{constructor(t,r,o){this.edit=t,this.mask=r,this.children=o,this._tag="IndexedNode"}modify(t,r,o,n,s,i){let c=this.mask,p=this.children,u=To(r,n),f=vo(u),m=Lc(c,f),y=c&f,b=qc(this,t);if(!y){let H=new Ar().modify(t,r+5,o,n,s,i);return H?p.length>=gy?VI(t,u,H,c,p):new e(t,c|f,by(b,m,H,p)):this}let C=p[m],R=C.modify(t,r+5,o,n,s,i);if(C===R)return this;let v=c,w;if(qt(R)){if(v&=~f,!v)return new Ar;if(p.length<=2&&GI(p[m^1]))return p[m^1];w=vf(b,m,p)}else w=tn(b,m,R,p);return b?(this.mask=v,this.children=w,this):new e(t,v,w)}},kf=class e{constructor(t,r,o){this.edit=t,this.size=r,this.children=o,this._tag="ArrayNode"}modify(t,r,o,n,s,i){let c=this.size,p=this.children,u=To(r,n),f=p[u],m=(f||new Ar).modify(t,r+5,o,n,s,i);if(f===m)return this;let y=qc(this,t),b;if(qt(f)&&!qt(m))++c,b=tn(y,u,m,p);else if(!qt(f)&&qt(m)){if(--c,c<=yy)return $I(t,c,u,p);b=tn(y,u,new Ar,p)}else b=tn(y,u,m,p);return y?(this.size=c,this.children=b,this):new e(t,c,b)}};function $I(e,t,r,o){let n=new Array(t-1),s=0,i=0;for(let c=0,p=o.length;c<p;++c)if(c!==r){let u=o[c];u&&!qt(u)&&(n[s++]=u,i|=1<<c)}return new Fi(e,i,n)}function VI(e,t,r,o,n){let s=[],i=o,c=0;for(let p=0;i;++p)i&1&&(s[p]=n[c++]),i>>>=1;return s[t]=r,new kf(e,c+1,s)}function YI(e,t,r,o,n,s){if(r===n)return new If(e,r,[s,o]);let i=To(t,r),c=To(t,n);if(i===c)return p=>new Fi(e,vo(i)|vo(c),[p]);{let p=i<c?[o,s]:[s,o];return new Fi(e,vo(i)|vo(c),p)}}function Sy(e,t,r,o,n,s){let i,c=t;for(;;){let p=YI(e,c,r,o,n,s);if(typeof p=="function")i=new Hc(p,i),c=c+5;else{let u=p;for(;i!=null;)u=i.value(u),i=i.previous;return u}}}var wf=Symbol.for("@effect/data/HashMap"),Pi=class{constructor(t,r,o,n){this._editable=t,this._edit=r,this._root=o,this._size=n,this._id=wf}[Symbol.iterator](){return new Uc(this,(t,r)=>[t,r])}[A](){let t=S("HashMap");for(let r of this)t^=I(S(r[0]))(S(r[1]));return t}[M](t){if(Cy(t)){if(t._size!==this._size)return!1;for(let r of this){let o=jc(r[0],S(r[0]))(t);if(j(o))return!1;if(!O(r[1],o.value))return!1}return!0}return!1}toString(){return`HashMap(${Array.from(this).map(([t,r])=>`[${String(t)}, ${String(r)}]`).join(", ")})`}toJSON(){return{_tag:"HashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},Uc=class e{constructor(t,r){this.map=t,this.f=r,this.v=Ey(this.map._root,this.f,void 0)}next(){if(j(this.v))return{done:!0,value:void 0};let t=this.v.value;return this.v=Wc(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new e(this.map,this.f)}},Wc=e=>e?_y(e[0],e[1],e[2],e[3],e[4]):x(),Ey=(e,t,r=void 0)=>{switch(e._tag){case"LeafNode":return N(e.value)?d({value:t(e.key,e.value.value),cont:r}):Wc(r);case"CollisionNode":case"ArrayNode":case"IndexedNode":{let o=e.children;return _y(o.length,o,0,t,r)}default:return Wc(r)}},_y=(e,t,r,o,n)=>{for(;r<e;){let s=t[r++];if(s&&!qt(s))return Ey(s,o,[e,t,r,o,n])}return Wc(n)},us=()=>new Pi(!1,0,new Ar,0),Oy=(...e)=>Ff(e),Ff=e=>{let t=Kc(us());for(let r of e)rn(r[0],r[1])(t);return My(t)},Cy=e=>pe(e)&&"_id"in e&&e._id===wf,Ry=e=>e&&qt(e._root),Ay=a(2,(e,t)=>jc(e,t,S(t))),jc=a(3,(e,t,r)=>{let o=e._root,n=0;for(;;)switch(o._tag){case"LeafNode":return O(t,o.key)?o.value:x();case"CollisionNode":{if(r===o.hash){let s=o.children;for(let i=0,c=s.length;i<c;++i){let p=s[i];if("key"in p&&O(t,p.key))return p.value}}return x()}case"IndexedNode":{let s=To(n,r),i=vo(s);if(o.mask&i){o=o.children[Lc(o.mask,i)],n+=5;break}return x()}case"ArrayNode":{if(o=o.children[To(n,r)],o){n+=5;break}return x()}default:return x()}});var Pf=a(2,(e,t)=>N(jc(e,t,S(t))));var rn=a(3,(e,t,r)=>Nf(e,t,()=>d(r))),QI=a(3,(e,t,r)=>e._editable?(e._root=t,e._size=r,e):t===e._root?e:new Pi(e._editable,e._edit,t,r)),zc=e=>new Uc(e,t=>t);var ls=e=>e._size,Kc=e=>new Pi(!0,e._edit+1,e._root,e._size),My=e=>(e._editable=!1,e);var Nf=a(3,(e,t,r)=>Ty(e,t,S(t),r)),Ty=a(4,(e,t,r,o)=>{let n={value:e._size},s=e._root.modify(e._editable?e._edit:NaN,0,o,r,t,n);return QI(s,n.value)(e)});var Ni=a(2,(e,t)=>Nf(e,t,x));var vy=a(2,(e,t)=>fs(e,us(),(r,o,n)=>rn(r,n,t(o,n))));var Bc=a(2,(e,t)=>fs(e,void 0,(r,o,n)=>t(o,n))),fs=a(3,(e,t,r)=>{let o=e._root;if(o._tag==="LeafNode")return N(o.value)?r(t,o.value.value,o.key):t;if(o._tag==="EmptyNode")return t;let n=[o.children],s;for(;s=n.pop();)for(let i=0,c=s.length;i<c;){let p=s[i++];p&&!qt(p)&&(p._tag==="LeafNode"?N(p.value)&&(t=r(t,p.value.value,p.key)):n.push(p.children))}return t});var Df=Symbol.for("@effect/data/HashSet"),ms=class{constructor(t){this._keyMap=t,this._id=Df}[Symbol.iterator](){return zc(this._keyMap)}[A](){return I(S(this._keyMap))(S("HashSet"))}[M](t){return ky(t)?ls(this._keyMap)===ls(t._keyMap)&&O(this._keyMap,t._keyMap):!1}toString(){return`HashSet(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"HashSet",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},ky=e=>pe(e)&&"_id"in e&&e._id===Df,Di=()=>new ms(us()),wy=e=>{let t=Gc(Di());for(let r of e)hs(t,r);return $c(t)},Fy=(...e)=>{let t=Gc(Di());for(let r of e)hs(t,r);return $c(t)},Py=a(2,(e,t)=>Pf(e._keyMap,t));var Ny=e=>ls(e._keyMap),Gc=e=>new ms(Kc(e._keyMap)),$c=e=>(e._keyMap._editable=!1,e),Lf=a(2,(e,t)=>{let r=Gc(e);return t(r),$c(r)}),hs=a(2,(e,t)=>e._keyMap._editable?(rn(t,!0)(e._keyMap),e):new ms(rn(t,!0)(e._keyMap))),Hf=a(2,(e,t)=>e._keyMap._editable?(Ni(t)(e._keyMap),e):new ms(Ni(t)(e._keyMap))),Dy=a(2,(e,t)=>Lf(e,r=>{for(let o of t)Hf(r,o)}));var Ly=a(2,(e,t)=>Lf(Di(),r=>{Hy(e,o=>hs(r,o));for(let o of t)hs(r,o)}));var Hy=a(2,(e,t)=>Bc(e._keyMap,(r,o)=>t(o))),qy=a(3,(e,t,r)=>fs(e._keyMap,t,(o,n,s)=>r(o,s)));var oo=us,Uy=Oy,Vc=Ff,Wy=Ry,Li=Ay;var Mr=rn,qf=zc;var Yc=ls;var jy=Ni;var zy=vy;var Ky=Bc,Uf=fs;var XI=Symbol.for("@effect/data/MutableRef"),Wf=class{constructor(t){this.current=t,this._T=r=>r,this._id=XI}toString(){return`MutableRef(${String(this.current)})`}toJSON(){return{_tag:"MutableRef",current:this.current}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},at=e=>new Wf(e),Jc=a(3,(e,t,r)=>O(t,e.current)?(e.current=r,!0):!1);var _t=e=>e.current;var By=e=>tk(e,t=>t+1),Ut=a(2,(e,t)=>(e.current=t,e)),ek=a(2,(e,t)=>(e.current=t,e.current)),jf=a(2,(e,t)=>Ut(e,t(_t(e)))),tk=a(2,(e,t)=>ek(e,t(_t(e))));var rk=Symbol.for("@effect/data/MutableHashMap"),zf=class{constructor(){this._id=rk,this.backingMap=at(oo())}[Symbol.iterator](){return this.backingMap.current[Symbol.iterator]()}toString(){return`MutableHashMap(${Array.from(this).map(([t,r])=>`[${String(t)}, ${String(r)}]`).join(", ")})`}toJSON(){return{_tag:"MutableHashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},sn=()=>new zf;var ye=a(2,(e,t)=>Li(e.backingMap.current,t)),nr=a(2,(e,t)=>N(ye(e,t)));var an=a(2,(e,t)=>(jf(e.backingMap,jy(t)),e)),ct=a(3,(e,t,r)=>(jf(e.backingMap,Mr(t,r)),e)),Qc=e=>Yc(_t(e.backingMap));var Gy=Symbol.for("@effect/data/Chunk");function ok(e,t,r,o,n){for(let s=t;s<Math.min(e.length,t+n);s++)r[o+s-t]=e[s];return r}var $y=[],nk=e=>gc((t,r)=>Ze(t).every((o,n)=>e(o,Io(r,n)))),sk=nk(O),re=class{constructor(t){switch(this.backing=t,this._id=Gy,t._tag){case"IEmpty":{this.length=0,this.depth=0,this.left=this,this.right=this;break}case"IConcat":{this.length=t.left.length+t.right.length,this.depth=1+Math.max(t.left.depth,t.right.depth),this.left=t.left,this.right=t.right;break}case"IArray":{this.length=t.array.length,this.depth=0,this.left=sr,this.right=sr;break}case"ISingleton":{this.length=1,this.depth=0,this.left=sr,this.right=sr;break}case"ISlice":{this.length=t.length,this.depth=t.chunk.depth+1,this.left=sr,this.right=sr;break}}}toString(){return`Chunk(${Ze(this).map(String).join(", ")})`}toJSON(){return{_tag:"Chunk",values:Ze(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}[M](t){return Vy(t)&&sk(this,t)}[A](){return Qr(Ze(this))}[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return $y[Symbol.iterator]();default:return Ze(this)[Symbol.iterator]()}}pipe(){return E(this,arguments)}},Vy=e=>pe(e)&&"_id"in e&&e._id===Gy,sr=new re({_tag:"IEmpty"}),Xe=()=>sr;var Oe=e=>new re({_tag:"ISingleton",a:e}),Tr=e=>Vy(e)?e:new re({_tag:"IArray",array:J(e)}),Bf=(e,t,r)=>{switch(e.backing._tag){case"IArray":{ok(e.backing.array,0,t,r,e.length);break}case"IConcat":{Bf(e.left,t,r),Bf(e.right,t,r+e.left.length);break}case"ISingleton":{t[r]=e.backing.a;break}case"ISlice":{let o=0,n=r;for(;o<e.length;)t[n]=Io(e,o),o+=1,n+=1;break}}},Ze=e=>{switch(e.backing._tag){case"IEmpty":return $y;case"IArray":return e.backing.array;default:{let t=new Array(e.length);return Bf(e,t,0),e.backing={_tag:"IArray",array:t},e.left=sr,e.right=sr,e.depth=0,t}}},no=e=>{switch(e.backing._tag){case"IEmpty":case"ISingleton":return e;case"IArray":return new re({_tag:"IArray",array:gf(e.backing.array)});case"IConcat":return new re({_tag:"IConcat",left:no(e.backing.right),right:no(e.backing.left)});case"ISlice":return Ot(gf(Ze(e)))}},ik=a(2,(e,t)=>t<0||t>=e.length?x():d(Io(e,t))),Ot=e=>new re({_tag:"IArray",array:e});var Io=a(2,(e,t)=>{switch(e.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return e.backing.a}case"IArray":{if(t>=e.length||t<0)throw new Error("Index out of bounds");return e.backing.array[t]}case"IConcat":return t<e.left.length?Io(e.left,t):Io(e.right,t-e.left.length);case"ISlice":return Io(e.backing.chunk,t+e.backing.offset)}}),Zc=a(2,(e,t)=>Yy(e,Oe(t))),Te=a(2,(e,t)=>Yy(Oe(t),e)),Gf=a(2,(e,t)=>{if(t<=0)return sr;if(t>=e.length)return e;switch(e.backing._tag){case"ISlice":return new re({_tag:"ISlice",chunk:e.backing.chunk,length:t,offset:e.backing.offset});case"IConcat":return t>e.left.length?new re({_tag:"IConcat",left:e.left,right:Gf(e.right,t-e.left.length)}):Gf(e.left,t);default:return new re({_tag:"ISlice",chunk:e,offset:0,length:t})}}),ds=a(2,(e,t)=>{if(t<=0)return e;if(t>=e.length)return sr;switch(e.backing._tag){case"ISlice":return new re({_tag:"ISlice",chunk:e.backing.chunk,offset:e.backing.offset+t,length:e.backing.length-t});case"IConcat":return t>e.left.length?ds(e.right,t-e.left.length):new re({_tag:"IConcat",left:ds(e.left,t),right:e.right});default:return new re({_tag:"ISlice",chunk:e,offset:t,length:e.length-t})}});var ir=a(2,(e,t)=>{if(e.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return e;let r=t.depth-e.depth;if(Math.abs(r)<=1)return new re({_tag:"IConcat",left:e,right:t});if(r<-1)if(e.left.depth>=e.right.depth){let o=ir(e.right,t);return new re({_tag:"IConcat",left:e.left,right:o})}else{let o=ir(e.right.right,t);if(o.depth===e.depth-3){let n=new re({_tag:"IConcat",left:e.right.left,right:o});return new re({_tag:"IConcat",left:e.left,right:n})}else{let n=new re({_tag:"IConcat",left:e.left,right:e.right.left});return new re({_tag:"IConcat",left:n,right:o})}}else if(t.right.depth>=t.left.depth){let o=ir(e,t.left);return new re({_tag:"IConcat",left:o,right:t.right})}else{let o=ir(e,t.left.left);if(o.depth===t.depth-3){let n=new re({_tag:"IConcat",left:o,right:t.left.right});return new re({_tag:"IConcat",left:n,right:t.right})}else{let n=new re({_tag:"IConcat",left:t.left.right,right:t.right});return new re({_tag:"IConcat",left:o,right:n})}}}),Yy=a(2,(e,t)=>ir(e,t));var xs=e=>e.length===0,Ke=e=>e.length>0,cn=ik(0),pn=e=>Io(e,0),Be=pn;var Jy=e=>Io(e,e.length-1),$f=a(2,(e,t)=>e.backing._tag==="ISingleton"?Oe(t(e.backing.a,0)):Ot(Zr((r,o)=>t(r,o))(Ze(e))));var Xc=a(2,(e,t)=>Ot(Zo(Ze(e),t)));var ak=a(2,(e,t)=>[Gf(e,t),ds(e,t)]);var Qy=a(2,(e,t)=>{let r=0;for(let o of Ze(e)){if(t(o))break;r++}return ak(e,r)});var Ge=e=>ds(e,1);var Zy=e=>Ot(Qg(Ze(e)));var ck=Symbol.for("@effect/data/MutableList"),Vf=class{constructor(){this._id=ck,this.head=void 0,this.tail=void 0,this._length=0}[Symbol.iterator](){let t=!1,r=this.head;return{next(){if(t)return this.return();if(r==null)return t=!0,this.return();let o=r.value;return r=r.next,{done:t,value:o}},return(o){return t||(t=!0),{done:!0,value:o}}}}toString(){return`MutableList(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableList",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}},Yf=class{constructor(t){this.value=t,this.removed=!1,this.prev=void 0,this.next=void 0}},Xy=()=>new Vf;var eb=e=>Jf(e)===0,Jf=e=>e._length;var tb=a(2,(e,t)=>{let r=new Yf(t);return e.head===void 0&&(e.head=r),e.tail===void 0||(e.tail.next=r,r.prev=e.tail),e.tail=r,e._length+=1,e}),rb=e=>{let t=e.head;if(t!==void 0)return pk(e,t),t.value};var pk=(e,t)=>{t.removed||(t.removed=!0,t.prev!==void 0&&t.next!==void 0?(t.prev.next=t.next,t.next.prev=t.prev):t.prev!==void 0?(e.tail=t.prev,t.prev.next=void 0):t.next!==void 0?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))};var lk=Symbol.for("@effect/data/MutableQueue"),Zf=Symbol.for("@effect/data/mutable/MutableQueue/Empty"),Qf=class{constructor(t=void 0){this.capacity=t,this._tag="Bounded",this._id=lk,this.queue=Xy()}[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()}toString(){return`MutableQueue(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableQueue",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}pipe(){return E(this,arguments)}};var ob=()=>new Qf;var nb=a(2,(e,t)=>{let r=Jf(e.queue);return e.capacity!==void 0&&r===e.capacity?!1:(tb(t)(e.queue),!0)});var sb=a(2,(e,t)=>eb(e.queue)?t:rb(e.queue));var gs=Symbol.for("@effect/data/Differ/ContextPatch");function vr(e){return e}var Xf=class{constructor(){this._tag="Empty",this._Input=vr,this._Output=vr,this._id=gs}[A](){return ke("ContextPatch(Empty)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}},em=class{constructor(t,r){this.first=t,this.second=r,this._tag="AndThen",this._id=gs,this._Input=vr,this._Output=vr}[A](){return ke("ContextPatch(AndThen)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.first,t.first)&&O(this.second,t.second)}},tm=class{constructor(t,r){this.tag=t,this.service=r,this._tag="AddService",this._id=gs,this._Input=vr,this._Output=vr}[A](){return ke("ContextPatch(AddService)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.tag,t.tag)&&O(this.service,t.service)}},rm=class{constructor(t){this.tag=t,this._tag="RemoveService",this._id=gs,this._Input=vr,this._Output=vr}[A](){return ke("ContextPatch(RemoveService)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.tag,t.tag)}},om=class{constructor(t,r){this.tag=t,this.update=r,this._tag="UpdateService",this._id=gs,this._Input=vr,this._Output=vr}[A](){return ke("ContextPatch(AndThen)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.tag,t.tag)&&O(this.update,t.update)}},nm=()=>new Xf,ib=(e,t)=>{let r=new Map(e.unsafeMap),o=nm();for(let[n,s]of t.unsafeMap.entries())if(r.has(n)){let i=r.get(n);r.delete(n),O(i,s)||(o=Hi(new om(n,()=>s))(o))}else r.delete(n),o=Hi(new tm(n,s))(o);for(let[n]of r.entries())o=Hi(new rm(n))(o);return o},Hi=a(2,(e,t)=>new em(e,t)),ab=a(2,(e,t)=>{let r=!1,o=Oe(e),n=new Map(t.unsafeMap);for(;Ke(o);){let i=Be(o),c=Ge(o);switch(i._tag){case"Empty":{o=c;break}case"AddService":{n.set(i.tag,i.service),o=c;break}case"AndThen":{o=Te(Te(c,i.second),i.first);break}case"RemoveService":{n.delete(i.tag),o=c;break}case"UpdateService":{n.set(i.tag,i.update(n.get(i.tag))),r=!0,o=c;break}}}if(!r)return new eo(n);let s=new Map;for(let[i]of t.unsafeMap)n.has(i)&&(s.set(i,n.get(i)),n.delete(i));for(let[i,c]of n)s.set(i,c);return new eo(s)});var ep=nm,cb=ib,pb=Hi,ub=ab;var $e=Di,pt=wy,so=Fy,fb=Py;var io=Ny;var Ir=hs,sm=Hf,im=Dy;var Ve=Ly;var un=qy;var qi=Symbol.for("@effect/data/Differ/HashSetPatch");function rp(e){return e}var am=class{constructor(){this._tag="Empty",this._Value=rp,this._id=qi}[A](){return ke("HashSetPatch(Empty)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}},cm=class{constructor(t,r){this.first=t,this.second=r,this._tag="AndThen",this._Value=rp,this._id=qi}[A](){return ke("HashSetPatch(AndThen)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.first,t.first)&&O(this.second,t.second)}},pm=class{constructor(t){this.value=t,this._tag="Add",this._Value=rp,this._id=qi}[A](){return ke("HashSetPatch(Add)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.value,t.value)}},um=class{constructor(t){this.value=t,this._tag="Remove",this._Value=rp,this._id=qi}[A](){return ke("HashSetPatch(Remove)")}[M](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&O(this.value,t.value)}},lm=()=>new am,mb=(e,t)=>{let[r,o]=un([e,lm()],([n,s],i)=>fb(i)(n)?[sm(i)(n),s]:[n,tp(new pm(i))(s)])(t);return un(o,(n,s)=>tp(new um(s))(n))(r)},tp=a(2,(e,t)=>new cm(e,t)),hb=a(2,(e,t)=>{let r=t,o=Oe(e);for(;Ke(o);){let n=Be(o),s=Ge(o);switch(n._tag){case"Empty":{o=s;break}case"AndThen":{o=Te(n.first)(Te(n.second)(s));break}case"Add":{r=Ir(n.value)(r),o=s;break}case"Remove":r=sm(n.value)(r),o=s}}return r});var op=lm,db=mb,xb=tp,gb=hb;var bb=Symbol.for("@effect/data/Differ"),fm=class{constructor(t){this._id=bb,this._P=F,this._V=F,this.empty=t.empty,this.diff=t.diff,this.combine=t.combine,this.patch=t.patch}},Ui=e=>new fm(e),Sb=()=>Ui({empty:ep(),combine:(e,t)=>pb(t)(e),diff:(e,t)=>cb(e,t),patch:(e,t)=>ub(t)(e)});var Eb=()=>Ui({empty:op(),combine:(e,t)=>xb(t)(e),diff:(e,t)=>db(e,t),patch:(e,t)=>gb(t)(e)});var _b=()=>Ob((e,t)=>t),Ob=e=>Ui({empty:F,combine:(t,r)=>t===F?r:r===F?t:o=>r(t(o)),diff:(t,r)=>O(t,r)?F:Ci(r),patch:(t,r)=>e(r,t(r))});var Cb=a(3,(e,t,r)=>e.diff(t,r)),Rb=a(3,(e,t,r)=>e.combine(t,r)),Ab=a(3,(e,t,r)=>e.patch(t,r)),np=Ui,Mb=Sb;var Tb=Eb;var vb=_b;var dm=Symbol.for("@effect/data/List"),Wi=e=>Array.from(e),gk=e=>yg(Jg(e),Wi),yk=gk(O),ys=class{constructor(t,r){this.head=t,this.tail=r,this._tag="Cons",this._id=dm}toString(){return`List.Cons(${Wi(this).map(String).join(", ")})`}toJSON(){return{_tag:"List.Cons",values:Wi(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}[M](t){return Ib(t)&&this._tag===t._tag&&yk(this,t)}[A](){return Qr(Wi(this))}[Symbol.iterator](){let t=!1,r=this;return{next(){if(t)return this.return();if(r._tag==="Nil")return t=!0,this.return();let o=r.head;return r=r.tail,{done:t,value:o}},return(o){return t||(t=!0),{done:!0,value:o}}}}pipe(){return E(this,arguments)}},hm=class{constructor(){this._tag="Nil",this._id=dm}toString(){return"List.Nil"}toJSON(){return{_tag:"List.Nil"}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}[A](){return Qr(Wi(this))}[M](t){return Ib(t)&&this._tag===t._tag}[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}}pipe(){return E(this,arguments)}},Ib=e=>pe(e)&&"_id"in e&&e._id===dm,ut=e=>e._tag==="Nil",ji=e=>e._tag==="Cons";var kb=new hm,bk=()=>kb,ao=(e,t)=>new ys(e,t),ar=bk,zi=e=>new ys(e,kb);var wb=a(2,(e,t)=>Sk(t,e));var ko=a(2,(e,t)=>ao(t,e)),Sk=a(2,(e,t)=>{if(ut(e))return t;if(ut(t))return e;{let r=new ys(t.head,e),o=r,n=t.tail;for(;!ut(n);){let s=new ys(n.head,e);o.tail=s,o=s,n=n.tail}return r}});var Fb=a(2,(e,t)=>{let r=e;for(;!ut(r);){if(t(r.head))return d(r.head);r=r.tail}return x()});var sp=e=>ut(e)?x():d(e.head);var Pb=a(3,(e,t,r)=>{let o=t,n=e;for(;!ut(n);)o=r(o,n.head),n=n.tail;return o});var Nb=e=>{let t=ar(),r=e;for(;!ut(r);)t=ko(t,r.head),r=r.tail;return t};var Db,Lb,Hb,ap="@effect/io/Fiber/Id",wo=Symbol.for(ap),Ki="None",xm="Runtime",gm="Composite",ym=class{constructor(){this[Db]=wo,this._tag=Ki}[(Db=wo,A)](){return I(S(this._tag))(S(ap))}[M](t){return pp(t)&&t._tag===Ki}},bm=class{constructor(t,r){this.id=t,this.startTimeMillis=r,this[Lb]=wo,this._tag=xm}[(Lb=wo,A)](){return I(S(this.startTimeMillis))(I(S(this.id))(I(S(this._tag))(S(ap))))}[M](t){return pp(t)&&t._tag===xm&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}},Sm=class{constructor(t,r){this.left=t,this.right=r,this[Hb]=wo,this._tag=gm}[(Hb=wo,A)](){return I(S(this.right))(I(S(this.left))(I(S(this._tag))(S(ap))))}[M](t){return pp(t)&&t._tag===gm&&O(this.left,t.left)&&O(this.right,t.right)}},cp=new ym;var pp=e=>typeof e=="object"&&e!=null&&wo in e;var Ub=a(2,(e,t)=>e._tag===Ki?t:t._tag===Ki?e:new Sm(e,t));var ip=e=>{switch(e._tag){case Ki:return $e();case xm:return so(e.id);case gm:return Ve(ip(e.right))(ip(e.left))}},qb=z(Symbol.for("@effect/io/Fiber/Id/_fiberCounter"),()=>at(0));var up=e=>Array.from(ip(e)).map(r=>`#${r}`).join(",");var Wb=()=>{let e=_t(qb);return Ut(e+1)(qb),new bm(e,new Date().getTime())};var et=cp;var Em=Ub;var zb=up;var lp=Wb;var ln="Die",Fo="Empty",fn="Fail",Es="Interrupt",mn="Annotated",hn="Parallel",dn="Sequential";var Yb="@effect/io/Cause",Am=Symbol.for(Yb),_k={_E:e=>e},gn={[Am]:_k,[A](){return I(S(Ck(this)))(S(Yb))},[M](e){return dp(e)&&Ok(this,e)},pipe(){return E(this,arguments)},toJSON(){return{_tag:"Cause",errors:bp(this)}},toString(){return uo(this)},[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}},tt=(()=>{let e=Object.create(gn);return e._tag=Fo,e})(),yn=e=>{let t=Object.create(gn);return t._tag=fn,t.error=e,t},Le=e=>{let t=Object.create(gn);return t._tag=ln,t.defect=e,t},cr=e=>{let t=Object.create(gn);return t._tag=Es,t.fiberId=e,t},Po=(e,t)=>{let r=Object.create(gn);return r._tag=mn,r.cause=e,r.annotation=t,r},Fe=(e,t)=>{let r=Object.create(gn);return r._tag=hn,r.left=e,r.right=t,r},Ce=(e,t)=>{let r=Object.create(gn);return r._tag=dn,r.left=e,r.right=t,r},dp=e=>typeof e=="object"&&e!=null&&Am in e,Mm=e=>e._tag===Fo;var xp=e=>e._tag===ln;var Tm=e=>e._tag===Fo?!0:xn(e,!0,(t,r)=>{switch(r._tag){case Fo:return d(t);case ln:case fn:case Es:return d(!1);default:return x()}});var No=e=>yp(void 0,Ak)(e),Bi=e=>no(xn(e,Xe(),(t,r)=>r._tag===fn?d(Te(r.error)(t)):x())),gp=e=>no(xn(e,Xe(),(t,r)=>r._tag===ln?d(Te(r.defect)(t)):x())),Gi=e=>xn(e,$e(),(t,r)=>r._tag===Es?d(Ir(r.fiberId)(t)):x()),Jb=e=>$i(e,t=>t._tag===fn?d(t.error):x()),co=e=>{let t=Jb(e);switch(t._tag){case"None":return P(e);case"Some":return q(t.value)}};var vm=e=>Os(e,{onEmpty:x(),onFail:()=>x(),onDie:t=>d(Le(t)),onInterrupt:()=>x(),onAnnotated:(t,r)=>Me(o=>Po(o,r))(t),onSequential:(t,r)=>N(t)&&N(r)?d(Ce(t.value,r.value)):N(t)&&j(r)?d(t.value):j(t)&&N(r)?d(r.value):x(),onParallel:(t,r)=>N(t)&&N(r)?d(Fe(t.value,r.value)):N(t)&&j(r)?d(t.value):j(t)&&N(r)?d(r.value):x()}),Qb=e=>Os(e,{onEmpty:x(),onFail:t=>d(Le(t)),onDie:t=>d(Le(t)),onInterrupt:()=>x(),onAnnotated:(t,r)=>Me(o=>Po(o,r))(t),onSequential:(t,r)=>N(t)&&N(r)?d(Ce(t.value,r.value)):N(t)&&j(r)?d(t.value):j(t)&&N(r)?d(r.value):x(),onParallel:(t,r)=>N(t)&&N(r)?d(Fe(t.value,r.value)):N(t)&&j(r)?d(t.value):j(t)&&N(r)?d(r.value):x()});var _s=e=>Os(e,{onEmpty:tt,onFail:()=>tt,onDie:t=>Le(t),onInterrupt:t=>cr(t),onAnnotated:(t,r)=>Mm(t)?t:Po(t,r),onSequential:Ce,onParallel:Fe}),Zb=e=>Os(e,{onEmpty:tt,onFail:t=>Le(t),onDie:t=>Le(t),onInterrupt:t=>cr(t),onAnnotated:(t,r)=>Mm(t)?t:Po(t,r),onSequential:(t,r)=>Ce(t,r),onParallel:(t,r)=>Fe(t,r)});var Xb=a(2,(e,t)=>Os(e,{onEmpty:tt,onFail:r=>t(r),onDie:r=>Le(r),onInterrupt:r=>cr(r),onAnnotated:(r,o)=>Po(r,o),onSequential:(r,o)=>Ce(r,o),onParallel:(r,o)=>Fe(r,o)})),Im=e=>Xb(e,F);var Ok=(e,t)=>{let r=Oe(e),o=Oe(t);for(;Ke(r)&&Ke(o);){let[n,s]=xn([$e(),Xe()],([p,u],f)=>{let[m,y]=_m(f);return d([Ve(m)(p),ir(y)(u)])})(Be(r)),[i,c]=xn([$e(),Xe()],([p,u],f)=>{let[m,y]=_m(f);return d([Ve(m)(p),ir(y)(u)])})(Be(o));if(!O(n,i))return!1;r=s,o=c}return!0},Ck=e=>Rk(Oe(e),Xe()),Rk=(e,t)=>{for(;;){let[r,o]=it([$e(),Xe()],([s,i],c)=>{let[p,u]=_m(c);return[Ve(p)(s),ir(u)(i)]})(e),n=io(r)>0?Te(r)(t):t;if(xs(o))return no(n);e=o,t=n}throw new Error("BUG: Cause.flattenCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")};var $i=a(2,(e,t)=>{let r=[e];for(;r.length>0;){let o=r.pop(),n=t(o);switch(n._tag){case"None":{switch(o._tag){case dn:case hn:{r.push(o.right),r.push(o.left);break}case mn:{r.push(o.cause);break}}break}case"Some":return n}}return x()});var _m=e=>{let t=e,r=[],o=$e(),n=Xe();for(;t!==void 0;)switch(t._tag){case Fo:{if(r.length===0)return[o,n];t=r.pop();break}case fn:{if(r.length===0)return[Ir(t.error)(o),n];o=Ir(t.error)(o),t=r.pop();break}case ln:{if(r.length===0)return[Ir(t.defect)(o),n];o=Ir(t.defect)(o),t=r.pop();break}case Es:{if(r.length===0)return[Ir(t.fiberId)(o),n];o=Ir(t.fiberId)(o),t=r.pop();break}case mn:{t=t.cause;break}case dn:{switch(t.left._tag){case Fo:{t=t.right;break}case dn:{t=Ce(t.left.left,Ce(t.left.right,t.right));break}case hn:{t=Fe(Ce(t.left.left,t.right),Ce(t.left.right,t.right));break}case mn:{t=Ce(t.left.cause,t.right);break}default:{n=Te(t.right)(n),t=t.left;break}}break}case hn:{r.push(t.right),t=t.left;break}}throw new Error("BUG: Cause.evaluateCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")};var Ak={emptyCase:_r,failCase:Pt,dieCase:Pt,interruptCase:_r,annotatedCase:(e,t)=>t,sequentialCase:(e,t,r)=>t&&r,parallelCase:(e,t,r)=>t&&r};var Kb="SequentialCase",Bb="ParallelCase",Gb="AnnotatedCase",Os=a(2,(e,{onAnnotated:t,onDie:r,onEmpty:o,onFail:n,onInterrupt:s,onParallel:i,onSequential:c})=>yp(e,void 0,{emptyCase:()=>o,failCase:(p,u)=>n(u),dieCase:(p,u)=>r(u),interruptCase:(p,u)=>s(u),annotatedCase:(p,u,f)=>t(u,f),sequentialCase:(p,u,f)=>c(u,f),parallelCase:(p,u,f)=>i(u,f)})),xn=a(3,(e,t,r)=>{let o=t,n=e,s=[];for(;n!==void 0;){let i=r(o,n);switch(o=N(i)?i.value:o,n._tag){case dn:{s.push(n.right),n=n.left;break}case hn:{s.push(n.right),n=n.left;break}case mn:{n=n.cause;break}default:{n=void 0;break}}n===void 0&&s.length>0&&(n=s.pop())}return o}),yp=a(3,(e,t,r)=>{let o=[e],n=[];for(;o.length>0;){let i=o.pop();switch(i._tag){case Fo:{n.push(P(r.emptyCase(t)));break}case fn:{n.push(P(r.failCase(t,i.error)));break}case ln:{n.push(P(r.dieCase(t,i.defect)));break}case Es:{n.push(P(r.interruptCase(t,i.fiberId)));break}case mn:{o.push(i.cause),n.push(q({_tag:Gb,annotation:i.annotation}));break}case dn:{o.push(i.right),o.push(i.left),n.push(q({_tag:Kb}));break}case hn:{o.push(i.right),o.push(i.left),n.push(q({_tag:Bb}));break}}}let s=[];for(;n.length>0;){let i=n.pop();switch(i._tag){case"Left":{switch(i.left._tag){case Kb:{let c=s.pop(),p=s.pop(),u=r.sequentialCase(t,c,p);s.push(u);break}case Bb:{let c=s.pop(),p=s.pop(),u=r.parallelCase(t,c,p);s.push(u);break}case Gb:{let c=s.pop(),p=r.annotatedCase(t,c,i.left.annotation);s.push(p);break}}break}case"Right":{s.push(i.right);break}}}if(s.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/io/issues");return s.pop()}),Vi=(e,t)=>{let r={value:t,enumerable:!0},o={...e,toString(){return`${this._tag}: ${this.message}`}};return n=>Object.create(o,{_tag:r,message:{value:n,enumerable:!0}})},Om=Symbol.for("@effect/io/Cause/errors/RuntimeException"),km=Vi({[Om]:Om},"RuntimeException");var fp=Symbol.for("@effect/io/Cause/errors/InterruptedException"),Mk=Vi({[fp]:fp},"InterruptedException"),wm=e=>typeof e=="object"&&e!=null&&fp in e,Cm=Symbol.for("@effect/io/Cause/errors/IllegalArgument"),Cs=Vi({[Cm]:Cm},"IllegalArgumentException");var mp=Symbol.for("@effect/io/Cause/errors/NoSuchElement"),po=Vi({[mp]:mp},"NoSuchElementException"),Fm=e=>typeof e=="object"&&e!=null&&mp in e,Rm=Symbol.for("@effect/io/Cause/errors/InvalidHubCapacityException"),Gj=Vi({[Rm]:Rm},"InvalidHubCapacityException");var hp=Symbol.for("@effect/io/Cause/SpanAnnotation"),Tk=e=>typeof e=="object"&&e!==null&&hp in e,eS=e=>({_tag:"SpanAnnotation",[hp]:hp,span:e});var $b=e=>{if(typeof e=="object"&&e!=null&&"toString"in e&&typeof e.toString=="function"&&e.toString!==Object.prototype.toString)return e.toString();if(typeof e=="string")return`Error: ${e}`;if(typeof e=="object"&&e!==null&&"message"in e&&typeof e.message=="string"){let t=JSON.parse(JSON.stringify(e)),r=new Set(Object.keys(t));if(r.delete("name"),r.delete("message"),r.delete("_tag"),r.size===0)return`${"name"in e&&typeof e.name=="string"?e.name:"Error"}${"_tag"in e&&typeof e._tag=="string"?`(${e._tag})`:""}: ${e.message}`}return`Error: ${JSON.stringify(e)}`},Vb=e=>e instanceof Error?[$b(e),e.stack?.split(`
`).filter(t=>!t.startsWith("Error")).join(`
`)]:[$b(e),void 0];var vk=e=>{let t=e.split(`
`),r=[];for(let o=0;o<t.length;o++){if(t[o].includes("EffectPrimitive")||t[o].includes("Generator.next")||t[o].includes("FiberRuntime"))return r.join(`
`);r.push(t[o])}return r.join(`
`)},uo=e=>{if(No(e))return"All fibers interrupted without errors.";let t=bp(e).map(r=>{let o=r.message;if(r.stack&&(o+=`\r
${vk(r.stack)}`),r.span){let n=r.span,s=0;for(;n&&n._tag==="Span"&&s<10;)o+=`\r
    at ${n.name}`,n=je(n.parent),s++}return o}).join(`\r
\r
`);return t.includes(`\r
`)?`\r
${t}\r
`:t},bp=e=>yp(e,void 0,{emptyCase:()=>[],dieCase:(t,r)=>{let o=Vb(r);return[{message:o[0],stack:o[1],span:void 0}]},failCase:(t,r)=>{let o=Vb(r);return[{message:o[0],stack:o[1],span:void 0}]},interruptCase:()=>[],parallelCase:(t,r,o)=>[...r,...o],sequentialCase:(t,r,o)=>[...r,...o],annotatedCase:(t,r,o)=>Tk(o)?r.map(n=>({...n,span:n.span??o.span})):r});var tS=uo;var Yi=255,rS=8,Sp=e=>e&Yi,Ep=e=>e>>rS&Yi,Sn=(e,t)=>(e&Yi)+((t&e&Yi)<<rS),_p=Sn(0,0),oS=e=>Sn(e,e),nS=e=>Sn(e,0);var sS=a(2,(e,t)=>Sn(Sp(e)&~t,Ep(e)));var Pm=a(2,(e,t)=>e|t);var iS=e=>~e>>>0&Yi;var cS=0,pr=1,Nm=2,Op=4,Ji=16,Cp=32;var Dm=e=>Qi(e,Cp);var Lm=a(2,(e,t)=>e|t);var kr=e=>Rs(e)&&!pS(e),Rs=e=>Qi(e,pr);var Qi=a(2,(e,t)=>(e&t)!==0),Rp=(...e)=>e.reduce((t,r)=>t|r,0),Hm=Rp(cS);var Zi=e=>Qi(e,Op);var pS=e=>Qi(e,Ji);var En=a(2,(e,t)=>Sn(e^t,t)),As=a(2,(e,t)=>e&(iS(Sp(t))|Ep(t))|Sp(t)&Ep(t));var qm=np({empty:_p,diff:(e,t)=>En(e,t),combine:(e,t)=>Pm(t)(e),patch:(e,t)=>As(t,e)});var Mp=_p;var Um=oS,Wm=nS;var jm=sS;var lS,fS,mS,hS={_tag:"Empty"},_n=(e,t)=>({_tag:"Par",left:e,right:t}),Tp=(e,t)=>({_tag:"Seq",left:e,right:t}),Bm=(e,t)=>({_tag:"Single",dataSource:e,blockedRequest:t});var dS=e=>{let t=zi(e),r=ar();for(;;){let[o,n]=Pb(t,[xS(),ar()],([s,i],c)=>{let[p,u]=Pk(c);return[gS(s,p),wb(i,u)]});if(r=Nk(r,o),ut(n))return Nb(r);t=n}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/query/issues")},Pk=e=>{let t=e,r=xS(),o=ar(),n=ar();for(;;)switch(t._tag){case"Empty":{if(ut(o))return[r,n];t=o.head,o=o.tail;break}case"Par":{o=ao(t.right,o),t=t.left;break}case"Seq":{let s=t.left,i=t.right;switch(s._tag){case"Empty":{t=i;break}case"Par":{let c=s.left,p=s.right;t=_n(Tp(c,i),Tp(p,i));break}case"Seq":{let c=s.left,p=s.right;t=Tp(c,Tp(p,i));break}case"Single":{t=s,n=ao(i,n);break}}break}case"Single":{if(r=gS(r,Uk(t.dataSource,t.blockedRequest)),ut(o))return[r,n];t=o.head,o=o.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/query/issues")},Nk=(e,t)=>{if(ut(e))return zi(zm(t));if(Wk(t))return e;let r=$k(e.head),o=jk(t);return r.length===1&&o.length===1&&O(r[0],o[0])?ao(Gk(e.head,zm(t)),e.tail):ao(zm(t),e)},Dk=Symbol.for("@effect/io/RequestBlock.Entry"),Km=class{constructor(t,r,o,n,s){this.request=t,this.result=r,this.listeners=o,this.ownerId=n,this.state=s,this[lS]=Lk}};lS=Dk;var Lk={_R:e=>e};var Gm=e=>new Km(e.request,e.result,e.listeners,e.ownerId,e.state),Hk=Symbol.for("@effect/io/RequestBlockParallel"),qk={_R:e=>e},Xi=class{constructor(t){this.map=t,this[fS]=qk}};fS=Hk;var xS=()=>new Xi(oo()),Uk=(e,t)=>new Xi(Uy([e,Array.of(t)])),gS=(e,t)=>new Xi(Uf(e.map,t.map,(r,o,n)=>Mr(r,n,De(Li(r,n),{onNone:()=>o,onSome:s=>[...s,...o]})))),Wk=e=>Wy(e.map),jk=e=>Array.from(qf(e.map)),zm=e=>Bk(zy(e.map,t=>Array.of(t)));var zk=Symbol.for("@effect/io/RequestBlockSequential"),Kk={_R:e=>e},vp=class{constructor(t){this.map=t,this[mS]=Kk}};mS=zk;var Bk=e=>new vp(e),Gk=(e,t)=>new vp(Uf(t.map,e.map,(r,o,n)=>Mr(r,n,De(Li(r,n),{onNone:()=>[],onSome:s=>[...s,...o]}))));var $k=e=>Array.from(qf(e.map)),yS=e=>Array.from(e.map);var On="Pending",ea="Done";var Vk="@effect/io/Deferred",ES=Symbol.for(Vk),_S={_E:e=>e,_A:e=>e},Ip=e=>({_tag:On,joiners:e}),$m=e=>({_tag:ea,effect:e});var Ms="Async",OS="Commit",fe="Failure",Ts="OnFailure",vs="OnSuccess",Is="OnSuccessAndFailure",me="Success",kp="Sync",CS="Tag",lo="UpdateRuntimeFlags",ks="While",wp="WithRuntime",ws="Yield",ta="RevertFlags";var Pp=class{constructor(){this.buckets=[]}scheduleTask(t,r){let o,n;for(n=0;n<this.buckets.length&&this.buckets[n][0]<=r;n++)o=this.buckets[n];if(o)o[1].push(t);else{let s=[];for(let i=0;i<n;i++)s.push(this.buckets[i]);s.push([r,[t]]);for(let i=n;i<this.buckets.length;i++)s.push(this.buckets[i]);this.buckets=s}}},Vm=class{constructor(t){this.maxNextTickBeforeTimer=t,this.running=!1,this.tasks=new Pp}starveInternal(t){let r=this.tasks.buckets;this.tasks.buckets=[];for(let[o,n]of r)for(let s=0;s<n.length;s++)n[s]();this.tasks.buckets.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=this.maxNextTickBeforeTimer?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}scheduleTask(t,r){this.tasks.scheduleTask(t,r),this.running||(this.running=!0,this.starve())}},Ym=z(Symbol.for("@effect/io/Scheduler/defaultScheduler"),()=>new Vm(2048)),Np=class{constructor(){this.tasks=new Pp,this.deferred=!1}scheduleTask(t,r){this.deferred?Ym.scheduleTask(t,r):this.tasks.scheduleTask(t,r)}flush(){for(;this.tasks.buckets.length>0;){let t=this.tasks.buckets;this.tasks.buckets=[];for(let[r,o]of t)for(let n=0;n<o.length;n++)o[n]()}this.deferred=!0}};var AS,MS,TS,vS,Jk="@effect/io/Effect/Error",Jm=Symbol.for(Jk),kS=e=>typeof e=="object"&&e!=null&&Jm in e,wS=e=>({[Jm]:Jm,_tag:"EffectError",cause:e}),he=(e,t)=>{let r=new Re("Blocked");return r.i0=e,r.i1=t,r},Up=e=>{let t=new Re("RunBlocked");return t.i0=e,t},Fs=Symbol.for("@effect/io/Effect"),Lp=class{constructor(t,r){this.patch=t,this.op=r,this._tag=ta}},Re=class{constructor(t){this._tag=t,this.i0=void 0,this.i1=void 0,this.i2=void 0,this.trace=void 0,this[AS]=Qm}[(AS=Fs,M)](t){return this===t}[A](){return Ro(this)}pipe(){return E(this,arguments)}},Hp=class{constructor(t){this._tag=t,this.i0=void 0,this.i1=void 0,this.i2=void 0,this.trace=void 0,this[MS]=Qm}[(MS=Fs,M)](t){return this===t}[A](){return Ro(this)}get cause(){return this.i0}pipe(){return E(this,arguments)}toJSON(){return{_tag:this._tag,cause:this.cause.toJSON()}}toString(){return tS(this.cause)}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}},qp=class{constructor(t){this._tag=t,this.i0=void 0,this.i1=void 0,this.i2=void 0,this.trace=void 0,this[TS]=Qm}[(TS=Fs,M)](t){return this===t}[A](){return Ro(this)}get value(){return this.i0}pipe(){return E(this,arguments)}toJSON(){return{_tag:this._tag,value:this.value}}toString(){return`Success: ${String(this.value)}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}},Qm={_R:e=>e,_E:e=>e,_A:e=>e},de=e=>typeof e=="object"&&e!=null&&Fs in e,ue=e=>{let t=new Re(wp);return t.i0=e,t},zt=a(3,(e,t,r)=>be(o=>l(e,n=>l(Z(T(()=>o(t(n)))),s=>T(()=>r(n,s)).pipe(Y({onFailure:i=>{switch(s._tag){case fe:return D(Fe(s.i0,i));case me:return D(i)}},onSuccess:()=>s})))))),V=a(2,(e,t)=>l(e,()=>h(t))),Q=e=>V(e,void 0),Kt=(e,t=et)=>T(()=>{let r,o,n=new Re(Ms);if(e.length!==1){let s=new AbortController;o=s,n.i0=i=>{r=e(i,s.signal)}}else n.i0=s=>{r=e(s)};return n.i1=t,Uo(n,()=>(o&&o.abort(),r??k))}),Pr=(e,t=et)=>Kt(r=>{let o=e(r);if(Or(o))r(o.right);else return o.left},t),Nr=a(2,(e,t)=>{let r=new Re(Ts);return r.i0=e,r.i1=t,r}),lt=a(2,(e,t)=>ie(e,{onFailure:t,onSuccess:h})),Do=e=>(...t)=>e(...t),FS=a(2,(e,t)=>Y(e,{onFailure:Do(r=>{let o=co(r);switch(o._tag){case"Left":return $(()=>D(r))(t(o.left));case"Right":return D(o.right)}}),onSuccess:h})),PS=e=>ue((t,r)=>e(Rs(r.runtimeFlags))),Zm=e=>D(Le(e)),Ps=e=>Hr(()=>Le(km(e))),Lo=e=>Hr(()=>Le(e())),Dr=e=>ie(e,{onFailure:t=>h(q(t)),onSuccess:t=>h(P(t))}),Lr=()=>T(()=>Ye(ho)),Ns=e=>l(Lr(),e),Z=e=>oa(e,{onFailure:K,onSuccess:X}),L=e=>D(yn(e)),ur=e=>Hr(()=>yn(e())),D=e=>{let t=new Hp(fe);return t.i0=e,t},Hr=e=>l(g(e),D),Ho=ue(e=>h(e.id())),Bt=e=>ue(t=>e(t.id())),l=a(2,(e,t)=>{let r=new Re(vs);return r.i0=e,r.i1=t,r}),wr=e=>{let t=new Re("OnStep");return t.i0=e,t.i1=X,t},Ds=(e,t)=>{let r=new Re("OnStep");return r.i0=e,r.i1=t,r},ft=e=>l(e,F),qo=e=>ie(e,{onFailure:h,onSuccess:L}),oa=a(2,(e,{onFailure:t,onSuccess:r})=>Y(e,{onFailure:o=>h(t(o)),onSuccess:o=>h(r(o))})),Y=a(2,(e,{onFailure:t,onSuccess:r})=>{let o=new Re(Is);return o.i0=e,o.i1=t,o.i2=r,o}),ie=a(2,(e,{onFailure:t,onSuccess:r})=>Y(e,{onFailure:o=>{let n=Bi(o);return gp(o).length>0?D(Zb(o)):n.length>0?t(pn(n)):D(o)},onSuccess:r})),He=a(2,(e,t)=>T(()=>{let r=J(e),o=new Array(r.length),n=0;return V(Tn({while:()=>n<r.length,body:()=>t(r[n],n),step:s=>{o[n++]=s}}),o)})),mt=a(2,(e,t)=>T(()=>{let r=J(e),o=0;return Tn({while:()=>o<r.length,body:()=>t(r[o],o),step:()=>{o++}})})),Wp=a(e=>typeof e[0]=="boolean"||de(e[0]),(e,{onFalse:t,onTrue:r})=>typeof e=="boolean"?e?r:t:l(e,Do(o=>o?r:t))),jp=l(Ho,e=>zp(e)),zp=e=>D(cr(e)),jt=e=>{let t=new Re(lo);t.i0=Um(pr);let r=o=>o._tag==="Blocked"?he(o.i0,jt(o.i1)):o;return t.i1=()=>Ds(e,r),t},NS=e=>{let t=new Re(lo);t.i0=Um(pr);let r=o=>o._tag==="Blocked"?he(o.i0,jt(o.i1)):o;return t.i1=o=>Rs(o)?wr(e(jt)):wr(e(Fr)),l(t,r)},qr=a(2,(e,t)=>be(r=>l(Z(r(e)),o=>xh(t,o)))),_=a(2,(e,t)=>l(e,r=>g(()=>t(r)))),Kp=a(2,(e,{onFailure:t,onSuccess:r})=>ie(e,{onFailure:o=>ur(()=>t(o)),onSuccess:o=>g(()=>r(o))})),fo=a(2,(e,t)=>Y(e,{onFailure:r=>{let o=co(r);switch(o._tag){case"Left":return ur(()=>t(o.left));case"Right":return D(o.right)}},onSuccess:h})),Bp=a(2,(e,t)=>lr(e,Do(r=>ou(r)?k:t(r.i0)))),lr=a(2,(e,t)=>be(r=>Y(r(e),{onFailure:o=>{let n=K(o);return Y(t(n),{onFailure:s=>K(Ce(o,s)),onSuccess:()=>n})},onSuccess:o=>{let n=X(o);return W(t(n),n)}}))),Uo=a(2,(e,t)=>lr(e,iu({onFailure:r=>No(r)?Q(t(Gi(r))):k,onSuccess:()=>k}))),Rn=a(2,(e,t)=>Qk(e,t,h)),An=e=>Xm(e,F),Xm=a(2,(e,t)=>ie(e,{onFailure:r=>Zm(t(r)),onSuccess:h})),DS=(e,t)=>J(e).reduceRight(([r,o],n)=>{let s=t(n);switch(s._tag){case"Left":return[[s.left,...r],o];case"Right":return[r,[s.right,...o]]}},[new Array,new Array]),Rt=a(2,(e,t)=>Ee(ho,t)(e)),LS=a(2,(e,t)=>qe(ho,r=>is(r,t))(e)),Mn=a(2,(e,t)=>Ns(r=>Rt(e,t(r)))),Gp=ue((e,t)=>h(t.runtimeFlags)),h=e=>{let t=new qp(me);return t.i0=e,t},T=e=>l(g(e),F),g=e=>{let t=new Re(kp);return t.i0=e,t},At=a(2,(e,t)=>l(e,r=>V(t(r),r))),$p=e=>ue(t=>{let r=t.getFiberRef(ra),o=$(()=>t.scope())(r);return e(Ee(ra,d(o)))}),Qk=a(3,(e,t,r)=>Y(e,{onFailure:o=>gp(o).length>0?D(jg(Qb(o))):t(),onSuccess:r})),Fr=e=>{let t=new Re(lo);t.i0=Wm(pr),t.i1=()=>Ds(e,r);let r=o=>o._tag==="Blocked"?he(o.i0,Fr(o.i1)):o;return t},be=e=>{let t=new Re(lo);t.i0=Wm(pr);let r=o=>o._tag==="Blocked"?he(o.i0,Fr(o.i1)):o;return t.i1=o=>Rs(o)?wr(e(jt)):wr(e(Fr)),l(t,r)},k=h(void 0),Ls=e=>{let t=new Re(lo);return t.i0=e,t.i1=void 0,t},Hs=a(2,(e,t)=>l(t,r=>r?_(d)(e):h(x()))),Tn=e=>{let t=new Re(ks);return t.i0=e.while,t.i1=e.body,t.i2=e.step,t},HS=a(2,(e,t)=>Ee(e,Xp,t)),qS=a(2,(e,t)=>Ee(e,ia,t)),US=a(2,(e,t)=>{let r=new Re(lo);return r.i0=t,r.i1=()=>e,r}),WS=a(2,(e,t)=>Ee(e,ca,t)),Mt=e=>{let t=new Re(ws);return typeof e?.priority<"u"?uh(e.priority)(t):t},Vp=a(2,(e,t)=>l(e,r=>_(t,o=>[r,o])));var qs=a(2,(e,t)=>l(e,r=>V(t,r))),W=a(2,(e,t)=>l(e,()=>t)),mo=a(3,(e,t,r)=>l(e,o=>_(t,n=>r(o,n)))),vn=Pr(()=>{let e=setInterval(()=>{},2147483647);return q(g(()=>clearInterval(e)))}),Wo=e=>l(Ho,t=>Gt(t)(e)),Gt=a(2,(e,t)=>l(e.interruptAsFork(t),()=>e.await())),eh={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return E(this,arguments)}},th={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return E(this,arguments)}},rh={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return E(this,arguments)}},oh={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return E(this,arguments)}},Yp={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return E(this,arguments)}},Jp={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return E(this,arguments)}},nh={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return E(this,arguments)}},sh={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return E(this,arguments)}},ih=[eh,nh,Jp,Yp,oh,rh,th,sh],Zk="@effect/io/FiberRef",Xk=Symbol.for(Zk),ew={_A:e=>e},Ye=e=>jS(e,t=>[t,t]);var Se=a(2,(e,t)=>l(Ye(e),t)),Cn=a(2,(e,t)=>jS(e,()=>[void 0,t]));var jS=a(2,(e,t)=>ue(r=>{let[o,n]=t(r.getFiberRef(e));return r.setFiberRef(e,n),h(o)}));var tw="@effect/io/RequestResolver",zS=Symbol.for(tw),rw={_R:e=>e,_A:e=>e},IS=class e{constructor(t,r){this.runAll=t,this.target=r,this[vS]=rw,this.runAll=t}[(vS=zS,A)](){return this.target?S(this.target):Ro(this)}[M](t){return this.target?ow(t)&&O(this.target,t.target):this===t}identified(...t){return new e(this.runAll,Tr(t))}pipe(){return E(this,arguments)}},ow=e=>typeof e=="object"&&e!=null&&zS in e;var Ee=a(3,(e,t,r)=>l(zt(qs(Ye(t),Cn(t,r)),()=>wr(e),o=>Cn(t,o)),o=>o._tag==="Blocked"?he(o.i0,Ee(o.i1,t,r)):o)),qe=a(3,(e,t,r)=>Se(t,o=>Ee(e,t,r(o)))),xe=(e,t)=>Us(e,{differ:vb(),fork:t?.fork??F,join:t?.join}),ah=e=>Us(e,{differ:Tb(),fork:op()}),Qp=e=>Us(e,{differ:Mb(),fork:ep()}),Us=(e,t)=>({[Xk]:ew,initial:e,diff:(r,o)=>Cb(r,o)(t.differ),combine:(r,o)=>Rb(r,o)(t.differ),patch:r=>o=>Ab(r,o)(t.differ),fork:t.fork,join:t.join??((r,o)=>o),pipe(){return E(this,arguments)}}),KS=e=>Us(e,{differ:qm,fork:Mp}),ho=Qp(Ht()),na=xe(0),ch=xe(2048),sa=z(Symbol.for("@effect/io/FiberRef/currentLogAnnotation"),()=>xe(oo())),ph=xe(Yp),Zp=z(Symbol.for("@effect/io/FiberRef/currentLogSpan"),()=>xe(ar())),xo=z(Symbol.for("@effect/io/FiberRef/currentScheduler"),()=>xe(Ym)),BS=a(2,(e,t)=>Ee(e,xo,t)),uh=a(2,(e,t)=>Ee(e,na,t)),GS=a(2,(e,t)=>Ee(e,ch,t)),Xp=z(Symbol.for("@effect/io/FiberRef/currentConcurrency"),()=>xe("unbounded")),ia=z(Symbol.for("@effect/io/FiberRef/currentRequestBatching"),()=>xe(!0)),aa=z(Symbol.for("@effect/io/FiberRef/currentUnhandledErrorLogLevel"),()=>xe(d(Jp))),$S=a(2,(e,t)=>Ee(e,aa,t)),go=ah($e()),VS=Ye(go),ra=z(Symbol.for("@effect/io/FiberRef/currentForkScopeOverride"),()=>xe(x(),{fork:()=>x(),join:(e,t)=>e})),In=z(Symbol.for("@effect/io/FiberRef/currentInterruptedCause"),()=>xe(tt,{fork:()=>tt,join:(e,t)=>e})),yo=z(Symbol.for("@effect/io/FiberRef/currentTracerSpan"),()=>xe(ar())),ca=z(Symbol.for("@effect/io/FiberRef/currentTracerTiming"),()=>xe(!0)),eu=z(Symbol.for("@effect/io/FiberRef/currentTracerSpanAnnotations"),()=>xe(oo())),tu=z(Symbol.for("@effect/io/FiberRef/currentTracerSpanLinks"),()=>xe(Xe())),ru=Symbol.for("@effect/io/Scope"),lh=Symbol.for("@effect/io/CloseableScope");var Ws=(e,t)=>e.addFinalizer(t),jo=(e,t)=>e.close(t),fh=(e,t)=>e.fork(t),mh=a(2,(e,t)=>_(sw(e,t),De({onNone:()=>()=>k,onSome:r=>o=>nw(r,o)(e)}))),nw=a(3,(e,t,r)=>T(()=>{switch(e.state._tag){case"Exited":return k;case"Running":{let o=e.state.finalizers.get(t);return e.state.finalizers.delete(t),o!=null?e.state.update(o)(r):k}}})),sw=a(2,(e,t)=>T(()=>{switch(e.state._tag){case"Exited":return e.state.nextKey+=1,V(t(e.state.exit),x());case"Running":{let r=e.state.nextKey;return e.state.finalizers.set(r,t),e.state.nextKey+=1,h(d(r))}}}));var YS=g(()=>({state:{_tag:"Running",nextKey:0,finalizers:new Map,update:F}}));var hh=e=>e._tag==="Failure",ou=e=>e._tag==="Success";var JS=a(2,(e,t)=>{switch(e._tag){case fe:return K(e.i0);case me:return X(t)}}),pa=e=>JS(e,void 0);var js=(e,t)=>iw(e,t?.parallel?Fe:Ce),nu=e=>K(Le(e));var fr=e=>K(yn(e)),K=e=>{let t=new Hp(fe);return t.i0=e,t},QS=a(2,(e,t)=>{switch(e._tag){case fe:return K(e.i0);case me:return t(e.i0)}});var ZS=e=>QS(F)(e);var su=e=>K(cr(e)),Dp=a(2,(e,t)=>{switch(e._tag){case fe:return K(e.i0);case me:return X(t(e.i0))}});var iu=a(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case fe:return t(e.i0);case me:return r(e.i0)}}),kn=a(2,(e,{onFailure:t,onSuccess:r})=>{switch(e._tag){case fe:return t(e.i0);case me:return r(e.i0)}}),X=e=>{let t=new qp(me);return t.i0=e,t};var Ur=X(void 0);var ua=a(3,(e,t,{onFailure:r,onSuccess:o})=>{switch(e._tag){case fe:switch(t._tag){case me:return K(e.i0);case fe:return K(r(e.i0,t.i0))}case me:switch(t._tag){case me:return X(o(e.i0,t.i0));case fe:return K(t.i0)}}}),iw=(e,t)=>{let r=Tr(e);return Ke(r)?d(Dp(o=>Array.from(o))(Dp(no)(it(Dp(Oe)(Be(r)),(o,n)=>ua(n,{onSuccess:(s,i)=>Te(i)(s),onFailure:t})(o))(Ge(r))))):x()},zs=e=>({[ES]:_S,state:at(Ip([])),blockingOn:e,pipe(){return E(this,arguments)}}),rt=()=>l(Ho,e=>XS(e)),XS=e=>g(()=>zs(e)),ve=e=>Pr(t=>{let r=_t(e.state);switch(r._tag){case ea:return P(r.effect);case On:return Ut(Ip([t,...r.joiners]))(e.state),q(aw(e,t))}},e.blockingOn),dh=a(2,(e,t)=>qr(t,e)),Ks=a(2,(e,t)=>g(()=>{let r=_t(e.state);switch(r._tag){case ea:return!1;case On:{Ut($m(t))(e.state);for(let o=0;o<r.joiners.length;o++)r.joiners[o](t);return!0}}})),xh=a(2,(e,t)=>Ks(e,t)),la=a(2,(e,t)=>Ks(e,L(t)));var wn=a(2,(e,t)=>Ks(e,D(t)));var eE=e=>l(Ho,t=>Ks(e,zp(t)));var Bs=a(2,(e,t)=>Ks(e,h(t)));var Gs=(e,t)=>{let r=_t(e.state);if(r._tag===On){Ut($m(t))(e.state);for(let o=r.joiners.length-1;o>=0;o--)r.joiners[o](t)}},aw=(e,t)=>g(()=>{let r=_t(e.state);r._tag===On&&Ut(Ip(r.joiners.filter(o=>o!==t)))(e.state)});var Fn=ve;var tE=xh;var rE=eE;var gh=zs;var nE=ZS;var sE=X;var pE,cw="@effect/io/Clock",bh=Symbol.for(cw),Wr=St(bh),pw=2**31-1,aE={unsafeSchedule(e,t){let r=Rr(t);if(r>pw)return Pt;let o=!1,n=setTimeout(()=>{o=!0,e()},r);return()=>(clearTimeout(n),!o)}},cE=function(){let e=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*e;let t="timeOrigin"in performance&&typeof performance.timeOrigin=="number"?BigInt(Math.round(performance.timeOrigin*1e6)):BigInt(Date.now())*e;return()=>t+BigInt(Math.round(performance.now()*1e6))}(),uw=function(){let e=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!e)return cE;let t=cE()-e.bigint();return()=>t+e.bigint()}(),yh=class{constructor(){this[pE]=bh,this.currentTimeMillis=g(()=>this.unsafeCurrentTimeMillis()),this.currentTimeNanos=g(()=>this.unsafeCurrentTimeNanos())}unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return uw()}scheduler(){return h(aE)}sleep(t){return Pr(r=>{let o=aE.unsafeSchedule(()=>r(k),t);return q(Q(g(o)))})}};pE=bh;var uE=()=>new yh;var au="And",cu="Or",pu="InvalidData",uu="MissingData",lu="SourceUnavailable",fu="Unsupported";var fw="@effect/io/Config/Error",Sh=Symbol.for(fw),$s={[Sh]:Sh},mu=(e,t)=>{let r=Object.create($s);return r._tag=au,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),r},hu=(e,t)=>{let r=Object.create($s);return r._tag=cu,r.left=e,r.right=t,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),r},jr=(e,t,r={pathDelim:"."})=>{let o=Object.create($s);return o._tag=pu,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Invalid data at ${Xr(r.pathDelim)(this.path)}: "${this.message}")`}}),o},mr=(e,t,r={pathDelim:"."})=>{let o=Object.create($s);return o._tag=uu,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Missing data at ${Xr(r.pathDelim)(this.path)}: "${this.message}")`}}),o},fE=(e,t,r,o={pathDelim:"."})=>{let n=Object.create($s);return n._tag=lu,n.path=e,n.message=t,n.cause=r,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Source unavailable at ${Xr(o.pathDelim)(this.path)}: "${this.message}")`}}),n},du=(e,t,r={pathDelim:"."})=>{let o=Object.create($s);return o._tag=fu,o.path=e,o.message=t,Object.defineProperty(o,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${Xr(r.pathDelim)(this.path)}: "${this.message}")`}}),o};var bo=a(2,(e,t)=>{switch(e._tag){case au:return mu(bo(t)(e.left),bo(t)(e.right));case cu:return hu(bo(t)(e.left),bo(t)(e.right));case pu:return jr([...t,...e.path],e.message);case uu:return mr([...t,...e.path],e.message);case lu:return fE([...t,...e.path],e.message,e.cause);case fu:return du([...t,...e.path],e.message)}}),mw={andCase:(e,t,r)=>t&&r,orCase:(e,t,r)=>t&&r,invalidDataCase:Pt,missingDataCase:_r,sourceUnavailableCase:Pt,unsupportedCase:Pt},mE=a(3,(e,t,r)=>{let o=[e],n=[];for(;o.length>0;){let i=o.pop();switch(i._tag){case au:{o.push(i.right),o.push(i.left),n.push(q({_tag:"AndCase"}));break}case cu:{o.push(i.right),o.push(i.left),n.push(q({_tag:"OrCase"}));break}case pu:{n.push(P(r.invalidDataCase(t,i.path,i.message)));break}case uu:{n.push(P(r.missingDataCase(t,i.path,i.message)));break}case lu:{n.push(P(r.sourceUnavailableCase(t,i.path,i.message,i.cause)));break}case fu:{n.push(P(r.unsupportedCase(t,i.path,i.message)));break}}}let s=[];for(;n.length>0;){let i=n.pop();switch(i._tag){case"Left":{switch(i.left._tag){case"AndCase":{let c=s.pop(),p=s.pop(),u=r.andCase(t,c,p);s.push(u);break}case"OrCase":{let c=s.pop(),p=s.pop(),u=r.orCase(t,c,p);s.push(u);break}}break}case"Right":{s.push(i.right);break}}}if(s.length===0)throw new Error("BUG: ConfigError.reduceWithContext - please report an issue at https://github.com/Effect-TS/io/issues");return s.pop()}),hE=e=>mE(e,void 0,mw);var Eh=hE;var dE="@effect/io/Config/Secret",_h=Symbol.for(dE),dw={[_h]:_h,[A](){return I(Qr(this.raw))(S(dE))},[M](e){return xw(e)&&this.raw.length===e.raw.length&&this.raw.every((t,r)=>O(t,e.raw[r]))}},xw=e=>typeof e=="object"&&e!=null&&_h in e,gw=e=>{let t=Object.create(dw);return Object.defineProperty(t,"toString",{enumerable:!1,value(){return"ConfigSecret(<redacted>)"}}),Object.defineProperty(t,"raw",{enumerable:!1,value:e}),t};var xE=e=>gw(e.split("").map(t=>t.charCodeAt(0)));var gu="Constant",yu="Fail",fa="Fallback",bu="Described",Su="Lazy",Eu="MapOrFail",_u="Nested",Ou="Primitive",Cu="Sequence",Ru="HashMap",Au="ZipWith";var bw="@effect/io/Config",Tu=Symbol.for(bw),Sw={_A:e=>e},$t={[Tu]:Sw,pipe(){return E(this,arguments)}},bE=e=>{let t=zo("a boolean property",r=>{switch(r){case"true":case"yes":case"on":case"1":return P(!0);case"false":case"no":case"off":case"0":return P(!1);default:{let o=jr([],`Expected a boolean value, but received ${r}`);return q(o)}}});return e===void 0?t:Vt(e)(t)},SE=(e,t)=>So(Ze)(vu(e,t)),vu=(e,t)=>So(t===void 0?Mu(e):Vt(t)(Mu(e)),Ot),EE=e=>{let t=zo("a date property",r=>{let o=Date.parse(r);return Number.isNaN(o)?q(jr([],`Expected a date value but received ${r}`)):P(new Date(o))});return e===void 0?t:Vt(e)(t)},_E=e=>{let t=Object.create($t);return t._tag=yu,t.message=e,t.parse=()=>q(du([],e)),t},OE=e=>{let t=zo("a number property",r=>{let o=Number.parseFloat(r);return Number.isNaN(o)?q(jr([],`Expected an number value but received ${r}`)):P(o)});return e===void 0?t:Vt(e)(t)},CE=e=>{let t=zo("an integer property",r=>{let o=Number.parseInt(r,10);return Number.isNaN(o)?q(jr([],`Expected an integer value but received ${r}`)):P(o)});return e===void 0?t:Vt(e)(t)},RE=e=>{let t=Vs(Oh(),r=>{let o=r.toUpperCase(),n=ih.find(s=>s.label===o);return n===void 0?q(jr([],`Expected a log level, but found: ${r}`)):P(n)});return e===void 0?t:Vt(t,e)},So=a(2,(e,t)=>Vs(e,r=>P(t(r)))),AE=a(2,(e,t)=>Vs(e,r=>{try{return P(t(r))}catch(o){return q(jr([],o instanceof Error?o.message:`${o}`))}})),Vs=a(2,(e,t)=>{let r=Object.create($t);return r._tag=Eu,r.original=e,r.mapOrFail=t,r}),ME=e=>t=>mr([],`Expected ${t.description} with name ${e}`),Vt=a(2,(e,t)=>{let r=Object.create($t);return r._tag=_u,r.name=t,r.config=e,r}),TE=a(2,(e,t)=>{let r=Object.create($t);return r._tag=fa,r.first=e,r.second=ma(t),r.condition=_r,r}),Iu=a(2,(e,t)=>{let r=Object.create($t);return r._tag=fa,r.first=e,r.second=ma(t.orElse),r.condition=t.if,r}),vE=e=>Iu({orElse:()=>Ys(x()),if:Eh})(So(d)(e)),zo=(e,t)=>{let r=Object.create($t);return r._tag=Ou,r.description=e,r.parse=t,r},Mu=e=>{let t=Object.create($t);return t._tag=Cu,t.config=e,t},IE=e=>{let t=zo("a secret property",r=>P(xE(r)));return e===void 0?t:Vt(e)(t)},kE=(e,t)=>{let r=So(vu(e),pt);return t===void 0?r:Vt(t)(r)},Oh=e=>{let t=zo("a text property",P);return e===void 0?t:Vt(e)(t)},wE=e=>Array.isArray(e)?yE(e):Symbol.iterator in e?yE([...e]):FE(e),FE=e=>{let t=Object.entries(e),r=So(n=>({[t[0][0]]:n}))(t[0][1]);if(t.length===1)return r;let o=t.slice(1);for(let[n,s]of o)r=ha(s,(i,c)=>({...i,[n]:c}))(r);return r},Ys=e=>{let t=Object.create($t);return t._tag=gu,t.value=e,t.parse=()=>P(e),t},ma=e=>{let t=Object.create($t);return t._tag=Su,t.config=e,t},PE=e=>ma(()=>Ys(e())),NE=(e,t)=>{let r=Object.create($t);return r._tag=Ru,r.valueConfig=e,t===void 0?r:Vt(t)(r)},Ch=e=>typeof e=="object"&&e!=null&&Tu in e,yE=e=>{if(e.length===0)return Ys([]);if(e.length===1)return So(e[0],r=>[r]);let t=So(e[0],r=>[r]);for(let r=1;r<e.length;r++){let o=e[r];t=ha(o,(n,s)=>[...n,s])(t)}return t},Rh=e=>Ch(e)?e:FE(Object.fromEntries(Object.entries(e).map(([t,r])=>[t,Rh(r)]))),DE=a(2,(e,{message:t,validation:r})=>Vs(e,o=>r(o)?P(o):q(jr([],t)))),LE=a(2,(e,t)=>Iu(e,{orElse:()=>Ys(t),if:Eh})),HE=a(2,(e,t)=>{let r=Object.create($t);return r._tag=bu,r.config=e,r.description=t,r}),qE=a(2,(e,t)=>ha(e,t,(r,o)=>[r,o])),ha=a(3,(e,t,r)=>{let o=Object.create($t);return o._tag=Au,o.left=e,o.right=t,o.zip=r,o});var WE={_tag:"Empty"};var ku=a(2,(e,t)=>{let r=zi(t),o=e;for(;ji(r);){let n=r.head;switch(n._tag){case"Empty":{r=r.tail;break}case"AndThen":{r=ao(n.first,ao(n.second,r.tail));break}case"MapName":{o=Zr(o,n.f),r=r.tail;break}case"Nested":{o=rr(o,n.name),r=r.tail;break}case"Unnested":{if(Kg(n.name)(kc(o)))o=Lt(o),r=r.tail;else return q(mr(o,`Expected ${n.name} to be in path in ConfigProvider#unnested`));break}}}return P(o)});var wu=(e,t)=>[...e,...t],_w="@effect/io/Config/Provider",Ah=Symbol.for(_w),Js=St(Ah),Ow="@effect/io/Config/Provider/Flat",jE=Symbol.for(Ow),Cw=e=>({[Ah]:Ah,pipe(){return E(this,arguments)},...e}),Rw=e=>({[jE]:jE,patch:e.patch,load:(t,r,o=!0)=>e.load(t,r,o),enumerateChildren:e.enumerateChildren}),Aw=e=>Cw({load:t=>l(Yt(e,Xo(),t,!1),r=>De(kc(r),{onNone:()=>L(mr(Xo(),`Expected a single value having structure: ${t}`)),onSome:h})),flattened:e}),zE=(e={})=>{let{pathDelim:t,seqDelim:r}=Object.assign({},{pathDelim:"_",seqDelim:","},e),o=p=>Xr(t)(p),n=p=>p.split(t),s=()=>typeof process<"u"&&"env"in process&&typeof process.env=="object"?process.env:{};return Aw(Rw({load:(p,u,f=!0)=>{let m=o(p),y=s(),b=m in y?d(y[m]):x();return l(C=>Iw(C,p,u,r,f))(fo(()=>mr(p,`Expected ${m} to exist in the process context`))(b))},enumerateChildren:p=>g(()=>{let u=s(),f=Object.keys(u),y=Array.from(f).map(b=>n(b.toUpperCase())).filter(b=>{for(let C=0;C<p.length;C++){let R=xf(C)(p),v=b[C];if(v===void 0||R!==v)return!1}return!0}).flatMap(b=>b.slice(p.length,p.length+1));return pt(y)}),patch:WE}))};var Mw=(e,t,r,o)=>{let n=bf(r.length,p=>p>=o.length?x():d([e(p),p+1])),s=bf(o.length,p=>p>=r.length?x():d([t(p),p+1])),i=wu(r,n),c=wu(o,s);return[i,c]},Yt=(e,t,r,o)=>{let n=r;switch(n._tag){case gu:return h(bt(n.value));case bu:return T(()=>Yt(e,t,n.config,o));case yu:return L(mr(t,n.message));case fa:return lt(s=>n.condition(s)?lt(i=>L(hu(s,i)))(Yt(e,t,n.second,o)):L(s))(T(()=>Yt(e,t,n.first,o)));case Su:return T(()=>Yt(e,t,n.config(),o));case Eu:return T(()=>l(He(s=>fo(bo(t))(n.mapOrFail(s))))(Yt(e,t,n.original,o)));case _u:return T(()=>Yt(e,wu(t,bt(n.name)),n.config,o));case Ou:return l(s=>l(i=>{if(i.length===0){let c=$(()=>"<n/a>")($g(s));return L(ME(c))}return h(i)})(e.load(s,n,o)))(ku(t,e.patch));case Cu:return l(s=>l(i=>i.length===0?T(()=>_(Yt(e,s,n.config,!0),bt)):_(c=>{let p=Fc(c);return p.length===0?bt(Xo()):bt(p)})(He(i,c=>Yt(e,Bg(t,`[${c}]`),n.config,!0))))(l(Fw)(e.enumerateChildren(s))))(ku(t,e.patch));case Ru:return T(()=>l(s=>l(i=>_(c=>{if(c.length===0)return bt(oo());let p=c.map(u=>Array.from(u));return Zr(u=>Vc(yf(J(i),u)))(kw(p))})(He(c=>Yt(e,wu(s,bt(c)),n.valueConfig,o))(i)))(e.enumerateChildren(s)))(ku(t,e.patch)));case Au:return T(()=>l(s=>l(i=>{if(Ae(s)&&Ae(i))return L(mu(s.left,i.left));if(Ae(s)&&Or(i))return L(s.left);if(Or(s)&&Ae(i))return L(i.left);if(Or(s)&&Or(i)){let c=Xr(".")(t),p=Tw(t,c),[u,f]=Mw(p,p,Zr(P)(s.right),Zr(P)(i.right));return He(([m,y])=>_(([b,C])=>n.zip(b,C))(Vp(m,y)))(yf(f)(u))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/io/issues")})(Dr(Yt(e,t,n.right,o))))(Dr(Yt(e,t,n.left,o))))}},Tw=(e,t)=>r=>q(mr(e,`The element at index ${r} in a sequence at path "${t}" was missing`));var vw=(e,t)=>e.split(new RegExp(`\\s*${ww(t)}\\s*`)),Iw=(e,t,r,o,n)=>n?fo(bo(t))(He(s=>r.parse(s.trim()))(vw(e,o))):fo(bo(t))(_(bt)(r.parse(e))),kw=e=>Object.keys(e[0]).map(t=>e.map(r=>r[t])),ww=e=>e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&"),Fw=e=>_(Tc)(Dr(Kp({onFailure:()=>Xo(),onSuccess:Zo(yt)})(He(e,Nw))));var Pw=/^(\[(\d+)\])$/,Nw=e=>{let t=e.match(Pw);if(t!==null){let r=t[2];return ns(Dw)(r!==void 0&&r.length>0?d(r):x())}return x()};var Dw=e=>{let t=Number.parseInt(e);return Number.isNaN(t)?x():d(t)};var Mh=Symbol("@effect/io/Console"),KE=St(Mh),BE={[Mh]:Mh,assert(e,...t){return g(()=>{console.assert(e,...t)})},clear:g(()=>{console.clear()}),count(e){return g(()=>{console.count(e)})},countReset(e){return g(()=>{console.countReset(e)})},debug(...e){return g(()=>{console.debug(...e)})},dir(e,t){return g(()=>{console.dir(e,t)})},dirxml(...e){return g(()=>{console.dirxml(...e)})},error(...e){return g(()=>{console.error(...e)})},group(e){return e?.collapsed?g(()=>console.groupCollapsed(e?.label)):g(()=>console.group(e?.label))},groupEnd:g(()=>{console.groupEnd()}),info(...e){return g(()=>{console.info(...e)})},log(...e){return g(()=>{console.log(...e)})},table(e,t){return g(()=>{console.table(e,t)})},time(e){return g(()=>console.time(e))},timeEnd(e){return g(()=>console.timeEnd(e))},timeLog(e,...t){return g(()=>{console.timeLog(e,...t)})},trace(...e){return g(()=>{console.trace(...e)})},warn(...e){return g(()=>{console.warn(...e)})},withGroup(e,t){return zt(t?.collapsed?g(()=>console.groupCollapsed(t?.label)):g(()=>console.group(t?.label)),()=>e,()=>g(()=>console.groupEnd()))},withTime(e,t){return zt(g(()=>console.time(t)),()=>e,()=>g(()=>console.timeEnd(t)))}};var GE,qw="@effect/io/Random",vh=Symbol.for(qw),Ih=St(vh),Th=class{constructor(t){this.seed=t,this[GE]=vh,this.PRNG=new ts(t)}next(){return g(()=>this.PRNG.number())}nextBoolean(){return _(this.next(),t=>t>.5)}nextInt(){return g(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(t,r){return _(this.next(),o=>(r-t)*o+t)}nextIntBetween(t,r){return g(()=>this.PRNG.integer(r-t)+t)}shuffle(t){return Uw(t,r=>this.nextIntBetween(0,r+1))}};GE=vh;var Uw=(e,t)=>T(()=>l(r=>{let o=[];for(let n=r.length;n>=2;n=n-1)o.push(n);return V(Tr(r))(mt(n=>_(s=>Ww(r,n-1,s))(t(n)))(o))})(g(()=>Array.from(e)))),Ww=(e,t,r)=>{let o=e[t];return e[t]=e[r],e[r]=o,e},$E=e=>new Th(e);var VE=Symbol.for("@effect/io/Tracer"),zw=e=>({[VE]:VE,...e}),Qs=St(Symbol.for("@effect/io/Tracer")),Kw=z("@effect/io/Tracer/SpanId.ids",()=>at(0)),kh=class{constructor(t,r,o,n,s){this.name=t,this.parent=r,this.context=o,this.links=n,this.startTime=s,this._tag="Span",this.traceId="native",this.events=[],this.end=(i,c)=>{this.status={_tag:"Ended",endTime:i,exit:c,startTime:this.status.startTime}},this.attribute=(i,c)=>{this.attributes.set(i,c)},this.event=(i,c,p)=>{this.events.push([i,c,p??{}])},this.status={_tag:"Started",startTime:s},this.attributes=new Map,this.spanId=`span${By(Kw)}`}},YE=zw({span:(e,t,r,o,n)=>new kh(e,t,r,o,n)});var Bw=we(Qs,YE)(we(Js,zE())(we(Ih,$E(Math.random()*4294967296>>>0))(we(KE,BE)(we(Wr,uE())(Ht()))))),ot=Qp(Bw),QE=e=>{let t=ze(e);return da(r=>r.sleep(t))},da=e=>Se(ot,t=>e(to(t,Wr))),ZE=da(e=>e.currentTimeMillis),XE=da(e=>e.currentTimeNanos),e_=a(2,(e,t)=>qe(ot,we(Wr,t))(e)),t_=a(2,(e,t)=>qe(ot,we(Js,t))(e)),wh=e=>Se(ot,t=>e(to(t,Js))),r_=e=>wh(t=>t.load(e));var Fu=e=>Se(ot,t=>e(to(t,Ih)));var Pu=e=>Se(ot,t=>e(to(t,Qs))),o_=a(2,(e,t)=>qe(ot,we(Qs,t))(e));var Fh=QE,Nu=ZE,Ph=XE,n_=da;var i_;function a_(e){return new Pn(e)}var Nh=Symbol.for("@effect/io/FiberRefs"),Pn=class{constructor(t){this.locals=t,this[i_]=Nh}pipe(){return E(this,arguments)}};i_=Nh;var Gw=(e,t,r,o=!1)=>{let n=e,s=t,i=r,c=o,p;for(;p===void 0;)if(Cr(s)&&Cr(i)){let u=_e(s)[0],f=Lt(s),m=_e(i)[0],y=_e(i)[1],b=Lt(i);u.startTimeMillis<m.startTimeMillis?(i=b,c=!0):u.startTimeMillis>m.startTimeMillis?s=f:u.id<m.id?(i=b,c=!0):u.id>m.id?s=f:p=[y,c]}else p=[n.initial,!0];return p},Du=a(3,(e,t,r)=>{let o=new Map(e.locals);for(let[n,s]of r.locals){let i=_e(s)[1];if(!O(_e(s)[0],t)){if(!o.has(n)){if(O(i,n.initial))continue;o.set(n,[[t,n.join(n.initial,i)]]);continue}let c=o.get(n),[p,u]=Gw(n,c,s);if(u){let f=n.diff(p,i),m=_e(c)[1],y=n.join(m,n.patch(f)(m));if(!O(m,y)){let b,C=_e(c)[0];O(C,t)?b=rr([C,y])(Lt(c)):b=rr([t,y])(c),o.set(n,b)}}}}return new Pn(new Map(o))}),Lu=a(2,(e,t)=>{let r=new Map;for(let[o,n]of e.locals.entries()){let s=_e(n)[1],i=o.patch(o.fork)(s);O(s,i)?r.set(o,n):r.set(o,rr([t,i])(n))}return new Pn(r)}),c_=e=>pt(e.locals.keys()),p_=e=>mt(c_(e),t=>Cn(t,Zs(e,t))),ga=a(2,(e,t)=>{let r=new Map(e.locals);return r.delete(t),new Pn(r)}),ya=a(2,(e,t)=>e.locals.has(t)?d(_e(e.locals.get(t))[1]):x()),Zs=a(2,(e,t)=>$(()=>t.initial)(ya(e,t))),Nn=a(2,(e,{fiberId:t,fiberRef:r,value:o})=>{let n=e.locals.has(r)?e.locals.get(r):Xo(),s;if(df(n))s=bt([t,o]);else{let[c,p]=_e(n);if(O(c,t)){if(O(p,o))return e;s=rr([t,o])(Lt(n))}else s=rr([t,o])(n)}let i=new Map(e.locals);return new Pn(i.set(r,s))});var u_=Lu;var l_=Du,f_=p_,Lh=Nn,m_=a_;var d_="Empty",x_="Add",g_="Remove",y_="Update",b_="AndThen",S_={_tag:d_},qu=(e,t)=>{let r=new Map(e.locals),o=S_;for(let[n,s]of t.locals.entries()){let i=_e(s)[1],c=r.get(n);if(c!==void 0){let p=_e(c)[1];O(p,i)||(o=Hu({_tag:y_,fiberRef:n,patch:n.diff(p,i)})(o))}else o=Hu({_tag:x_,fiberRef:n,value:i})(o);r.delete(n)}for(let[n]of r.entries())o=Hu({_tag:g_,fiberRef:n})(o);return o},Hu=a(2,(e,t)=>({_tag:b_,first:e,second:t})),Uu=a(3,(e,t,r)=>{let o=r,n=bt(e);for(;Cr(n);){let s=_e(n),i=Lt(n);switch(s._tag){case d_:{n=i;break}case x_:{o=Nn(o,{fiberId:t,fiberRef:s.fiberRef,value:s.value}),n=i;break}case g_:{o=ga(o,s.fiberRef),n=i;break}case y_:{let c=Zs(o,s.fiberRef);o=Nn(o,{fiberId:t,fiberRef:s.fiberRef,value:s.fiberRef.patch(s.patch)(c)}),n=i;break}case b_:{n=rr(s.first)(rr(s.second)(i));break}}}return o});var __,O_="@effect/io/Metric/Label",Hh=Symbol.for(O_),qh=class{constructor(t,r){this.key=t,this.value=r,this[__]=Hh}[(__=Hh,A)](){return I(S(this.value))(I(S(this.key))(S(O_)))}[M](t){return $w(t)&&this.key===t.key&&this.value===t.value}pipe(){return E(this,arguments)}},Wu=(e,t)=>new qh(e,t),$w=e=>typeof e=="object"&&e!=null&&Hh in e;var ju=class e{constructor(t){this.self=t,this.called=!1}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new e(this.self)}};var Yw=eh,Uh=th,Wh=rh,jh=oh,zh=Yp,Kh=Jp,Bh=nh,Jw=sh;var Qw=Ri(e=>e.ordinal)(yt);var R_=Zl(Qw);var A_=e=>{switch(e){case"All":return Yw;case"Debug":return Kh;case"Error":return Wh;case"Fatal":return Uh;case"Info":return zh;case"Trace":return Bh;case"None":return Jw;case"Warning":return jh}};var T_=(e,t)=>({label:e,startTime:t}),v_=e=>t=>`${t.label.replace(/[\s="]/g,"_")}=${e-t.startTime}ms`;var I_=T_,k_=v_;var F_,zu=Symbol.for("@effect/io/Ref"),$h={_A:e=>e},Gh=class{constructor(t){this.ref=t,this[F_]=$h}modify(t){return g(()=>{let r=_t(this.ref),[o,n]=t(r);return r!==n&&Ut(n)(this.ref),o})}pipe(){return E(this,arguments)}};F_=zu;var Ku=e=>new Gh(at(e)),Dn=e=>g(()=>Ku(e)),hr=e=>e.modify(t=>[t,t]),zr=a(2,(e,t)=>e.modify(()=>[void 0,t])),P_=a(2,(e,t)=>e.modify(r=>[r,t]));var Bu=a(2,(e,t)=>e.modify(t));var ba=a(2,(e,t)=>e.modify(r=>[void 0,t(r)]));var Sa=Dn,$u=hr,N_=P_;var D_=Bu;var L_=ba;var q_=Pu;var U_=a(e=>de(e[0]),function(){let e=arguments;return qe(e[0],sa,typeof e[1]=="string"?Mr(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[o,n])=>Mr(r,o,n),t))}),Vu=e=>_(e,d),W_=e=>fo(e,d),j_=(e,t=et)=>Pr(r=>{let o=e(r);switch(o._tag){case"None":return q(k);case"Some":return P(o.value)}},t),Ea=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),g(()=>{try{return t()}catch(o){throw wS(yn(r?r(o):o))}})},z_=a(3,(e,t,r)=>lt(e,o=>typeof o=="object"&&o!=null&&t in o&&o[t]===r.failure?r.onFailure(o):L(o))),K_=a(2,(e,t)=>Nr(e,Do(r=>{let o=$i(r,n=>xp(n)?d(n):x());switch(o._tag){case"None":return D(r);case"Some":return t(o.value.defect)}}))),B_=a(2,(e,t)=>Y(e,{onFailure:r=>{let o=t(r);switch(o._tag){case"None":return D(r);case"Some":return o.value}},onSuccess:h})),G_=a(2,(e,t)=>Nr(e,Do(r=>{let o=$i(r,n=>xp(n)?d(n):x());switch(o._tag){case"None":return D(r);case"Some":{let n=t(o.value.defect);return n._tag==="Some"?n.value:D(r)}}}))),$_=a(3,(e,t,r)=>lt(e,o=>pe(o)&&"_tag"in o&&o._tag===t?r(o):L(o))),V_=a(2,(e,t)=>lt(e,r=>{let o=Object.keys(t);return pe(r)&&"_tag"in r&&o.includes(r._tag)?t[r._tag](r):L(r)})),Y_=e=>oa(e,{onFailure:F,onSuccess:()=>tt}),Kr=n_,J_=Kr(h),Q_=a(2,(e,t)=>W(Fh(t),e)),Yu=e=>ue((t,r)=>e({id:t.id(),status:r,interruptors:Gi(t.getFiberRef(In))})),Z_=Yu(e=>io(e.interruptors)>0?jp:k),X_=Yu(h),Ln=e=>Ju(e,Jh,qu),eO=h({}),tO=a(3,(e,t,r)=>l(e,o=>_(r(o),n=>({...o,[t]:n})))),rO=a(2,(e,t)=>_(e,r=>({[t]:r}))),oO=a(3,(e,t,r)=>_(e,o=>({...o,[t]:r(o)}))),nO=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!1),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>u?(o.push(c),h(!0)):t(c,p))}return _(s,()=>o)})),sO=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!0),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>_(u?t(c,p):h(!1),f=>(f||o.push(c),f)))}return _(s,()=>o)})),iO=e=>_(Lr(),e),Yh=e=>Rn(e,()=>l(Mt(),()=>Yh(e)));var aO=a(3,(e,t,r)=>_a(e,t,()=>Lo(r))),cO=a(3,(e,t,r)=>_a(e,t,()=>Ps(r))),_a=a(3,(e,t,r)=>l(e,o=>t(o)?h(o):r(o))),pO=a(3,(e,t,r)=>_a(e,t,o=>ur(()=>r(o)))),uO=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=r.next();return o.done?h(x()):lO(r,0,t,o.value)})),lO=(e,t,r,o)=>l(r(o,t),n=>{if(n)return h(d(o));let s=e.next();return s.done?h(x()):lO(e,t+1,r,s.value)}),fO=e=>T(()=>{let t=Tr(e);return Ke(t)?it(Be(t),(r,o)=>Rn(r,()=>o))(Ge(t)):Lo(()=>Cs("Received an empty collection of effects"))}),mO=a(2,(e,t)=>qo(t(qo(e)))),Oa=a(2,(e,{onFailure:t,onSuccess:r})=>ie(e,{onFailure:o=>h(t(o)),onSuccess:o=>h(r(o))})),hO=a(2,(e,t)=>T(()=>dO(e[Symbol.iterator](),0,t))),dO=(e,t,r)=>{let o=e.next();return o.done?h(!0):l(r(o.value,t),n=>n?dO(e,t+1,r):h(n))},xO=e=>{let t=l(l(e,()=>Mt()),()=>t);return t},Vh=class{constructor(t){this.value=t}[Symbol.iterator](){return new ju(this)}},eF=function(){let e=arguments[0];for(let t=1;t<arguments.length;t++)e=arguments[t](e);return new Vh(e)},gO=e=>T(()=>{let t=e(eF),r=t.next(),o=n=>n.done?h(n.value):l(s=>o(t.next(s)))(n.value.value);return o(r)}),Jh=ue(e=>h(e.unsafeGetFiberRefs())),yO=e=>ie(e,{onFailure:t=>L(d(t)),onSuccess:t=>{let o=t[Symbol.iterator]().next();return o.done?L(x()):h(o.value)}}),bO=e=>Oa(e,{onFailure:Xn,onSuccess:Xn}),SO=e=>Y(e,{onFailure:t=>Zh(t,"An error was silently ignored because it is not anticipated to be useful"),onSuccess:()=>k}),EO=e=>Qu((t,r)=>l_(r,t,e)),_O=e=>Oa(e,{onFailure:_r,onSuccess:Pt}),OO=e=>Oa(e,{onFailure:Pt,onSuccess:_r}),Qh=(e,t)=>T(()=>t.while(e)?l(t.body(e),r=>Qh(r,t)):h(e)),Hn=e=>(t,r)=>{let o=Dt(e),n,s;return dp(t)?(s=t,n=r??""):(n=t,s=r??tt),ue(i=>(i.log(n,s,o),k))},CO=Hn(),RO=Hn(Bh),Zh=Hn(Kh),AO=Hn(zh),MO=Hn(jh),TO=Hn(Wh),vO=Hn(Uh),IO=a(2,(e,t)=>l(Nu,r=>qe(e,Zp,ko(I_(t,r))))),kO=Ye(sa),wO=(e,t)=>t.discard?PO(e,t.while,t.step,t.body):_(FO(e,t.while,t.step,t.body),r=>Array.from(r)),FO=(e,t,r,o)=>T(()=>t(e)?l(o(e),n=>_(FO(r(e),t,r,o),ko(n))):g(()=>ar())),PO=(e,t,r,o)=>T(()=>t(e)?l(o(e),()=>PO(r(e),t,r,o)):k),NO=a(3,(e,t,r)=>T(()=>{let o=e[Symbol.iterator](),n=[],s=h(t),i,c=0;for(;!(i=o.next()).done;){let p=c++;s=l(s,u=>_(r(u,i.value,p),([f,m])=>(n.push(m),f)))}return _(s,p=>[p,n])})),Xs=a(2,(e,t)=>Y(e,{onFailure:r=>Hr(()=>t(r)),onSuccess:h})),Xh=e=>l(t=>_(r=>W(r,l(([o,n])=>V(qn(o),n))(ve(t))))(ed(qr(t)(Ln(e)))))(rt()),DO=e=>ie(e,{onFailure:t=>h(t),onSuccess:h}),Ca=e=>_(e,t=>!t),LO=e=>ie(e,{onFailure:t=>L(d(t)),onSuccess:t=>{switch(t._tag){case"None":return k;case"Some":return L(x())}}}),ed=e=>_(Sa(!0),t=>Q(Hs(e,N_(t,!1)))),HO=e=>ie(e,{onFailure:()=>h(x()),onSuccess:t=>h(d(t))}),qO=a(2,(e,t)=>Rn(e,()=>ur(t))),UO=a(2,(e,t)=>Rn(e,()=>g(t))),WO=e=>Y(e,{onFailure:t=>{let r=Array.from(Bi(t));return r.length===0?D(t):L(r)},onSuccess:h}),qn=e=>Qu((t,r)=>Uu(t,r)(e)),jO=e=>e.length>=1?Kt((t,r)=>{e(r).then(o=>t(X(o))).catch(o=>t(nu(o)))}):Kt(t=>{e().then(r=>t(X(r))).catch(r=>t(nu(r)))}),zO=a(3,(e,t,r)=>td(e,t,h(r))),td=a(3,(e,t,r)=>Ns(o=>l(r,n=>Rt(e,we(t,n)(o))))),KO=Fu(h),BO=a(3,(e,t,r)=>J(e).reduce((o,n,s)=>l(o,i=>r(i,n,s)),h(t))),GO=a(3,(e,t,r)=>J(e).reduceRight((o,n,s)=>l(o,i=>r(n,i,s)),h(t))),$O=a(3,(e,t,r)=>l(g(()=>e[Symbol.iterator]()),o=>VO(o,0,t,r.while,r.body))),VO=(e,t,r,o,n)=>{let s=e.next();return!s.done&&o(r)?l(n(r,s.value,t),i=>VO(e,t+1,i,o,n)):h(r)},YO=a(2,(e,t)=>T(()=>JO(e,t))),JO=(e,t)=>l(e,r=>t<=0?h(r):W(Mt(),JO(e,t-1))),QO=e=>Y(e,{onFailure:L,onSuccess:h}),ZO=e=>T(()=>f_(e)),ei=Fh,XO=e=>ie(e,{onFailure:t=>L(d(t)),onSuccess:t=>{switch(t._tag){case"None":return L(x());case"Some":return h(t.value)}}}),ti=h(x()),rd=e=>h(d(e)),Ju=a(3,(e,t,r)=>l(t,o=>l(e,n=>_(t,s=>[r(o,s),n])))),eC=a(3,(e,t,r)=>od(e,[Wu(t,r)])),od=a(2,(e,t)=>nd(e,pt(t))),nd=a(2,(e,t)=>qe(go,r=>Ve(t)(r))(e)),tC=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!1),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>u?h(!0):(o.push(c),t(c,p)))}return _(s,()=>o)})),rC=a(2,(e,t)=>T(()=>{let r=e[Symbol.iterator](),o=[],n,s=h(!0),i=0;for(;(n=r.next())&&!n.done;){let c=n.value,p=i++;s=l(s,u=>_(f=>(f&&o.push(c),f))(u?t(c,p):h(!1)))}return _(s,()=>o)})),oC=a(2,(e,{onFailure:t,onSuccess:r})=>Y(e,{onFailure:o=>{let n=co(o);switch(n._tag){case"Left":return W(t(n.left),D(o));case"Right":return D(o)}},onSuccess:o=>V(r(o),o)})),nC=a(2,(e,t)=>Nr(e,r=>De(vm(r),{onNone:()=>D(r),onSome:o=>W(t(o),D(r))}))),sd=a(2,(e,t)=>Y(e,{onFailure:r=>{let o=co(r);switch(o._tag){case"Left":return W(t(o.left),D(r));case"Right":return D(r)}},onSuccess:h})),sC=a(3,(e,t,r)=>sd(e,o=>pe(o)&&"_tag"in o&&o._tag===t?r(o):k)),iC=a(2,(e,t)=>Y(e,{onFailure:r=>W(t(r),D(r)),onSuccess:h})),aC=e=>id(e,Ph),id=a(2,(e,t)=>Ju(e,t,(r,o)=>Dc(o-r))),cC=q_,pC=cC(h),ad=e=>{let t,r;return typeof e=="function"?t=e:(t=e.try,r=e.catch),t.length>=1?T(()=>{let o=new AbortController;return l(Ea(()=>t(o.signal)),n=>Kt(s=>(n.then(i=>s(X(i))).catch(i=>s(fr(r?r(i):i))),g(()=>o.abort()))))}):l(Ea(e),o=>Kt(n=>{o.then(s=>n(X(s))).catch(s=>n(fr(r?r(s):s)))}))},uC=a(2,(e,t)=>l(e,r=>Ea({try:()=>t.try(r),catch:t.catch}))),lC=a(2,(e,t)=>l(e,r=>ad({try:t.try.length>=1?o=>t.try(r,o):()=>t.try(r),catch:t.catch}))),fC=a(2,(e,t)=>T(()=>t()?ti:Vu(e))),mC=a(2,(e,t)=>l(t,r=>r?ti:Vu(e))),hC=e=>Xs(e,Im),Qu=e=>ue(t=>(t.setFiberRefs(e(t.id(),t.unsafeGetFiberRefs())),k)),dC=a(3,(e,t,r)=>Mn(e,o=>we(o,t,r(wi(o,t))))),Zu=a(2,(e,t)=>T(()=>t()?_(e,d):h(x()))),xC=a(3,(e,t,r)=>l(Ye(t),o=>r(o)?_(e,n=>[o,d(n)]):h([o,x()]))),gC=a(3,(e,t,r)=>l($u(t),o=>r(o)?_(e,n=>[o,d(n)]):h([o,x()]))),yC=a(2,(e,t)=>t(e)),bC=(e,t)=>(...r)=>l(e,o=>t(o)(...r)),SC=(e,t)=>(...r)=>_(e,o=>t(o)(...r)),cd=e=>new Proxy({},{get(t,r,o){return(...n)=>l(e,s=>s[r](...n))}}),pd=e=>new Proxy({},{get(t,r,o){return l(e,n=>n[r])}}),EC=e=>({functions:cd(e),constants:pd(e)}),_C=function(){let e=arguments;return l(ld,t=>t._tag==="Some"?g(()=>{if(typeof e[0]=="string")t.value.attribute(e[0],e[1]);else for(let r in e[0])t.value.attribute(r,e[0][r])}):k)},OC=a(e=>de(e[0]),function(){let e=arguments;return qe(e[0],eu,typeof e[1]=="string"?Mr(e[1],e[2]):t=>Object.entries(e[1]).reduce((r,[o,n])=>Mr(r,o,n),t))}),ud=_(Ye(yo),sp),ld=_(Ye(yo),Fb(e=>e._tag==="Span")),tF=BigInt(0),Xu=Se(ca,e=>e?Ph:h(tF)),CC=a(e=>de(e[0]),(e,t,r)=>qe(e,tu,Zc({_tag:"SpanLink",span:t,attributes:r??{}}))),ri=(e,t)=>cC(r=>l(t?.parent?rd(t.parent):t?.root?ti:ud,o=>l(Ye(eu),n=>l(Ye(tu),s=>l(Xu,i=>g(()=>{let c=t?.links?[...Ze(s),...t.links]:Ze(s),p=r.span(e,o,t?.context??Ht(),c,i);return Ky(n,(u,f)=>p.attribute(f,u)),Object.entries(t?.attributes??{}).forEach(([u,f])=>p.attribute(u,f)),p})))))),RC=Ye(eu),AC=Ye(tu),fd=(e,...t)=>{let r=t.length===1?void 0:t[0],o=t[t.length-1];return zt(ri(e,r),o,(n,s)=>l(Xu,i=>g(()=>n.end(i,s))))},md=a(2,(e,t)=>qe(e,yo,ko(t))),MC=a(e=>typeof e[0]!="string",(e,t,r)=>fd(t,r??{},o=>md(e,o))),TC=e=>T(()=>{let t=e();return t==null?L(po()):h(t)}),vC=e=>lt(_(e,d),t=>Fm(t)?ti:L(t));var IC,kC,wC,el="@effect/io/Fiber/Status",Ko=Symbol.for(el),hd="Done",FC="Running",PC="Suspended",dd=class{constructor(){this[IC]=Ko,this._tag=hd}[(IC=Ko,A)](){return I(S(this._tag))(S(el))}[M](t){return tl(t)&&t._tag===hd}},xd=class{constructor(t){this.runtimeFlags=t,this[kC]=Ko,this._tag=FC}[(kC=Ko,A)](){return I(S(this.runtimeFlags))(I(S(this._tag))(S(el)))}[M](t){return tl(t)&&t._tag===FC&&this.runtimeFlags===t.runtimeFlags}},gd=class{constructor(t,r){this.runtimeFlags=t,this.blockingOn=r,this[wC]=Ko,this._tag=PC}[(wC=Ko,A)](){return I(S(this.blockingOn))(I(S(this.runtimeFlags))(I(S(this._tag))(S(el))))}[M](t){return tl(t)&&t._tag===PC&&this.runtimeFlags===t.runtimeFlags&&O(this.blockingOn,t.blockingOn)}},NC=new dd,DC=e=>new xd(e),LC=(e,t)=>new gd(e,t),tl=e=>typeof e=="object"&&e!=null&&Ko in e,HC=e=>e._tag===hd;var qC=NC,yd=DC,UC=LC;var WC=HC;var ni=qu;var bd=Uu;var rl=z(Symbol.for("@effect/io/FiberRef/currentRequestMap"),()=>xe(new Map));var Sd=(e,t,r,o)=>{switch(e?.concurrency){case void 0:return t();case"unbounded":return r();case"inherit":return Se(Xp,n=>n==="unbounded"?r():n>1?o(n):t());default:return e.concurrency>1?o(e.concurrency):t()}},Ra=(e,t,r)=>{switch(e?.concurrency){case void 0:return t();case"unbounded":return r();case"inherit":return Se(Xp,o=>o==="unbounded"||o>1?r():t());default:return e.concurrency>1?r():t()}};var zC="Sequential",KC="Parallel";var si={_tag:zC},BC={_tag:KC};var GC=e=>e._tag===zC,$C=e=>e._tag===KC;var ol="InterruptSignal",nl="Stateful",sl="Resume",il="YieldNow",Ed=e=>({_tag:ol,cause:e}),ii=e=>({_tag:nl,onFiber:e}),Un=e=>({_tag:sl,effect:e}),YC=()=>({_tag:il});var QC,ZC,iF="@effect/io/Fiber/Scope",al=Symbol.for(iF),_d=class{constructor(){this[QC]=al,this.fiberId=et,this.roots=new Set}add(t,r){this.roots.add(r),r.unsafeAddObserver(()=>{this.roots.delete(r)})}};QC=al;var Od=class{constructor(t,r){this.fiberId=t,this.parent=r,this[ZC]=al}add(t,r){this.parent.tell(ii(o=>{o.addChild(r),r.unsafeAddObserver(()=>{o.removeChild(r)})}))}};ZC=al;var XC=e=>new Od(e.id(),e),Wn=z(Symbol.for("@effect/io/FiberScope/Global"),()=>new _d);var aF="@effect/io/Fiber",Aa=Symbol.for(aF),Ma={_E:e=>e,_A:e=>e},cF={[Aa]:Ma,pipe(){return E(this,arguments)}},pF="@effect/io/Fiber",tR=Symbol.for(pF);var Cd=e=>e.await();var rR=e=>e.inheritAll();var oR=a(2,(e,t)=>e.interruptAsFork(t)),jn=e=>qs(ft(e.await()),e.inheritAll());var $K={...cF,id:()=>et,await:()=>vn,children:()=>h([]),inheritAll:()=>vn,poll:()=>h(x()),interruptAsFork:()=>vn};var Bo="@effect/io/Fiber/Current";var uF="@effect/io/Logger",sR=Symbol.for(uF),iR={_Message:e=>e,_Output:e=>e},cl=e=>({[sR]:iR,log:e,pipe(){return E(this,arguments)}});var JK={[sR]:iR,log:Xn,pipe(){return E(this,arguments)}};var aR=cl(({annotations:e,cause:t,date:r,fiberId:o,logLevel:n,message:s,spans:i})=>{let c=r.getTime(),u=[`timestamp=${r.toISOString()}`,`level=${n.label}`,`fiber=${up(o)}`].join(" "),f=lF(s);if(f.length>0&&(u=u+" message=",u=Rd(f,u)),t!=null&&t!=tt&&(u=u+" cause=",u=Rd(uo(t),u)),ji(i)){u=u+" ";let m=!0;for(let y of i)m?m=!1:u=u+" ",u=u+k_(c)(y)}if(Yc(e)>0){u=u+" ";let m=!0;for(let[y,b]of e)m?m=!1:u=u+" ",u=u+hF(y),u=u+"=",u=Rd(String(b),u)}return u}),lF=e=>{try{return typeof e=="object"?JSON.stringify(e):String(e)}catch{return String(e)}},fF=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,mF=/^[^\s"=]+$/,Rd=(e,t)=>t+(e.match(mF)?e:fF(e));var hF=e=>e.replace(/[\s="]/g,"_");var cR,pR="@effect/io/Metric/Boundaries",Ad=Symbol.for(pR),Md=class{constructor(t){this.values=t,this[cR]=Ad}[(cR=Ad,A)](){return I(S(this.values))(S(pR))}[M](t){return xF(t)&&O(this.values,t.values)}pipe(){return E(this,arguments)}},xF=e=>typeof e=="object"&&e!=null&&Ad in e,gF=e=>{let t=Zy(ir(Oe(Number.POSITIVE_INFINITY))(e));return new Md(t)};var uR=e=>gF(Ot(hf(e.count-1,t=>e.start*Math.pow(e.factor,t))));var lR,fR,mR,hR,dR,xR,gR,yR,bR,SR,bF="@effect/io/Metric/KeyType",Ta=Symbol.for(bF),CR="effect/io/Metric/KeyType/Counter",Td=Symbol.for(CR),RR="effect/io/Metric/KeyType/Frequency",vd=Symbol.for(RR),AR="effect/io/Metric/KeyType/Gauge",Id=Symbol.for(AR),MR="effect/io/Metric/KeyType/Histogram",kd=Symbol.for(MR),TR="effect/io/Metric/KeyType/Summary",wd=Symbol.for(TR),va={_In:e=>e,_Out:e=>e},Fd=class{constructor(){this[lR]=va,this[fR]=Td}[(lR=Ta,fR=Td,A)](){return S(CR)}[M](t){return Nd(t)}pipe(){return E(this,arguments)}},ER=class{constructor(){this[mR]=va,this[hR]=vd}[(mR=Ta,hR=vd,A)](){return S(RR)}[M](t){return Dd(t)}pipe(){return E(this,arguments)}},_R=class{constructor(){this[dR]=va,this[xR]=Id}[(dR=Ta,xR=Id,A)](){return S(AR)}[M](t){return Ld(t)}pipe(){return E(this,arguments)}},Pd=class{constructor(t){this.boundaries=t,this[gR]=va,this[yR]=kd}[(gR=Ta,yR=kd,A)](){return I(S(this.boundaries))(S(MR))}[M](t){return Hd(t)&&O(this.boundaries,t.boundaries)}pipe(){return E(this,arguments)}},OR=class{constructor(t,r,o,n){this.maxAge=t,this.maxSize=r,this.error=o,this.quantiles=n,this[bR]=va,this[SR]=wd}[(bR=Ta,SR=wd,A)](){return I(S(this.quantiles))(I(S(this.error))(I(S(this.maxSize))(I(S(this.maxAge))(S(TR)))))}[M](t){return qd(t)&&O(this.maxAge,t.maxAge)&&this.maxSize===t.maxSize&&this.error===t.error&&O(this.quantiles,t.quantiles)}pipe(){return E(this,arguments)}},vR=new Fd;var IR=e=>new Pd(e);var Nd=e=>typeof e=="object"&&e!=null&&Td in e,Dd=e=>typeof e=="object"&&e!=null&&vd in e,Ld=e=>typeof e=="object"&&e!=null&&Id in e,Hd=e=>typeof e=="object"&&e!=null&&kd in e,qd=e=>typeof e=="object"&&e!=null&&wd in e;var wR,SF="@effect/io/Metric/Key",FR=Symbol.for(SF),EF={_Type:e=>e},Ia=class{constructor(t,r,o,n=$e()){this.name=t,this.keyType=r,this.description=o,this.tags=n,this[wR]=EF}[(wR=FR,A)](){return I(S(this.tags))(I(S(this.description))(I(S(this.keyType))(S(this.name))))}[M](t){return _F(t)&&this.name===t.name&&O(this.keyType,t.keyType)&&O(this.description,t.description)&&O(this.tags,t.tags)}pipe(){return E(this,arguments)}},_F=e=>typeof e=="object"&&e!=null&&FR in e,PR=(e,t)=>new Ia(e,vR,Dt(t));var NR=(e,t,r)=>new Ia(e,IR(t),Dt(r));var DR=a(2,(e,t)=>io(t)===0?e:new Ia(e.name,e.keyType,e.description,Ve(t)(e.tags)));var LR,HR,qR,UR,WR,jR,zR,KR,BR,GR,CF="@effect/io/Metric/State",ka=Symbol.for(CF),$R="effect/io/Metric/State/Counter",Ud=Symbol.for($R),VR="effect/io/Metric/State/Frequency",Wd=Symbol.for(VR),YR="effect/io/Metric/State/Gauge",jd=Symbol.for(YR),JR="effect/io/Metric/State/Histogram",zd=Symbol.for(JR),QR="effect/io/Metric/State/Summary",Kd=Symbol.for(QR),wa={_A:e=>e},Bd=class{constructor(t){this.count=t,this[LR]=wa,this[HR]=Ud}[(LR=ka,HR=Ud,A)](){return I(S(this.count))(S($R))}[M](t){return RF(t)&&this.count===t.count}pipe(){return E(this,arguments)}},Gd=class{constructor(t){this.occurrences=t,this[qR]=wa,this[UR]=Wd}[(qR=ka,UR=Wd,A)](){return I(S(this.occurrences))(S(VR))}[M](t){return AF(t)&&O(this.occurrences,t.occurrences)}pipe(){return E(this,arguments)}},$d=class{constructor(t){this.value=t,this[WR]=wa,this[jR]=jd}[(WR=ka,jR=jd,A)](){return I(S(this.value))(S(YR))}[M](t){return MF(t)&&this.value===t.value}pipe(){return E(this,arguments)}},Vd=class{constructor(t,r,o,n,s){this.buckets=t,this.count=r,this.min=o,this.max=n,this.sum=s,this[zR]=wa,this[KR]=zd}[(zR=ka,KR=zd,A)](){return I(S(this.sum))(I(S(this.max))(I(S(this.min))(I(S(this.count))(I(S(this.buckets))(S(JR))))))}[M](t){return TF(t)&&O(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return E(this,arguments)}},Yd=class{constructor(t,r,o,n,s,i){this.error=t,this.quantiles=r,this.count=o,this.min=n,this.max=s,this.sum=i,this[BR]=wa,this[GR]=Kd}[(BR=ka,GR=Kd,A)](){return I(S(this.sum))(I(S(this.max))(I(S(this.min))(I(S(this.count))(I(S(this.quantiles))(I(S(this.error))(S(QR)))))))}[M](t){return vF(t)&&this.error===t.error&&O(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}pipe(){return E(this,arguments)}},ZR=e=>new Bd(e),XR=e=>new Gd(e),eA=e=>new $d(e),tA=e=>new Vd(e.buckets,e.count,e.min,e.max,e.sum),rA=e=>new Yd(e.error,e.quantiles,e.count,e.min,e.max,e.sum);var RF=e=>typeof e=="object"&&e!=null&&Ud in e,AF=e=>typeof e=="object"&&e!=null&&Wd in e,MF=e=>typeof e=="object"&&e!=null&&jd in e,TF=e=>typeof e=="object"&&e!=null&&zd in e,vF=e=>typeof e=="object"&&e!=null&&Kd in e;var kF="@effect/io/Metric/Hook",wF=Symbol.for(kF),FF={_In:e=>e,_Out:e=>e},Fa=e=>({[wF]:FF,pipe(){return E(this,arguments)},...e});var nA=e=>{let t=0;return Fa({get:()=>ZR(t),update:r=>{t=t+r}})},sA=e=>{let t=0,r=new Map,o=s=>{t=t+1;let i=r.get(s)??0;r.set(s,i+1)},n=()=>Vc(r.entries());return Fa({get:()=>XR(n()),update:o})},iA=(e,t)=>{let r=t;return Fa({get:()=>eA(r),update:o=>{r=o}})},aA=e=>{let t=e.keyType.boundaries.values,r=t.length,o=new Uint32Array(r+1),n=new Float32Array(r),s=0,i=0,c=Number.MAX_VALUE,p=Number.MIN_VALUE;$f((m,y)=>{n[y]=m})(Xc(yt)(t));let u=m=>{let y=0,b=r;for(;y!==b;){let C=Math.floor(y+(b-y)/2),R=n[C];m<=R?b=C:y=C,b===y+1&&(m<=n[y]?b=y:y=b)}o[y]=o[y]+1,s=s+1,i=i+m,m<c&&(c=m),m>p&&(p=m)},f=()=>{let m=Array(r),y=0;for(let b=0;b<r;b++){let C=n[b],R=o[b];y=y+R,m[b]=[C,y]}return Ot(m)};return Fa({get:()=>tA({buckets:f(),count:s,min:c,max:p,sum:i}),update:u})},cA=e=>{let{error:t,maxAge:r,maxSize:o,quantiles:n}=e.keyType,s=Xc(yt)(n),i=Array(o),c=0,p=0,u=0,f=Number.MAX_VALUE,m=Number.MIN_VALUE,y=C=>{let R=[],v=0;for(;v!==o-1;){let w=i[v];if(w!=null){let[H,U]=w,te=as(C-H);Mf(te,Rf)&&te<=r&&R.push(U)}v=v+1}return PF(t,s,Xc(yt)(Ot(R)))},b=(C,R)=>{if(o>0){c=c+1;let v=c%o;i[v]=[R,C]}p=p+1,u=u+C,C<f&&(f=C),C>m&&(m=C)};return Fa({get:()=>rA({error:t,quantiles:y(Date.now()),count:p,min:f,max:m,sum:u}),update:([C,R])=>b(C,R)})},PF=(e,t,r)=>{let o=r.length;if(xs(t))return Xe();let n=pn(t),s=ds(1)(t),i=it(Oe(oA(e,o,x(),0,n,r)),(c,p)=>{let u=pn(c);return Zc(oA(e,o,u.value,u.consumed,p,u.rest))(c)})(s);return $f(c=>[c.quantile,c.value])(i)},oA=(e,t,r,o,n,s)=>{let i=e,c=t,p=r,u=o,f=n,m=s,y=e,b=t,C=r,R=o,v=n,w=s;for(;;){if(xs(m))return{quantile:f,value:x(),consumed:u,rest:Xe()};if(f===1)return{quantile:f,value:d(Jy(m)),consumed:u+m.length,rest:Xe()};let H=Qy(ce=>ce>pn(m))(m),U=f*c,te=i/2*U,ge=u+H[0].length,Ie=Math.abs(ge-U);if(ge<U-te){y=i,b=c,C=cn(m),R=ge,v=f,w=H[1],i=y,c=b,p=C,u=R,f=v,m=w;continue}if(ge>U+te)return{quantile:f,value:p,consumed:u,rest:m};switch(p._tag){case"None":{y=i,b=c,C=cn(m),R=ge,v=f,w=H[1],i=y,c=b,p=C,u=R,f=v,m=w;continue}case"Some":{let ce=Math.abs(U-p.value);if(Ie<ce){y=i,b=c,C=cn(m),R=ge,v=f,w=H[1],i=y,c=b,p=C,u=R,f=v,m=w;continue}return{quantile:f,value:d(p.value),consumed:u,rest:m}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/io/issues")};var DF="@effect/io/Metric/Pair",LF=Symbol.for(DF),HF={_Type:e=>e};var pA=(e,t)=>({[LF]:HF,metricKey:e,metricState:t,pipe(){return E(this,arguments)}});var uA,UF="@effect/io/Metric/Registry",lA=Symbol.for(UF),Jd=class{constructor(){this[uA]=lA,this.map=sn()}snapshot(){let t=[];for(let[r,o]of this.map)t.push(pA(r,o.get()));return pt(t)}get(t){let r=je(ye(t)(this.map));if(r==null){if(Nd(t.keyType))return this.getCounter(t);if(Ld(t.keyType))return this.getGauge(t);if(Dd(t.keyType))return this.getFrequency(t);if(Hd(t.keyType))return this.getHistogram(t);if(qd(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/io/issues")}else return r}getCounter(t){let r=je(ye(t)(this.map));if(r==null){let o=nA(t);nr(t)(this.map)||ct(t,o)(this.map),r=o}return r}getFrequency(t){let r=je(ye(t)(this.map));if(r==null){let o=sA(t);nr(t)(this.map)||ct(t,o)(this.map),r=o}return r}getGauge(t){let r=je(ye(t)(this.map));if(r==null){let o=iA(t,0);nr(t)(this.map)||ct(t,o)(this.map),r=o}return r}getHistogram(t){let r=je(ye(t)(this.map));if(r==null){let o=aA(t);nr(t)(this.map)||ct(t,o)(this.map),r=o}return r}getSummary(t){let r=je(ye(t)(this.map));if(r==null){let o=cA(t);nr(t)(this.map)||ct(t,o)(this.map),r=o}return r}};uA=lA;var fA=()=>new Jd;var jF="@effect/io/Metric",zF=Symbol.for(jF),KF={_Type:e=>e,_In:e=>e,_Out:e=>e},BF=z(Symbol.for("@effect/io/Metric/globalMetricRegistry"),()=>fA()),GF=function(e,t,r){return Object.assign(n=>At(n,s=>g(()=>t(s,$e()))),{[zF]:KF,keyType:e,unsafeUpdate:t,unsafeValue:r,pipe(){return E(this,arguments)}})};var Pa=(e,t)=>mA(PR(e,t));var mA=e=>{let t=r=>{let o=DR(r)(e);return BF.get(o)};return GF(e.keyType,(r,o)=>t(o).update(r),r=>t(r).get())};var hA=(e,t,r)=>mA(NR(e,t,r));var dA=a(2,(e,t)=>Se(rl,r=>g(()=>{if(r.has(e)){let o=r.get(e);o.state.completed||(o.state.completed=!0,Gs(o.result,t))}})));var Na=class{constructor(){this.count=0,this.observers=new Set}addObserver(t){this.observers.add(t)}removeObserver(t){this.observers.delete(t)}increment(){this.count++,this.observers.forEach(t=>t(this.count))}decrement(){this.count--,this.observers.forEach(t=>t(this.count))}};var xA,gA,yA,bA,VF,YF="@effect/io/Supervisor",La=Symbol.for(YF),pl={_T:e=>e},Da=class e{constructor(t,r){this.underlying=t,this.value0=r,this[xA]=pl}value(){return this.value0()}onStart(t,r,o,n){this.underlying.onStart(t,r,o,n)}onEnd(t,r){this.underlying.onEnd(t,r)}onEffect(t,r){this.underlying.onEffect(t,r)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new e(this,()=>_(t)(this.value()))}zip(t){return new Go(this,t)}onRun(t,r){return this.underlying.onRun(t,r)}};xA=La;var Go=class e{constructor(t,r){this.left=t,this.right=r,this[gA]=pl}value(){return Vp(this.left.value(),this.right.value())}onStart(t,r,o,n){this.left.onStart(t,r,o,n),this.right.onStart(t,r,o,n)}onEnd(t,r){this.left.onEnd(t,r),this.right.onEnd(t,r)}onEffect(t,r){this.left.onEffect(t,r),this.right.onEffect(t,r)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new Da(this,()=>_(t)(this.value()))}zip(t){return new e(this,t)}onRun(t,r){return this.right.onRun(()=>this.left.onRun(t,r),r)}};gA=La;var Qd=class{constructor(){this[yA]=pl,this.fibers=new Set}value(){return g(()=>Array.from(this.fibers))}onStart(t,r,o,n){this.fibers.add(n)}onEnd(t,r){this.fibers.delete(r)}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new Da(this,()=>_(t)(this.value()))}zip(t){return new Go(this,t)}onRun(t,r){return t()}};yA=La;var Zd=class{constructor(t){this.effect=t,this[bA]=pl}value(){return this.effect}onStart(t,r,o,n){}onEnd(t,r){}onEffect(t,r){}onSuspend(t){}onResume(t){}map(t){return new Da(this,()=>_(t)(this.value()))}zip(t){return new Go(this,t)}onRun(t,r){return t()}};bA=La;VF=La;var JF=()=>new Qd,SA=g(JF),QF=e=>new Zd(e),zn=QF(k);var EA="Empty",_A="AddSupervisor",OA="RemoveSupervisor",CA="AndThen",ai={_tag:EA},ll=(e,t)=>({_tag:CA,first:e,second:t}),ZF=(e,t)=>XF(t,Oe(e)),XF=(e,t)=>{let r=e,o=t;for(;Ke(o);){let n=Be(o);switch(n._tag){case EA:{o=Ge(o);break}case _A:{r=r.zip(n.supervisor),o=Ge(o);break}case OA:{r=Xd(r,n.supervisor),o=Ge(o);break}case CA:{o=Te(n.first)(Te(n.second)(Ge(o)));break}}}return r},Xd=(e,t)=>O(e,t)?zn:e instanceof Go?Xd(e.left,t).zip(Xd(e.right,t)):e,fl=e=>O(e,zn)?$e():e instanceof Go?Ve(fl(e.right))(fl(e.left)):so(e),e0=(e,t)=>{if(O(e,t))return ai;let r=fl(e),o=fl(t),n=un(ai,(i,c)=>ll(i,{_tag:_A,supervisor:c}))(im(r)(o)),s=un(ai,(i,c)=>ll(i,{_tag:OA,supervisor:c}))(im(o)(r));return ll(n,s)},RA=np({empty:ai,patch:ZF,combine:ll,diff:e0});var AA,MA,r0=Pa("effect_fiber_started"),TA=Pa("effect_fiber_active"),o0=Pa("effect_fiber_successes"),n0=Pa("effect_fiber_failures"),s0=hA("effect_fiber_lifetimes",uR({start:1,factor:2,count:100})),Ha="Continue",i0="Done",vA="Yield",a0={_E:e=>e,_A:e=>e},qa=e=>{throw new Error(`BUG: FiberRuntime - ${JSON.stringify(e)} - please report an issue at https://github.com/Effect-TS/io/issues`)},ml={[vs]:(e,t,r)=>t.i1(r),OnStep:(e,t,r)=>t.i1(X(r)),[Is]:(e,t,r)=>t.i2(r),[ta]:(e,t,r)=>(e.patchRuntimeFlags(e._runtimeFlags,t.patch),kr(e._runtimeFlags)&&e.isInterrupted()?K(e.getInterruptedCause()):X(r)),[ks]:(e,t,r)=>(t.i2(r),t.i0()?(e.pushStack(t),t.i1()):k)},c0={[ol]:(e,t,r,o)=>(e.processNewInterruptSignal(o.cause),kr(t)?K(o.cause):r),[sl]:(e,t,r,o)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[nl]:(e,t,r,o)=>(o.onFiber(e,yd(t)),r),[il]:(e,t,r,o)=>l(Mt(),()=>r)},p0=e=>mt(dS(e),t=>pi(yS(t),([r,o])=>{let n=new Map;for(let s of o)for(let i of s)n.set(i.request,i);return Ee(S0(r.runAll(o),o.flat()),rl,n)},!1)),Ua=class{pipe(){return E(this,arguments)}constructor(t,r,o){if(this[AA]=Ma,this[MA]=a0,this._queue=new Array,this._children=null,this._observers=new Array,this._running=!1,this._stack=[],this._asyncInterruptor=null,this._asyncBlockingOn=null,this._exitValue=null,this._steps=[!1],this.run=()=>{this.drainQueueOnCurrentThread()},this._runtimeFlags=o,this._fiberId=t,this._fiberRefs=r,this._supervisor=this.getFiberRef(ci),Zi(o)){let n=this.getFiberRef(go);r0.unsafeUpdate(1,n),TA.unsafeUpdate(1,n)}}id(){return this._fiberId}resume(t){this.tell(Un(t))}status(){return this.ask((t,r)=>r)}runtimeFlags(){return this.ask((t,r)=>WC(r)?t._runtimeFlags:r.runtimeFlags)}scope(){return XC(this)}children(){return this.ask(t=>Array.from(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(In)}fiberRefs(){return this.ask(t=>t.unsafeGetFiberRefs())}ask(t){return T(()=>{let r=zs(this._fiberId);return this.tell(ii((o,n)=>{Gs(r,g(()=>t(o,n)))})),ve(r)})}tell(t){this._queue.push(t),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}await(){return Kt(t=>{let r=o=>t(h(o));return this.tell(ii((o,n)=>{o._exitValue!==null?r(this._exitValue):o.unsafeAddObserver(r)})),g(()=>this.tell(ii((o,n)=>{o.unsafeRemoveObserver(r)})))},this.id())}inheritAll(){return ue((t,r)=>{let o=t.id(),n=t.unsafeGetFiberRefs(),s=r.runtimeFlags,i=this.unsafeGetFiberRefs(),c=Du(n,o,i);t.setFiberRefs(c);let p=t.getFiberRef(kA),u=jm(Ji)(jm(pr)(En(s,p)));return Ls(u)})}poll(){return g(()=>Dt(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(t){return g(()=>this.tell(Ed(cr(t))))}unsafeAddObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}unsafeRemoveObserver(t){this._observers=this._observers.filter(r=>r!==t)}unsafeGetFiberRefs(){return this.setFiberRef(kA,this._runtimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=ga(this._fiberRefs,t)}getFiberRef(t){return this._fiberRefs.locals.has(t)?this._fiberRefs.locals.get(t)[0][1]:t.initial}setFiberRef(t,r){this._fiberRefs=Nn(this._fiberRefs,{fiberId:this._fiberId,fiberRef:t,value:r}),t===ci&&(this._supervisor=r)}setFiberRefs(t){this._fiberRefs=t,this._supervisor=this.getFiberRef(ci)}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let r=Ha,o=globalThis[Bo];globalThis[Bo]=this;try{for(;r===Ha;)r=this._queue.length===0?i0:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[Bo]=o}this._queue.length>0&&!this._running?(this._running=!0,r===vA?(this.drainQueueLaterOnExecutor(),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(){this.getFiberRef(xo).scheduleTask(this.run,this.getFiberRef(na))}drainQueueWhileRunning(t,r){let o=r;for(;this._queue.length>0;){let n=this._queue.splice(0,1)[0];o=c0[n._tag](this,t,o,n)}return o}isInterrupted(){return!Tm(this.getFiberRef(In))}addInterruptedCause(t){let r=this.getFiberRef(In);this.setFiberRef(In,Ce(r,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(let r of this._children)r.tell(Ed(cr(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){let t=this._children.values();this._children=null;let r=!1;return Tn({while:()=>!r,body:()=>{let n=t.next();return n.done?g(()=>{r=!0}):Q(n.value.await())},step:()=>{}})}return null}reportExitValue(t){if(Zi(this._runtimeFlags)){let r=this.getFiberRef(go);switch(TA.unsafeUpdate(-1,r),t._tag){case me:{o0.unsafeUpdate(1,r);break}case fe:{n0.unsafeUpdate(1,r);break}}}if(t._tag==="Failure"){let r=this.getFiberRef(aa);!No(t.cause)&&r._tag==="Some"&&this.log("Fiber terminated with a non handled error",t.cause,r)}}setExitValue(t){if(this._exitValue=t,Zi(this._runtimeFlags)){let r=this.getFiberRef(go),o=this.id().startTimeMillis,n=new Date().getTime();s0.unsafeUpdate((n-o)/1e3,r)}this.reportExitValue(t);for(let r=this._observers.length-1;r>=0;r--)this._observers[r](t)}getLoggers(){return this.getFiberRef(PA)}log(t,r,o){let n=N(o)?o.value:this.getFiberRef(ph),s=this.getFiberRef(FA);if(R_(s,n))return;let i=this.getFiberRef(Zp),c=this.getFiberRef(sa),p=this.getLoggers(),u=this.unsafeGetFiberRefs();if(io(p)>0){let f=to(this.getFiberRef(ot),Wr),m=new Date(f.unsafeCurrentTimeMillis());for(let y of p)y.log({fiberId:this.id(),logLevel:n,message:t,cause:r,context:u,spans:i,annotations:c,date:m})}}evaluateMessageWhileSuspended(t){switch(t._tag){case il:return vA;case ol:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(K(t.cause)),this._asyncInterruptor=null),Ha;case sl:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),Ha;case nl:return t.onFiber(this,this._exitValue!==null?qC:UC(this._runtimeFlags,this._asyncBlockingOn)),Ha;default:return qa(t)}}evaluateEffect(t){this._supervisor.onResume(this);try{let r=kr(this._runtimeFlags)&&this.isInterrupted()?K(this.getInterruptedCause()):t;for(;r!==null;)try{let o=r,n=this.runLoop(o);this._runtimeFlags=Lm(Ji)(this._runtimeFlags);let s=this.interruptAllChildren();s!==null?r=l(s,()=>n):(this._queue.length===0?this.setExitValue(n):this.tell(Un(n)),r=null)}catch(o){if(de(o))o._tag===ws?Dm(this._runtimeFlags)?(this.tell(YC()),this.tell(Un(Ur)),r=null):r=Ur:o._tag===Ms&&(r=null);else throw o}}finally{this._supervisor.onSuspend(this)}}start(t){if(this._running)this.tell(Un(t));else{this._running=!0;let r=globalThis[Bo];globalThis[Bo]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[Bo]=r,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(t){this.tell(Un(t))}patchRuntimeFlags(t,r){let o=As(t,r);return globalThis[Bo]=this,this._runtimeFlags=o,o}initiateAsync(t,r){let o=!1,n=s=>{o||(o=!0,this.tell(Un(s)))};kr(t)&&(this._asyncInterruptor=n);try{r(n)}catch(s){n(D(Le(s)))}}pushStack(t){this._stack.push(t),t._tag==="OnStep"&&this._steps.push(!0),t._tag==="RevertFlags"&&this._steps.push(!1)}popStack(){let t=this._stack.pop();if(t)return(t._tag==="OnStep"||t._tag==="RevertFlags")&&this._steps.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._tag!==Ts)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._tag!==vs&&t._tag!==ks)return t;t=this.popStack()}}[(AA=Aa,MA=tR,CS)](t){return _(Ye(ho),r=>{try{return wi(r,t)}catch(o){throw console.log(o),o}})}Left(t){return fr(t.i0)}None(t){return fr(po())}Right(t){return X(t.i0)}Some(t){return X(t.i0)}[kp](t){let r=t.i0(),o=this.getNextSuccessCont();if(o!==void 0)return o._tag in ml||qa(o),ml[o._tag](this,o,r);throw X(r)}[me](t){let r=t,o=this.getNextSuccessCont();if(o!==void 0)return o._tag in ml||qa(o),ml[o._tag](this,o,r.i0);throw r}[fe](t){let r=this.getFiberRef(yo),o=ut(r)||r.head._tag==="ExternalSpan"?t.i0:Po(t.i0,eS(r.head)),n=this.getNextFailCont();if(n!==void 0)switch(n._tag){case Ts:case Is:return kr(this._runtimeFlags)&&this.isInterrupted()?K(_s(o)):n.i1(o);case"OnStep":return kr(this._runtimeFlags)&&this.isInterrupted()?K(_s(o)):n.i1(K(o));case ta:return this.patchRuntimeFlags(this._runtimeFlags,n.patch),kr(this._runtimeFlags)&&this.isInterrupted()?K(Ce(o,this.getInterruptedCause())):K(o);default:qa(n)}else throw K(o)}[wp](t){return t.i0(this,yd(this._runtimeFlags))}Blocked(t){if(this._steps[this._steps.length-1]){let r=this.popStack();if(r)switch(r._tag){case"OnStep":return r.i1(t);case"OnSuccess":return he(t.i0,l(t.i1,r.i1));case"OnSuccessAndFailure":return he(t.i0,Y(t.i1,{onFailure:r.i1,onSuccess:r.i2}));case"OnFailure":return he(t.i0,Nr(t.i1,r.i1));case"While":return he(t.i0,l(t.i1,o=>(r.i2(o),r.i0()?Tn({while:r.i0,body:r.i1,step:r.i2}):k)));case"RevertFlags":{this.pushStack(r);break}}}return be(r=>l(Tt(Up(t.i0)),()=>r(t.i1)))}RunBlocked(t){return p0(t.i0)}[lo](t){let r=t.i0,o=this._runtimeFlags,n=As(o,r);if(kr(n)&&this.isInterrupted())return K(this.getInterruptedCause());if(this.patchRuntimeFlags(this._runtimeFlags,r),t.i1){let s=En(n,o);return this.pushStack(new Lp(s,t)),t.i1(o)}else return Ur}[vs](t){return this.pushStack(t),t.i0}OnStep(t){return this.pushStack(t),t.i0}[Ts](t){return this.pushStack(t),t.i0}[Is](t){return this.pushStack(t),t.i0}[Ms](t){throw this._asyncBlockingOn=t.i1,this.initiateAsync(this._runtimeFlags,t.i0),t}[ws](t){throw t}[ks](t){let r=t.i0,o=t.i1;return r()?(this.pushStack(t),o()):Ur}[OS](t){return t.commit()}runLoop(t){let r=t,o=0;for(;;){if(this._runtimeFlags&Nm&&this._supervisor.onEffect(this,r),this._queue.length>0&&(r=this.drainQueueWhileRunning(this._runtimeFlags,r)),o+=1,o>=this.getFiberRef(ch)){o=0;let n=r;r=l(Mt(),()=>n)}try{r._tag in this||(typeof r=="function"&&console.log(r()),qa(r)),r=this._supervisor.onRun(()=>this[r._tag](r),this)}catch(n){if(de(n)){if(n._tag===ws||n._tag===Ms)throw n;if(n._tag===me||n._tag===fe)return n}else kS(n)?r=K(n.cause):wm(n)?r=K(Ce(Le(n),cr(et))):r=K(Le(n))}}}},FA=xe(A_("Info")),u0=cl(e=>{let t=aR.log(e);globalThis.console.log(t)});var l0=cl(({annotations:e,cause:t,context:r,fiberId:o,logLevel:n,message:s})=>{let i=ns(ya(r,yo),sp),c=Me(ya(r,ot),u=>to(u,Wr));if(i._tag==="None"||i.value._tag==="ExternalSpan"||c._tag==="None")return;let p=Object.fromEntries(e);p["effect.fiberId"]=zb(o),p["effect.logLevel"]=n.label,t!==null&&t!==tt&&(p["effect.cause"]=uo(t)),i.value.event(String(s),c.value.unsafeCurrentTimeNanos(),p)}),PA=ah(so(u0,l0)),ja=a(e=>de(e[0]),(e,t)=>Fr(At(e,r=>za(o=>t(r,o))))),NA=a(e=>de(e[0]),(e,t)=>Br(e,za(r=>t(r)))),za=e=>ue(t=>{let r=t.unsafeGetFiberRefs();return l(dl,o=>Ws(o,n=>ue(s=>{let i=s.unsafeGetFiberRefs(),c=ni(i,r),p=ni(r,i);return s.setFiberRefs(bd(c,s.id(),r)),Br(e(n),g(()=>{s.setFiberRefs(bd(p,s.id(),s.unsafeGetFiberRefs()))}))})))}),DA=e=>Ee(ra,d(Wn))(e),IA=Symbol("@effect/io/Effect/existsPar/found"),LA=a(e=>Nt(e[0]),(e,t,r)=>Ra(r,()=>T(()=>HA(e[Symbol.iterator](),0,t)),()=>ie(Jt(e,(o,n)=>Wp(t(o,n),{onTrue:L(IA),onFalse:k}),r),{onFailure:o=>o===IA?h(!0):L(o),onSuccess:()=>h(!1)}))),HA=(e,t,r)=>{let o=e.next();return o.done?h(!1):l(r(o.value,t),n=>n?h(n):HA(e,t+1,r))},qA=a(e=>Nt(e[0]),(e,t,r)=>{let o=r?.negate?(n,s)=>_(t(n,s),Tg):t;return Ra(r,()=>T(()=>J(e).reduceRight((n,s,i)=>mo(n,T(()=>o(s,i)),(c,p)=>p?[s,...c]:c),g(()=>new Array))),()=>_(Jt(e,(n,s)=>_(o(n,s),i=>i?d(n):x()),r),Yg))}),f0=e=>{if(Array.isArray(e)||Nt(e))return[e,x()];let t=Object.keys(e),r=t.length;return[t.map(o=>e[o]),d(o=>{let n={};for(let s=0;s<r;s++)n[t[s]]=o[s];return n})]},m0=(e,t,r)=>{let o=[];for(let n of e)o.push(Dr(n));return l(Jt(o,F,{concurrency:r?.concurrency,batching:r?.batching}),n=>{let s=x(),i=n.length,c=new Array(i),p=new Array(i),u=!1;for(let f=0;f<i;f++){let m=n[f];m._tag==="Left"?(c[f]=d(m.left),u=!0):(p[f]=m.right,c[f]=s)}return u?t._tag==="Some"?L(t.value(c)):L(c):r?.discard?k:t._tag==="Some"?h(t.value(p)):h(p)})},h0=(e,t,r)=>{let o=[];for(let n of e)o.push(Dr(n));return r?.discard?Jt(o,F,{concurrency:r?.concurrency,batching:r?.batching,discard:!0}):_(Jt(o,F,{concurrency:r?.concurrency,batching:r?.batching}),n=>t._tag==="Some"?t.value(n):n)},ui=(e,t)=>{let[r,o]=f0(e);return t?.mode==="validate"?m0(r,o,t):t?.mode==="either"?h0(r,o,t):o._tag==="Some"?_(Jt(r,F,t),o.value):Jt(r,F,t)},UA=e=>t=>ui(t,e),WA=(e,t)=>_(ui(J(e).map(Z),t),ki(r=>ou(r)?d(r.i0):x())),ox=a(2,(e,t)=>Array.from({length:t},()=>e)),jA=a(e=>de(e[0]),(e,t,r)=>ui(ox(t)(e),r)),Jt=a(e=>Nt(e[0]),(e,t,r)=>ue(o=>{let n=r?.batching===!0||r?.batching==="inherit"&&o.getFiberRef(ia);return r?.discard?Sd(r,()=>n?ex(e,t):mt(e,t),()=>pi(e,t,n),s=>nx(e,s,t,n)):Sd(r,()=>n?tx(e,1,t,!0):He(e,t),()=>Wa(e,t,n),s=>tx(e,s,t,n))})),Wa=(e,t,r)=>T(()=>{let o=J(e),n=new Array(o.length);return W(pi(o,(i,c)=>l(t(i,c),p=>g(()=>n[c]=p)),r),h(n))}),ex=(e,t)=>T(()=>{let r=J(e),o=r.length;if(o===0)return k;if(o===1)return Q(t(r[0],0));let n=r.map(t),s=new Array,i=c=>c===n.length?T(()=>{if(s.length>0){let p=s.map(u=>u.i0).reduce(_n);return he(p,ex(s.map(u=>u.i1),F))}return k}):Ds(n[c],p=>p._tag==="Blocked"?(s.push(p),i(c+1)):p._tag==="Failure"?T(()=>{if(s.length>0){let u=s.map(f=>f.i0).reduce(_n);return he(u,l(ex(s.map(f=>f.i1),F),()=>p))}return k}):i(c+1));return i(0)}),pi=(e,t,r)=>T(()=>{let o=J(e),n=o.length;return n===0?k:n===1?Q(t(o[0],0)):be(s=>{let i=zs(et),c=0,p=[],u=[],f=$p(m=>He(o,(y,b)=>_(C=>(C.unsafeAddObserver(()=>{u.push(C)}),C))(Kn(m(l(C=>{switch(C._tag){case"Failure":{if(p.length>0){let R=p.map(w=>w.i0).reduce(_n),v=pi(p,w=>w.i1,r);return he(R,Y(v,{onFailure:w=>W(la(i,void 0),D(Fe(w,C.cause))),onSuccess:()=>W(la(i,void 0),D(C.cause))}))}return W(la(i,void 0),D(C.cause))}default:{if(C._tag==="Blocked"&&p.push(C),c+1===n)if(p.length>0){let R=p.map(w=>w.i0).reduce(_n),v=pi(p,w=>w.i1,r);return Bs(i,he(R,v))}else Gs(i,X(Ur));else c=c+1;return k}}})(T(()=>s((r?wr:Z)(t(y,b))))))))));return l(f,m=>Y(s(ve(i)),{onFailure:y=>l(Wa(m,Wo,r),b=>{let C=js(b,{parallel:!0});return C._tag==="Some"&&hh(C.value)?D(Fe(_s(y),C.value.i0)):D(_s(y))}),onSuccess:y=>l(y,()=>mt(u,b=>b.inheritAll()))}))})}),tx=(e,t,r,o)=>T(()=>{let n=J(e),s=new Array(n.length);return W(nx(n,t,(c,p)=>_(r(c,p),u=>s[p]=u),o),h(s))}),nx=(e,t,r,o)=>T(()=>{let n=0,s=e[Symbol.iterator](),i=[],c=l(g(()=>s.next()),u=>u.done?k:l((o?wr:Z)(Q(r(u.value,n++))),f=>{switch(f._tag){case"Blocked":return i.push(f),c;case"Failure":return f;case"Success":return c}})),p=[];for(let u=0;u<t;u++)p.push(c);return l(Z(pi(p,F,o)),u=>{if(i.length===0)return u;let f=i.map(y=>y.i0).reduce(_n),m=nx(i,t,y=>y.i1,o);return u._tag==="Failure"?he(f,Y(m,{onFailure:y=>K(Fe(u.cause,y)),onSuccess:()=>u})):he(f,m)})}),Tt=e=>ue((t,r)=>h(KA(e,t,r.runtimeFlags))),Kn=e=>d0(e,Wn),zA=a(2,(e,t)=>Tt(Bp(e,r=>{let o=co(r);switch(o._tag){case"Left":return t(o.left);case"Right":return D(o.right)}}))),KA=(e,t,r,o=null)=>{let n=rx(e,t,r,o);return n.resume(e),n},rx=(e,t,r,o=null)=>{let n=lp(),s=t.unsafeGetFiberRefs(),i=Lu(s,n),c=new Ua(n,i,r),p=Zs(i,ho),u=c._supervisor;return u.onStart(p,e,d(t),c),c.unsafeAddObserver(m=>u.onEnd(m,c)),(o!==null?o:$(()=>t.scope())(t.getFiberRef(ra))).add(r,c),c},d0=(e,t)=>ue((r,o)=>h(KA(e,r,o.runtimeFlags,t))),sx=a(e=>Nt(e[0]),(e,t,r,o)=>Ra(o,()=>J(e).reduce((n,s,i)=>mo(n,s,(c,p)=>r(c,p,i)),h(t)),()=>l(Sa(t),n=>l(Jt(e,(s,i)=>l(s,c=>L_(n,p=>r(p,c,i))),o),()=>$u(n))))),ix=a(e=>Nt(e[0]),(e,t,r)=>_(o=>DS(o,F))(Jt(e,(o,n)=>Dr(t(o,n)),r))),BA=a(e=>Nt(e[0]),(e,t,r)=>l(ix(e,t,{concurrency:r?.concurrency,batching:r?.batching}),([o,n])=>o.length===0?r?.discard?k:h(n):L(o))),GA=e=>{let t=Tr(e);if(!Ke(t))return Lo(()=>Cs("Received an empty collection of effects"));let r=Be(t),o=Ge(t),n=s=>V(s[0])(rR(s[1]));return l(s=>l(i=>be(c=>l(p=>l(u=>Uo(()=>it(k,(f,m)=>qs(Wo(m))(f))(u))(c(l(n)(Fn(s)))))(At(u=>it(k,(f,m)=>W(Q(Tt(l(x0(u,m,s,i))(Cd(m)))))(f))(u))(_(u=>Te(p)(u))(_(Ot)(He(u=>Tt(jt(u)))(o))))))(Tt(jt(r)))))(Sa(o.length)))(rt())},x0=(e,t,r,o)=>n=>kn(n,{onFailure:s=>ft(D_(o,i=>[i===0?Q(wn(r,s)):k,i-1])),onSuccess:s=>l(i=>i?it(k,(c,p)=>p===t?c:qs(Wo(p))(c))(Tr(e)):k)(Bs(r,[s,t]))}),$A=a(e=>Nt(e[0]),(e,t,r,o)=>Ra(o,()=>J(e).reduce((n,s,i)=>mo(n,s,(c,p)=>r(c,p,i)),t),()=>T(()=>_(n=>{switch(n._tag){case"None":throw new Error("BUG: Effect.reduceEffect - please report an issue at https://github.com/Effect-TS/io/issues");case"Some":return n.value}})(sx([t,...e],x(),(n,s,i)=>{switch(n._tag){case"None":return d(s);case"Some":return d(r(n.value,s,i))}},o))))),VA=e=>l(dl,t=>l(Bn(BC),r=>W(Gn(e,r))(t.addFinalizer(o=>r.close(o))))),$o=e=>l(fx,e),ax=e=>l(Bn(),t=>y0(t)(e)),YA=e=>$o(t=>l(r=>Gn(r)(e))(fh(t,si))),JA=(e,t)=>cx([Wu(e,t)]),cx=e=>px(pt(e)),px=e=>dr(go,t=>Ve(e)(t)),QA=a(2,(e,t)=>zt(Bn(),r=>l(Gn(e,r),t),(r,o)=>jo(r,o))),ZA=e=>ie(e,{onFailure:t=>{switch(t._tag){case"None":return h(x());case"Some":return L(t.value)}},onSuccess:t=>h(d(t))}),XA=a(e=>de(e[1]),(e,t,r)=>ux(e,t,(o,n)=>[o,n],r)),ux=a(e=>de(e[1]),(e,t,r,o)=>ft(Eo(Z(e),Z(t),(n,s)=>ua(n,s,{onSuccess:r,onFailure:(i,c)=>o?.concurrent?Fe(i,c):Ce(i,c)}),o)));var eM=a(e=>Nt(e[0]),(e,t,r)=>qo(Jt(e,(o,n)=>qo(t(o,n)),r))),tM=e=>dr(ot,we(Wr,e)),hl=e=>dr(ot,we(Js,e)),rM=e=>$o(t=>l(fh(t,si),r=>_(o=>[Bt(n=>jo(r,su(n))),o])(Gn(r)(e)))),oM=a(e=>de(e[1]),(e,t,r)=>Eo(e,t,(o,n)=>[o,n],r)),nM=a(e=>de(e[1]),(e,t,r)=>Eo(e,t,(o,n)=>o,r)),sM=a(e=>de(e[1]),(e,t,r)=>Eo(e,t,(o,n)=>n,r)),Eo=a(e=>de(e[1]),(e,t,r,o)=>_(ui([e,t],{concurrency:o?.concurrent?2:1,batching:o?.batching}),([n,s])=>r(n,s))),lx=e=>e===Mp?k:Fr(l(t=>{let r=As(t,e),o=En(r,t);return Q(W(za(()=>Ls(o)))(Ls(e)))})(Gp)),g0=(e,t)=>r=>T(()=>{switch(r.state._tag){case"Exited":return k;case"Running":{let o=r.state.finalizers,n=r.state.update,s=Array.from(o.keys()).sort((i,c)=>c-i).map(i=>o.get(i));return r.state={_tag:"Exited",nextKey:r.state.nextKey,exit:t,update:n},GC(e)?l(i=>$(()=>Ur)(Me(pa)(js(i))))(He(i=>Z(n(i)(t)))(s)):$C(e)?l(i=>$(()=>Ur)(Me(pa)(js(i,{parallel:!0}))))(Wa(s,i=>Z(n(i)(t)),!1)):l(i=>$(()=>Ur)(Me(pa)(js(i,{parallel:!0}))))(tx(s,e.parallelism,i=>Z(n(i)(t)),!1))}}}),fx=St(ru),dl=fx,Bn=(e=si)=>_(YS,t=>({[ru]:ru,[lh]:lh,pipe(){return E(this,arguments)},fork:r=>Fr(l(o=>V(o)(At(n=>Ws(o,n))(mh(t,n=>jo(o,n)))))(Bn(r))),close:r=>Q(g0(e,r)(t)),addFinalizer:r=>Q(mh(r)(t))})),Gn=a(2,(e,t)=>Mn(e,is(Of(fx,t)))),y0=a(2,(e,t)=>lr(r=>t.close(r))(Gn(t)(e))),b0=e=>Us(e,{differ:RA,fork:ai}),Qt=a(2,(e,t)=>Q(ja(l(Ye(e),r=>V(Cn(e,t),r)),r=>Cn(e,r)))),dr=a(2,(e,t)=>Se(e,r=>Qt(e,t(r))));var kA=KS(Hm),ci=b0(zn),iM=e=>Q(Cd(xl(e))),xl=e=>({[Aa]:Ma,id:()=>J(e).reduce((t,r)=>Em(t,r.id()),et),await:()=>Z(Wa(e,t=>ft(t.await()),!1)),children:()=>_(Wa(e,t=>t.children(),!1),Fc),inheritAll:()=>mt(e,t=>t.inheritAll()),poll:()=>_(He(e,t=>t.poll()),Pc(d(X(new Array)),(t,r)=>{switch(r._tag){case"None":return x();case"Some":switch(t._tag){case"None":return x();case"Some":return d(ua(r.value,t.value,{onSuccess:(o,n)=>[o,...n],onFailure:Fe}))}}})),interruptAsFork:t=>mt(e,r=>r.interruptAsFork(t)),pipe(){return E(this,arguments)}});var mx=a(3,(e,t,r)=>hx(e,t,{onSelfWin:(o,n)=>l(o.await(),s=>{switch(s._tag){case me:return l(o.inheritAll(),()=>r.onSelfDone(s,n));case fe:return r.onSelfDone(s,n)}}),onOtherWin:(o,n)=>l(o.await(),s=>{switch(s._tag){case me:return l(o.inheritAll(),()=>r.onOtherDone(s,n));case fe:return r.onOtherDone(s,n)}})})),aM=e=>be(t=>Bt(r=>l(Kn(t(e)),o=>Uo(()=>oR(r)(o))(t(jn(o)))))),gl=a(2,(e,t)=>Bt(r=>mx(e,t,{onSelfDone:(o,n)=>kn(o,{onFailure:s=>Xs(i=>Fe(s,i))(jn(n)),onSuccess:s=>V(s)(Gt(r)(n))}),onOtherDone:(o,n)=>kn(o,{onFailure:s=>Xs(i=>Fe(i,s))(jn(n)),onSuccess:s=>V(s)(Gt(r)(n))})}))),hx=a(3,(e,t,r)=>ue((o,n)=>{let s=n.runtimeFlags,i=at(!0),c=rx(e,o,s,r.selfScope),p=rx(t,o,s,r.otherScope);return Kt(u=>{c.unsafeAddObserver(()=>wA(c,p,r.onSelfWin,i,u)),p.unsafeAddObserver(()=>wA(p,c,r.onOtherWin,i,u)),c.startFork(e),p.startFork(t)},Em(c.id(),p.id()))})),wA=(e,t,r,o,n)=>{Jc(!0,!1)(o)&&n(r(e,t))},Br=a(2,(e,t)=>be(r=>Y(r(e),{onFailure:o=>Y(t,{onFailure:n=>D(Ce(o,n)),onSuccess:()=>D(o)}),onSuccess:o=>V(t,o)}))),S0=(e,t)=>Bt(r=>l(l(Kn(jt(e)),o=>Kt(n=>{let s=t.map(p=>p.listeners.count),i=()=>{s.every(p=>p===0)&&(c.forEach(p=>p()),n(Wo(o)))};o.unsafeAddObserver(p=>{c.forEach(u=>u()),n(p)});let c=t.map((p,u)=>{let f=m=>{s[u]=m,i()};return p.listeners.addObserver(f),()=>p.listeners.removeObserver(f)});return i(),g(()=>{c.forEach(p=>p())})})),()=>T(()=>{let o=t.flatMap(n=>n.state.completed?[]:[n]);return mt(o,n=>dA(n.request,su(r)))})));var cM=(e,t)=>ja(ri(e,t),(r,o)=>l(Xu,n=>g(()=>r.end(n,o)))),yl=(e,t)=>l(ri(e,t),r=>dr(yo,ko(r))),bl=e=>dr(ot,we(Qs,e)),Sl=e=>dr(yo,ko(e));var pM,fM,uM=(e,t,r,o)=>ro({_tag:"Complete",key:e,exit:t,entryStats:r,timeToLiveMillis:o}),lM=(e,t)=>ro({_tag:"Pending",key:e,deferred:t}),E0=(e,t)=>ro({_tag:"Refreshing",deferred:e,complete:t}),dx=Symbol.for("@effect/cache/Cache/MapKey"),xx=class{constructor(t){this.current=t,this[pM]=dx,this.previous=void 0,this.next=void 0}[(pM=dx,A)](){return I(S(this.next))(I(S(this.previous))(S(this.current)))}[M](t){return this===t?!0:_0(t)&&O(this.current,t.current)&&O(this.previous,t.previous)&&O(this.next,t.next)}},li=e=>new xx(e),_0=e=>typeof e=="object"&&e!=null&&dx in e,gx=class{constructor(){this.head=void 0,this.tail=void 0}add(t){if(t!==this.tail)if(this.tail===void 0)this.head=t,this.tail=t;else{let r=t.previous,o=t.next;o!==void 0&&(t.next=void 0,r!==void 0?(r.next=o,o.previous=r):(this.head=o,this.head.previous=void 0)),this.tail.next=t,t.previous=this.tail,this.tail=t}}remove(){let t=this.head;if(t!==void 0){let r=t.next;r!==void 0?(t.next=void 0,this.head=r,this.head.previous=void 0):(this.head=void 0,this.tail=void 0)}return t}},O0=()=>new gx,C0=(e,t,r,o,n,s)=>({map:e,keys:t,accesses:r,updating:o,hits:n,misses:s}),R0=()=>C0(sn(),O0(),ob(),at(!1),0,0),A0="@effect/cache/Cache",M0=Symbol.for(A0),T0={_Key:e=>e,_Error:e=>e,_Value:e=>e},v0=e=>e,El=e=>({loadedMillis:e}),yx=class{constructor(t,r,o,n,s){this.capacity=t,this.context=r,this.fiberId=o,this.lookup=n,this.timeToLive=s,this[fM]=T0,this.cacheState=R0()}get(t){return _(this.getEither(t),Tc)}cacheStats(){return g(()=>v0({hits:this.cacheState.hits,misses:this.cacheState.misses,size:Qc(this.cacheState.map)}))}getOption(t){return T(()=>De(ye(this.cacheState.map,t),{onNone:()=>{let r=li(t);return this.trackAccess(r),this.trackMiss(),h(x())},onSome:r=>this.resolveMapValue(r)}))}getOptionComplete(t){return T(()=>De(ye(this.cacheState.map,t),{onNone:()=>{let r=li(t);return this.trackAccess(r),this.trackMiss(),h(x())},onSome:r=>this.resolveMapValue(r,!0)}))}contains(t){return g(()=>nr(this.cacheState.map,t))}entryStats(t){return g(()=>{let r=ye(this.cacheState.map,t);if(N(r))switch(r.value._tag){case"Complete":{let o=r.value.entryStats.loadedMillis;return d(El(o))}case"Pending":return x();case"Refreshing":{let o=r.value.complete.entryStats.loadedMillis;return d(El(o))}}return x()})}getEither(t){return T(()=>{let r=t,o,n,s=je(ye(this.cacheState.map,r));return s===void 0&&(n=gh(this.fiberId),o=li(r),nr(this.cacheState.map,r)?s=je(ye(this.cacheState.map,r)):ct(this.cacheState.map,r,lM(o,n))),s===void 0?(this.trackAccess(o),this.trackMiss(),_(this.lookupValueOf(t,n),P)):l(this.resolveMapValue(s),De({onNone:()=>this.getEither(t),onSome:i=>h(q(i))}))})}invalidate(t){return g(()=>{an(this.cacheState.map,t)})}invalidateWhen(t,r){return g(()=>{let o=ye(this.cacheState.map,t);N(o)&&o.value._tag==="Complete"&&o.value.exit._tag==="Success"&&r(o.value.exit.value)&&an(this.cacheState.map,t)})}invalidateAll(){return g(()=>{this.cacheState.map=sn()})}refresh(t){return Kr(r=>T(()=>{let o=t,n=gh(this.fiberId),s=je(ye(this.cacheState.map,o));if(s===void 0&&(nr(this.cacheState.map,o)?s=je(ye(this.cacheState.map,o)):ct(this.cacheState.map,o,lM(li(o),n))),s===void 0)return Q(this.lookupValueOf(t,n));switch(s._tag){case"Complete":{if(this.hasExpired(r,s.timeToLiveMillis)){let i=je(ye(this.cacheState.map,o));return O(i,s)&&an(this.cacheState.map,o),Q(this.get(t))}return Q(Zu(()=>{let i=je(ye(this.cacheState.map,o));if(O(i,s)){let c=E0(n,s);return ct(this.cacheState.map,o,c),!0}return!1})(this.lookupValueOf(t,n)))}case"Pending":return Fn(s.deferred);case"Refreshing":return Fn(s.deferred)}}))}set(t,r){return Kr(o=>g(()=>{let n=o.unsafeCurrentTimeMillis(),s=t,i=sE(r),c=uM(li(s),i,El(n),n+Rr(ze(this.timeToLive(i))));ct(this.cacheState.map,s,c)}))}size(){return g(()=>Qc(this.cacheState.map))}values(){return g(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[1].exit.value);return t})}entries(){return g(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push([r[0],r[1].exit.value]);return t})}keys(){return g(()=>{let t=[];for(let r of this.cacheState.map)r[1]._tag==="Complete"&&r[1].exit._tag==="Success"&&t.push(r[0]);return t})}resolveMapValue(t,r=!1){return Kr(o=>{switch(t._tag){case"Complete":return this.trackAccess(t.key),this.trackHit(),this.hasExpired(o,t.timeToLiveMillis)?(an(this.cacheState.map,t.key.current),h(x())):_(t.exit,d);case"Pending":return this.trackAccess(t.key),this.trackHit(),r?h(x()):_(Fn(t.deferred),d);case"Refreshing":return this.trackAccess(t.complete.key),this.trackHit(),this.hasExpired(o,t.complete.timeToLiveMillis)?r?h(x()):_(Fn(t.deferred),d):_(t.complete.exit,d)}})}trackHit(){this.cacheState.hits=this.cacheState.hits+1}trackMiss(){this.cacheState.misses=this.cacheState.misses+1}trackAccess(t){if(nb(this.cacheState.accesses,t),Jc(this.cacheState.updating,!1,!0)){let r=!0;for(;r;){let n=sb(this.cacheState.accesses,Zf);n===Zf?r=!1:this.cacheState.keys.add(n)}let o=Qc(this.cacheState.map);for(r=o>this.capacity;r;){let n=this.cacheState.keys.remove();n!==void 0?nr(this.cacheState.map,n.current)&&(an(this.cacheState.map,n.current),o=o-1,r=o>this.capacity):r=!1}Ut(this.cacheState.updating,!1)}}hasExpired(t,r){return t.unsafeCurrentTimeMillis()>r}lookupValueOf(t,r){return Kr(o=>T(()=>{let n=t;return Uo(()=>W(rE(r),g(()=>{an(this.cacheState.map,n)})))(l(s=>{let i=o.unsafeCurrentTimeMillis(),c=El(i),p=uM(li(n),s,c,i+Rr(ze(this.timeToLive(s))));return ct(this.cacheState.map,n,p),W(tE(r,s),s)})(Z(Rt(this.context)(this.lookup(t)))))}))}};fM=M0;var mM=(e,t,r)=>new yx(e,Ht(),cp,t,o=>ze(r(o)));var I0="@effect/io/Schedule/Interval",bx=Symbol.for(I0),hM={[bx]:bx,startMillis:0,endMillis:0};var dM=hM;var xM=e=>$(()=>dM)(cn(e.intervals)).startMillis;var gM=xM;var N0="Done";var yM=e=>e._tag===N0;var bM=yM;var H0,SM,q0="@effect/io/Schedule",U0=Symbol.for(q0),W0="@effect/io/Schedule/Driver",j0=Symbol.for(W0);var z0={_Env:e=>e,_In:e=>e,_Out:e=>e};H0=U0;var Sx=class{constructor(t,r){this.schedule=t,this.ref=r,this[SM]=z0}state(){return _(hr(this.ref),t=>t[1])}last(){return l(hr(this.ref),([t,r])=>{switch(t._tag){case"None":return ur(()=>po());case"Some":return h(t.value)}})}reset(){return zr(this.ref,[x(),this.schedule.initial])}next(t){return l(r=>l(o=>l(([n,s,i])=>bM(i)?W(L(x()))(zr(this.ref,[d(s),n])):V(s)(W(ei(as(gM(i.intervals)-o)))(zr(this.ref,[d(s),n]))))(T(()=>this.schedule.step(o,t,r))))(Nu))(_(hr(this.ref),r=>r[1]))}};SM=j0;var Ex=e=>_(t=>new Sx(e,t))(Dn([x(),e.initial]));var EM=a(2,(e,t)=>_x(e,t,(r,o)=>L(r))),_x=a(3,(e,t,r)=>l(Ex(t),o=>ie(e,{onFailure:n=>r(n,x()),onSuccess:n=>_M(e,o,r,n)}))),_M=(e,t,r,o)=>ie(t.next(o),{onFailure:()=>An(t.last()),onSuccess:n=>ie(e,{onFailure:s=>r(s,d(n)),onSuccess:s=>_M(e,t,r,s)})}),OM=a(2,(e,t)=>Ba(e,r=>g(()=>t(r)))),Ba=a(2,(e,t)=>l(e,r=>l(t(r),o=>o?h(r):l(Mt(),()=>Ba(e,t))))),CM=a(2,(e,t)=>Ox(e,r=>g(()=>t(r)))),Ox=a(2,(e,t)=>Ba(e,r=>Ca(t(r)))),RM=a(2,(e,t)=>Cx(e,t,(r,o)=>L(r))),AM=a(2,(e,t)=>MM(e,t)),MM=(e,t)=>lt(e,r=>t<0?L(r):l(Mt(),()=>MM(e,t-1))),Cx=a(3,(e,t,r)=>l(Ex(t),o=>TM(e,o,r))),TM=(e,t,r)=>lt(e,o=>ie(t.next(o),{onFailure:()=>l(n=>r(o,n))(An(t.last())),onSuccess:()=>TM(e,t,r)})),vM=a(2,(e,t)=>Ga(e,r=>g(()=>t(r)))),Ga=a(2,(e,t)=>lt(e,r=>l(t(r),o=>o?L(r):l(Mt(),()=>Ga(e,t))))),IM=a(2,(e,t)=>Rx(e,r=>g(()=>t(r)))),Rx=a(2,(e,t)=>Ga(e,r=>Ca(t(r)))),_l=a(2,(e,t)=>Ax(e,void 0,t)),Ax=a(3,(e,t,r)=>l(Ex(r),o=>kM(e,t,o))),kM=(e,t,r)=>ie(r.next(t),{onFailure:()=>An(r.last()),onSuccess:()=>l(e,o=>kM(e,o,r))});var FM,NM,DM,Tx=class{constructor(t){this.permits=t,this.waiters=new Array,this.taken=0,this.take=r=>Pr(o=>{if(this.free<r){let n=()=>{if(this.free>=r){let s=this.waiters.findIndex(i=>i===n);s!==-1&&this.waiters.splice(s,1),this.taken+=r,o(h(r))}};return this.waiters.push(n),q(g(()=>{let s=this.waiters.findIndex(i=>i===n);s!==-1&&this.waiters.splice(s,1)}))}return this.taken+=r,P(h(r))}),this.release=r=>ue(o=>(this.taken-=r,o.getFiberRef(xo).scheduleTask(()=>{this.waiters.forEach(n=>n())},o.getFiberRef(na)),k)),this.withPermits=r=>o=>be(n=>l(n(this.take(r)),s=>Br(n(o),this.release(s))))}get free(){return this.permits-this.taken}},Cl=e=>new Tx(e),LM=e=>g(()=>Cl(e)),HM=e=>Rl(e,iM),qM=a(2,(e,t)=>_(Ix(e,t),r=>r[0])),Ix=a(2,(e,t)=>{let r=ze(t);return l(Lr(),o=>_(Al(x()),n=>[Rt(K0(e,r,n),o),B0(n)]))}),PM=(e,t,r)=>{let o=Rr(ze(t));return _(n=>d([r+o,n]))(At(n=>qr(e,n))(rt()))},K0=(e,t,r)=>be(o=>l(n=>j(n)?Ps("BUG: Effect.cachedInvalidate - please report an issue at https://github.com/Effect-TS/io/issues"):o(ve(n.value[1])))(l(n=>J0(r,s=>{switch(s._tag){case"None":return d(PM(e,t,n));case"Some":{let[i]=s.value;return i-n<=0?d(PM(e,t,n)):x()}}}))(Kr(n=>n.currentTimeMillis)))),B0=e=>zr(e,x()),UM=a(2,(e,t)=>Rl(e,r=>t(xl(r)))),Rl=a(2,(e,t)=>l(SA,r=>Br(l(r.value(),t))(Fx(e,r)))),WM=a(e=>Nt(e[0]),(e,t)=>t?.discard?mt(e,Tt):_(He(e,Tt),xl)),kx=a(2,(e,t)=>be(r=>l(t.fork(si),o=>At(n=>o.addFinalizer(()=>Bt(s=>O(s,n.id())?k:Q(Wo(n)))))(Kn(lr(n=>o.close(n))(r(e))))))),wx=e=>$o(t=>kx(e,t)),jM=e=>jn(e),zM=e=>T(()=>l(e,jn)),Mx=Symbol.for("@effect/io/Effect/memoizeFunction.key"),Ol=class{constructor(t,r){this.a=t,this.eq=r,this[FM]=Mx}[(FM=Mx,M)](t){return typeof t=="object"&&t!==null&&Mx in t?this.eq?this.eq(this.a,t.a):O(this.a,t.a):!1}[A](){return this.eq?0:S(this.a)}},KM=(e,t)=>_(r=>o=>l(([n,s])=>V(s)(qn(n)))(l(ve)(r.modifyEffect(n=>{let s=ye(new Ol(o,t))(n);return j(s)?_(i=>[i,ct(new Ol(o,t),i)(n)])(At(i=>Tt(qr(i)(Ln(e(o)))))(rt())):h([s.value,n])}))))(l(Al)(g(()=>sn()))),BM=a(2,(e,t)=>(r=>ft(r))(gl(Z(t))(Z(e)))),GM=a(2,(e,t)=>wx(_l(t)(e))),Fx=a(2,(e,t)=>qe(ci,o=>o.zip(t))(e)),$M=a(2,(e,t)=>$a(e,{onTimeout:x,onSuccess:d,duration:t})),VM=a(2,(e,{duration:t,onTimeout:r})=>ft($a(e,{onTimeout:()=>ur(r),onSuccess:h,duration:t}))),YM=a(2,(e,{duration:t,onTimeout:r})=>ft($a(e,{onTimeout:()=>Hr(r),onSuccess:h,duration:t}))),$a=a(2,(e,{duration:t,onSuccess:r,onTimeout:o})=>Bt(n=>hx(e,jt(ei(t)),{onSelfWin:(s,i)=>l(s.await(),c=>c._tag==="Success"?l(s.inheritAll(),()=>V(Gt(i,n),r(c.value))):l(Gt(i,n),()=>K(c.cause))),onOtherWin:(s,i)=>l(s.await(),c=>c._tag==="Success"?l(s.inheritAll(),()=>V(Gt(i,n),o())):l(Gt(i,n),()=>K(c.cause))),otherScope:Wn}))),G0="@effect/io/Ref/Synchronized",$0=Symbol.for(G0),V0={_A:e=>e},vx=class{constructor(t,r){this.ref=t,this.withLock=r,this[NM]=V0,this[DM]=$h}modify(t){return this.modifyEffect(r=>h(t(r)))}modifyEffect(t){return this.withLock(l(([r,o])=>V(zr(this.ref,o),r))(l(hr(this.ref),t)))}pipe(){return E(this,arguments)}};NM=$0,DM=zu;var Al=e=>g(()=>Y0(e)),Y0=e=>{let t=Ku(e),r=Cl(1);return new vx(t,r.withPermits(1))},J0=a(2,(e,t)=>e.modifyEffect(r=>{let o=t(r);switch(o._tag){case"None":return h([r,r]);case"Some":return _(o.value,n=>[n,n])}}));var QM="Fresh",ZM="FromEffect",XM="Scoped",eT="Suspend";var tT="ZipWithPar";var rT=Gt;var Tl=e=>(t,r)=>{let o=lp(),n=t,s=Lh(e.fiberRefs,{fiberId:o,fiberRef:ho,value:e.context});r?.scheduler&&(s=Lh(s,{fiberId:o,fiberRef:xo,value:r.scheduler})),r?.updateRefs&&(s=r.updateRefs(s,o));let i=new Ua(o,u_(s,o),e.runtimeFlags),c=i._supervisor;return c!==zn&&(c.onStart(e.context,n,x(),i),i.unsafeAddObserver(p=>c.onEnd(p,i))),Wn.add(e.runtimeFlags,i),i.start(n),i},Px=e=>(t,r)=>{let o=Tl(e)(t);return r&&o.unsafeAddObserver(n=>{r(n)}),(n,s)=>Px(e)(rT(n??et)(o),s?i=>s(nE(i)):void 0)},X0=e=>t=>{let r=aT(e)(t);if(r._tag==="Failure")throw sT(r.i0);return r.i0},eP=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new Error;Error.stackTraceLimit=t;let o=`Fiber #${e.id().id} cannot be be resolved synchronously, this is caused by using runSync on an effect that performs async work`,n="AsyncFiberException";return Object.defineProperties(r,{_tag:{value:n},message:{value:o},name:{value:n},toString:{get(){return()=>o}},[nT]:{get(){return()=>o}}}),r};var oT=Symbol.for("@effect/io/Runtime/FiberFailure"),tP=Symbol.for("@effect/io/Runtime/FiberFailure/Cause"),nT=Symbol.for("nodejs.util.inspect.custom"),sT=e=>{let t=Error.stackTraceLimit;Error.stackTraceLimit=0;let r=new Error;Error.stackTraceLimit=t;let o=bp(e);return o.length>0&&(r.name=o[0].message.split(":")[0],r.message=o[0].message.substring(r.name.length+2),r.stack=`${r.name}: ${r.message}
${o[0].stack}`),r[oT]=oT,r[tP]=e,r.toString=()=>uo(e),r[nT]=()=>r.toString(),r};var iT=e=>{let t=e;switch(t._tag){case"Failure":case"Success":return t;case"Left":return fr(t.left);case"Right":return X(t.right);case"Some":return X(t.value);case"None":return fr(po())}},aT=e=>t=>{let r=iT(t);if(r)return r;let o=new Np,n=Tl(e)(t,{scheduler:o});o.flush();let s=n.unsafePoll();if(s)return s;throw eP(n)},rP=e=>t=>cT(e)(t).then(r=>{switch(r._tag){case me:return r.i0;case fe:throw sT(r.i0)}}),cT=e=>t=>new Promise(r=>{let o=iT(t);o&&r(o),Tl(e)(t).unsafeAddObserver(n=>{r(n)})}),Ml=class{constructor(t,r,o){this.context=t,this.runtimeFlags=r,this.fiberRefs=o}pipe(){return E(this,arguments)}},oP=e=>new Ml(e.context,e.flags,e.fiberRefs),Nx=()=>ue((e,t)=>h(new Ml(e.getFiberRef(ho),t.runtimeFlags,e.unsafeGetFiberRefs()))),nP=Rp(pr,Cp,Op),xr=oP({context:Ht(),flags:nP,fiberRefs:m_(new Map)}),pT=Px(xr),uT=Tl(xr),lT=rP(xr),fT=cT(xr),mT=X0(xr),hT=aT(xr),dT=e=>l(rt(),t=>l(Nx(),r=>be(o=>W(Tt(o(Nr(e(n=>Px(r)(qr(n,t))),n=>wn(t,n)))),o(ve(t))))));var xT=a(2,(e,t)=>e.modifyEffect(t));var aP="@effect/io/Layer",cP=Symbol.for(aP),pP={_RIn:e=>e,_E:e=>e,_ROut:e=>e},vl={[cP]:pP,pipe(){return E(this,arguments)}};var uP=e=>e._tag===QM,Dx=class{constructor(t){this.ref=t}getOrElseMemoize(t,r){return ft(xT(this.ref,o=>{let n=o.get(t);if(n!==void 0){let[s,i]=n,c=lr(iu({onFailure:()=>k,onSuccess:()=>Ws(r,i)}))(l(([p,u])=>V(u)(qn(p)))(s));return h([c,o])}return l(s=>l(i=>_(c=>{let p=be(f=>l(m=>l(y=>{switch(y._tag){case fe:return W(D(y.i0))(W(jo(m,y))(wn(i,y.i0)));case me:return V(y.i0[1])(W(Bs(i,y.i0))(W(Ws(r,b=>l(C=>C(b))(hr(c))))(W(ba(s,b=>b+1))(zr(c,b=>Q(Hs(Bu(s,C=>[C===1,C-1]))(jo(m,b))))))))}})(Z(f(l(yT(t,m),y=>Ln(y(this)))))))(Bn())),u=[lr(kn({onFailure:()=>k,onSuccess:()=>ba(s,f=>f+1)}))(ve(i)),f=>l(m=>m(f))(hr(c))];return[p,uP(t)?o:o.set(t,u)]})(Dn(()=>k)))(rt()))(Dn(0))}))}},lP=()=>_(Al(new Map),e=>new Dx(e));var gT=a(2,(e,t)=>l(lP(),r=>l(yT(e,t),o=>o(r)))),yT=(e,t)=>{let r=e;switch(r._tag){case"Locally":return g(()=>o=>r.f(o.getOrElseMemoize(r.self,t)));case"ExtendScope":return g(()=>o=>$o(n=>o.getOrElseMemoize(r.layer,n)));case"Fold":return g(()=>o=>Y({onFailure:n=>o.getOrElseMemoize(r.failureK(n),t),onSuccess:n=>o.getOrElseMemoize(r.successK(n),t)})(o.getOrElseMemoize(r.layer,t)));case"Fresh":return g(()=>o=>gT(t)(r.layer));case"FromEffect":return g(()=>o=>r.effect);case"ProvideTo":return g(()=>o=>l(n=>Rt(n)(o.getOrElseMemoize(r.second,t)))(o.getOrElseMemoize(r.first,t)));case"Scoped":return g(()=>o=>Gn(r.effect,t));case"Suspend":return g(()=>o=>o.getOrElseMemoize(r.evaluate(),t));case"ZipWith":return g(()=>o=>mo(o.getOrElseMemoize(r.second,t),r.zipK)(o.getOrElseMemoize(r.first,t)));case"ZipWithPar":return g(()=>o=>Eo(o.getOrElseMemoize(r.second,t),r.zipK,{concurrent:!0})(o.getOrElseMemoize(r.first,t)))}};var fP=()=>mP(Lr());function mP(e){let t=Object.create(vl);return t._tag=ZM,t.effect=e,t}var hP=a(2,(e,t)=>gP(e,t,(r,o)=>is(o)(r)));var vt=e=>dP(V(Ht())(e)),dP=e=>{let t=Object.create(vl);return t._tag=XM,t.effect=e,t};var xP=e=>{let t=Object.create(vl);return t._tag=eT,t.evaluate=e,t};var gP=a(3,(e,t,r)=>xP(()=>{let o=Object.create(vl);return o._tag=tT,o.first=e,o.second=t,o.zipK=r,o})),Lx=a(2,(e,t)=>zt(Bn(),r=>l(gT(t,r),o=>Rt(e,o)),(r,o)=>jo(r,o))),bT=a(2,(e,t)=>Lx(e,hP(fP(),t)));var ET=e=>vt(hl(e)),_T=e=>vt(Sl(e)),OT=(e,t)=>vt(yl(e,t)),CT=e=>vt(bl(e));var Hx=En;var fi=xe(mM(65536,()=>_(rt(),e=>({listeners:new Na,handle:e})),()=>Af(60))),Va=z(Symbol.for("@effect/io/FiberRef/currentCacheEnabled"),()=>xe(!1)),qx=(e,t)=>l(de(t)?t:h(t),r=>Bt(o=>{let n=new Proxy(e,{});return Se(Va,s=>{if(s)return Se(fi,c=>l(c.getEither(n),p=>{switch(p._tag){case"Left":return p.left.listeners.increment(),he(hS,l(Z(ve(p.left.handle)),u=>u._tag==="Failure"&&No(u.cause)?(p.left.listeners.decrement(),l(c.invalidateWhen(n,f=>f.handle===p.left.handle),()=>qx(n,t))):Br(ve(p.left.handle),g(()=>p.left.listeners.decrement()))));case"Right":return p.right.listeners.increment(),he(Bm(r,Gm({request:n,result:p.right.handle,listeners:p.right.listeners,ownerId:o,state:{completed:!1}})),be(u=>l(Z(u(ve(p.right.handle))),f=>(p.right.listeners.decrement(),f))))}}));let i=new Na;return i.increment(),l(rt(),c=>he(Bm(r,Gm({request:n,result:c,listeners:i,ownerId:o,state:{completed:!1}})),Br(ve(c),g(()=>i.decrement()))))})})),RT=(e,t)=>Se(Va,r=>r?Se(fi,o=>l(o.getEither(e),n=>{switch(n._tag){case"Left":return k;case"Right":return dh(n.right.handle,t)}})):k),AT=a(2,(e,t)=>Ee(e,Va,t)),MT=a(2,(e,t)=>Ee(e,fi,t));var EP=Fs,_P=de,OP=qM,CP=Ix,RP=Xh,AP=KM,MP=ed,TP=ui,vP=UA,IP=WA,kP=nO,wP=sO,FP=hO,PP=LA,NP=qA,DP=uO,LP=fO,Ya=Jt,HP=yO,qP=sx,UP=ix,WP=BO,jP=$A,zP=GO,KP=$O,BP=ox,GP=jA,$P=tC,VP=rC,YP=BA,JP=eM,QP=Kt,ZP=dT,XP=j_,eN=Pr,tN=L,rN=ur,oN=D,nN=Hr,sN=Zm,iN=Ps,aN=Lo,cN=gO,pN=vn,uN=LO,lN=jO,fN=h,mN=ti,hN=rd,mi=T,dN=g,ht=k,xN=Mt,gN=z_;var yN=lt,bN=Nr,SN=K_,EN=FS,_N=B_,ON=G_,CN=$_,RN=V_,AN=Y_,MN=Yh,TN=bO,vN=SO,IN=WO,kN=QO,wN=RM,FN=AM,PN=Cx,NN=vM,DN=Ga,LN=IM,HN=Rx,qN=Ea;var UN=uC,WN=lC,jN=ad,zN=hC,KN=Z_,BN=PS,GN=aM,$N=jp,VN=zp,YN=jt,JN=NS,QN=Uo,ZN=Fr,XN=be,eD=V,tD=Vu,rD=W_,oD=Q,nD=qo,sD=mO,jx=_,iD=NO,aD=Kp,cD=fo,pD=Xs,uD=DO,lD=Ca,fD=ja,mD=NA,TT=zt,hD=za,dD=Br,xD=Bp,gD=lr,yD=VA,bD=YA,SD=dl,ED=$o,_D=ax,OD=QA,CD=rM,RD=HM,AD=DA,MD=X_,TD=Yu,vD=Ln,ID=UM,kD=Rl,wD=Ho,FD=Bt,PD=Tt,ND=Kn,DD=WM,LD=kx,HD=wx,qD=zA,UD=jM,WD=zM,jD=Fx,zD=$p,KD=HS,BD=e=>vt(Qt(xo,e)),GD=GS,$D=BS,VD=uh,YD=J_,JD=Kr,QD=e=>vt(dr(ot,we(Wr,e))),ZD=tM,XD=e_,eL=Q_,tL=ei,rL=aC,oL=id,nL=$M,sL=VM,iL=YM,aL=$a,cL=r_,pL=wh,uL=ET,lL=t_,fL=hl,mL=Lr,vT=iO,hL=Ns,dL=Mn,xL=Rt,IT=LS,gL=a(2,(e,t)=>{let r=Hx(xr.runtimeFlags,t.runtimeFlags),o=Hx(t.runtimeFlags,xr.runtimeFlags),n=ni(xr.fiberRefs,t.fiberRefs),s=ni(t.fiberRefs,xr.fiberRefs);return TT(l(Wx(r),()=>Ux(n)),()=>IT(e,t.context),()=>l(Wx(o),()=>Ux(s)))}),yL=Lx,bL=zO,SL=td,EL=bT,_L=SC,OL=bC,CL=cd,RL=pd,AL=EC,ML=e=>vT(t=>iy(t,e)),TL=dC,vL=eO,IL=tO,kL=rO,wL=oO;var Vo=Dr,FL=Z,PL=qr,NL=HO,DL=XO,LL=ZA,HL=Wp;var qL=aO,UL=cO,WL=_a,jL=pO,zL=fC,KL=mC,BL=Zu,GL=Hs,$L=xC,VL=gC,It=l,YL=ft,JL=GA,QL=gl,ZL=BM,XL=mx,e2=Ju,t2=At,r2=oC,o2=nC,n2=sd,s2=sC,i2=iC,a2=xO,c2=Qh,p2=wO,u2=EM,l2=YO,f2=_x,m2=OM,h2=Ba,d2=CM,x2=Ox,g2=_l,y2=GM,b2=Ax,S2=Tn,E2=Jh,_2=EO,O2=Ee,C2=qe,R2=Qt,A2=dr,Ux=qn,M2=ZO,T2=Qu,v2=_O,I2=OO,k2=Oa,w2=oa,F2=Y,P2=ie,N2=CO,D2=RO,L2=Zh,H2=AO,q2=MO,U2=TO,W2=vO,j2=IO,z2=U_,K2=kO,B2=$S,G2=e=>vt(Qt(aa,e)),$2=An,V2=Xm,Y2=Rn,J2=qO,Q2=UO,Z2=KO,X2=Fu,eH=Nx,tH=Gp,Wx=Ls,rH=US,oH=lx,nH=eC,sH=od,iH=nd,aH=JA,cH=cx,pH=px,uH=VS,lH=yC,fH=Do,mH=F,hH=Cl,dH=LM,xH=uT,gH=pT,kT=lT,yH=fT,bH=mT,SH=hT,EH=XA,_H=ux,OH=oM,CH=nM,RH=sM,AH=Eo,MH=he,TH=Up,vH=wr,IH=Ds,kH=qx,wH=RT,FH=qS,PH=e=>vt(Qt(ia,e)),NH=e=>vt(Qt(Va,e)),DH=e=>vt(de(e)?l(e,t=>Qt(fi,t)):Qt(fi,e)),LH=AT,HH=MT,qH=CT,UH=pC,WH=Pu,jH=o_,zH=bl,KH=WS,BH=e=>vt(Qt(ca,e)),GH=OC,$H=_C,VH=ld,YH=ud,JH=RC,QH=AC,ZH=CC,XH=ri,eq=_T,tq=OT,rq=fd,oq=cM,nq=MC,sq=yl,iq=md,aq=Sl,cq=TC,pq=vC;var dt={};dc(dt,{ConfigTypeId:()=>uq,all:()=>lq,array:()=>fq,boolean:()=>mq,chunk:()=>hq,date:()=>dq,fail:()=>xq,hashMap:()=>Dq,hashSet:()=>kq,integer:()=>yq,isConfig:()=>Sq,logLevel:()=>bq,map:()=>Eq,mapAttempt:()=>_q,mapOrFail:()=>Oq,nested:()=>Cq,number:()=>gq,option:()=>Mq,orElse:()=>Rq,orElseIf:()=>Aq,primitive:()=>Tq,repeat:()=>vq,secret:()=>Iq,string:()=>wq,succeed:()=>Fq,suspend:()=>Pq,sync:()=>Nq,unwrap:()=>Lq,validate:()=>Hq,withDefault:()=>qq,withDescription:()=>Uq,zip:()=>Wq,zipWith:()=>jq});var uq=Tu,lq=wE,fq=SE,mq=bE,hq=vu,dq=EE,xq=_E,gq=OE,yq=CE,bq=RE,Sq=Ch,Eq=So,_q=AE,Oq=Vs,Cq=Vt,Rq=TE,Aq=Iu,Mq=vE,Tq=zo,vq=Mu,Iq=IE,kq=kE,wq=Oh,Fq=Ys,Pq=ma,Nq=PE,Dq=NE,Lq=Rh,Hq=DE,qq=LE,Uq=HE,Wq=qE,jq=ha;var Il={};dc(Il,{Class:()=>py,TaggedClass:()=>wI,array:()=>II,case:()=>kI,struct:()=>ro,tagged:()=>cy,taggedEnum:()=>FI,tuple:()=>vI,unsafeArray:()=>Cf,unsafeStruct:()=>ay});var oe={};dc(oe,{Do:()=>vL,EffectTypeId:()=>EP,acquireRelease:()=>fD,acquireReleaseInterruptible:()=>mD,acquireUseRelease:()=>TT,addFinalizer:()=>hD,all:()=>TP,allSuccesses:()=>IP,allWith:()=>vP,allowInterrupt:()=>KN,annotateCurrentSpan:()=>$H,annotateLogs:()=>z2,annotateSpans:()=>GH,as:()=>eD,asSome:()=>tD,asSomeError:()=>rD,asUnit:()=>oD,async:()=>QP,asyncEffect:()=>ZP,asyncEither:()=>eN,asyncOption:()=>XP,awaitAllChildren:()=>RD,bind:()=>IL,bindTo:()=>kL,blocked:()=>MH,cacheRequestResult:()=>wH,cached:()=>RP,cachedFunction:()=>AP,cachedInvalidateWithTTL:()=>CP,cachedWithTTL:()=>OP,catch:()=>gN,catchAll:()=>yN,catchAllCause:()=>bN,catchAllDefect:()=>SN,catchSome:()=>EN,catchSomeCause:()=>_N,catchSomeDefect:()=>ON,catchTag:()=>CN,catchTags:()=>RN,cause:()=>AN,checkInterruptible:()=>BN,clock:()=>YD,clockWith:()=>JD,config:()=>cL,configProviderWith:()=>pL,context:()=>mL,contextWith:()=>vT,contextWithEffect:()=>hL,currentParentSpan:()=>YH,currentSpan:()=>VH,daemonChildren:()=>AD,delay:()=>eL,descriptor:()=>MD,descriptorWith:()=>TD,die:()=>sN,dieMessage:()=>iN,dieSync:()=>aN,diffFiberRefs:()=>vD,disconnect:()=>GN,dropUntil:()=>kP,dropWhile:()=>wP,either:()=>Vo,ensuring:()=>dD,ensuringChild:()=>ID,ensuringChildren:()=>kD,eventually:()=>MN,every:()=>FP,exists:()=>PP,exit:()=>FL,fail:()=>tN,failCause:()=>oN,failCauseSync:()=>nN,failSync:()=>rN,fiberId:()=>wD,fiberIdWith:()=>FD,filter:()=>NP,filterOrDie:()=>qL,filterOrDieMessage:()=>UL,filterOrElse:()=>WL,filterOrFail:()=>jL,findFirst:()=>DP,firstSuccessOf:()=>LP,flatMap:()=>It,flatMapStep:()=>IH,flatten:()=>YL,flip:()=>nD,flipWith:()=>sD,forEach:()=>Ya,forever:()=>a2,fork:()=>PD,forkAll:()=>DD,forkDaemon:()=>ND,forkIn:()=>LD,forkScoped:()=>HD,forkWithErrorHandler:()=>qD,fromFiber:()=>UD,fromFiberEffect:()=>WD,fromNullable:()=>cq,gen:()=>cN,getFiberRefs:()=>E2,head:()=>HP,if:()=>HL,ignore:()=>TN,ignoreLogged:()=>vN,inheritFiberRefs:()=>_2,interrupt:()=>$N,interruptWith:()=>VN,interruptible:()=>YN,interruptibleMask:()=>JN,intoDeferred:()=>PL,isEffect:()=>_P,isFailure:()=>v2,isSuccess:()=>I2,iterate:()=>c2,labelMetrics:()=>sH,labelMetricsScoped:()=>cH,labelMetricsScopedSet:()=>pH,labelMetricsSet:()=>iH,let:()=>wL,linkSpans:()=>ZH,locally:()=>O2,locallyScoped:()=>R2,locallyScopedWith:()=>A2,locallyWith:()=>C2,log:()=>N2,logAnnotations:()=>K2,logDebug:()=>L2,logError:()=>U2,logFatal:()=>W2,logInfo:()=>H2,logTrace:()=>D2,logWarning:()=>q2,loop:()=>p2,makeSemaphore:()=>dH,makeSpan:()=>XH,map:()=>jx,mapAccum:()=>iD,mapBoth:()=>aD,mapError:()=>cD,mapErrorCause:()=>pD,mapInputContext:()=>dL,match:()=>k2,matchCause:()=>w2,matchCauseEffect:()=>F2,matchEffect:()=>P2,merge:()=>uD,mergeAll:()=>qP,metricLabels:()=>uH,negate:()=>lD,never:()=>pN,none:()=>uN,onError:()=>xD,onExit:()=>gD,onInterrupt:()=>QN,once:()=>MP,option:()=>NL,optionFromOptional:()=>pq,orDie:()=>$2,orDieWith:()=>V2,orElse:()=>Y2,orElseFail:()=>J2,orElseSucceed:()=>Q2,parallelErrors:()=>IN,parallelFinalizers:()=>yD,partition:()=>UP,patchFiberRefs:()=>Ux,promise:()=>lN,provideContext:()=>xL,provideLayer:()=>yL,provideService:()=>bL,provideServiceEffect:()=>SL,provideSomeContext:()=>IT,provideSomeLayer:()=>EL,provideSomeRuntime:()=>gL,race:()=>QL,raceAll:()=>JL,raceFirst:()=>ZL,raceWith:()=>XL,random:()=>Z2,randomWith:()=>X2,reduce:()=>WP,reduceEffect:()=>jP,reduceRight:()=>zP,reduceWhile:()=>KP,repeat:()=>u2,repeatN:()=>l2,repeatOrElse:()=>f2,repeatUntil:()=>m2,repeatUntilEffect:()=>h2,repeatWhile:()=>d2,repeatWhileEffect:()=>x2,replicate:()=>BP,replicateEffect:()=>GP,request:()=>kH,retry:()=>wN,retryN:()=>FN,retryOrElse:()=>PN,retryUntil:()=>NN,retryUntilEffect:()=>DN,retryWhile:()=>LN,retryWhileEffect:()=>HN,runCallback:()=>gH,runFork:()=>xH,runPromise:()=>kT,runPromiseExit:()=>yH,runRequestBlock:()=>TH,runSync:()=>bH,runSyncExit:()=>SH,runtime:()=>eH,runtimeFlags:()=>tH,sandbox:()=>kN,schedule:()=>g2,scheduleForked:()=>y2,scheduleFrom:()=>b2,scope:()=>SD,scopeWith:()=>ED,scoped:()=>_D,sequentialFinalizers:()=>bD,serviceConstants:()=>RL,serviceFunction:()=>_L,serviceFunctionEffect:()=>OL,serviceFunctions:()=>CL,serviceMembers:()=>AL,serviceOption:()=>ML,setClock:()=>QD,setConfigProvider:()=>uL,setFiberRefs:()=>M2,setParentSpan:()=>eq,setRequestBatching:()=>PH,setRequestCache:()=>DH,setRequestCaching:()=>NH,setScheduler:()=>BD,setSpan:()=>tq,setTracer:()=>qH,setTracerTiming:()=>BH,setUnhandledErrorLogLevel:()=>G2,sleep:()=>tL,some:()=>DL,spanAnnotations:()=>JH,spanLinks:()=>QH,step:()=>vH,succeed:()=>fN,succeedNone:()=>mN,succeedSome:()=>hN,summarized:()=>e2,supervised:()=>jD,suspend:()=>mi,sync:()=>dN,tagMetrics:()=>nH,tagMetricsScoped:()=>aH,takeUntil:()=>$P,takeWhile:()=>VP,tap:()=>t2,tapBoth:()=>r2,tapDefect:()=>o2,tapError:()=>n2,tapErrorCause:()=>i2,tapErrorTag:()=>s2,timed:()=>rL,timedWith:()=>oL,timeout:()=>nL,timeoutFail:()=>sL,timeoutFailCause:()=>iL,timeoutTo:()=>aL,tracer:()=>UH,tracerWith:()=>WH,transplant:()=>zD,try:()=>qN,tryMap:()=>UN,tryMapPromise:()=>WN,tryPromise:()=>jN,unified:()=>mH,unifiedFn:()=>fH,uninterruptible:()=>ZN,uninterruptibleMask:()=>XN,unit:()=>ht,unless:()=>zL,unlessEffect:()=>KL,unsafeMakeSemaphore:()=>hH,unsandbox:()=>zN,unsome:()=>LL,updateFiberRefs:()=>T2,updateRuntimeFlags:()=>Wx,updateService:()=>TL,useSpan:()=>rq,useSpanScoped:()=>oq,using:()=>OD,validate:()=>EH,validateAll:()=>YP,validateFirst:()=>JP,validateWith:()=>_H,when:()=>BL,whenEffect:()=>GL,whenFiberRef:()=>$L,whenRef:()=>VL,whileLoop:()=>S2,withClock:()=>XD,withClockScoped:()=>ZD,withConcurrency:()=>KD,withConfigProvider:()=>lL,withConfigProviderScoped:()=>fL,withEarlyRelease:()=>CD,withLogSpan:()=>j2,withMaxFiberOps:()=>GD,withMetric:()=>lH,withParentSpan:()=>iq,withParentSpanScoped:()=>aq,withRequestBatching:()=>FH,withRequestCache:()=>HH,withRequestCaching:()=>LH,withRuntimeFlags:()=>rH,withRuntimeFlagsScoped:()=>oH,withScheduler:()=>$D,withSchedulingPriority:()=>VD,withSpan:()=>nq,withSpanScoped:()=>sq,withTracer:()=>jH,withTracerScoped:()=>zH,withTracerTiming:()=>KH,withUnhandledErrorLogLevel:()=>B2,yieldNow:()=>xN,zip:()=>OH,zipLeft:()=>CH,zipRight:()=>RH,zipWith:()=>AH});var Qa={};dc(Qa,{SafeRefinementId:()=>t1,any:()=>i1,bigint:()=>l1,boolean:()=>c1,date:()=>f1,defined:()=>a1,discriminator:()=>FT,discriminators:()=>Bx,discriminatorsExhaustive:()=>PT,either:()=>kl,exhaustive:()=>LT,instanceOf:()=>NT,instanceOfUnsafe:()=>h1,is:()=>o1,nonEmptyString:()=>r1,not:()=>e1,null:()=>u1,number:()=>s1,option:()=>x1,orElse:()=>DT,orElseAbsurd:()=>d1,record:()=>m1,string:()=>n1,tag:()=>Zq,tags:()=>Xq,tagsExhaustive:()=>Gx,type:()=>Bq,typeTags:()=>Vq,undefined:()=>p1,value:()=>Gq,valueTags:()=>$q,when:()=>Yq,whenAnd:()=>Qq,whenOr:()=>Jq});var Ja=class e{constructor(t){this.cases=t,this._tag="TypeMatcher",this._input=F,this._filters=F,this._remaining=F,this._result=F}add(t){return new e([...this.cases,t])}pipe(){return E(this,arguments)}},zx=class e{constructor(t,r){this.provided=t,this.value=r,this._tag="ValueMatcher",this._input=F,this._filters=F,this._result=F}add(t){return this.value._tag==="Right"?this:t._tag==="When"&&t.guard(this.provided)===!0?new e(this.provided,P(t.evaluate(this.provided))):t._tag==="Not"&&t.guard(this.provided)===!1?new e(this.provided,P(t.evaluate(this.provided))):this}pipe(){return E(this,arguments)}},$n=class{constructor(t,r){this.guard=t,this.evaluate=r,this._tag="When"}},Kx=class{constructor(t,r){this.guard=t,this.evaluate=r,this._tag="Not"}},hi=e=>{if(typeof e=="function")return e;if(Array.isArray(e)){let t=e.map(hi),r=t.length;return o=>{if(!Array.isArray(o))return!1;for(let n=0;n<r;n++)if(t[n](o[n])===!1)return!1;return!0}}else if(e!==null&&typeof e=="object"){let t=Object.entries(e).map(([o,n])=>[o,hi(n)]),r=t.length;return o=>{if(typeof o!="object"||o===null)return!1;for(let n=0;n<r;n++){let[s,i]=t[n];if(!(s in o)||i(o[s])===!1)return!1}return!0}}return t=>t===e},zq=e=>{let t=e.map(hi),r=t.length;return o=>{for(let n=0;n<r;n++)if(t[n](o)===!0)return!0;return!1}},Kq=e=>{let t=e.map(hi),r=t.length;return o=>{for(let n=0;n<r;n++)if(t[n](o)===!1)return!1;return!0}},Bq=()=>new Ja([]),Gq=e=>new zx(e,q(e)),$q=e=>{let t=Gx(e)(new Ja([]));return r=>t(r)},Vq=()=>e=>{let t=Gx(e)(new Ja([]));return r=>t(r)},Yq=(e,t)=>r=>r.add(new $n(hi(e),t)),Jq=(...e)=>t=>{let r=e[e.length-1],o=e.slice(0,-1);return t.add(new $n(zq(o),r))},Qq=(...e)=>t=>{let r=e[e.length-1],o=e.slice(0,-1);return t.add(new $n(Kq(o),r))},FT=e=>(...t)=>{let r=t[t.length-1],o=t.slice(0,-1),n=o.length===1?s=>s[e]===o[0]:s=>o.includes(s[e]);return s=>s.add(new $n(n,r))},Bx=e=>t=>{let r=[];for(let n in t){let s=c=>c[e]===n,i=t[n];i&&r.push(new $n(s,i))}let o=r.length;return n=>{let s=n;for(let i=0;i<o;i++)s=s.add(r[i]);return s}},PT=e=>t=>{let r=Bx(e)(t);return o=>LT(r(o))},Zq=FT("_tag"),Xq=Bx("_tag"),Gx=PT("_tag"),e1=(e,t)=>r=>r.add(new Kx(hi(e),t)),t1=Symbol.for("@effect/match/SafeRefinementId"),r1=e=>typeof e=="string"&&e.length>0,o1=(...e)=>{let t=e.length;return r=>{for(let o=0;o<t;o++)if(r===e[o])return!0;return!1}},n1=Ai,s1=Jo,i1=()=>!0,a1=e=>e!=null,c1=bc,p1=Mi;var u1=Rg;var l1=es,f1=Sc,m1=Ti,NT=e=>t=>t instanceof e,h1=NT,DT=e=>t=>{let r=kl(t);return Ac(r)?r._tag==="Right"?r.right:e(r.left):o=>{let n=r(o);return n._tag==="Right"?n.right:e(n.left)}},d1=e=>DT(()=>{throw new Error("absurd")})(e),kl=e=>{if(e._tag==="ValueMatcher")return e.value;let t=e.cases.length;return r=>{for(let o=0;o<t;o++){let n=e.cases[o];if(n._tag==="When"&&n.guard(r)===!0)return P(n.evaluate(r));if(n._tag==="Not"&&n.guard(r)===!1)return P(n.evaluate(r))}return q(r)}},x1=e=>{let t=kl(e);return Ac(t)?Mc(t,{onLeft:()=>x(),onRight:d}):r=>Mc(t(r),{onLeft:()=>x(),onRight:o=>d(o)})},LT=e=>{let t=kl(e);if(Ac(t)){if(t._tag==="Right")return t.right;throw new Error("@effect/match: exhaustive absurd")}return r=>{let o=t(r);if(o._tag==="Right")return o.right;throw new Error("@effect/match: exhaustive absurd")}};var wl="@effect/schema/ArbitraryHookId",$x="@effect/schema/PrettyHookId",Vx=(e,t)=>{switch(t._tag){case"StringKeyword":case"TemplateLiteral":return Object.keys(e);case"SymbolKeyword":return Object.getOwnPropertySymbols(e);case"Refinement":return Vx(e,t.from)}},Za=e=>Object.keys(e).concat(Object.getOwnPropertySymbols(e)),Fl=e=>{let t=!1,r;return()=>(t||(r=e(),t=!0),r)};var Yx=e=>({_tag:"ParseError",errors:e}),gr=(e,t,r)=>({_tag:"Type",expected:e,actual:t,message:Dt(r)}),qT={_tag:"Forbidden"},_o=(e,t)=>({_tag:"Index",index:e,errors:t}),Gr=(e,t)=>({_tag:"Key",key:e,errors:t}),Pl={_tag:"Missing"},Jx=e=>({_tag:"Unexpected",actual:e}),Qx=e=>({_tag:"UnionMember",errors:e}),Je=P,Zt=e=>q(Yx([e])),Ue=e=>q(Yx(e)),$r=e=>{let t=e;if(t._tag==="Left"||t._tag==="Right")return t},di=(e,t)=>{let r=e;return r._tag==="Left"?r:r._tag==="Right"?t(r.right):It(e,t)},UT=(e,t)=>{let r=e;return r._tag==="Left"?r:r._tag==="Right"?P(t(r.right)):jx(e,t)};var eg="@effect/schema/TypeAnnotationId",Dl="@effect/schema/MessageAnnotationId",xi="@effect/schema/IdentifierAnnotationId",nt="@effect/schema/TitleAnnotationId",Yo="@effect/schema/DescriptionAnnotationId",zT="@effect/schema/ExamplesAnnotationId",KT="@effect/schema/JSONSchemaAnnotationId",BT="@effect/schema/DocumentationAnnotationId",tc=e=>t=>Object.prototype.hasOwnProperty.call(t.annotations,e)?d(t.annotations[e]):x(),gi=(e,t,r,o={})=>({_tag:"Declaration",typeParameters:e,type:t,decode:r,annotations:o});var GT=e=>({_tag:"Literal",literal:e,annotations:{}}),Vn=e=>e._tag==="Literal";var g1=e=>e._tag==="UniqueSymbol",y1={_tag:"UndefinedKeyword",annotations:{[nt]:"undefined"}};var b1={_tag:"VoidKeyword",annotations:{[nt]:"void"}};var rc={_tag:"NeverKeyword",annotations:{[nt]:"never"}};var yi={_tag:"UnknownKeyword",annotations:{[nt]:"unknown"}},S1=e=>e._tag==="UnknownKeyword",$T={_tag:"AnyKeyword",annotations:{[nt]:"any"}},E1=e=>e._tag==="AnyKeyword",Ll={_tag:"StringKeyword",annotations:{[nt]:"string"}},ec=e=>e._tag==="StringKeyword",VT={_tag:"NumberKeyword",annotations:{[nt]:"number"}},Nl=e=>e._tag==="NumberKeyword",_1={_tag:"BooleanKeyword",annotations:{[nt]:"boolean"}},WT=e=>e._tag==="BooleanKeyword",O1={_tag:"BigIntKeyword",annotations:{[nt]:"bigint"}},jT=e=>e._tag==="BigIntKeyword",tg={_tag:"SymbolKeyword",annotations:{[nt]:"symbol"}},Xx=e=>e._tag==="SymbolKeyword",C1={_tag:"ObjectKeyword",annotations:{[nt]:"object"}};var oc=(e,t)=>({type:e,isOptional:t}),Yn=(e,t,r,o={})=>({_tag:"Tuple",elements:e,rest:t,isReadonly:r,annotations:o});var Ne=(e,t,r,o,n={})=>({name:e,type:t,isOptional:r,isReadonly:o,annotations:n}),YT=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return!0;case"Refinement":return YT(e.from);default:return!1}},bi=(e,t,r)=>{if(YT(e))return{parameter:e,type:t,isReadonly:r};throw new Error("An index signature parameter type must be 'string', 'symbol', a template literal type or a refinement of the previous types")},Oo=(e,t,r={})=>{let o={};for(let s=0;s<e.length;s++){let i=e[s].name;if(Object.prototype.hasOwnProperty.call(o,i))throw new Error(`Duplicate property signature ${String(i)}`);o[i]=null}let n={string:!1,symbol:!1};for(let s=0;s<t.length;s++){let i=ql(t[s].parameter);if(ec(i)){if(n.string)throw new Error("Duplicate index signature for type `string`");n.string=!0}else if(Xx(i)){if(n.symbol)throw new Error("Duplicate index signature for type `symbol`");n.symbol=!0}}return{_tag:"TypeLiteral",propertySignatures:R1(e),indexSignatures:t,annotations:r}};var Co=(e,t={})=>{let r=v1(e);switch(r.length){case 0:return rc;case 1:return r[0];default:return{_tag:"Union",types:T1(r),annotations:t}}};var nc=(e,t={})=>({_tag:"Lazy",f:Fl(e),annotations:t});var sc=(e,t,r,o={})=>({_tag:"Refinement",from:e,decode:t,isReversed:r,annotations:o}),JT=e=>e._tag==="Refinement",ic=(e,t,r,o)=>({from:e,to:t,decode:r,encode:o}),Hl=(e,t,r,o,n,s={})=>({_tag:"Transform",from:e,to:t,decode:r,encode:o,propertySignatureTransformations:n,annotations:s}),QT=(e,t,r,o,n={})=>Hl(e,t,r,o,[],n),ZT=(e,t,r,o={})=>Hl(e,t,n=>{for(let s=0;s<r.length;s++){let i=r[s],c=i.from,p=Object.prototype.hasOwnProperty.call(n,c)?d(n[c]):x();delete n[c];let u=i.decode(p);N(u)&&(n[i.to]=u.value)}return Je(n)},n=>{for(let s=0;s<r.length;s++){let i=r[s],c=i.to,p=Object.prototype.hasOwnProperty.call(n,c)?d(n[c]):x();delete n[c];let u=i.encode(p);N(u)&&(n[i.from]=u.value)}return Je(n)},r,o);var XT=(e,t,r)=>({...e,annotations:{...e.annotations,[t]:r}});var ev=e=>e.map(t=>Ne(t.name,Pe(t.type),t.isOptional,t.isReadonly,t.annotations)),tv=e=>e.map(t=>bi(t.parameter,Pe(t.type),t.isReadonly)),Pe=e=>{switch(e._tag){case"Declaration":return gi(e.typeParameters.map(Pe),Pe(e.type),e.decode,e.annotations);case"Tuple":return Yn(e.elements.map(t=>oc(Pe(t.type),t.isOptional)),Me(e.rest,ss(Pe)),e.isReadonly,e.annotations);case"TypeLiteral":return Oo(ev(e.propertySignatures),tv(e.indexSignatures),e.annotations);case"Union":return Co(e.types.map(Pe),e.annotations);case"Lazy":return nc(()=>Pe(e.f()),e.annotations);case"Refinement":return sc(Pe(e.from),e.decode,!1,e.annotations);case"Transform":return Pe(e.to)}return e},Xt=e=>{switch(e._tag){case"Declaration":return gi(e.typeParameters.map(Xt),Xt(e.type),e.decode,e.annotations);case"Tuple":return Yn(e.elements.map(t=>oc(Xt(t.type),t.isOptional)),Me(e.rest,ss(Xt)),e.isReadonly);case"TypeLiteral":return Oo(e.propertySignatures.map(t=>Ne(t.name,Xt(t.type),t.isOptional,t.isReadonly)),e.indexSignatures.map(t=>bi(t.parameter,Xt(t.type),t.isReadonly)));case"Union":return Co(e.types.map(Xt));case"Lazy":return nc(()=>Xt(e.f()));case"Refinement":case"Transform":return Xt(e.from)}return e},rv=e=>{switch(e._tag){case"Declaration":return rv(e.type);case"NeverKeyword":return 0;case"Literal":case"UndefinedKeyword":case"VoidKeyword":case"UniqueSymbol":return 1;case"BooleanKeyword":return 2;case"StringKeyword":case"NumberKeyword":case"BigIntKeyword":case"SymbolKeyword":return 3;case"ObjectKeyword":return 5;case"UnknownKeyword":case"AnyKeyword":return 6;default:return 4}},R1=Zo(ne(yt,Ri(e=>rv(e.type)))),ov=_g(yt,yt,yt),A1=Xl(ov),nv=[0,0,0],M1=e=>e.reduce(A1,nv),Xa=e=>{switch(e._tag){case"Tuple":{let t=e.elements.length,r=N(e.rest)?e.rest.value.length:0;return[2,t,r]}case"TypeLiteral":{let t=e.propertySignatures.length,r=e.indexSignatures.length;return t+r===0?[-4,0,0]:[4,t,r]}case"Declaration":{let[t,r,o]=Xa(e.type);return[6,r,o]}case"Lazy":return[8,0,0];case"Union":return M1(e.types.map(Xa));case"Refinement":{let[t,r,o]=Xa(e.from);return[t+1,r,o]}case"Transform":return Xa(e.from);case"ObjectKeyword":return[-2,0,0];case"UnknownKeyword":case"AnyKeyword":return[-4,0,0];default:return nv}},T1=Zo(Eg(Ri(ov,Xa))),v1=e=>{let t=ne(e,wc(o=>{switch(o._tag){case"NeverKeyword":return[];case"Union":return o.types;default:return[o]}}));if(t.some(E1))return[$T];if(t.some(S1))return[yi];let r;return(r=t.findIndex(ec))!==-1&&(t=t.filter((o,n)=>n===r||!ec(o)&&!(Vn(o)&&typeof o.literal=="string"))),(r=t.findIndex(Nl))!==-1&&(t=t.filter((o,n)=>n===r||!Nl(o)&&!(Vn(o)&&typeof o.literal=="number"))),(r=t.findIndex(WT))!==-1&&(t=t.filter((o,n)=>n===r||!WT(o)&&!(Vn(o)&&typeof o.literal=="boolean"))),(r=t.findIndex(jT))!==-1&&(t=t.filter((o,n)=>n===r||!jT(o)&&!(Vn(o)&&typeof o.literal=="bigint"))),(r=t.findIndex(Xx))!==-1&&(t=t.filter((o,n)=>n===r||!Xx(o)&&!g1(o))),t},ql=e=>{switch(e._tag){case"StringKeyword":case"SymbolKeyword":case"TemplateLiteral":return e;case"Refinement":return ql(e.from)}};var Vr=(e,t=[])=>({value:e,forest:t}),sv=e=>I1(Vr("error(s) found",e.map(Wl))),I1=e=>e.value+iv(`
`,e.forest),iv=(e,t)=>{let r="",o=t.length,n;for(let s=0;s<o;s++){n=t[s];let i=s===o-1;r+=e+(i?"\u2514":"\u251C")+"\u2500 "+n.value,r+=iv(e+(o>1&&!i?"\u2502  ":"   "),n.forest)}return r},ac=e=>{if(e==null||typeof e=="number"||typeof e=="symbol"||e instanceof Date)return String(e);if(typeof e=="bigint")return String(e)+"n";try{return JSON.stringify(e)}catch{return String(e)}},k1=e=>{switch(e.type._tag){case"StringKeyword":return"${string}";case"NumberKeyword":return"${number}"}},w1=e=>e.head+e.spans.map(t=>k1(t)+t.literal).join(""),F1=tc(Dl),P1=tc(nt),N1=tc(xi),D1=tc(Yo),yr=e=>ne(N1(e),os(()=>P1(e)),os(()=>D1(e))),Ul=e=>{switch(e._tag){case"StringKeyword":case"NumberKeyword":case"BooleanKeyword":case"BigIntKeyword":case"UndefinedKeyword":case"SymbolKeyword":case"ObjectKeyword":case"AnyKeyword":case"UnknownKeyword":case"VoidKeyword":case"NeverKeyword":return $(yr(e),()=>e._tag);case"Literal":return $(yr(e),()=>ac(e.literal));case"UniqueSymbol":return $(yr(e),()=>ac(e.symbol));case"Union":return e.types.map(Ul).join(" or ");case"TemplateLiteral":return $(yr(e),()=>w1(e));case"Tuple":return $(yr(e),()=>"<anonymous tuple or array schema>");case"TypeLiteral":return $(yr(e),()=>"<anonymous type literal schema>");case"Enums":return $(yr(e),()=>e.enums.map((t,r)=>JSON.stringify(r)).join(" | "));case"Lazy":return $(yr(e),()=>"<anonymous lazy schema>");case"Declaration":return $(yr(e),()=>"<anonymous declaration schema>");case"Refinement":return $(yr(e),()=>"<anonymous refinement schema>");case"Transform":return $(yr(e),()=>`${Ul(e.from)} -> ${Ul(e.to)}`)}},Wl=e=>{switch(e._tag){case"Type":return Vr(ne(F1(e.expected),Me(t=>t(e.actual)),os(()=>e.message),$(()=>`Expected ${Ul(e.expected)}, actual ${ac(e.actual)}`)));case"Forbidden":return Vr("is forbidden");case"Index":{let t=e.errors.map(Wl);return t.length===1&&t[0].forest.length!==0?Vr(`[${e.index}]${t[0].value}`,t[0].forest):Vr(`[${e.index}]`,t)}case"Unexpected":return Vr("is unexpected");case"Key":{let t=e.errors.map(Wl);return t.length===1&&t[0].forest.length!==0?Vr(`[${ac(e.key)}]${t[0].value}`,t[0].forest):Vr(`[${ac(e.key)}]`,t)}case"Missing":return Vr("is missing");case"UnionMember":return Vr("union member",e.errors.map(Wl))}};var cv=e=>{let t=st(e);return(r,o)=>t(r,{...o,isEffectAllowed:!0})};var ng=e=>st(e.ast);var sg=e=>cv(e.ast);var ig=e=>cv(br(e.ast)),st=(e,t=!0)=>{switch(e._tag){case"Refinement":if(e.isReversed){let r=st(Pe(e),t),o=st(br(pv(e.from)),!1);return(n,s)=>cc(di(r(n,s),i=>o(i,s)),s)}else{let r=st(e.from,t);return(o,n)=>cc(di(r(o,n),s=>e.decode(s,n)),n)}case"Transform":{let r=st(e.to,!1);if(t){let o=st(e.from);return(n,s)=>cc(di(o(n,s),i=>di(e.decode(i,s),c=>r(c,s))),s)}else return(o,n)=>cc(di(e.decode(o,n),s=>r(s,n)),n)}case"Declaration":{let r=e.decode(...e.typeParameters);return(o,n)=>cc(r(o,n),n)}case"Literal":return xt(e,r=>r===e.literal);case"UniqueSymbol":return xt(e,r=>r===e.symbol);case"UndefinedKeyword":return xt(e,Mi);case"VoidKeyword":return xt(e,Mi);case"NeverKeyword":return xt(e,Ag);case"UnknownKeyword":case"AnyKeyword":return Je;case"StringKeyword":return xt(e,Ai);case"NumberKeyword":return xt(e,Jo);case"BooleanKeyword":return xt(e,bc);case"BigIntKeyword":return xt(e,es);case"SymbolKeyword":return xt(e,Og);case"ObjectKeyword":return xt(e,pe);case"Enums":return xt(e,r=>e.enums.some(([o,n])=>n===r));case"TemplateLiteral":{let r=q1(e);return xt(e,o=>Ai(o)&&r.test(o))}case"Tuple":{let r=e.elements.map(s=>st(s.type,t)),o=ne(e.rest,Me(ss(s=>st(s)))),n=e.elements.filter(s=>!s.isOptional).length;return N(e.rest)&&(n+=e.rest.value.length-1),(s,i)=>{if(!Array.isArray(s))return Zt(gr(H1,s));let c=i?.errors==="all",p=[],u=0,f=s.length;for(let R=f;R<=n-1;R++){let v=_o(R,[Pl]);if(c){p.push([u++,v]);continue}else return Zt(v)}if(j(e.rest))for(let R=e.elements.length;R<=f-1;R++){let v=_o(R,[Jx(s[R])]);if(c){p.push([u++,v]);continue}else return Ue(kt(We(p),v))}let m=[],y=0,b;for(;y<r.length;y++)if(f<y+1){if(e.elements[y].isOptional)continue}else{let R=r[y],v=R(s[y],i),w=$r(v);if(w){if(Ae(w)){let H=_o(y,w.left.errors);if(c){p.push([u++,H]);continue}else return Ue(kt(We(p),H))}m.push([u++,w.right])}else{let H=u++,U=y;b||(b=[]),b.push(({es:te,output:ge})=>It(Vo(v),Ie=>{if(Ae(Ie)){let ce=_o(U,Ie.left.errors);return c?(te.push([H,ce]),ht):Ue(kt(We(te),ce))}return ge.push([H,Ie.right]),ht}))}}if(N(o)){let R=_e(o.value),v=Lt(o.value);for(;y<f-v.length;y++){let w=R(s[y],i),H=$r(w);if(H)if(Ae(H)){let U=_o(y,H.left.errors);if(c){p.push([u++,U]);continue}else return Ue(kt(We(p),U))}else m.push([u++,H.right]);else{let U=u++,te=y;b||(b=[]),b.push(({es:ge,output:Ie})=>It(Vo(w),ce=>{if(Ae(ce)){let Er=_o(te,ce.left.errors);return c?(ge.push([U,Er]),ht):Ue(kt(We(ge),Er))}else return Ie.push([U,ce.right]),ht}))}}for(let w=0;w<v.length;w++)if(y+=w,!(f<y+1)){let H=v[w](s[y],i),U=$r(H);if(U){if(Ae(U)){let te=_o(y,U.left.errors);if(c){p.push([u++,te]);continue}else return Ue(kt(We(p),te))}m.push([u++,U.right])}else{let te=u++,ge=y;b||(b=[]),b.push(({es:Ie,output:ce})=>It(Vo(H),Er=>{if(Ae(Er)){let Yr=_o(ge,Er.left.errors);return c?(Ie.push([te,Yr]),ht):Ue(kt(We(Ie),Yr))}return ce.push([te,Er.right]),ht}))}}}let C=({es:R,output:v})=>Ic(R)?Ue(We(R)):Je(We(v));if(b&&b.length>0){let R=b;return mi(()=>{let v={es:Array.from(p),output:Array.from(m)};return It(Ya(R,w=>w(v),{concurrency:"unbounded",discard:!0}),()=>C(v))})}return C({output:m,es:p})}}case"TypeLiteral":{if(e.propertySignatures.length===0&&e.indexSignatures.length===0)return xt(e,Mg);let r=e.propertySignatures.map(i=>st(i.type,t)),o=e.indexSignatures.map(i=>[st(i.parameter,t),st(i.type,t)]),n=st(Co(e.indexSignatures.map(i=>ql(i.parameter)))),s={};for(let i=0;i<r.length;i++)s[e.propertySignatures[i].name]=null;return(i,c)=>{if(!Ti(i))return Zt(gr(av,i));let p=c?.errors==="all",u=[],f=0;if(c?.onExcessProperty==="error"){for(let R of Za(i))if(!Object.prototype.hasOwnProperty.call(s,R)){let v=n(R),w=$r(v);if(w&&Ae(w)){let H=Gr(R,[Jx(i[R])]);if(p){u.push([f++,H]);continue}else return Ue(kt(We(u),H))}}}let y={},b;for(let R=0;R<r.length;R++){let v=e.propertySignatures[R],w=r[R],H=v.name;if(Object.prototype.hasOwnProperty.call(i,H)){let U=w(i[H],c),te=$r(U);if(te){if(Ae(te)){let ge=Gr(H,te.left.errors);if(p){u.push([f++,ge]);continue}else return Ue(kt(We(u),ge))}y[H]=te.right}else{let ge=f++,Ie=H;b||(b=[]),b.push(({es:ce,output:Er})=>It(Vo(U),Yr=>{if(Ae(Yr)){let mc=Gr(Ie,Yr.left.errors);return p?(ce.push([ge,mc]),ht):Ue(kt(We(ce),mc))}return Er[Ie]=Yr.right,ht}))}}else if(!v.isOptional){let U=Gr(H,[Pl]);if(p){u.push([f++,U]);continue}else return Zt(U)}}for(let R=0;R<o.length;R++){let v=o[R][0],w=o[R][1],H=Vx(i,e.indexSignatures[R].parameter);for(let U of H){if(Object.prototype.hasOwnProperty.call(s,U))continue;let te=$r(v(U,c));if(te&&Ae(te)){let ce=Gr(U,te.left.errors);if(p){u.push([f++,ce]);continue}else return Ue(kt(We(u),ce))}let ge=w(i[U],c),Ie=$r(ge);if(Ie)if(Ae(Ie)){let ce=Gr(U,Ie.left.errors);if(p){u.push([f++,ce]);continue}else return Ue(kt(We(u),ce))}else y[U]=Ie.right;else{let ce=f++,Er=U;b||(b=[]),b.push(({es:Yr,output:mc})=>It(Vo(ge),Jl=>{if(Ae(Jl)){let xg=Gr(Er,Jl.left.errors);return p?(Yr.push([ce,xg]),ht):Ue(kt(We(Yr),xg))}else return mc[U]=Jl.right,ht}))}}}let C=({es:R,output:v})=>Ic(R)?Ue(We(R)):Je(v);if(b&&b.length>0){let R=b;return mi(()=>{let v={es:Array.from(u),output:Object.assign({},y)};return It(Ya(R,w=>w(v),{concurrency:"unbounded",discard:!0}),()=>C(v))})}return C({es:u,output:y})}}case"Union":{let r=L1(e.types),o=Za(r.keys),n=o.length,s=new Map;for(let i=0;i<e.types.length;i++)s.set(e.types[i],st(e.types[i],!0));return(i,c)=>{let p=[],u=0,f=[];if(n>0)if(Ti(i))for(let b=0;b<n;b++){let C=o[b],R=r.keys[C].buckets;if(Object.prototype.hasOwnProperty.call(i,C)){let v=String(i[C]);Object.prototype.hasOwnProperty.call(R,v)?f=f.concat(R[v]):p.push([u++,Gr(C,[gr(r.keys[C].ast,i[C])])])}else p.push([u++,Gr(C,[Pl])])}else p.push([u++,gr(av,i)]);r.otherwise.length>0&&(f=f.concat(r.otherwise));let m;for(let b=0;b<f.length;b++){let C=s.get(f[b])(i,c),R=!m||m.length===0?$r(C):void 0;if(R){if(Or(R))return Je(R.right);p.push([u++,Qx(R.left.errors)])}else{let v=u++;m||(m=[]),m.push(w=>mi(()=>"finalResult"in w?ht:It(Vo(C),H=>(Or(H)?w.finalResult=Je(H.right):w.es.push([v,Qx(H.left.errors)]),ht))))}}let y=b=>Ic(b)?Ue(We(b)):Zt(gr(rc,i));if(m&&m.length>0){let b=m;return mi(()=>{let C={es:Array.from(p)};return It(Ya(b,R=>R(C),{concurrency:1,discard:!0}),()=>"finalResult"in C?C.finalResult:y(C.es))})}return y(p)}}case"Lazy":{let r=Fl(()=>st(e.f(),t));return(o,n)=>r()(o,n)}}},xt=(e,t)=>r=>t(r)?Je(r):Zt(gr(e,r)),og=e=>{switch(e._tag){case"Declaration":return og(e.type);case"TypeLiteral":{let t=[];for(let r=0;r<e.propertySignatures.length;r++){let o=e.propertySignatures[r],n=Xt(o.type);Vn(n)&&!o.isOptional&&t.push([o.name,n])}return t}case"Refinement":case"Transform":return og(e.from)}return[]},L1=e=>{let t={},r=[];for(let o=0;o<e.length;o++){let n=e[o],s=og(n);if(s.length>0)for(let i=0;i<s.length;i++){let[c,p]=s[i],u=String(p.literal);t[c]=t[c]||{buckets:{},ast:rc};let f=t[c].buckets;if(Object.prototype.hasOwnProperty.call(f,u)){if(i<s.length-1)continue;f[u].push(n),t[c].ast=Co([t[c].ast,p])}else{f[u]=[n],t[c].ast=Co([t[c].ast,p]);break}}else r.push(n)}return{keys:t,otherwise:r}},pv=e=>JT(e)?pv(e.from):e,cc=(e,t)=>{let r=$r(e);return r||(t?.isEffectAllowed===!0?e:Zt(qT))},H1=Yn([],d([yi]),!0,{[Yo]:"a generic array"}),av=Oo([],[bi(Ll,yi,!0),bi(tg,yi,!0)],{[Yo]:"a generic object"}),kt=(e,t)=>(e.push(t),e),q1=e=>{let t=`^${e.head}`;for(let r of e.spans)ec(r.type)?t+=".*":Nl(r.type)&&(t+="-?\\d+(\\.\\d+)?"),t+=r.literal;return t+="$",new RegExp(t)};function We(e){return e.sort(([t],[r])=>t>r?1:t<r?-1:0).map(([t,r])=>r)}var br=e=>{switch(e._tag){case"Declaration":return gi(e.typeParameters.map(br),e.type,e.decode,e.annotations);case"Tuple":return Yn(e.elements.map(t=>oc(br(t.type),t.isOptional)),Me(e.rest,ss(br)),e.isReadonly);case"TypeLiteral":return Oo(e.propertySignatures.map(t=>Ne(t.name,br(t.type),t.isOptional,t.isReadonly,t.annotations)),e.indexSignatures.map(t=>bi(t.parameter,br(t.type),t.isReadonly)));case"Union":return Co(e.types.map(br));case"Lazy":return nc(()=>br(e.f()));case"Refinement":return sc(e.from,e.decode,!e.isReversed,e.annotations);case"Transform":return Hl(br(e.to),br(e.from),e.encode,e.decode,e.propertySignatureTransformations.map(t=>ic(t.to,t.from,t.encode,t.decode)))}return e};var B1=Symbol.for("@effect/schema/Schema");var ag=class{constructor(t){Ft(this,"ast");Ft(this,"_id",B1);Ft(this,"From");Ft(this,"To");this.ast=t}pipe(){return E(this,arguments)}},wt=e=>new ag(e);var G1=e=>wt(GT(e)),jl=(...e)=>Kl(...e.map(t=>G1(t)));var uv=(e,t,r,o)=>wt(gi(e.map(n=>n.ast),t.ast,(...n)=>r(...n.map(wt)),o)),Kl=(...e)=>wt(Co(e.map(t=>t.ast)));var cg=e=>wt(Yn([],d([e.ast]),!0));var zl=class e{constructor(t,r,o){Ft(this,"_from");Ft(this,"_annotations");Ft(this,"_optional");Ft(this,"From");Ft(this,"FromIsOptional");Ft(this,"To");Ft(this,"ToIsOptional");this._from=t,this._annotations=r,this._optional=o}optional(){if(this._optional)throw new Error("duplicate optional configuration");return new e(this._from,this._annotations,{to:"optional"})}withDefault(t){if(this._optional&&this._optional.to!=="optional")throw new Error("duplicate optional configuration");return new e(this._from,this._annotations,{to:"default",value:t})}toOption(){if(this._optional&&this._optional.to!=="optional")throw new Error("duplicate optional configuration");return new e(this._from,this._annotations,{to:"Option"})}},$1=(e,t)=>new zl(e.ast,t),Qn=(e,t)=>$1(e,t).optional(),Jn=e=>{let t=Za(e),r=[],o=[],n=[],s=[];for(let i=0;i<t.length;i++){let c=t[i],p=e[c];if(p instanceof zl){let u=p._optional;if(u)switch(u.to){case"optional":{r.push(Ne(c,p._from,!0,!0,p._annotations)),o.push(Ne(c,p._from,!0,!0)),n.push(Ne(c,Pe(p._from),!0,!0,p._annotations));break}case"default":{o.push(Ne(c,p._from,!0,!0)),n.push(Ne(c,Pe(p._from),!1,!0,p._annotations)),s.push(ic(c,c,os(()=>d(u.value())),F));break}case"Option":{o.push(Ne(c,p._from,!0,!0)),n.push(Ne(c,nU(wt(Pe(p._from))).ast,!1,!0,p._annotations)),s.push(ic(c,c,d,zg));break}}else r.push(Ne(c,p._from,!1,!0,p._annotations)),o.push(Ne(c,p._from,!1,!0)),n.push(Ne(c,Pe(p._from),!1,!0,p._annotations))}else r.push(Ne(c,p.ast,!1,!0)),o.push(Ne(c,p.ast,!1,!0)),n.push(Ne(c,Pe(p.ast),!1,!0))}return s.length>0?wt(ZT(Oo(o,[]),Oo(n,[]),s)):wt(Oo(r,[]))};var V1=e=>{let t={};if(e?.typeId!==void 0){let r=e?.typeId;typeof r=="object"?(t[eg]=r.id,t[r.id]=r.params):t[eg]=r}return e?.message!==void 0&&(t[Dl]=e?.message),e?.identifier!==void 0&&(t[xi]=e?.identifier),e?.title!==void 0&&(t[nt]=e?.title),e?.description!==void 0&&(t[Yo]=e?.description),e?.examples!==void 0&&(t[zT]=e?.examples),e?.documentation!==void 0&&(t[BT]=e?.documentation),e?.jsonSchema!==void 0&&(t[KT]=e?.jsonSchema),e?.arbitrary!==void 0&&(t[wl]=e?.arbitrary),t};function lv(e,t){return r=>{let o=s=>e(s)?Je(s):Zt(gr(n,s)),n=sc(r.ast,o,!1,V1(t));return wt(n)}}var Y1=a(4,(e,t,r,o)=>wt(QT(e.ast,t.ast,r,o)));var pc=e=>t=>wt(XT(t.ast,Yo,e));var Zn=wt(Ll),pg=wt(VT);var J1=()=>e=>e.date(),Q1=()=>e=>`new Date(${JSON.stringify(e)})`,fv=uv([],Jn({}),()=>e=>Sc(e)?Je(e):Zt(gr(fv.ast,e)),{[xi]:"Date",[$x]:Q1,[wl]:J1}),Z1="@effect/schema/ValidDateTypeId",X1=e=>t=>t.pipe(lv(r=>!isNaN(r.getTime()),{typeId:Z1,description:"a valid Date",...e})),eU=fv.pipe(X1()),ug=e=>Y1(e,eU,r=>Je(new Date(r)),r=>Je(r.toISOString()));var tU=e=>t=>t.oneof(t.constant(x()),e(t).map(d)),rU=e=>De({onNone:()=>"none()",onSome:t=>`some(${e(t)})`}),oU=e=>Kl(Jn({_tag:jl("None")}),Jn({_tag:jl("Some"),value:e})),nU=e=>{let t=uv([e],oU(e),r=>{let o=ng(r);return(n,s)=>Wg(n)?j(n)?Je(x()):UT(o(n.value,s),d):Zt(gr(t.ast,n))},{[xi]:"Option",[$x]:rU,[wl]:tU});return t};var sU="@effect/schema/MaxLengthTypeId",uc=(e,t)=>r=>r.pipe(lv(o=>o.length<=e,{typeId:sU,description:`a string at most ${e} character(s) long`,jsonSchema:{maxLength:e},...t}));var hv=Oi(require("fs/promises")),dv=Oi(require("@actions/glob"));var er=class extends Il.TaggedClass("GenericError"){};var aU=dt.string("INPUT_FILE").pipe(dt.map(e=>({_tag:"File",path:e})),dt.orElse(()=>dt.string("JSON").pipe(dt.map(e=>({_tag:"Json",stringified:e})))),dt.orElse(()=>ne(dt.all({key:dt.string("KEY"),value:dt.number("VALUE")}),dt.map(({key:e,value:t})=>({_tag:"KeyVal",key:e,value:t})))),dt.nested("INPUT")),xv=ne(oe.config(aU),oe.mapError(e=>new er({error:e,message:"Failed to read input"}))),gv=e=>oe.try({try:()=>JSON.parse(e),catch:t=>new er({message:"Failed to parse JSON",error:t})}),yv=jl("lower-is-better","higher-is-better"),cU=Jn({key:ne(Zn,uc(120)),sortDate:ne(Zn,ug,Qn),value:pg,units:ne(Zn,uc(32),Qn),trend:ne(yv,Qn)}),o$=Jn({metrics:ne(cU,cg)}),mv=Jn({key:ne(Zn,uc(120),pc("a key to identify the metric across runs")),value:ne(pg,pc("the value of the metric")),sortDate:ne(Zn,ug,pc("the date to apply sorting by. defaults to the commit time"),Qn),units:ne(Zn,uc(32),pc("the units of the metric. example: ms, MiB"),Qn),trend:ne(yv,Qn)}),bv=Kl(ne(mv,cg),mv),n$=ig(bv),Sv=e=>sg(bv)(e).pipe(oe.map(t=>[t].flat()),oe.mapError(t=>new er({error:t,message:`Failed to parse given JSON:
${sv(t.errors)}`}))),pU=e=>oe.tryPromise({try:()=>hv.default.readFile(e,"utf-8"),catch:t=>new er({message:"Failed to read file",error:t})}).pipe(oe.flatMap(gv),oe.flatMap(Sv)),uU=e=>oe.gen(function*(t){let r=yield*t(oe.tryPromise({try:()=>dv.create(e),catch:s=>new er({message:"Failed to parse glob syntax",error:s})})),o=yield*t(oe.tryPromise({try:()=>r.glob(),catch:s=>new er({message:"Failed to iterate through glob",error:s})}));return(yield*t(oe.all(o.map(pU),{concurrency:5}))).flat()}),Ev=ne(Qa.type(),Qa.tagsExhaustive({File:({path:e})=>uU(e),Json:({stringified:e})=>gv(e).pipe(oe.flatMap(Sv)),KeyVal:({key:e,value:t})=>oe.succeed([{key:e,value:t}])}));var Yl=require("@actions/core"),qv=require("@actions/http-client");var _v=e=>e;function Ov(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,o)}return r}function Cv(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ov(Object(r),!0).forEach(function(o){lU(e,o,r[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ov(Object(r)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(r,o))})}return e}function lU(e,t,r){return t=fU(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function fU(e){var t=mU(e,"string");return typeof t=="symbol"?t:String(t)}function mU(e,t){if(typeof e!="object"||e===null)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var o=r.call(e,t||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}var Rv=Av({});function Av(e){return t.withOptions=r=>Av(Cv(Cv({},e),r)),t;function t(r,...o){let n=typeof r=="string"?[r]:r.raw,{escapeSpecialCharacters:s=Array.isArray(r)}=e,i="";for(let u=0;u<n.length;u++){let f=n[u];s&&(f=f.replace(/\\\n[ \t]*/g,"").replace(/\\`/g,"`").replace(/\\\$/g,"$").replace(/\\{/g,"{")),i+=f,u<o.length&&(i+=o[u])}let c=i.split(`
`),p=null;for(let u of c){let f=u.match(/^(\s+)\S+/);if(f){let m=f[1].length;p?p=Math.min(p,m):p=m}}if(p!==null){let u=p;i=c.map(f=>f[0]===" "||f[0]==="	"?f.slice(u):f).join(`
`)}return i.trim().replace(/\\n/g,`
`)}}var Mv=(e=0)=>t=>`\x1B[${t+e}m`,Tv=(e=0)=>t=>`\x1B[${38+e};5;${t}m`,vv=(e=0)=>(t,r,o)=>`\x1B[${38+e};2;${t};${r};${o}m`,ae={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],gray:[90,39],grey:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgGray:[100,49],bgGrey:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}},c$=Object.keys(ae.modifier),hU=Object.keys(ae.color),dU=Object.keys(ae.bgColor),p$=[...hU,...dU];function xU(){let e=new Map;for(let[t,r]of Object.entries(ae)){for(let[o,n]of Object.entries(r))ae[o]={open:`\x1B[${n[0]}m`,close:`\x1B[${n[1]}m`},r[o]=ae[o],e.set(n[0],n[1]);Object.defineProperty(ae,t,{value:r,enumerable:!1})}return Object.defineProperty(ae,"codes",{value:e,enumerable:!1}),ae.color.close="\x1B[39m",ae.bgColor.close="\x1B[49m",ae.color.ansi=Mv(),ae.color.ansi256=Tv(),ae.color.ansi16m=vv(),ae.bgColor.ansi=Mv(10),ae.bgColor.ansi256=Tv(10),ae.bgColor.ansi16m=vv(10),Object.defineProperties(ae,{rgbToAnsi256:{value(t,r,o){return t===r&&r===o?t<8?16:t>248?231:Math.round((t-8)/247*24)+232:16+36*Math.round(t/255*5)+6*Math.round(r/255*5)+Math.round(o/255*5)},enumerable:!1},hexToRgb:{value(t){let r=/[a-f\d]{6}|[a-f\d]{3}/i.exec(t.toString(16));if(!r)return[0,0,0];let[o]=r;o.length===3&&(o=[...o].map(s=>s+s).join(""));let n=Number.parseInt(o,16);return[n>>16&255,n>>8&255,n&255]},enumerable:!1},hexToAnsi256:{value:t=>ae.rgbToAnsi256(...ae.hexToRgb(t)),enumerable:!1},ansi256ToAnsi:{value(t){if(t<8)return 30+t;if(t<16)return 90+(t-8);let r,o,n;if(t>=232)r=((t-232)*10+8)/255,o=r,n=r;else{t-=16;let c=t%36;r=Math.floor(t/36)/5,o=Math.floor(c/6)/5,n=c%6/5}let s=Math.max(r,o,n)*2;if(s===0)return 30;let i=30+(Math.round(n)<<2|Math.round(o)<<1|Math.round(r));return s===2&&(i+=60),i},enumerable:!1},rgbToAnsi:{value:(t,r,o)=>ae.ansi256ToAnsi(ae.rgbToAnsi256(t,r,o)),enumerable:!1},hexToAnsi:{value:t=>ae.ansi256ToAnsi(ae.hexToAnsi256(t)),enumerable:!1}}),ae}var gU=xU(),Sr=gU;var Gl=Oi(require("process"),1),kv=Oi(require("os"),1),lg=Oi(require("tty"),1);function tr(e,t=globalThis.Deno?globalThis.Deno.args:Gl.default.argv){let r=e.startsWith("-")?"":e.length===1?"-":"--",o=t.indexOf(r+e),n=t.indexOf("--");return o!==-1&&(n===-1||o<n)}var{env:le}=Gl.default,Bl;tr("no-color")||tr("no-colors")||tr("color=false")||tr("color=never")?Bl=0:(tr("color")||tr("colors")||tr("color=true")||tr("color=always"))&&(Bl=1);function yU(){if("FORCE_COLOR"in le)return le.FORCE_COLOR==="true"?1:le.FORCE_COLOR==="false"?0:le.FORCE_COLOR.length===0?1:Math.min(Number.parseInt(le.FORCE_COLOR,10),3)}function bU(e){return e===0?!1:{level:e,hasBasic:!0,has256:e>=2,has16m:e>=3}}function SU(e,{streamIsTTY:t,sniffFlags:r=!0}={}){let o=yU();o!==void 0&&(Bl=o);let n=r?Bl:o;if(n===0)return 0;if(r){if(tr("color=16m")||tr("color=full")||tr("color=truecolor"))return 3;if(tr("color=256"))return 2}if("TF_BUILD"in le&&"AGENT_NAME"in le)return 1;if(e&&!t&&n===void 0)return 0;let s=n||0;if(le.TERM==="dumb")return s;if(Gl.default.platform==="win32"){let i=kv.default.release().split(".");return Number(i[0])>=10&&Number(i[2])>=10586?Number(i[2])>=14931?3:2:1}if("CI"in le)return"GITHUB_ACTIONS"in le||"GITEA_ACTIONS"in le?3:["TRAVIS","CIRCLECI","APPVEYOR","GITLAB_CI","BUILDKITE","DRONE"].some(i=>i in le)||le.CI_NAME==="codeship"?1:s;if("TEAMCITY_VERSION"in le)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.test(le.TEAMCITY_VERSION)?1:0;if(le.COLORTERM==="truecolor"||le.TERM==="xterm-kitty")return 3;if("TERM_PROGRAM"in le){let i=Number.parseInt((le.TERM_PROGRAM_VERSION||"").split(".")[0],10);switch(le.TERM_PROGRAM){case"iTerm.app":return i>=3?3:2;case"Apple_Terminal":return 2}}return/-256(color)?$/i.test(le.TERM)?2:/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(le.TERM)||"COLORTERM"in le?1:s}function Iv(e,t={}){let r=SU(e,{streamIsTTY:e&&e.isTTY,...t});return bU(r)}var EU={stdout:Iv({isTTY:lg.default.isatty(1)}),stderr:Iv({isTTY:lg.default.isatty(2)})},wv=EU;function Fv(e,t,r){let o=e.indexOf(t);if(o===-1)return e;let n=t.length,s=0,i="";do i+=e.slice(s,o)+t+r,s=o+n,o=e.indexOf(t,s);while(o!==-1);return i+=e.slice(s),i}function Pv(e,t,r,o){let n=0,s="";do{let i=e[o-1]==="\r";s+=e.slice(n,i?o-1:o)+t+(i?`\r
`:`
`)+r,n=o+1,o=e.indexOf(`
`,n)}while(o!==-1);return s+=e.slice(n),s}var{stdout:Nv,stderr:Dv}=wv,fg=Symbol("GENERATOR"),Si=Symbol("STYLER"),lc=Symbol("IS_EMPTY"),Lv=["ansi","ansi","ansi256","ansi16m"],Ei=Object.create(null),_U=(e,t={})=>{if(t.level&&!(Number.isInteger(t.level)&&t.level>=0&&t.level<=3))throw new Error("The `level` option should be an integer from 0 to 3");let r=Nv?Nv.level:0;e.level=t.level===void 0?r:t.level},$l=class{constructor(t){return Hv(t)}},Hv=e=>{let t=(...r)=>r.join(" ");return _U(t,e),Object.setPrototypeOf(t,fc.prototype),t};function fc(e){return Hv(e)}Object.setPrototypeOf(fc.prototype,Function.prototype);for(let[e,t]of Object.entries(Sr))Ei[e]={get(){let r=Vl(this,hg(t.open,t.close,this[Si]),this[lc]);return Object.defineProperty(this,e,{value:r}),r}};Ei.visible={get(){let e=Vl(this,this[Si],!0);return Object.defineProperty(this,"visible",{value:e}),e}};var mg=(e,t,r,...o)=>e==="rgb"?t==="ansi16m"?Sr[r].ansi16m(...o):t==="ansi256"?Sr[r].ansi256(Sr.rgbToAnsi256(...o)):Sr[r].ansi(Sr.rgbToAnsi(...o)):e==="hex"?mg("rgb",t,r,...Sr.hexToRgb(...o)):Sr[r][e](...o),OU=["rgb","hex","ansi256"];for(let e of OU){Ei[e]={get(){let{level:r}=this;return function(...o){let n=hg(mg(e,Lv[r],"color",...o),Sr.color.close,this[Si]);return Vl(this,n,this[lc])}}};let t="bg"+e[0].toUpperCase()+e.slice(1);Ei[t]={get(){let{level:r}=this;return function(...o){let n=hg(mg(e,Lv[r],"bgColor",...o),Sr.bgColor.close,this[Si]);return Vl(this,n,this[lc])}}}}var CU=Object.defineProperties(()=>{},{...Ei,level:{enumerable:!0,get(){return this[fg].level},set(e){this[fg].level=e}}}),hg=(e,t,r)=>{let o,n;return r===void 0?(o=e,n=t):(o=r.openAll+e,n=t+r.closeAll),{open:e,close:t,openAll:o,closeAll:n,parent:r}},Vl=(e,t,r)=>{let o=(...n)=>RU(o,n.length===1?""+n[0]:n.join(" "));return Object.setPrototypeOf(o,CU),o[fg]=e,o[Si]=t,o[lc]=r,o},RU=(e,t)=>{if(e.level<=0||!t)return e[lc]?"":t;let r=e[Si];if(r===void 0)return t;let{openAll:o,closeAll:n}=r;if(t.includes("\x1B"))for(;r!==void 0;)t=Fv(t,r.close,r.open),r=r.parent;let s=t.indexOf(`
`);return s!==-1&&(t=Pv(t,n,o,s)),o+t+n};Object.defineProperties(fc.prototype,Ei);var x$=fc(),g$=fc({level:Dv?Dv.level:0});var _i=new $l({level:2}),dg=_i.cyan("`id-token`"),AU=Rv`
  Failed to read GitHub Actions ID token.

  This means you probably forgot to add permissions for ${dg} in your workflow/job definition.
  The ${dg} permissions allows GitHub to sign your requests to the Benchy API. This does not
  give GitHub access to your Benchy account: it's merely a way to prove that the request is coming
  from your GitHub workflow.

  An example of a workflow with the ${dg} permission:

  ${_i.dim.yellow("```yaml")}
   jobs:
     test:
       runs-on: ubuntu-latest
  ${_i.green("+    permissions:")}
  ${_i.green("+      id-token: write")}
       steps:
         ${_i.dim.white("# ...")}
  ${_i.dim.yellow("```")}

  For more information about the id-token permisison, see the [GitHub documentation](https://docs.github.com/en/actions/deployment/security-hardening-your-deployments/about-security-hardening-with-openid-connect#overview-of-openid-connect).
`,MU=oe.tryPromise({try:()=>(0,Yl.getIDToken)(),catch:e=>new er({message:AU,error:e})}),TU=oe.gen(function*(e){let t=yield*e(MU);return new qv.HttpClient("bnz-action",[],{headers:{Authorization:`Bearer ${t}`}})}),vU=oe.gen(function*(e){let t=yield*e(xv),r=yield*e(Ev(t)),o=yield*e(TU),n=yield*e(oe.tryPromise({try:()=>o.postJson("https://bnz-web.vercel.app/api/metrics",{metrics:r}),catch:s=>new er({message:"Failed to send metrics",error:s})}));console.log("received",n)});vU.pipe(oe.catchTag("GenericError",e=>((0,Yl.error)(e.message+`
`+String(e.error)),process.exitCode=1,oe.unit)),_v,oe.runPromise);
